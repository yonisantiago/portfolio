var M$=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var HUe=M$((po,mo)=>{function E$(e,t){for(var i=0;i<t.length;i++){const n=t[i];if(typeof n!="string"&&!Array.isArray(n)){for(const r in n)if(r!=="default"&&!(r in e)){const s=Object.getOwnPropertyDescriptor(n,r);s&&Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:()=>n[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function i(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=i(r);fetch(r.href,s)}})();function DL(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function C$(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var i=function n(){if(this instanceof n){var r=[null];r.push.apply(r,arguments);var s=Function.bind.apply(t,r);return new s}return t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(i,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}),i}var Wj={exports:{}},nM={},Xj={exports:{}},ci={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zx=Symbol.for("react.element"),T$=Symbol.for("react.portal"),P$=Symbol.for("react.fragment"),D$=Symbol.for("react.strict_mode"),B$=Symbol.for("react.profiler"),L$=Symbol.for("react.provider"),R$=Symbol.for("react.context"),I$=Symbol.for("react.forward_ref"),O$=Symbol.for("react.suspense"),F$=Symbol.for("react.memo"),N$=Symbol.for("react.lazy"),oz=Symbol.iterator;function z$(e){return e===null||typeof e!="object"?null:(e=oz&&e[oz]||e["@@iterator"],typeof e=="function"?e:null)}var Yj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qj=Object.assign,Qj={};function Yg(e,t,i){this.props=e,this.context=t,this.refs=Qj,this.updater=i||Yj}Yg.prototype.isReactComponent={};Yg.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Yg.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Jj(){}Jj.prototype=Yg.prototype;function BL(e,t,i){this.props=e,this.context=t,this.refs=Qj,this.updater=i||Yj}var LL=BL.prototype=new Jj;LL.constructor=BL;qj(LL,Yg.prototype);LL.isPureReactComponent=!0;var az=Array.isArray,Kj=Object.prototype.hasOwnProperty,RL={current:null},Zj={key:!0,ref:!0,__self:!0,__source:!0};function $j(e,t,i){var n,r={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Kj.call(t,n)&&!Zj.hasOwnProperty(n)&&(r[n]=t[n]);var a=arguments.length-2;if(a===1)r.children=i;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)r[n]===void 0&&(r[n]=a[n]);return{$$typeof:zx,type:e,key:s,ref:o,props:r,_owner:RL.current}}function k$(e,t){return{$$typeof:zx,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function IL(e){return typeof e=="object"&&e!==null&&e.$$typeof===zx}function U$(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return t[i]})}var lz=/\/+/g;function bC(e,t){return typeof e=="object"&&e!==null&&e.key!=null?U$(""+e.key):t.toString(36)}function jb(e,t,i,n,r){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case zx:case T$:o=!0}}if(o)return o=e,r=r(o),e=n===""?"."+bC(o,0):n,az(r)?(i="",e!=null&&(i=e.replace(lz,"$&/")+"/"),jb(r,t,i,"",function(c){return c})):r!=null&&(IL(r)&&(r=k$(r,i+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(lz,"$&/")+"/")+e)),t.push(r)),1;if(o=0,n=n===""?".":n+":",az(e))for(var a=0;a<e.length;a++){s=e[a];var l=n+bC(s,a);o+=jb(s,t,i,l,r)}else if(l=z$(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=n+bC(s,a++),o+=jb(s,t,i,l,r);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Ew(e,t,i){if(e==null)return e;var n=[],r=0;return jb(e,n,"","",function(s){return t.call(i,s,r++)}),n}function G$(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(i){(e._status===0||e._status===-1)&&(e._status=1,e._result=i)},function(i){(e._status===0||e._status===-1)&&(e._status=2,e._result=i)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ys={current:null},Wb={transition:null},H$={ReactCurrentDispatcher:ys,ReactCurrentBatchConfig:Wb,ReactCurrentOwner:RL};ci.Children={map:Ew,forEach:function(e,t,i){Ew(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return Ew(e,function(){t++}),t},toArray:function(e){return Ew(e,function(t){return t})||[]},only:function(e){if(!IL(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ci.Component=Yg;ci.Fragment=P$;ci.Profiler=B$;ci.PureComponent=BL;ci.StrictMode=D$;ci.Suspense=O$;ci.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H$;ci.cloneElement=function(e,t,i){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=qj({},e.props),r=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=RL.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)Kj.call(t,l)&&!Zj.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=i;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:zx,type:e.type,key:r,ref:s,props:n,_owner:o}};ci.createContext=function(e){return e={$$typeof:R$,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:L$,_context:e},e.Consumer=e};ci.createElement=$j;ci.createFactory=function(e){var t=$j.bind(null,e);return t.type=e,t};ci.createRef=function(){return{current:null}};ci.forwardRef=function(e){return{$$typeof:I$,render:e}};ci.isValidElement=IL;ci.lazy=function(e){return{$$typeof:N$,_payload:{_status:-1,_result:e},_init:G$}};ci.memo=function(e,t){return{$$typeof:F$,type:e,compare:t===void 0?null:t}};ci.startTransition=function(e){var t=Wb.transition;Wb.transition={};try{e()}finally{Wb.transition=t}};ci.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ci.useCallback=function(e,t){return ys.current.useCallback(e,t)};ci.useContext=function(e){return ys.current.useContext(e)};ci.useDebugValue=function(){};ci.useDeferredValue=function(e){return ys.current.useDeferredValue(e)};ci.useEffect=function(e,t){return ys.current.useEffect(e,t)};ci.useId=function(){return ys.current.useId()};ci.useImperativeHandle=function(e,t,i){return ys.current.useImperativeHandle(e,t,i)};ci.useInsertionEffect=function(e,t){return ys.current.useInsertionEffect(e,t)};ci.useLayoutEffect=function(e,t){return ys.current.useLayoutEffect(e,t)};ci.useMemo=function(e,t){return ys.current.useMemo(e,t)};ci.useReducer=function(e,t,i){return ys.current.useReducer(e,t,i)};ci.useRef=function(e){return ys.current.useRef(e)};ci.useState=function(e){return ys.current.useState(e)};ci.useSyncExternalStore=function(e,t,i){return ys.current.useSyncExternalStore(e,t,i)};ci.useTransition=function(){return ys.current.useTransition()};ci.version="18.2.0";Xj.exports=ci;var ae=Xj.exports;const kx=DL(ae),cz=E$({__proto__:null,default:kx},[ae]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V$=ae,j$=Symbol.for("react.element"),W$=Symbol.for("react.fragment"),X$=Object.prototype.hasOwnProperty,Y$=V$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,q$={key:!0,ref:!0,__self:!0,__source:!0};function e8(e,t,i){var n,r={},s=null,o=null;i!==void 0&&(s=""+i),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)X$.call(t,n)&&!q$.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)r[n]===void 0&&(r[n]=t[n]);return{$$typeof:j$,type:e,key:s,ref:o,props:r,_owner:Y$.current}}nM.Fragment=W$;nM.jsx=e8;nM.jsxs=e8;Wj.exports=nM;var OL=Wj.exports;const pg=OL.Fragment,Be=OL.jsx,Et=OL.jsxs;var VP={},t8={exports:{}},bo={},i8={exports:{}},n8={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(U,X){var V=U.length;U.push(X);e:for(;0<V;){var q=V-1>>>1,H=U[q];if(0<r(H,X))U[q]=X,U[V]=H,V=q;else break e}}function i(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var X=U[0],V=U.pop();if(V!==X){U[0]=V;e:for(var q=0,H=U.length,Q=H>>>1;q<Q;){var J=2*(q+1)-1,le=U[J],j=J+1,ve=U[j];if(0>r(le,V))j<H&&0>r(ve,le)?(U[q]=ve,U[j]=V,q=j):(U[q]=le,U[J]=V,q=J);else if(j<H&&0>r(ve,V))U[q]=ve,U[j]=V,q=j;else break e}}return X}function r(U,X){var V=U.sortIndex-X.sortIndex;return V!==0?V:U.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(U){for(var X=i(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=U)n(c),X.sortIndex=X.expirationTime,t(l,X);else break;X=i(c)}}function b(U){if(g=!1,w(U),!p)if(i(l)!==null)p=!0,K(M);else{var X=i(c);X!==null&&Z(b,X.startTime-U)}}function M(U,X){p=!1,g&&(g=!1,v(S),S=-1),f=!0;var V=d;try{for(w(X),u=i(l);u!==null&&(!(u.expirationTime>X)||U&&!B());){var q=u.callback;if(typeof q=="function"){u.callback=null,d=u.priorityLevel;var H=q(u.expirationTime<=X);X=e.unstable_now(),typeof H=="function"?u.callback=H:u===i(l)&&n(l),w(X)}else n(l);u=i(l)}if(u!==null)var Q=!0;else{var J=i(c);J!==null&&Z(b,J.startTime-X),Q=!1}return Q}finally{u=null,d=V,f=!1}}var A=!1,T=null,S=-1,C=5,P=-1;function B(){return!(e.unstable_now()-P<C)}function k(){if(T!==null){var U=e.unstable_now();P=U;var X=!0;try{X=T(!0,U)}finally{X?z():(A=!1,T=null)}}else A=!1}var z;if(typeof x=="function")z=function(){x(k)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,W=F.port2;F.port1.onmessage=k,z=function(){W.postMessage(null)}}else z=function(){m(k,0)};function K(U){T=U,A||(A=!0,z())}function Z(U,X){S=m(function(){U(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,K(M))},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return i(l)},e.unstable_next=function(U){switch(d){case 1:case 2:case 3:var X=3;break;default:X=d}var V=d;d=X;try{return U()}finally{d=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(U,X){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var V=d;d=U;try{return X()}finally{d=V}},e.unstable_scheduleCallback=function(U,X,V){var q=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?q+V:q):V=q,U){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=V+H,U={id:h++,callback:X,priorityLevel:U,startTime:V,expirationTime:H,sortIndex:-1},V>q?(U.sortIndex=V,t(c,U),i(l)===null&&U===i(c)&&(g?(v(S),S=-1):g=!0,Z(b,V-q))):(U.sortIndex=H,t(l,U),p||f||(p=!0,K(M))),U},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(U){var X=d;return function(){var V=d;d=X;try{return U.apply(this,arguments)}finally{d=V}}}})(n8);i8.exports=n8;var Q$=i8.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r8=ae,xo=Q$;function Qe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s8=new Set,Ny={};function Vf(e,t){mg(e,t),mg(e+"Capture",t)}function mg(e,t){for(Ny[e]=t,e=0;e<t.length;e++)s8.add(t[e])}var tu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jP=Object.prototype.hasOwnProperty,J$=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uz={},hz={};function K$(e){return jP.call(hz,e)?!0:jP.call(uz,e)?!1:J$.test(e)?hz[e]=!0:(uz[e]=!0,!1)}function Z$(e,t,i,n){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function $$(e,t,i,n){if(t===null||typeof t>"u"||Z$(e,t,i,n))return!0;if(n)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function xs(e,t,i,n,r,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Br={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Br[e]=new xs(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Br[t]=new xs(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Br[e]=new xs(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Br[e]=new xs(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Br[e]=new xs(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Br[e]=new xs(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Br[e]=new xs(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Br[e]=new xs(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Br[e]=new xs(e,5,!1,e.toLowerCase(),null,!1,!1)});var FL=/[\-:]([a-z])/g;function NL(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(FL,NL);Br[t]=new xs(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(FL,NL);Br[t]=new xs(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(FL,NL);Br[t]=new xs(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Br[e]=new xs(e,1,!1,e.toLowerCase(),null,!1,!1)});Br.xlinkHref=new xs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Br[e]=new xs(e,1,!1,e.toLowerCase(),null,!0,!0)});function zL(e,t,i,n){var r=Br.hasOwnProperty(t)?Br[t]:null;(r!==null?r.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&($$(t,i,r,n)&&(i=null),n||r===null?K$(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):r.mustUseProperty?e[r.propertyName]=i===null?r.type===3?!1:"":i:(t=r.attributeName,n=r.attributeNamespace,i===null?e.removeAttribute(t):(r=r.type,i=r===3||r===4&&i===!0?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}var uu=r8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Cw=Symbol.for("react.element"),gm=Symbol.for("react.portal"),vm=Symbol.for("react.fragment"),kL=Symbol.for("react.strict_mode"),WP=Symbol.for("react.profiler"),o8=Symbol.for("react.provider"),a8=Symbol.for("react.context"),UL=Symbol.for("react.forward_ref"),XP=Symbol.for("react.suspense"),YP=Symbol.for("react.suspense_list"),GL=Symbol.for("react.memo"),Yu=Symbol.for("react.lazy"),l8=Symbol.for("react.offscreen"),dz=Symbol.iterator;function zv(e){return e===null||typeof e!="object"?null:(e=dz&&e[dz]||e["@@iterator"],typeof e=="function"?e:null)}var cn=Object.assign,AC;function V0(e){if(AC===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);AC=t&&t[1]||""}return`
`+AC+e}var SC=!1;function MC(e,t){if(!e||SC)return"";SC=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=n.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{SC=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?V0(e):""}function eee(e){switch(e.tag){case 5:return V0(e.type);case 16:return V0("Lazy");case 13:return V0("Suspense");case 19:return V0("SuspenseList");case 0:case 2:case 15:return e=MC(e.type,!1),e;case 11:return e=MC(e.type.render,!1),e;case 1:return e=MC(e.type,!0),e;default:return""}}function qP(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vm:return"Fragment";case gm:return"Portal";case WP:return"Profiler";case kL:return"StrictMode";case XP:return"Suspense";case YP:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case a8:return(e.displayName||"Context")+".Consumer";case o8:return(e._context.displayName||"Context")+".Provider";case UL:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case GL:return t=e.displayName||null,t!==null?t:qP(e.type)||"Memo";case Yu:t=e._payload,e=e._init;try{return qP(e(t))}catch{}}return null}function tee(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return qP(t);case 8:return t===kL?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ph(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function c8(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function iee(e){var t=c8(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var r=i.get,s=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Tw(e){e._valueTracker||(e._valueTracker=iee(e))}function u8(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=c8(e)?e.checked?"true":"false":e.value),e=n,e!==i?(t.setValue(e),!0):!1}function SA(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function QP(e,t){var i=t.checked;return cn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function fz(e,t){var i=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;i=Ph(t.value!=null?t.value:i),e._wrapperState={initialChecked:n,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function h8(e,t){t=t.checked,t!=null&&zL(e,"checked",t,!1)}function JP(e,t){h8(e,t);var i=Ph(t.value),n=t.type;if(i!=null)n==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?KP(e,t.type,i):t.hasOwnProperty("defaultValue")&&KP(e,t.type,Ph(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function pz(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function KP(e,t,i){(t!=="number"||SA(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var j0=Array.isArray;function Wm(e,t,i,n){if(e=e.options,t){t={};for(var r=0;r<i.length;r++)t["$"+i[r]]=!0;for(i=0;i<e.length;i++)r=t.hasOwnProperty("$"+e[i].value),e[i].selected!==r&&(e[i].selected=r),r&&n&&(e[i].defaultSelected=!0)}else{for(i=""+Ph(i),t=null,r=0;r<e.length;r++){if(e[r].value===i){e[r].selected=!0,n&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function ZP(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Qe(91));return cn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function mz(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(Qe(92));if(j0(i)){if(1<i.length)throw Error(Qe(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:Ph(i)}}function d8(e,t){var i=Ph(t.value),n=Ph(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),n!=null&&(e.defaultValue=""+n)}function gz(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function f8(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $P(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?f8(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Pw,p8=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,n,r){MSApp.execUnsafeLocalFunction(function(){return e(t,i,n,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Pw=Pw||document.createElement("div"),Pw.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Pw.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function zy(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var ry={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nee=["Webkit","ms","Moz","O"];Object.keys(ry).forEach(function(e){nee.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ry[t]=ry[e]})});function m8(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||ry.hasOwnProperty(e)&&ry[e]?(""+t).trim():t+"px"}function g8(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var n=i.indexOf("--")===0,r=m8(i,t[i],n);i==="float"&&(i="cssFloat"),n?e.setProperty(i,r):e[i]=r}}var ree=cn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function eD(e,t){if(t){if(ree[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Qe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Qe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Qe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Qe(62))}}function tD(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var iD=null;function HL(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var nD=null,Xm=null,Ym=null;function vz(e){if(e=Hx(e)){if(typeof nD!="function")throw Error(Qe(280));var t=e.stateNode;t&&(t=lM(t),nD(e.stateNode,e.type,t))}}function v8(e){Xm?Ym?Ym.push(e):Ym=[e]:Xm=e}function y8(){if(Xm){var e=Xm,t=Ym;if(Ym=Xm=null,vz(e),t)for(e=0;e<t.length;e++)vz(t[e])}}function x8(e,t){return e(t)}function w8(){}var EC=!1;function _8(e,t,i){if(EC)return e(t,i);EC=!0;try{return x8(e,t,i)}finally{EC=!1,(Xm!==null||Ym!==null)&&(w8(),y8())}}function ky(e,t){var i=e.stateNode;if(i===null)return null;var n=lM(i);if(n===null)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(Qe(231,t,typeof i));return i}var rD=!1;if(tu)try{var kv={};Object.defineProperty(kv,"passive",{get:function(){rD=!0}}),window.addEventListener("test",kv,kv),window.removeEventListener("test",kv,kv)}catch{rD=!1}function see(e,t,i,n,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(i,c)}catch(h){this.onError(h)}}var sy=!1,MA=null,EA=!1,sD=null,oee={onError:function(e){sy=!0,MA=e}};function aee(e,t,i,n,r,s,o,a,l){sy=!1,MA=null,see.apply(oee,arguments)}function lee(e,t,i,n,r,s,o,a,l){if(aee.apply(this,arguments),sy){if(sy){var c=MA;sy=!1,MA=null}else throw Error(Qe(198));EA||(EA=!0,sD=c)}}function jf(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function b8(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function yz(e){if(jf(e)!==e)throw Error(Qe(188))}function cee(e){var t=e.alternate;if(!t){if(t=jf(e),t===null)throw Error(Qe(188));return t!==e?null:e}for(var i=e,n=t;;){var r=i.return;if(r===null)break;var s=r.alternate;if(s===null){if(n=r.return,n!==null){i=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===i)return yz(r),e;if(s===n)return yz(r),t;s=s.sibling}throw Error(Qe(188))}if(i.return!==n.return)i=r,n=s;else{for(var o=!1,a=r.child;a;){if(a===i){o=!0,i=r,n=s;break}if(a===n){o=!0,n=r,i=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===i){o=!0,i=s,n=r;break}if(a===n){o=!0,n=s,i=r;break}a=a.sibling}if(!o)throw Error(Qe(189))}}if(i.alternate!==n)throw Error(Qe(190))}if(i.tag!==3)throw Error(Qe(188));return i.stateNode.current===i?e:t}function A8(e){return e=cee(e),e!==null?S8(e):null}function S8(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=S8(e);if(t!==null)return t;e=e.sibling}return null}var M8=xo.unstable_scheduleCallback,xz=xo.unstable_cancelCallback,uee=xo.unstable_shouldYield,hee=xo.unstable_requestPaint,Cn=xo.unstable_now,dee=xo.unstable_getCurrentPriorityLevel,VL=xo.unstable_ImmediatePriority,E8=xo.unstable_UserBlockingPriority,CA=xo.unstable_NormalPriority,fee=xo.unstable_LowPriority,C8=xo.unstable_IdlePriority,rM=null,zl=null;function pee(e){if(zl&&typeof zl.onCommitFiberRoot=="function")try{zl.onCommitFiberRoot(rM,e,void 0,(e.current.flags&128)===128)}catch{}}var Va=Math.clz32?Math.clz32:vee,mee=Math.log,gee=Math.LN2;function vee(e){return e>>>=0,e===0?32:31-(mee(e)/gee|0)|0}var Dw=64,Bw=4194304;function W0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function TA(e,t){var i=e.pendingLanes;if(i===0)return 0;var n=0,r=e.suspendedLanes,s=e.pingedLanes,o=i&268435455;if(o!==0){var a=o&~r;a!==0?n=W0(a):(s&=o,s!==0&&(n=W0(s)))}else o=i&~r,o!==0?n=W0(o):s!==0&&(n=W0(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&r)&&(r=n&-n,s=t&-t,r>=s||r===16&&(s&4194240)!==0))return t;if(n&4&&(n|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)i=31-Va(t),r=1<<i,n|=e[i],t&=~r;return n}function yee(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xee(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Va(s),a=1<<o,l=r[o];l===-1?(!(a&i)||a&n)&&(r[o]=yee(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}function oD(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function T8(){var e=Dw;return Dw<<=1,!(Dw&4194240)&&(Dw=64),e}function CC(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Ux(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Va(t),e[t]=i}function wee(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<i;){var r=31-Va(i),s=1<<r;t[r]=0,n[r]=-1,e[r]=-1,i&=~s}}function jL(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-Va(i),r=1<<n;r&t|e[n]&t&&(e[n]|=t),i&=~r}}var Di=0;function P8(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var D8,WL,B8,L8,R8,aD=!1,Lw=[],gh=null,vh=null,yh=null,Uy=new Map,Gy=new Map,th=[],_ee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wz(e,t){switch(e){case"focusin":case"focusout":gh=null;break;case"dragenter":case"dragleave":vh=null;break;case"mouseover":case"mouseout":yh=null;break;case"pointerover":case"pointerout":Uy.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gy.delete(t.pointerId)}}function Uv(e,t,i,n,r,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},t!==null&&(t=Hx(t),t!==null&&WL(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function bee(e,t,i,n,r){switch(t){case"focusin":return gh=Uv(gh,e,t,i,n,r),!0;case"dragenter":return vh=Uv(vh,e,t,i,n,r),!0;case"mouseover":return yh=Uv(yh,e,t,i,n,r),!0;case"pointerover":var s=r.pointerId;return Uy.set(s,Uv(Uy.get(s)||null,e,t,i,n,r)),!0;case"gotpointercapture":return s=r.pointerId,Gy.set(s,Uv(Gy.get(s)||null,e,t,i,n,r)),!0}return!1}function I8(e){var t=Qd(e.target);if(t!==null){var i=jf(t);if(i!==null){if(t=i.tag,t===13){if(t=b8(i),t!==null){e.blockedOn=t,R8(e.priority,function(){B8(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xb(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=lD(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var n=new i.constructor(i.type,i);iD=n,i.target.dispatchEvent(n),iD=null}else return t=Hx(i),t!==null&&WL(t),e.blockedOn=i,!1;t.shift()}return!0}function _z(e,t,i){Xb(e)&&i.delete(t)}function Aee(){aD=!1,gh!==null&&Xb(gh)&&(gh=null),vh!==null&&Xb(vh)&&(vh=null),yh!==null&&Xb(yh)&&(yh=null),Uy.forEach(_z),Gy.forEach(_z)}function Gv(e,t){e.blockedOn===t&&(e.blockedOn=null,aD||(aD=!0,xo.unstable_scheduleCallback(xo.unstable_NormalPriority,Aee)))}function Hy(e){function t(r){return Gv(r,e)}if(0<Lw.length){Gv(Lw[0],e);for(var i=1;i<Lw.length;i++){var n=Lw[i];n.blockedOn===e&&(n.blockedOn=null)}}for(gh!==null&&Gv(gh,e),vh!==null&&Gv(vh,e),yh!==null&&Gv(yh,e),Uy.forEach(t),Gy.forEach(t),i=0;i<th.length;i++)n=th[i],n.blockedOn===e&&(n.blockedOn=null);for(;0<th.length&&(i=th[0],i.blockedOn===null);)I8(i),i.blockedOn===null&&th.shift()}var qm=uu.ReactCurrentBatchConfig,PA=!0;function See(e,t,i,n){var r=Di,s=qm.transition;qm.transition=null;try{Di=1,XL(e,t,i,n)}finally{Di=r,qm.transition=s}}function Mee(e,t,i,n){var r=Di,s=qm.transition;qm.transition=null;try{Di=4,XL(e,t,i,n)}finally{Di=r,qm.transition=s}}function XL(e,t,i,n){if(PA){var r=lD(e,t,i,n);if(r===null)NC(e,t,n,DA,i),wz(e,n);else if(bee(r,e,t,i,n))n.stopPropagation();else if(wz(e,n),t&4&&-1<_ee.indexOf(e)){for(;r!==null;){var s=Hx(r);if(s!==null&&D8(s),s=lD(e,t,i,n),s===null&&NC(e,t,n,DA,i),s===r)break;r=s}r!==null&&n.stopPropagation()}else NC(e,t,n,null,i)}}var DA=null;function lD(e,t,i,n){if(DA=null,e=HL(n),e=Qd(e),e!==null)if(t=jf(e),t===null)e=null;else if(i=t.tag,i===13){if(e=b8(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return DA=e,null}function O8(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dee()){case VL:return 1;case E8:return 4;case CA:case fee:return 16;case C8:return 536870912;default:return 16}default:return 16}}var oh=null,YL=null,Yb=null;function F8(){if(Yb)return Yb;var e,t=YL,i=t.length,n,r="value"in oh?oh.value:oh.textContent,s=r.length;for(e=0;e<i&&t[e]===r[e];e++);var o=i-e;for(n=1;n<=o&&t[i-n]===r[s-n];n++);return Yb=r.slice(e,1<n?1-n:void 0)}function qb(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Rw(){return!0}function bz(){return!1}function Ao(e){function t(i,n,r,s,o){this._reactName=i,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(i=e[a],this[a]=i?i(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Rw:bz,this.isPropagationStopped=bz,this}return cn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Rw)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Rw)},persist:function(){},isPersistent:Rw}),t}var qg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qL=Ao(qg),Gx=cn({},qg,{view:0,detail:0}),Eee=Ao(Gx),TC,PC,Hv,sM=cn({},Gx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:QL,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Hv&&(Hv&&e.type==="mousemove"?(TC=e.screenX-Hv.screenX,PC=e.screenY-Hv.screenY):PC=TC=0,Hv=e),TC)},movementY:function(e){return"movementY"in e?e.movementY:PC}}),Az=Ao(sM),Cee=cn({},sM,{dataTransfer:0}),Tee=Ao(Cee),Pee=cn({},Gx,{relatedTarget:0}),DC=Ao(Pee),Dee=cn({},qg,{animationName:0,elapsedTime:0,pseudoElement:0}),Bee=Ao(Dee),Lee=cn({},qg,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ree=Ao(Lee),Iee=cn({},qg,{data:0}),Sz=Ao(Iee),Oee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zee(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Nee[e])?!!t[e]:!1}function QL(){return zee}var kee=cn({},Gx,{key:function(e){if(e.key){var t=Oee[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=qb(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Fee[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:QL,charCode:function(e){return e.type==="keypress"?qb(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?qb(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Uee=Ao(kee),Gee=cn({},sM,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mz=Ao(Gee),Hee=cn({},Gx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:QL}),Vee=Ao(Hee),jee=cn({},qg,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wee=Ao(jee),Xee=cn({},sM,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Yee=Ao(Xee),qee=[9,13,27,32],JL=tu&&"CompositionEvent"in window,oy=null;tu&&"documentMode"in document&&(oy=document.documentMode);var Qee=tu&&"TextEvent"in window&&!oy,N8=tu&&(!JL||oy&&8<oy&&11>=oy),Ez=String.fromCharCode(32),Cz=!1;function z8(e,t){switch(e){case"keyup":return qee.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function k8(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ym=!1;function Jee(e,t){switch(e){case"compositionend":return k8(t);case"keypress":return t.which!==32?null:(Cz=!0,Ez);case"textInput":return e=t.data,e===Ez&&Cz?null:e;default:return null}}function Kee(e,t){if(ym)return e==="compositionend"||!JL&&z8(e,t)?(e=F8(),Yb=YL=oh=null,ym=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return N8&&t.locale!=="ko"?null:t.data;default:return null}}var Zee={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tz(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Zee[e.type]:t==="textarea"}function U8(e,t,i,n){v8(n),t=BA(t,"onChange"),0<t.length&&(i=new qL("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var ay=null,Vy=null;function $ee(e){K8(e,0)}function oM(e){var t=_m(e);if(u8(t))return e}function ete(e,t){if(e==="change")return t}var G8=!1;if(tu){var BC;if(tu){var LC="oninput"in document;if(!LC){var Pz=document.createElement("div");Pz.setAttribute("oninput","return;"),LC=typeof Pz.oninput=="function"}BC=LC}else BC=!1;G8=BC&&(!document.documentMode||9<document.documentMode)}function Dz(){ay&&(ay.detachEvent("onpropertychange",H8),Vy=ay=null)}function H8(e){if(e.propertyName==="value"&&oM(Vy)){var t=[];U8(t,Vy,e,HL(e)),_8($ee,t)}}function tte(e,t,i){e==="focusin"?(Dz(),ay=t,Vy=i,ay.attachEvent("onpropertychange",H8)):e==="focusout"&&Dz()}function ite(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return oM(Vy)}function nte(e,t){if(e==="click")return oM(t)}function rte(e,t){if(e==="input"||e==="change")return oM(t)}function ste(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qa=typeof Object.is=="function"?Object.is:ste;function jy(e,t){if(Qa(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!jP.call(t,r)||!Qa(e[r],t[r]))return!1}return!0}function Bz(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Lz(e,t){var i=Bz(e);e=0;for(var n;i;){if(i.nodeType===3){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Bz(i)}}function V8(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?V8(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function j8(){for(var e=window,t=SA();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=SA(e.document)}return t}function KL(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ote(e){var t=j8(),i=e.focusedElem,n=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&V8(i.ownerDocument.documentElement,i)){if(n!==null&&KL(i)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=i.textContent.length,s=Math.min(n.start,r);n=n.end===void 0?s:Math.min(n.end,r),!e.extend&&s>n&&(r=n,n=s,s=r),r=Lz(i,s);var o=Lz(i,n);r&&o&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ate=tu&&"documentMode"in document&&11>=document.documentMode,xm=null,cD=null,ly=null,uD=!1;function Rz(e,t,i){var n=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;uD||xm==null||xm!==SA(n)||(n=xm,"selectionStart"in n&&KL(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ly&&jy(ly,n)||(ly=n,n=BA(cD,"onSelect"),0<n.length&&(t=new qL("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=xm)))}function Iw(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var wm={animationend:Iw("Animation","AnimationEnd"),animationiteration:Iw("Animation","AnimationIteration"),animationstart:Iw("Animation","AnimationStart"),transitionend:Iw("Transition","TransitionEnd")},RC={},W8={};tu&&(W8=document.createElement("div").style,"AnimationEvent"in window||(delete wm.animationend.animation,delete wm.animationiteration.animation,delete wm.animationstart.animation),"TransitionEvent"in window||delete wm.transitionend.transition);function aM(e){if(RC[e])return RC[e];if(!wm[e])return e;var t=wm[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in W8)return RC[e]=t[i];return e}var X8=aM("animationend"),Y8=aM("animationiteration"),q8=aM("animationstart"),Q8=aM("transitionend"),J8=new Map,Iz="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hh(e,t){J8.set(e,t),Vf(t,[e])}for(var IC=0;IC<Iz.length;IC++){var OC=Iz[IC],lte=OC.toLowerCase(),cte=OC[0].toUpperCase()+OC.slice(1);Hh(lte,"on"+cte)}Hh(X8,"onAnimationEnd");Hh(Y8,"onAnimationIteration");Hh(q8,"onAnimationStart");Hh("dblclick","onDoubleClick");Hh("focusin","onFocus");Hh("focusout","onBlur");Hh(Q8,"onTransitionEnd");mg("onMouseEnter",["mouseout","mouseover"]);mg("onMouseLeave",["mouseout","mouseover"]);mg("onPointerEnter",["pointerout","pointerover"]);mg("onPointerLeave",["pointerout","pointerover"]);Vf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var X0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ute=new Set("cancel close invalid load scroll toggle".split(" ").concat(X0));function Oz(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,lee(n,t,void 0,e),e.currentTarget=null}function K8(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var n=e[i],r=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Oz(r,a,c),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Oz(r,a,c),s=l}}}if(EA)throw e=sD,EA=!1,sD=null,e}function Wi(e,t){var i=t[mD];i===void 0&&(i=t[mD]=new Set);var n=e+"__bubble";i.has(n)||(Z8(t,e,2,!1),i.add(n))}function FC(e,t,i){var n=0;t&&(n|=4),Z8(i,e,n,t)}var Ow="_reactListening"+Math.random().toString(36).slice(2);function Wy(e){if(!e[Ow]){e[Ow]=!0,s8.forEach(function(i){i!=="selectionchange"&&(ute.has(i)||FC(i,!1,e),FC(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ow]||(t[Ow]=!0,FC("selectionchange",!1,t))}}function Z8(e,t,i,n){switch(O8(t)){case 1:var r=See;break;case 4:r=Mee;break;default:r=XL}i=r.bind(null,t,i,e),r=void 0,!rD||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),n?r!==void 0?e.addEventListener(t,i,{capture:!0,passive:r}):e.addEventListener(t,i,!0):r!==void 0?e.addEventListener(t,i,{passive:r}):e.addEventListener(t,i,!1)}function NC(e,t,i,n,r){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Qd(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}_8(function(){var c=s,h=HL(i),u=[];e:{var d=J8.get(e);if(d!==void 0){var f=qL,p=e;switch(e){case"keypress":if(qb(i)===0)break e;case"keydown":case"keyup":f=Uee;break;case"focusin":p="focus",f=DC;break;case"focusout":p="blur",f=DC;break;case"beforeblur":case"afterblur":f=DC;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Az;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Tee;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Vee;break;case X8:case Y8:case q8:f=Bee;break;case Q8:f=Wee;break;case"scroll":f=Eee;break;case"wheel":f=Yee;break;case"copy":case"cut":case"paste":f=Ree;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Mz}var g=(t&4)!==0,m=!g&&e==="scroll",v=g?d!==null?d+"Capture":null:d;g=[];for(var x=c,w;x!==null;){w=x;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,v!==null&&(b=ky(x,v),b!=null&&g.push(Xy(x,b,w)))),m)break;x=x.return}0<g.length&&(d=new f(d,p,null,i,h),u.push({event:d,listeners:g}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",d&&i!==iD&&(p=i.relatedTarget||i.fromElement)&&(Qd(p)||p[iu]))break e;if((f||d)&&(d=h.window===h?h:(d=h.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=i.relatedTarget||i.toElement,f=c,p=p?Qd(p):null,p!==null&&(m=jf(p),p!==m||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(g=Az,b="onMouseLeave",v="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(g=Mz,b="onPointerLeave",v="onPointerEnter",x="pointer"),m=f==null?d:_m(f),w=p==null?d:_m(p),d=new g(b,x+"leave",f,i,h),d.target=m,d.relatedTarget=w,b=null,Qd(h)===c&&(g=new g(v,x+"enter",p,i,h),g.target=w,g.relatedTarget=m,b=g),m=b,f&&p)t:{for(g=f,v=p,x=0,w=g;w;w=gp(w))x++;for(w=0,b=v;b;b=gp(b))w++;for(;0<x-w;)g=gp(g),x--;for(;0<w-x;)v=gp(v),w--;for(;x--;){if(g===v||v!==null&&g===v.alternate)break t;g=gp(g),v=gp(v)}g=null}else g=null;f!==null&&Fz(u,d,f,g,!1),p!==null&&m!==null&&Fz(u,m,p,g,!0)}}e:{if(d=c?_m(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var M=ete;else if(Tz(d))if(G8)M=rte;else{M=ite;var A=tte}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(M=nte);if(M&&(M=M(e,c))){U8(u,M,i,h);break e}A&&A(e,d,c),e==="focusout"&&(A=d._wrapperState)&&A.controlled&&d.type==="number"&&KP(d,"number",d.value)}switch(A=c?_m(c):window,e){case"focusin":(Tz(A)||A.contentEditable==="true")&&(xm=A,cD=c,ly=null);break;case"focusout":ly=cD=xm=null;break;case"mousedown":uD=!0;break;case"contextmenu":case"mouseup":case"dragend":uD=!1,Rz(u,i,h);break;case"selectionchange":if(ate)break;case"keydown":case"keyup":Rz(u,i,h)}var T;if(JL)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else ym?z8(e,i)&&(S="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(S="onCompositionStart");S&&(N8&&i.locale!=="ko"&&(ym||S!=="onCompositionStart"?S==="onCompositionEnd"&&ym&&(T=F8()):(oh=h,YL="value"in oh?oh.value:oh.textContent,ym=!0)),A=BA(c,S),0<A.length&&(S=new Sz(S,e,null,i,h),u.push({event:S,listeners:A}),T?S.data=T:(T=k8(i),T!==null&&(S.data=T)))),(T=Qee?Jee(e,i):Kee(e,i))&&(c=BA(c,"onBeforeInput"),0<c.length&&(h=new Sz("onBeforeInput","beforeinput",null,i,h),u.push({event:h,listeners:c}),h.data=T))}K8(u,t)})}function Xy(e,t,i){return{instance:e,listener:t,currentTarget:i}}function BA(e,t){for(var i=t+"Capture",n=[];e!==null;){var r=e,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=ky(e,i),s!=null&&n.unshift(Xy(e,s,r)),s=ky(e,t),s!=null&&n.push(Xy(e,s,r))),e=e.return}return n}function gp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Fz(e,t,i,n,r){for(var s=t._reactName,o=[];i!==null&&i!==n;){var a=i,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,r?(l=ky(i,s),l!=null&&o.unshift(Xy(i,l,a))):r||(l=ky(i,s),l!=null&&o.push(Xy(i,l,a)))),i=i.return}o.length!==0&&e.push({event:t,listeners:o})}var hte=/\r\n?/g,dte=/\u0000|\uFFFD/g;function Nz(e){return(typeof e=="string"?e:""+e).replace(hte,`
`).replace(dte,"")}function Fw(e,t,i){if(t=Nz(t),Nz(e)!==t&&i)throw Error(Qe(425))}function LA(){}var hD=null,dD=null;function fD(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var pD=typeof setTimeout=="function"?setTimeout:void 0,fte=typeof clearTimeout=="function"?clearTimeout:void 0,zz=typeof Promise=="function"?Promise:void 0,pte=typeof queueMicrotask=="function"?queueMicrotask:typeof zz<"u"?function(e){return zz.resolve(null).then(e).catch(mte)}:pD;function mte(e){setTimeout(function(){throw e})}function zC(e,t){var i=t,n=0;do{var r=i.nextSibling;if(e.removeChild(i),r&&r.nodeType===8)if(i=r.data,i==="/$"){if(n===0){e.removeChild(r),Hy(t);return}n--}else i!=="$"&&i!=="$?"&&i!=="$!"||n++;i=r}while(i);Hy(t)}function xh(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function kz(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var Qg=Math.random().toString(36).slice(2),Bl="__reactFiber$"+Qg,Yy="__reactProps$"+Qg,iu="__reactContainer$"+Qg,mD="__reactEvents$"+Qg,gte="__reactListeners$"+Qg,vte="__reactHandles$"+Qg;function Qd(e){var t=e[Bl];if(t)return t;for(var i=e.parentNode;i;){if(t=i[iu]||i[Bl]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=kz(e);e!==null;){if(i=e[Bl])return i;e=kz(e)}return t}e=i,i=e.parentNode}return null}function Hx(e){return e=e[Bl]||e[iu],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function _m(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Qe(33))}function lM(e){return e[Yy]||null}var gD=[],bm=-1;function Vh(e){return{current:e}}function qi(e){0>bm||(e.current=gD[bm],gD[bm]=null,bm--)}function Vi(e,t){bm++,gD[bm]=e.current,e.current=t}var Dh={},Jr=Vh(Dh),Us=Vh(!1),Cf=Dh;function gg(e,t){var i=e.type.contextTypes;if(!i)return Dh;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in i)r[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Gs(e){return e=e.childContextTypes,e!=null}function RA(){qi(Us),qi(Jr)}function Uz(e,t,i){if(Jr.current!==Dh)throw Error(Qe(168));Vi(Jr,t),Vi(Us,i)}function $8(e,t,i){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return i;n=n.getChildContext();for(var r in n)if(!(r in t))throw Error(Qe(108,tee(e)||"Unknown",r));return cn({},i,n)}function IA(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Dh,Cf=Jr.current,Vi(Jr,e),Vi(Us,Us.current),!0}function Gz(e,t,i){var n=e.stateNode;if(!n)throw Error(Qe(169));i?(e=$8(e,t,Cf),n.__reactInternalMemoizedMergedChildContext=e,qi(Us),qi(Jr),Vi(Jr,e)):qi(Us),Vi(Us,i)}var Rc=null,cM=!1,kC=!1;function eW(e){Rc===null?Rc=[e]:Rc.push(e)}function yte(e){cM=!0,eW(e)}function jh(){if(!kC&&Rc!==null){kC=!0;var e=0,t=Di;try{var i=Rc;for(Di=1;e<i.length;e++){var n=i[e];do n=n(!0);while(n!==null)}Rc=null,cM=!1}catch(r){throw Rc!==null&&(Rc=Rc.slice(e+1)),M8(VL,jh),r}finally{Di=t,kC=!1}}return null}var Am=[],Sm=0,OA=null,FA=0,Yo=[],qo=0,Tf=null,kc=1,Uc="";function Bd(e,t){Am[Sm++]=FA,Am[Sm++]=OA,OA=e,FA=t}function tW(e,t,i){Yo[qo++]=kc,Yo[qo++]=Uc,Yo[qo++]=Tf,Tf=e;var n=kc;e=Uc;var r=32-Va(n)-1;n&=~(1<<r),i+=1;var s=32-Va(t)+r;if(30<s){var o=r-r%5;s=(n&(1<<o)-1).toString(32),n>>=o,r-=o,kc=1<<32-Va(t)+r|i<<r|n,Uc=s+e}else kc=1<<s|i<<r|n,Uc=e}function ZL(e){e.return!==null&&(Bd(e,1),tW(e,1,0))}function $L(e){for(;e===OA;)OA=Am[--Sm],Am[Sm]=null,FA=Am[--Sm],Am[Sm]=null;for(;e===Tf;)Tf=Yo[--qo],Yo[qo]=null,Uc=Yo[--qo],Yo[qo]=null,kc=Yo[--qo],Yo[qo]=null}var go=null,lo=null,Zi=!1,Oa=null;function iW(e,t){var i=Zo(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function Hz(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,go=e,lo=xh(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,go=e,lo=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=Tf!==null?{id:kc,overflow:Uc}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=Zo(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,go=e,lo=null,!0):!1;default:return!1}}function vD(e){return(e.mode&1)!==0&&(e.flags&128)===0}function yD(e){if(Zi){var t=lo;if(t){var i=t;if(!Hz(e,t)){if(vD(e))throw Error(Qe(418));t=xh(i.nextSibling);var n=go;t&&Hz(e,t)?iW(n,i):(e.flags=e.flags&-4097|2,Zi=!1,go=e)}}else{if(vD(e))throw Error(Qe(418));e.flags=e.flags&-4097|2,Zi=!1,go=e}}}function Vz(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;go=e}function Nw(e){if(e!==go)return!1;if(!Zi)return Vz(e),Zi=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!fD(e.type,e.memoizedProps)),t&&(t=lo)){if(vD(e))throw nW(),Error(Qe(418));for(;t;)iW(e,t),t=xh(t.nextSibling)}if(Vz(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Qe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){lo=xh(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}lo=null}}else lo=go?xh(e.stateNode.nextSibling):null;return!0}function nW(){for(var e=lo;e;)e=xh(e.nextSibling)}function vg(){lo=go=null,Zi=!1}function eR(e){Oa===null?Oa=[e]:Oa.push(e)}var xte=uu.ReactCurrentBatchConfig;function La(e,t){if(e&&e.defaultProps){t=cn({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}var NA=Vh(null),zA=null,Mm=null,tR=null;function iR(){tR=Mm=zA=null}function nR(e){var t=NA.current;qi(NA),e._currentValue=t}function xD(e,t,i){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function Qm(e,t){zA=e,tR=Mm=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Fs=!0),e.firstContext=null)}function aa(e){var t=e._currentValue;if(tR!==e)if(e={context:e,memoizedValue:t,next:null},Mm===null){if(zA===null)throw Error(Qe(308));Mm=e,zA.dependencies={lanes:0,firstContext:e}}else Mm=Mm.next=e;return t}var Jd=null;function rR(e){Jd===null?Jd=[e]:Jd.push(e)}function rW(e,t,i,n){var r=t.interleaved;return r===null?(i.next=i,rR(t)):(i.next=r.next,r.next=i),t.interleaved=i,nu(e,n)}function nu(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var qu=!1;function sR(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sW(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function wh(e,t,i){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,mi&2){var r=n.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),n.pending=t,nu(e,i)}return r=n.interleaved,r===null?(t.next=t,rR(n)):(t.next=r.next,r.next=t),n.interleaved=t,nu(e,i)}function Qb(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,i|=n,t.lanes=i,jL(e,i)}}function jz(e,t){var i=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,i===n)){var r=null,s=null;if(i=i.firstBaseUpdate,i!==null){do{var o={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};s===null?r=s=o:s=s.next=o,i=i.next}while(i!==null);s===null?r=s=t:s=s.next=t}else r=s=t;i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function kA(e,t,i,n){var r=e.updateQueue;qu=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var h=e.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(s!==null){var u=r.baseState;o=0,h=c=l=null,a=s;do{var d=a.lane,f=a.eventTime;if((n&d)===d){h!==null&&(h=h.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(d=t,f=i,g.tag){case 1:if(p=g.payload,typeof p=="function"){u=p.call(f,u,d);break e}u=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(f,u,d):p,d==null)break e;u=cn({},u,d);break e;case 2:qu=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,d=r.effects,d===null?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=f,l=u):h=h.next=f,o|=d;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;d=a,a=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(1);if(h===null&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=h,t=r.shared.interleaved,t!==null){r=t;do o|=r.lane,r=r.next;while(r!==t)}else s===null&&(r.shared.lanes=0);Df|=o,e.lanes=o,e.memoizedState=u}}function Wz(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(r!==null){if(n.callback=null,n=i,typeof r!="function")throw Error(Qe(191,r));r.call(n)}}}var oW=new r8.Component().refs;function wD(e,t,i,n){t=e.memoizedState,i=i(n,t),i=i==null?t:cn({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var uM={isMounted:function(e){return(e=e._reactInternals)?jf(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=ps(),r=bh(e),s=qc(n,r);s.payload=t,i!=null&&(s.callback=i),t=wh(e,s,r),t!==null&&(ja(t,e,r,n),Qb(t,e,r))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=ps(),r=bh(e),s=qc(n,r);s.tag=1,s.payload=t,i!=null&&(s.callback=i),t=wh(e,s,r),t!==null&&(ja(t,e,r,n),Qb(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=ps(),n=bh(e),r=qc(i,n);r.tag=2,t!=null&&(r.callback=t),t=wh(e,r,n),t!==null&&(ja(t,e,n,i),Qb(t,e,n))}};function Xz(e,t,i,n,r,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!jy(i,n)||!jy(r,s):!0}function aW(e,t,i){var n=!1,r=Dh,s=t.contextType;return typeof s=="object"&&s!==null?s=aa(s):(r=Gs(t)?Cf:Jr.current,n=t.contextTypes,s=(n=n!=null)?gg(e,r):Dh),t=new t(i,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=uM,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function Yz(e,t,i,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&uM.enqueueReplaceState(t,t.state,null)}function _D(e,t,i,n){var r=e.stateNode;r.props=i,r.state=e.memoizedState,r.refs=oW,sR(e);var s=t.contextType;typeof s=="object"&&s!==null?r.context=aa(s):(s=Gs(t)?Cf:Jr.current,r.context=gg(e,s)),r.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(wD(e,t,s,i),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&uM.enqueueReplaceState(r,r.state,null),kA(e,i,r,n),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Vv(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(Qe(309));var n=i.stateNode}if(!n)throw Error(Qe(147,e));var r=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=r.refs;a===oW&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(Qe(284));if(!i._owner)throw Error(Qe(290,e))}return e}function zw(e,t){throw e=Object.prototype.toString.call(t),Error(Qe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function qz(e){var t=e._init;return t(e._payload)}function lW(e){function t(v,x){if(e){var w=v.deletions;w===null?(v.deletions=[x],v.flags|=16):w.push(x)}}function i(v,x){if(!e)return null;for(;x!==null;)t(v,x),x=x.sibling;return null}function n(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function r(v,x){return v=Ah(v,x),v.index=0,v.sibling=null,v}function s(v,x,w){return v.index=w,e?(w=v.alternate,w!==null?(w=w.index,w<x?(v.flags|=2,x):w):(v.flags|=2,x)):(v.flags|=1048576,x)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function a(v,x,w,b){return x===null||x.tag!==6?(x=XC(w,v.mode,b),x.return=v,x):(x=r(x,w),x.return=v,x)}function l(v,x,w,b){var M=w.type;return M===vm?h(v,x,w.props.children,b,w.key):x!==null&&(x.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Yu&&qz(M)===x.type)?(b=r(x,w.props),b.ref=Vv(v,x,w),b.return=v,b):(b=tA(w.type,w.key,w.props,null,v.mode,b),b.ref=Vv(v,x,w),b.return=v,b)}function c(v,x,w,b){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=YC(w,v.mode,b),x.return=v,x):(x=r(x,w.children||[]),x.return=v,x)}function h(v,x,w,b,M){return x===null||x.tag!==7?(x=hf(w,v.mode,b,M),x.return=v,x):(x=r(x,w),x.return=v,x)}function u(v,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=XC(""+x,v.mode,w),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Cw:return w=tA(x.type,x.key,x.props,null,v.mode,w),w.ref=Vv(v,null,x),w.return=v,w;case gm:return x=YC(x,v.mode,w),x.return=v,x;case Yu:var b=x._init;return u(v,b(x._payload),w)}if(j0(x)||zv(x))return x=hf(x,v.mode,w,null),x.return=v,x;zw(v,x)}return null}function d(v,x,w,b){var M=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return M!==null?null:a(v,x,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Cw:return w.key===M?l(v,x,w,b):null;case gm:return w.key===M?c(v,x,w,b):null;case Yu:return M=w._init,d(v,x,M(w._payload),b)}if(j0(w)||zv(w))return M!==null?null:h(v,x,w,b,null);zw(v,w)}return null}function f(v,x,w,b,M){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(w)||null,a(x,v,""+b,M);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Cw:return v=v.get(b.key===null?w:b.key)||null,l(x,v,b,M);case gm:return v=v.get(b.key===null?w:b.key)||null,c(x,v,b,M);case Yu:var A=b._init;return f(v,x,w,A(b._payload),M)}if(j0(b)||zv(b))return v=v.get(w)||null,h(x,v,b,M,null);zw(x,b)}return null}function p(v,x,w,b){for(var M=null,A=null,T=x,S=x=0,C=null;T!==null&&S<w.length;S++){T.index>S?(C=T,T=null):C=T.sibling;var P=d(v,T,w[S],b);if(P===null){T===null&&(T=C);break}e&&T&&P.alternate===null&&t(v,T),x=s(P,x,S),A===null?M=P:A.sibling=P,A=P,T=C}if(S===w.length)return i(v,T),Zi&&Bd(v,S),M;if(T===null){for(;S<w.length;S++)T=u(v,w[S],b),T!==null&&(x=s(T,x,S),A===null?M=T:A.sibling=T,A=T);return Zi&&Bd(v,S),M}for(T=n(v,T);S<w.length;S++)C=f(T,v,S,w[S],b),C!==null&&(e&&C.alternate!==null&&T.delete(C.key===null?S:C.key),x=s(C,x,S),A===null?M=C:A.sibling=C,A=C);return e&&T.forEach(function(B){return t(v,B)}),Zi&&Bd(v,S),M}function g(v,x,w,b){var M=zv(w);if(typeof M!="function")throw Error(Qe(150));if(w=M.call(w),w==null)throw Error(Qe(151));for(var A=M=null,T=x,S=x=0,C=null,P=w.next();T!==null&&!P.done;S++,P=w.next()){T.index>S?(C=T,T=null):C=T.sibling;var B=d(v,T,P.value,b);if(B===null){T===null&&(T=C);break}e&&T&&B.alternate===null&&t(v,T),x=s(B,x,S),A===null?M=B:A.sibling=B,A=B,T=C}if(P.done)return i(v,T),Zi&&Bd(v,S),M;if(T===null){for(;!P.done;S++,P=w.next())P=u(v,P.value,b),P!==null&&(x=s(P,x,S),A===null?M=P:A.sibling=P,A=P);return Zi&&Bd(v,S),M}for(T=n(v,T);!P.done;S++,P=w.next())P=f(T,v,S,P.value,b),P!==null&&(e&&P.alternate!==null&&T.delete(P.key===null?S:P.key),x=s(P,x,S),A===null?M=P:A.sibling=P,A=P);return e&&T.forEach(function(k){return t(v,k)}),Zi&&Bd(v,S),M}function m(v,x,w,b){if(typeof w=="object"&&w!==null&&w.type===vm&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Cw:e:{for(var M=w.key,A=x;A!==null;){if(A.key===M){if(M=w.type,M===vm){if(A.tag===7){i(v,A.sibling),x=r(A,w.props.children),x.return=v,v=x;break e}}else if(A.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Yu&&qz(M)===A.type){i(v,A.sibling),x=r(A,w.props),x.ref=Vv(v,A,w),x.return=v,v=x;break e}i(v,A);break}else t(v,A);A=A.sibling}w.type===vm?(x=hf(w.props.children,v.mode,b,w.key),x.return=v,v=x):(b=tA(w.type,w.key,w.props,null,v.mode,b),b.ref=Vv(v,x,w),b.return=v,v=b)}return o(v);case gm:e:{for(A=w.key;x!==null;){if(x.key===A)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){i(v,x.sibling),x=r(x,w.children||[]),x.return=v,v=x;break e}else{i(v,x);break}else t(v,x);x=x.sibling}x=YC(w,v.mode,b),x.return=v,v=x}return o(v);case Yu:return A=w._init,m(v,x,A(w._payload),b)}if(j0(w))return p(v,x,w,b);if(zv(w))return g(v,x,w,b);zw(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(i(v,x.sibling),x=r(x,w),x.return=v,v=x):(i(v,x),x=XC(w,v.mode,b),x.return=v,v=x),o(v)):i(v,x)}return m}var yg=lW(!0),cW=lW(!1),Vx={},kl=Vh(Vx),qy=Vh(Vx),Qy=Vh(Vx);function Kd(e){if(e===Vx)throw Error(Qe(174));return e}function oR(e,t){switch(Vi(Qy,t),Vi(qy,e),Vi(kl,Vx),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:$P(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=$P(t,e)}qi(kl),Vi(kl,t)}function xg(){qi(kl),qi(qy),qi(Qy)}function uW(e){Kd(Qy.current);var t=Kd(kl.current),i=$P(t,e.type);t!==i&&(Vi(qy,e),Vi(kl,i))}function aR(e){qy.current===e&&(qi(kl),qi(qy))}var nn=Vh(0);function UA(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var UC=[];function lR(){for(var e=0;e<UC.length;e++)UC[e]._workInProgressVersionPrimary=null;UC.length=0}var Jb=uu.ReactCurrentDispatcher,GC=uu.ReactCurrentBatchConfig,Pf=0,ln=null,Jn=null,mr=null,GA=!1,cy=!1,Jy=0,wte=0;function zr(){throw Error(Qe(321))}function cR(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Qa(e[i],t[i]))return!1;return!0}function uR(e,t,i,n,r,s){if(Pf=s,ln=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Jb.current=e===null||e.memoizedState===null?Ste:Mte,e=i(n,r),cy){s=0;do{if(cy=!1,Jy=0,25<=s)throw Error(Qe(301));s+=1,mr=Jn=null,t.updateQueue=null,Jb.current=Ete,e=i(n,r)}while(cy)}if(Jb.current=HA,t=Jn!==null&&Jn.next!==null,Pf=0,mr=Jn=ln=null,GA=!1,t)throw Error(Qe(300));return e}function hR(){var e=Jy!==0;return Jy=0,e}function Ml(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?ln.memoizedState=mr=e:mr=mr.next=e,mr}function la(){if(Jn===null){var e=ln.alternate;e=e!==null?e.memoizedState:null}else e=Jn.next;var t=mr===null?ln.memoizedState:mr.next;if(t!==null)mr=t,Jn=e;else{if(e===null)throw Error(Qe(310));Jn=e,e={memoizedState:Jn.memoizedState,baseState:Jn.baseState,baseQueue:Jn.baseQueue,queue:Jn.queue,next:null},mr===null?ln.memoizedState=mr=e:mr=mr.next=e}return mr}function Ky(e,t){return typeof t=="function"?t(e):t}function HC(e){var t=la(),i=t.queue;if(i===null)throw Error(Qe(311));i.lastRenderedReducer=e;var n=Jn,r=n.baseQueue,s=i.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,i.pending=null}if(r!==null){s=r.next,n=n.baseState;var a=o=null,l=null,c=s;do{var h=c.lane;if((Pf&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var u={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=u,o=n):l=l.next=u,ln.lanes|=h,Df|=h}c=c.next}while(c!==null&&c!==s);l===null?o=n:l.next=a,Qa(n,t.memoizedState)||(Fs=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,i.lastRenderedState=n}if(e=i.interleaved,e!==null){r=e;do s=r.lane,ln.lanes|=s,Df|=s,r=r.next;while(r!==e)}else r===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function VC(e){var t=la(),i=t.queue;if(i===null)throw Error(Qe(311));i.lastRenderedReducer=e;var n=i.dispatch,r=i.pending,s=t.memoizedState;if(r!==null){i.pending=null;var o=r=r.next;do s=e(s,o.action),o=o.next;while(o!==r);Qa(s,t.memoizedState)||(Fs=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),i.lastRenderedState=s}return[s,n]}function hW(){}function dW(e,t){var i=ln,n=la(),r=t(),s=!Qa(n.memoizedState,r);if(s&&(n.memoizedState=r,Fs=!0),n=n.queue,dR(mW.bind(null,i,n,e),[e]),n.getSnapshot!==t||s||mr!==null&&mr.memoizedState.tag&1){if(i.flags|=2048,Zy(9,pW.bind(null,i,n,r,t),void 0,null),vr===null)throw Error(Qe(349));Pf&30||fW(i,t,r)}return r}function fW(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=ln.updateQueue,t===null?(t={lastEffect:null,stores:null},ln.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function pW(e,t,i,n){t.value=i,t.getSnapshot=n,gW(t)&&vW(e)}function mW(e,t,i){return i(function(){gW(t)&&vW(e)})}function gW(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!Qa(e,i)}catch{return!0}}function vW(e){var t=nu(e,1);t!==null&&ja(t,e,1,-1)}function Qz(e){var t=Ml();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ky,lastRenderedState:e},t.queue=e,e=e.dispatch=Ate.bind(null,ln,e),[t.memoizedState,e]}function Zy(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},t=ln.updateQueue,t===null?(t={lastEffect:null,stores:null},ln.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e)),e}function yW(){return la().memoizedState}function Kb(e,t,i,n){var r=Ml();ln.flags|=e,r.memoizedState=Zy(1|t,i,void 0,n===void 0?null:n)}function hM(e,t,i,n){var r=la();n=n===void 0?null:n;var s=void 0;if(Jn!==null){var o=Jn.memoizedState;if(s=o.destroy,n!==null&&cR(n,o.deps)){r.memoizedState=Zy(t,i,s,n);return}}ln.flags|=e,r.memoizedState=Zy(1|t,i,s,n)}function Jz(e,t){return Kb(8390656,8,e,t)}function dR(e,t){return hM(2048,8,e,t)}function xW(e,t){return hM(4,2,e,t)}function wW(e,t){return hM(4,4,e,t)}function _W(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function bW(e,t,i){return i=i!=null?i.concat([e]):null,hM(4,4,_W.bind(null,t,e),i)}function fR(){}function AW(e,t){var i=la();t=t===void 0?null:t;var n=i.memoizedState;return n!==null&&t!==null&&cR(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function SW(e,t){var i=la();t=t===void 0?null:t;var n=i.memoizedState;return n!==null&&t!==null&&cR(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function MW(e,t,i){return Pf&21?(Qa(i,t)||(i=T8(),ln.lanes|=i,Df|=i,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Fs=!0),e.memoizedState=i)}function _te(e,t){var i=Di;Di=i!==0&&4>i?i:4,e(!0);var n=GC.transition;GC.transition={};try{e(!1),t()}finally{Di=i,GC.transition=n}}function EW(){return la().memoizedState}function bte(e,t,i){var n=bh(e);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},CW(e))TW(t,i);else if(i=rW(e,t,i,n),i!==null){var r=ps();ja(i,e,n,r),PW(i,t,n)}}function Ate(e,t,i){var n=bh(e),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(CW(e))TW(t,r);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,i);if(r.hasEagerState=!0,r.eagerState=a,Qa(a,o)){var l=t.interleaved;l===null?(r.next=r,rR(t)):(r.next=l.next,l.next=r),t.interleaved=r;return}}catch{}finally{}i=rW(e,t,r,n),i!==null&&(r=ps(),ja(i,e,n,r),PW(i,t,n))}}function CW(e){var t=e.alternate;return e===ln||t!==null&&t===ln}function TW(e,t){cy=GA=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function PW(e,t,i){if(i&4194240){var n=t.lanes;n&=e.pendingLanes,i|=n,t.lanes=i,jL(e,i)}}var HA={readContext:aa,useCallback:zr,useContext:zr,useEffect:zr,useImperativeHandle:zr,useInsertionEffect:zr,useLayoutEffect:zr,useMemo:zr,useReducer:zr,useRef:zr,useState:zr,useDebugValue:zr,useDeferredValue:zr,useTransition:zr,useMutableSource:zr,useSyncExternalStore:zr,useId:zr,unstable_isNewReconciler:!1},Ste={readContext:aa,useCallback:function(e,t){return Ml().memoizedState=[e,t===void 0?null:t],e},useContext:aa,useEffect:Jz,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,Kb(4194308,4,_W.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Kb(4194308,4,e,t)},useInsertionEffect:function(e,t){return Kb(4,2,e,t)},useMemo:function(e,t){var i=Ml();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=Ml();return t=i!==void 0?i(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=bte.bind(null,ln,e),[n.memoizedState,e]},useRef:function(e){var t=Ml();return e={current:e},t.memoizedState=e},useState:Qz,useDebugValue:fR,useDeferredValue:function(e){return Ml().memoizedState=e},useTransition:function(){var e=Qz(!1),t=e[0];return e=_te.bind(null,e[1]),Ml().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var n=ln,r=Ml();if(Zi){if(i===void 0)throw Error(Qe(407));i=i()}else{if(i=t(),vr===null)throw Error(Qe(349));Pf&30||fW(n,t,i)}r.memoizedState=i;var s={value:i,getSnapshot:t};return r.queue=s,Jz(mW.bind(null,n,s,e),[e]),n.flags|=2048,Zy(9,pW.bind(null,n,s,i,t),void 0,null),i},useId:function(){var e=Ml(),t=vr.identifierPrefix;if(Zi){var i=Uc,n=kc;i=(n&~(1<<32-Va(n)-1)).toString(32)+i,t=":"+t+"R"+i,i=Jy++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=wte++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Mte={readContext:aa,useCallback:AW,useContext:aa,useEffect:dR,useImperativeHandle:bW,useInsertionEffect:xW,useLayoutEffect:wW,useMemo:SW,useReducer:HC,useRef:yW,useState:function(){return HC(Ky)},useDebugValue:fR,useDeferredValue:function(e){var t=la();return MW(t,Jn.memoizedState,e)},useTransition:function(){var e=HC(Ky)[0],t=la().memoizedState;return[e,t]},useMutableSource:hW,useSyncExternalStore:dW,useId:EW,unstable_isNewReconciler:!1},Ete={readContext:aa,useCallback:AW,useContext:aa,useEffect:dR,useImperativeHandle:bW,useInsertionEffect:xW,useLayoutEffect:wW,useMemo:SW,useReducer:VC,useRef:yW,useState:function(){return VC(Ky)},useDebugValue:fR,useDeferredValue:function(e){var t=la();return Jn===null?t.memoizedState=e:MW(t,Jn.memoizedState,e)},useTransition:function(){var e=VC(Ky)[0],t=la().memoizedState;return[e,t]},useMutableSource:hW,useSyncExternalStore:dW,useId:EW,unstable_isNewReconciler:!1};function wg(e,t){try{var i="",n=t;do i+=eee(n),n=n.return;while(n);var r=i}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:r,digest:null}}function jC(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function bD(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var Cte=typeof WeakMap=="function"?WeakMap:Map;function DW(e,t,i){i=qc(-1,i),i.tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){jA||(jA=!0,LD=n),bD(e,t)},i}function BW(e,t,i){i=qc(-1,i),i.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var r=t.value;i.payload=function(){return n(r)},i.callback=function(){bD(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(i.callback=function(){bD(e,t),typeof n!="function"&&(_h===null?_h=new Set([this]):_h.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),i}function Kz(e,t,i){var n=e.pingCache;if(n===null){n=e.pingCache=new Cte;var r=new Set;n.set(t,r)}else r=n.get(t),r===void 0&&(r=new Set,n.set(t,r));r.has(i)||(r.add(i),e=Gte.bind(null,e,t,i),t.then(e,e))}function Zz(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function $z(e,t,i,n,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=qc(-1,1),t.tag=2,wh(i,t,1))),i.lanes|=1),e)}var Tte=uu.ReactCurrentOwner,Fs=!1;function ls(e,t,i,n){t.child=e===null?cW(t,null,i,n):yg(t,e.child,i,n)}function ek(e,t,i,n,r){i=i.render;var s=t.ref;return Qm(t,r),n=uR(e,t,i,n,s,r),i=hR(),e!==null&&!Fs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,ru(e,t,r)):(Zi&&i&&ZL(t),t.flags|=1,ls(e,t,n,r),t.child)}function tk(e,t,i,n,r){if(e===null){var s=i.type;return typeof s=="function"&&!_R(s)&&s.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=s,LW(e,t,s,n,r)):(e=tA(i.type,null,n,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&r)){var o=s.memoizedProps;if(i=i.compare,i=i!==null?i:jy,i(o,n)&&e.ref===t.ref)return ru(e,t,r)}return t.flags|=1,e=Ah(s,n),e.ref=t.ref,e.return=t,t.child=e}function LW(e,t,i,n,r){if(e!==null){var s=e.memoizedProps;if(jy(s,n)&&e.ref===t.ref)if(Fs=!1,t.pendingProps=n=s,(e.lanes&r)!==0)e.flags&131072&&(Fs=!0);else return t.lanes=e.lanes,ru(e,t,r)}return AD(e,t,i,n,r)}function RW(e,t,i){var n=t.pendingProps,r=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vi(Cm,no),no|=i;else{if(!(i&1073741824))return e=s!==null?s.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Vi(Cm,no),no|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:i,Vi(Cm,no),no|=n}else s!==null?(n=s.baseLanes|i,t.memoizedState=null):n=i,Vi(Cm,no),no|=n;return ls(e,t,r,i),t.child}function IW(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function AD(e,t,i,n,r){var s=Gs(i)?Cf:Jr.current;return s=gg(t,s),Qm(t,r),i=uR(e,t,i,n,s,r),n=hR(),e!==null&&!Fs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,ru(e,t,r)):(Zi&&n&&ZL(t),t.flags|=1,ls(e,t,i,r),t.child)}function ik(e,t,i,n,r){if(Gs(i)){var s=!0;IA(t)}else s=!1;if(Qm(t,r),t.stateNode===null)Zb(e,t),aW(t,i,n),_D(t,i,n,r),n=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=i.contextType;typeof c=="object"&&c!==null?c=aa(c):(c=Gs(i)?Cf:Jr.current,c=gg(t,c));var h=i.getDerivedStateFromProps,u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&Yz(t,o,n,c),qu=!1;var d=t.memoizedState;o.state=d,kA(t,n,o,r),l=t.memoizedState,a!==n||d!==l||Us.current||qu?(typeof h=="function"&&(wD(t,i,h,n),l=t.memoizedState),(a=qu||Xz(t,i,a,n,d,l,c))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,sW(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:La(t.type,a),o.props=c,u=t.pendingProps,d=o.context,l=i.contextType,typeof l=="object"&&l!==null?l=aa(l):(l=Gs(i)?Cf:Jr.current,l=gg(t,l));var f=i.getDerivedStateFromProps;(h=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==u||d!==l)&&Yz(t,o,n,l),qu=!1,d=t.memoizedState,o.state=d,kA(t,n,o,r);var p=t.memoizedState;a!==u||d!==p||Us.current||qu?(typeof f=="function"&&(wD(t,i,f,n),p=t.memoizedState),(c=qu||Xz(t,i,c,n,d,p,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,p,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),o.props=n,o.state=p,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return SD(e,t,i,n,s,r)}function SD(e,t,i,n,r,s){IW(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return r&&Gz(t,i,!1),ru(e,t,s);n=t.stateNode,Tte.current=t;var a=o&&typeof i.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=yg(t,e.child,null,s),t.child=yg(t,null,a,s)):ls(e,t,a,s),t.memoizedState=n.state,r&&Gz(t,i,!0),t.child}function OW(e){var t=e.stateNode;t.pendingContext?Uz(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Uz(e,t.context,!1),oR(e,t.containerInfo)}function nk(e,t,i,n,r){return vg(),eR(r),t.flags|=256,ls(e,t,i,n),t.child}var MD={dehydrated:null,treeContext:null,retryLane:0};function ED(e){return{baseLanes:e,cachePool:null,transitions:null}}function FW(e,t,i){var n=t.pendingProps,r=nn.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(r&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),Vi(nn,r&1),e===null)return yD(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=pM(o,n,0,null),e=hf(e,n,i,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=ED(i),t.memoizedState=MD,e):pR(t,o));if(r=e.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return Pte(e,t,o,n,a,r,i);if(s){s=n.fallback,o=t.mode,r=e.child,a=r.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&t.child!==r?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Ah(r,l),n.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Ah(a,s):(s=hf(s,o,i,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?ED(i):{baseLanes:o.baseLanes|i,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~i,t.memoizedState=MD,n}return s=e.child,e=s.sibling,n=Ah(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=i),n.return=t,n.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n}function pR(e,t){return t=pM({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function kw(e,t,i,n){return n!==null&&eR(n),yg(t,e.child,null,i),e=pR(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Pte(e,t,i,n,r,s,o){if(i)return t.flags&256?(t.flags&=-257,n=jC(Error(Qe(422))),kw(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,r=t.mode,n=pM({mode:"visible",children:n.children},r,0,null),s=hf(s,r,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&yg(t,e.child,null,o),t.child.memoizedState=ED(o),t.memoizedState=MD,s);if(!(t.mode&1))return kw(e,t,o,null);if(r.data==="$!"){if(n=r.nextSibling&&r.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(Qe(419)),n=jC(s,n,void 0),kw(e,t,o,n)}if(a=(o&e.childLanes)!==0,Fs||a){if(n=vr,n!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(n.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,nu(e,r),ja(n,e,r,-1))}return wR(),n=jC(Error(Qe(421))),kw(e,t,o,n)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=Hte.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,lo=xh(r.nextSibling),go=t,Zi=!0,Oa=null,e!==null&&(Yo[qo++]=kc,Yo[qo++]=Uc,Yo[qo++]=Tf,kc=e.id,Uc=e.overflow,Tf=t),t=pR(t,n.children),t.flags|=4096,t)}function rk(e,t,i){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),xD(e.return,t,i)}function WC(e,t,i,n,r){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=i,s.tailMode=r)}function NW(e,t,i){var n=t.pendingProps,r=n.revealOrder,s=n.tail;if(ls(e,t,n.children,i),n=nn.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&rk(e,i,t);else if(e.tag===19)rk(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Vi(nn,n),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(i=t.child,r=null;i!==null;)e=i.alternate,e!==null&&UA(e)===null&&(r=i),i=i.sibling;i=r,i===null?(r=t.child,t.child=null):(r=i.sibling,i.sibling=null),WC(t,!1,r,i,s);break;case"backwards":for(i=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&UA(e)===null){t.child=r;break}e=r.sibling,r.sibling=i,i=r,r=e}WC(t,!0,i,null,s);break;case"together":WC(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Zb(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ru(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),Df|=t.lanes,!(i&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Qe(153));if(t.child!==null){for(e=t.child,i=Ah(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=Ah(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function Dte(e,t,i){switch(t.tag){case 3:OW(t),vg();break;case 5:uW(t);break;case 1:Gs(t.type)&&IA(t);break;case 4:oR(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;Vi(NA,n._currentValue),n._currentValue=r;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Vi(nn,nn.current&1),t.flags|=128,null):i&t.child.childLanes?FW(e,t,i):(Vi(nn,nn.current&1),e=ru(e,t,i),e!==null?e.sibling:null);Vi(nn,nn.current&1);break;case 19:if(n=(i&t.childLanes)!==0,e.flags&128){if(n)return NW(e,t,i);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Vi(nn,nn.current),n)break;return null;case 22:case 23:return t.lanes=0,RW(e,t,i)}return ru(e,t,i)}var zW,CD,kW,UW;zW=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};CD=function(){};kW=function(e,t,i,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,Kd(kl.current);var s=null;switch(i){case"input":r=QP(e,r),n=QP(e,n),s=[];break;case"select":r=cn({},r,{value:void 0}),n=cn({},n,{value:void 0}),s=[];break;case"textarea":r=ZP(e,r),n=ZP(e,n),s=[];break;default:typeof r.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=LA)}eD(i,n);var o;i=null;for(c in r)if(!n.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(i||(i={}),i[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ny.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(a=r!=null?r[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(i||(i={}),i[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(i||(i={}),i[o]=l[o])}else i||(s||(s=[]),s.push(c,i)),i=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ny.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Wi("scroll",e),s||a===l||(s=[])):(s=s||[]).push(c,l))}i&&(s=s||[]).push("style",i);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};UW=function(e,t,i,n){i!==n&&(t.flags|=4)};function jv(e,t){if(!Zi)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;i!==null;)i.alternate!==null&&(n=i),i=i.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function kr(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,n=0;if(t)for(var r=e.child;r!==null;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags&14680064,n|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function Bte(e,t,i){var n=t.pendingProps;switch($L(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kr(t),null;case 1:return Gs(t.type)&&RA(),kr(t),null;case 3:return n=t.stateNode,xg(),qi(Us),qi(Jr),lR(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Nw(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Oa!==null&&(OD(Oa),Oa=null))),CD(e,t),kr(t),null;case 5:aR(t);var r=Kd(Qy.current);if(i=t.type,e!==null&&t.stateNode!=null)kW(e,t,i,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Qe(166));return kr(t),null}if(e=Kd(kl.current),Nw(t)){n=t.stateNode,i=t.type;var s=t.memoizedProps;switch(n[Bl]=t,n[Yy]=s,e=(t.mode&1)!==0,i){case"dialog":Wi("cancel",n),Wi("close",n);break;case"iframe":case"object":case"embed":Wi("load",n);break;case"video":case"audio":for(r=0;r<X0.length;r++)Wi(X0[r],n);break;case"source":Wi("error",n);break;case"img":case"image":case"link":Wi("error",n),Wi("load",n);break;case"details":Wi("toggle",n);break;case"input":fz(n,s),Wi("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Wi("invalid",n);break;case"textarea":mz(n,s),Wi("invalid",n)}eD(i,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&Fw(n.textContent,a,e),r=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Fw(n.textContent,a,e),r=["children",""+a]):Ny.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Wi("scroll",n)}switch(i){case"input":Tw(n),pz(n,s,!0);break;case"textarea":Tw(n),gz(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=LA)}n=r,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=f8(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(i,{is:n.is}):(e=o.createElement(i),i==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,i),e[Bl]=t,e[Yy]=n,zW(e,t,!1,!1),t.stateNode=e;e:{switch(o=tD(i,n),i){case"dialog":Wi("cancel",e),Wi("close",e),r=n;break;case"iframe":case"object":case"embed":Wi("load",e),r=n;break;case"video":case"audio":for(r=0;r<X0.length;r++)Wi(X0[r],e);r=n;break;case"source":Wi("error",e),r=n;break;case"img":case"image":case"link":Wi("error",e),Wi("load",e),r=n;break;case"details":Wi("toggle",e),r=n;break;case"input":fz(e,n),r=QP(e,n),Wi("invalid",e);break;case"option":r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=cn({},n,{value:void 0}),Wi("invalid",e);break;case"textarea":mz(e,n),r=ZP(e,n),Wi("invalid",e);break;default:r=n}eD(i,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?g8(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&p8(e,l)):s==="children"?typeof l=="string"?(i!=="textarea"||l!=="")&&zy(e,l):typeof l=="number"&&zy(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ny.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Wi("scroll",e):l!=null&&zL(e,s,l,o))}switch(i){case"input":Tw(e),pz(e,n,!1);break;case"textarea":Tw(e),gz(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ph(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Wm(e,!!n.multiple,s,!1):n.defaultValue!=null&&Wm(e,!!n.multiple,n.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=LA)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return kr(t),null;case 6:if(e&&t.stateNode!=null)UW(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Qe(166));if(i=Kd(Qy.current),Kd(kl.current),Nw(t)){if(n=t.stateNode,i=t.memoizedProps,n[Bl]=t,(s=n.nodeValue!==i)&&(e=go,e!==null))switch(e.tag){case 3:Fw(n.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Fw(n.nodeValue,i,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(i.nodeType===9?i:i.ownerDocument).createTextNode(n),n[Bl]=t,t.stateNode=n}return kr(t),null;case 13:if(qi(nn),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Zi&&lo!==null&&t.mode&1&&!(t.flags&128))nW(),vg(),t.flags|=98560,s=!1;else if(s=Nw(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Qe(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Qe(317));s[Bl]=t}else vg(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;kr(t),s=!1}else Oa!==null&&(OD(Oa),Oa=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=i,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||nn.current&1?Zn===0&&(Zn=3):wR())),t.updateQueue!==null&&(t.flags|=4),kr(t),null);case 4:return xg(),CD(e,t),e===null&&Wy(t.stateNode.containerInfo),kr(t),null;case 10:return nR(t.type._context),kr(t),null;case 17:return Gs(t.type)&&RA(),kr(t),null;case 19:if(qi(nn),s=t.memoizedState,s===null)return kr(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)jv(s,!1);else{if(Zn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=UA(e),o!==null){for(t.flags|=128,jv(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=i,i=t.child;i!==null;)s=i,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Vi(nn,nn.current&1|2),t.child}e=e.sibling}s.tail!==null&&Cn()>_g&&(t.flags|=128,n=!0,jv(s,!1),t.lanes=4194304)}else{if(!n)if(e=UA(o),e!==null){if(t.flags|=128,n=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),jv(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Zi)return kr(t),null}else 2*Cn()-s.renderingStartTime>_g&&i!==1073741824&&(t.flags|=128,n=!0,jv(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(i=s.last,i!==null?i.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Cn(),t.sibling=null,i=nn.current,Vi(nn,n?i&1|2:i&1),t):(kr(t),null);case 22:case 23:return xR(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?no&1073741824&&(kr(t),t.subtreeFlags&6&&(t.flags|=8192)):kr(t),null;case 24:return null;case 25:return null}throw Error(Qe(156,t.tag))}function Lte(e,t){switch($L(t),t.tag){case 1:return Gs(t.type)&&RA(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return xg(),qi(Us),qi(Jr),lR(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return aR(t),null;case 13:if(qi(nn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Qe(340));vg()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return qi(nn),null;case 4:return xg(),null;case 10:return nR(t.type._context),null;case 22:case 23:return xR(),null;case 24:return null;default:return null}}var Uw=!1,Xr=!1,Rte=typeof WeakSet=="function"?WeakSet:Set,vt=null;function Em(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(n){mn(e,t,n)}else i.current=null}function TD(e,t,i){try{i()}catch(n){mn(e,t,n)}}var sk=!1;function Ite(e,t){if(hD=PA,e=j8(),KL(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var n=i.getSelection&&i.getSelection();if(n&&n.rangeCount!==0){i=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{i.nodeType,s.nodeType}catch{i=null;break e}var o=0,a=-1,l=-1,c=0,h=0,u=e,d=null;t:for(;;){for(var f;u!==i||r!==0&&u.nodeType!==3||(a=o+r),u!==s||n!==0&&u.nodeType!==3||(l=o+n),u.nodeType===3&&(o+=u.nodeValue.length),(f=u.firstChild)!==null;)d=u,u=f;for(;;){if(u===e)break t;if(d===i&&++c===r&&(a=o),d===s&&++h===n&&(l=o),(f=u.nextSibling)!==null)break;u=d,d=u.parentNode}u=f}i=a===-1||l===-1?null:{start:a,end:l}}else i=null}i=i||{start:0,end:0}}else i=null;for(dD={focusedElem:e,selectionRange:i},PA=!1,vt=t;vt!==null;)if(t=vt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,vt=e;else for(;vt!==null;){t=vt;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,m=p.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:La(t.type,g),m);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Qe(163))}}catch(b){mn(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,vt=e;break}vt=t.return}return p=sk,sk=!1,p}function uy(e,t,i){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,s!==void 0&&TD(t,i,s)}r=r.next}while(r!==n)}}function dM(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var n=i.create;i.destroy=n()}i=i.next}while(i!==t)}}function PD(e){var t=e.ref;if(t!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof t=="function"?t(e):t.current=e}}function GW(e){var t=e.alternate;t!==null&&(e.alternate=null,GW(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Bl],delete t[Yy],delete t[mD],delete t[gte],delete t[vte])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function HW(e){return e.tag===5||e.tag===3||e.tag===4}function ok(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||HW(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function DD(e,t,i){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=LA));else if(n!==4&&(e=e.child,e!==null))for(DD(e,t,i),e=e.sibling;e!==null;)DD(e,t,i),e=e.sibling}function BD(e,t,i){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(BD(e,t,i),e=e.sibling;e!==null;)BD(e,t,i),e=e.sibling}var Sr=null,Ra=!1;function Au(e,t,i){for(i=i.child;i!==null;)VW(e,t,i),i=i.sibling}function VW(e,t,i){if(zl&&typeof zl.onCommitFiberUnmount=="function")try{zl.onCommitFiberUnmount(rM,i)}catch{}switch(i.tag){case 5:Xr||Em(i,t);case 6:var n=Sr,r=Ra;Sr=null,Au(e,t,i),Sr=n,Ra=r,Sr!==null&&(Ra?(e=Sr,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):Sr.removeChild(i.stateNode));break;case 18:Sr!==null&&(Ra?(e=Sr,i=i.stateNode,e.nodeType===8?zC(e.parentNode,i):e.nodeType===1&&zC(e,i),Hy(e)):zC(Sr,i.stateNode));break;case 4:n=Sr,r=Ra,Sr=i.stateNode.containerInfo,Ra=!0,Au(e,t,i),Sr=n,Ra=r;break;case 0:case 11:case 14:case 15:if(!Xr&&(n=i.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){r=n=n.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&TD(i,t,o),r=r.next}while(r!==n)}Au(e,t,i);break;case 1:if(!Xr&&(Em(i,t),n=i.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(a){mn(i,t,a)}Au(e,t,i);break;case 21:Au(e,t,i);break;case 22:i.mode&1?(Xr=(n=Xr)||i.memoizedState!==null,Au(e,t,i),Xr=n):Au(e,t,i);break;default:Au(e,t,i)}}function ak(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new Rte),t.forEach(function(n){var r=Vte.bind(null,e,n);i.has(n)||(i.add(n),n.then(r,r))})}}function xa(e,t){var i=t.deletions;if(i!==null)for(var n=0;n<i.length;n++){var r=i[n];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Sr=a.stateNode,Ra=!1;break e;case 3:Sr=a.stateNode.containerInfo,Ra=!0;break e;case 4:Sr=a.stateNode.containerInfo,Ra=!0;break e}a=a.return}if(Sr===null)throw Error(Qe(160));VW(s,o,r),Sr=null,Ra=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){mn(r,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)jW(t,e),t=t.sibling}function jW(e,t){var i=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(xa(t,e),dl(e),n&4){try{uy(3,e,e.return),dM(3,e)}catch(g){mn(e,e.return,g)}try{uy(5,e,e.return)}catch(g){mn(e,e.return,g)}}break;case 1:xa(t,e),dl(e),n&512&&i!==null&&Em(i,i.return);break;case 5:if(xa(t,e),dl(e),n&512&&i!==null&&Em(i,i.return),e.flags&32){var r=e.stateNode;try{zy(r,"")}catch(g){mn(e,e.return,g)}}if(n&4&&(r=e.stateNode,r!=null)){var s=e.memoizedProps,o=i!==null?i.memoizedProps:s,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&h8(r,s),tD(a,o);var c=tD(a,s);for(o=0;o<l.length;o+=2){var h=l[o],u=l[o+1];h==="style"?g8(r,u):h==="dangerouslySetInnerHTML"?p8(r,u):h==="children"?zy(r,u):zL(r,h,u,c)}switch(a){case"input":JP(r,s);break;case"textarea":d8(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Wm(r,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?Wm(r,!!s.multiple,s.defaultValue,!0):Wm(r,!!s.multiple,s.multiple?[]:"",!1))}r[Yy]=s}catch(g){mn(e,e.return,g)}}break;case 6:if(xa(t,e),dl(e),n&4){if(e.stateNode===null)throw Error(Qe(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(g){mn(e,e.return,g)}}break;case 3:if(xa(t,e),dl(e),n&4&&i!==null&&i.memoizedState.isDehydrated)try{Hy(t.containerInfo)}catch(g){mn(e,e.return,g)}break;case 4:xa(t,e),dl(e);break;case 13:xa(t,e),dl(e),r=e.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(vR=Cn())),n&4&&ak(e);break;case 22:if(h=i!==null&&i.memoizedState!==null,e.mode&1?(Xr=(c=Xr)||h,xa(t,e),Xr=c):xa(t,e),dl(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!h&&e.mode&1)for(vt=e,h=e.child;h!==null;){for(u=vt=h;vt!==null;){switch(d=vt,f=d.child,d.tag){case 0:case 11:case 14:case 15:uy(4,d,d.return);break;case 1:Em(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){n=d,i=d.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){mn(n,i,g)}}break;case 5:Em(d,d.return);break;case 22:if(d.memoizedState!==null){ck(u);continue}}f!==null?(f.return=d,vt=f):ck(u)}h=h.sibling}e:for(h=null,u=e;;){if(u.tag===5){if(h===null){h=u;try{r=u.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=u.stateNode,l=u.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=m8("display",o))}catch(g){mn(e,e.return,g)}}}else if(u.tag===6){if(h===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(g){mn(e,e.return,g)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:xa(t,e),dl(e),n&4&&ak(e);break;case 21:break;default:xa(t,e),dl(e)}}function dl(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(HW(i)){var n=i;break e}i=i.return}throw Error(Qe(160))}switch(n.tag){case 5:var r=n.stateNode;n.flags&32&&(zy(r,""),n.flags&=-33);var s=ok(e);BD(e,s,r);break;case 3:case 4:var o=n.stateNode.containerInfo,a=ok(e);DD(e,a,o);break;default:throw Error(Qe(161))}}catch(l){mn(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ote(e,t,i){vt=e,WW(e)}function WW(e,t,i){for(var n=(e.mode&1)!==0;vt!==null;){var r=vt,s=r.child;if(r.tag===22&&n){var o=r.memoizedState!==null||Uw;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Xr;a=Uw;var c=Xr;if(Uw=o,(Xr=l)&&!c)for(vt=r;vt!==null;)o=vt,l=o.child,o.tag===22&&o.memoizedState!==null?uk(r):l!==null?(l.return=o,vt=l):uk(r);for(;s!==null;)vt=s,WW(s),s=s.sibling;vt=r,Uw=a,Xr=c}lk(e)}else r.subtreeFlags&8772&&s!==null?(s.return=r,vt=s):lk(e)}}function lk(e){for(;vt!==null;){var t=vt;if(t.flags&8772){var i=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Xr||dM(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Xr)if(i===null)n.componentDidMount();else{var r=t.elementType===t.type?i.memoizedProps:La(t.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Wz(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}Wz(t,o,i)}break;case 5:var a=t.stateNode;if(i===null&&t.flags&4){i=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break;case"img":l.src&&(i.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var u=h.dehydrated;u!==null&&Hy(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Qe(163))}Xr||t.flags&512&&PD(t)}catch(d){mn(t,t.return,d)}}if(t===e){vt=null;break}if(i=t.sibling,i!==null){i.return=t.return,vt=i;break}vt=t.return}}function ck(e){for(;vt!==null;){var t=vt;if(t===e){vt=null;break}var i=t.sibling;if(i!==null){i.return=t.return,vt=i;break}vt=t.return}}function uk(e){for(;vt!==null;){var t=vt;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{dM(4,t)}catch(l){mn(t,i,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var r=t.return;try{n.componentDidMount()}catch(l){mn(t,r,l)}}var s=t.return;try{PD(t)}catch(l){mn(t,s,l)}break;case 5:var o=t.return;try{PD(t)}catch(l){mn(t,o,l)}}}catch(l){mn(t,t.return,l)}if(t===e){vt=null;break}var a=t.sibling;if(a!==null){a.return=t.return,vt=a;break}vt=t.return}}var Fte=Math.ceil,VA=uu.ReactCurrentDispatcher,mR=uu.ReactCurrentOwner,ta=uu.ReactCurrentBatchConfig,mi=0,vr=null,kn=null,Tr=0,no=0,Cm=Vh(0),Zn=0,$y=null,Df=0,fM=0,gR=0,hy=null,Ds=null,vR=0,_g=1/0,Bc=null,jA=!1,LD=null,_h=null,Gw=!1,ah=null,WA=0,dy=0,RD=null,$b=-1,eA=0;function ps(){return mi&6?Cn():$b!==-1?$b:$b=Cn()}function bh(e){return e.mode&1?mi&2&&Tr!==0?Tr&-Tr:xte.transition!==null?(eA===0&&(eA=T8()),eA):(e=Di,e!==0||(e=window.event,e=e===void 0?16:O8(e.type)),e):1}function ja(e,t,i,n){if(50<dy)throw dy=0,RD=null,Error(Qe(185));Ux(e,i,n),(!(mi&2)||e!==vr)&&(e===vr&&(!(mi&2)&&(fM|=i),Zn===4&&ih(e,Tr)),Hs(e,n),i===1&&mi===0&&!(t.mode&1)&&(_g=Cn()+500,cM&&jh()))}function Hs(e,t){var i=e.callbackNode;xee(e,t);var n=TA(e,e===vr?Tr:0);if(n===0)i!==null&&xz(i),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(i!=null&&xz(i),t===1)e.tag===0?yte(hk.bind(null,e)):eW(hk.bind(null,e)),pte(function(){!(mi&6)&&jh()}),i=null;else{switch(P8(n)){case 1:i=VL;break;case 4:i=E8;break;case 16:i=CA;break;case 536870912:i=C8;break;default:i=CA}i=$W(i,XW.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function XW(e,t){if($b=-1,eA=0,mi&6)throw Error(Qe(327));var i=e.callbackNode;if(Jm()&&e.callbackNode!==i)return null;var n=TA(e,e===vr?Tr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=XA(e,n);else{t=n;var r=mi;mi|=2;var s=qW();(vr!==e||Tr!==t)&&(Bc=null,_g=Cn()+500,uf(e,t));do try{kte();break}catch(a){YW(e,a)}while(1);iR(),VA.current=s,mi=r,kn!==null?t=0:(vr=null,Tr=0,t=Zn)}if(t!==0){if(t===2&&(r=oD(e),r!==0&&(n=r,t=ID(e,r))),t===1)throw i=$y,uf(e,0),ih(e,n),Hs(e,Cn()),i;if(t===6)ih(e,n);else{if(r=e.current.alternate,!(n&30)&&!Nte(r)&&(t=XA(e,n),t===2&&(s=oD(e),s!==0&&(n=s,t=ID(e,s))),t===1))throw i=$y,uf(e,0),ih(e,n),Hs(e,Cn()),i;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(Qe(345));case 2:Ld(e,Ds,Bc);break;case 3:if(ih(e,n),(n&130023424)===n&&(t=vR+500-Cn(),10<t)){if(TA(e,0)!==0)break;if(r=e.suspendedLanes,(r&n)!==n){ps(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=pD(Ld.bind(null,e,Ds,Bc),t);break}Ld(e,Ds,Bc);break;case 4:if(ih(e,n),(n&4194240)===n)break;for(t=e.eventTimes,r=-1;0<n;){var o=31-Va(n);s=1<<o,o=t[o],o>r&&(r=o),n&=~s}if(n=r,n=Cn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Fte(n/1960))-n,10<n){e.timeoutHandle=pD(Ld.bind(null,e,Ds,Bc),n);break}Ld(e,Ds,Bc);break;case 5:Ld(e,Ds,Bc);break;default:throw Error(Qe(329))}}}return Hs(e,Cn()),e.callbackNode===i?XW.bind(null,e):null}function ID(e,t){var i=hy;return e.current.memoizedState.isDehydrated&&(uf(e,t).flags|=256),e=XA(e,t),e!==2&&(t=Ds,Ds=i,t!==null&&OD(t)),e}function OD(e){Ds===null?Ds=e:Ds.push.apply(Ds,e)}function Nte(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var n=0;n<i.length;n++){var r=i[n],s=r.getSnapshot;r=r.value;try{if(!Qa(s(),r))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ih(e,t){for(t&=~gR,t&=~fM,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-Va(t),n=1<<i;e[i]=-1,t&=~n}}function hk(e){if(mi&6)throw Error(Qe(327));Jm();var t=TA(e,0);if(!(t&1))return Hs(e,Cn()),null;var i=XA(e,t);if(e.tag!==0&&i===2){var n=oD(e);n!==0&&(t=n,i=ID(e,n))}if(i===1)throw i=$y,uf(e,0),ih(e,t),Hs(e,Cn()),i;if(i===6)throw Error(Qe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ld(e,Ds,Bc),Hs(e,Cn()),null}function yR(e,t){var i=mi;mi|=1;try{return e(t)}finally{mi=i,mi===0&&(_g=Cn()+500,cM&&jh())}}function Bf(e){ah!==null&&ah.tag===0&&!(mi&6)&&Jm();var t=mi;mi|=1;var i=ta.transition,n=Di;try{if(ta.transition=null,Di=1,e)return e()}finally{Di=n,ta.transition=i,mi=t,!(mi&6)&&jh()}}function xR(){no=Cm.current,qi(Cm)}function uf(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,fte(i)),kn!==null)for(i=kn.return;i!==null;){var n=i;switch($L(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&RA();break;case 3:xg(),qi(Us),qi(Jr),lR();break;case 5:aR(n);break;case 4:xg();break;case 13:qi(nn);break;case 19:qi(nn);break;case 10:nR(n.type._context);break;case 22:case 23:xR()}i=i.return}if(vr=e,kn=e=Ah(e.current,null),Tr=no=t,Zn=0,$y=null,gR=fM=Df=0,Ds=hy=null,Jd!==null){for(t=0;t<Jd.length;t++)if(i=Jd[t],n=i.interleaved,n!==null){i.interleaved=null;var r=n.next,s=i.pending;if(s!==null){var o=s.next;s.next=r,n.next=o}i.pending=n}Jd=null}return e}function YW(e,t){do{var i=kn;try{if(iR(),Jb.current=HA,GA){for(var n=ln.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}GA=!1}if(Pf=0,mr=Jn=ln=null,cy=!1,Jy=0,mR.current=null,i===null||i.return===null){Zn=1,$y=t,kn=null;break}e:{var s=e,o=i.return,a=i,l=t;if(t=Tr,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,u=h.tag;if(!(h.mode&1)&&(u===0||u===11||u===15)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=Zz(o);if(f!==null){f.flags&=-257,$z(f,o,a,s,t),f.mode&1&&Kz(s,c,t),t=f,l=c;var p=t.updateQueue;if(p===null){var g=new Set;g.add(l),t.updateQueue=g}else p.add(l);break e}else{if(!(t&1)){Kz(s,c,t),wR();break e}l=Error(Qe(426))}}else if(Zi&&a.mode&1){var m=Zz(o);if(m!==null){!(m.flags&65536)&&(m.flags|=256),$z(m,o,a,s,t),eR(wg(l,a));break e}}s=l=wg(l,a),Zn!==4&&(Zn=2),hy===null?hy=[s]:hy.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=DW(s,l,t);jz(s,v);break e;case 1:a=l;var x=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(_h===null||!_h.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var b=BW(s,a,t);jz(s,b);break e}}s=s.return}while(s!==null)}JW(i)}catch(M){t=M,kn===i&&i!==null&&(kn=i=i.return);continue}break}while(1)}function qW(){var e=VA.current;return VA.current=HA,e===null?HA:e}function wR(){(Zn===0||Zn===3||Zn===2)&&(Zn=4),vr===null||!(Df&268435455)&&!(fM&268435455)||ih(vr,Tr)}function XA(e,t){var i=mi;mi|=2;var n=qW();(vr!==e||Tr!==t)&&(Bc=null,uf(e,t));do try{zte();break}catch(r){YW(e,r)}while(1);if(iR(),mi=i,VA.current=n,kn!==null)throw Error(Qe(261));return vr=null,Tr=0,Zn}function zte(){for(;kn!==null;)QW(kn)}function kte(){for(;kn!==null&&!uee();)QW(kn)}function QW(e){var t=ZW(e.alternate,e,no);e.memoizedProps=e.pendingProps,t===null?JW(e):kn=t,mR.current=null}function JW(e){var t=e;do{var i=t.alternate;if(e=t.return,t.flags&32768){if(i=Lte(i,t),i!==null){i.flags&=32767,kn=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Zn=6,kn=null;return}}else if(i=Bte(i,t,no),i!==null){kn=i;return}if(t=t.sibling,t!==null){kn=t;return}kn=t=e}while(t!==null);Zn===0&&(Zn=5)}function Ld(e,t,i){var n=Di,r=ta.transition;try{ta.transition=null,Di=1,Ute(e,t,i,n)}finally{ta.transition=r,Di=n}return null}function Ute(e,t,i,n){do Jm();while(ah!==null);if(mi&6)throw Error(Qe(327));i=e.finishedWork;var r=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(Qe(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(wee(e,s),e===vr&&(kn=vr=null,Tr=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||Gw||(Gw=!0,$W(CA,function(){return Jm(),null})),s=(i.flags&15990)!==0,i.subtreeFlags&15990||s){s=ta.transition,ta.transition=null;var o=Di;Di=1;var a=mi;mi|=4,mR.current=null,Ite(e,i),jW(i,e),ote(dD),PA=!!hD,dD=hD=null,e.current=i,Ote(i),hee(),mi=a,Di=o,ta.transition=s}else e.current=i;if(Gw&&(Gw=!1,ah=e,WA=r),s=e.pendingLanes,s===0&&(_h=null),pee(i.stateNode),Hs(e,Cn()),t!==null)for(n=e.onRecoverableError,i=0;i<t.length;i++)r=t[i],n(r.value,{componentStack:r.stack,digest:r.digest});if(jA)throw jA=!1,e=LD,LD=null,e;return WA&1&&e.tag!==0&&Jm(),s=e.pendingLanes,s&1?e===RD?dy++:(dy=0,RD=e):dy=0,jh(),null}function Jm(){if(ah!==null){var e=P8(WA),t=ta.transition,i=Di;try{if(ta.transition=null,Di=16>e?16:e,ah===null)var n=!1;else{if(e=ah,ah=null,WA=0,mi&6)throw Error(Qe(331));var r=mi;for(mi|=4,vt=e.current;vt!==null;){var s=vt,o=s.child;if(vt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(vt=c;vt!==null;){var h=vt;switch(h.tag){case 0:case 11:case 15:uy(8,h,s)}var u=h.child;if(u!==null)u.return=h,vt=u;else for(;vt!==null;){h=vt;var d=h.sibling,f=h.return;if(GW(h),h===c){vt=null;break}if(d!==null){d.return=f,vt=d;break}vt=f}}}var p=s.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(g!==null)}}vt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,vt=o;else e:for(;vt!==null;){if(s=vt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:uy(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,vt=v;break e}vt=s.return}}var x=e.current;for(vt=x;vt!==null;){o=vt;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,vt=w;else e:for(o=x;vt!==null;){if(a=vt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:dM(9,a)}}catch(M){mn(a,a.return,M)}if(a===o){vt=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,vt=b;break e}vt=a.return}}if(mi=r,jh(),zl&&typeof zl.onPostCommitFiberRoot=="function")try{zl.onPostCommitFiberRoot(rM,e)}catch{}n=!0}return n}finally{Di=i,ta.transition=t}}return!1}function dk(e,t,i){t=wg(i,t),t=DW(e,t,1),e=wh(e,t,1),t=ps(),e!==null&&(Ux(e,1,t),Hs(e,t))}function mn(e,t,i){if(e.tag===3)dk(e,e,i);else for(;t!==null;){if(t.tag===3){dk(t,e,i);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(_h===null||!_h.has(n))){e=wg(i,e),e=BW(t,e,1),t=wh(t,e,1),e=ps(),t!==null&&(Ux(t,1,e),Hs(t,e));break}}t=t.return}}function Gte(e,t,i){var n=e.pingCache;n!==null&&n.delete(t),t=ps(),e.pingedLanes|=e.suspendedLanes&i,vr===e&&(Tr&i)===i&&(Zn===4||Zn===3&&(Tr&130023424)===Tr&&500>Cn()-vR?uf(e,0):gR|=i),Hs(e,t)}function KW(e,t){t===0&&(e.mode&1?(t=Bw,Bw<<=1,!(Bw&130023424)&&(Bw=4194304)):t=1);var i=ps();e=nu(e,t),e!==null&&(Ux(e,t,i),Hs(e,i))}function Hte(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),KW(e,i)}function Vte(e,t){var i=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;r!==null&&(i=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Qe(314))}n!==null&&n.delete(t),KW(e,i)}var ZW;ZW=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||Us.current)Fs=!0;else{if(!(e.lanes&i)&&!(t.flags&128))return Fs=!1,Dte(e,t,i);Fs=!!(e.flags&131072)}else Fs=!1,Zi&&t.flags&1048576&&tW(t,FA,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Zb(e,t),e=t.pendingProps;var r=gg(t,Jr.current);Qm(t,i),r=uR(null,t,n,e,r,i);var s=hR();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Gs(n)?(s=!0,IA(t)):s=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,sR(t),r.updater=uM,t.stateNode=r,r._reactInternals=t,_D(t,n,e,i),t=SD(null,t,n,!0,s,i)):(t.tag=0,Zi&&s&&ZL(t),ls(null,t,r,i),t=t.child),t;case 16:n=t.elementType;e:{switch(Zb(e,t),e=t.pendingProps,r=n._init,n=r(n._payload),t.type=n,r=t.tag=Wte(n),e=La(n,e),r){case 0:t=AD(null,t,n,e,i);break e;case 1:t=ik(null,t,n,e,i);break e;case 11:t=ek(null,t,n,e,i);break e;case 14:t=tk(null,t,n,La(n.type,e),i);break e}throw Error(Qe(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:La(n,r),AD(e,t,n,r,i);case 1:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:La(n,r),ik(e,t,n,r,i);case 3:e:{if(OW(t),e===null)throw Error(Qe(387));n=t.pendingProps,s=t.memoizedState,r=s.element,sW(e,t),kA(t,n,null,i);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){r=wg(Error(Qe(423)),t),t=nk(e,t,n,i,r);break e}else if(n!==r){r=wg(Error(Qe(424)),t),t=nk(e,t,n,i,r);break e}else for(lo=xh(t.stateNode.containerInfo.firstChild),go=t,Zi=!0,Oa=null,i=cW(t,null,n,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(vg(),n===r){t=ru(e,t,i);break e}ls(e,t,n,i)}t=t.child}return t;case 5:return uW(t),e===null&&yD(t),n=t.type,r=t.pendingProps,s=e!==null?e.memoizedProps:null,o=r.children,fD(n,r)?o=null:s!==null&&fD(n,s)&&(t.flags|=32),IW(e,t),ls(e,t,o,i),t.child;case 6:return e===null&&yD(t),null;case 13:return FW(e,t,i);case 4:return oR(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=yg(t,null,n,i):ls(e,t,n,i),t.child;case 11:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:La(n,r),ek(e,t,n,r,i);case 7:return ls(e,t,t.pendingProps,i),t.child;case 8:return ls(e,t,t.pendingProps.children,i),t.child;case 12:return ls(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,s=t.memoizedProps,o=r.value,Vi(NA,n._currentValue),n._currentValue=o,s!==null)if(Qa(s.value,o)){if(s.children===r.children&&!Us.current){t=ru(e,t,i);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=qc(-1,i&-i),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}s.lanes|=i,l=s.alternate,l!==null&&(l.lanes|=i),xD(s.return,i,t),a.lanes|=i;break}l=l.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Qe(341));o.lanes|=i,a=o.alternate,a!==null&&(a.lanes|=i),xD(o,i,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ls(e,t,r.children,i),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,Qm(t,i),r=aa(r),n=n(r),t.flags|=1,ls(e,t,n,i),t.child;case 14:return n=t.type,r=La(n,t.pendingProps),r=La(n.type,r),tk(e,t,n,r,i);case 15:return LW(e,t,t.type,t.pendingProps,i);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:La(n,r),Zb(e,t),t.tag=1,Gs(n)?(e=!0,IA(t)):e=!1,Qm(t,i),aW(t,n,r),_D(t,n,r,i),SD(null,t,n,!0,e,i);case 19:return NW(e,t,i);case 22:return RW(e,t,i)}throw Error(Qe(156,t.tag))};function $W(e,t){return M8(e,t)}function jte(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zo(e,t,i,n){return new jte(e,t,i,n)}function _R(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Wte(e){if(typeof e=="function")return _R(e)?1:0;if(e!=null){if(e=e.$$typeof,e===UL)return 11;if(e===GL)return 14}return 2}function Ah(e,t){var i=e.alternate;return i===null?(i=Zo(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function tA(e,t,i,n,r,s){var o=2;if(n=e,typeof e=="function")_R(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case vm:return hf(i.children,r,s,t);case kL:o=8,r|=8;break;case WP:return e=Zo(12,i,t,r|2),e.elementType=WP,e.lanes=s,e;case XP:return e=Zo(13,i,t,r),e.elementType=XP,e.lanes=s,e;case YP:return e=Zo(19,i,t,r),e.elementType=YP,e.lanes=s,e;case l8:return pM(i,r,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case o8:o=10;break e;case a8:o=9;break e;case UL:o=11;break e;case GL:o=14;break e;case Yu:o=16,n=null;break e}throw Error(Qe(130,e==null?e:typeof e,""))}return t=Zo(o,i,t,r),t.elementType=e,t.type=n,t.lanes=s,t}function hf(e,t,i,n){return e=Zo(7,e,n,t),e.lanes=i,e}function pM(e,t,i,n){return e=Zo(22,e,n,t),e.elementType=l8,e.lanes=i,e.stateNode={isHidden:!1},e}function XC(e,t,i){return e=Zo(6,e,null,t),e.lanes=i,e}function YC(e,t,i){return t=Zo(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Xte(e,t,i,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=CC(0),this.expirationTimes=CC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=CC(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function bR(e,t,i,n,r,s,o,a,l){return e=new Xte(e,t,i,a,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Zo(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},sR(s),e}function Yte(e,t,i){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gm,key:n==null?null:""+n,children:e,containerInfo:t,implementation:i}}function e9(e){if(!e)return Dh;e=e._reactInternals;e:{if(jf(e)!==e||e.tag!==1)throw Error(Qe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Gs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Qe(171))}if(e.tag===1){var i=e.type;if(Gs(i))return $8(e,i,t)}return t}function t9(e,t,i,n,r,s,o,a,l){return e=bR(i,n,!0,e,r,s,o,a,l),e.context=e9(null),i=e.current,n=ps(),r=bh(i),s=qc(n,r),s.callback=t??null,wh(i,s,r),e.current.lanes=r,Ux(e,r,n),Hs(e,n),e}function mM(e,t,i,n){var r=t.current,s=ps(),o=bh(r);return i=e9(i),t.context===null?t.context=i:t.pendingContext=i,t=qc(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=wh(r,t,o),e!==null&&(ja(e,r,o,s),Qb(e,r,o)),o}function YA(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function fk(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function AR(e,t){fk(e,t),(e=e.alternate)&&fk(e,t)}function qte(){return null}var i9=typeof reportError=="function"?reportError:function(e){console.error(e)};function SR(e){this._internalRoot=e}gM.prototype.render=SR.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Qe(409));mM(e,t,null,null)};gM.prototype.unmount=SR.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Bf(function(){mM(null,e,null,null)}),t[iu]=null}};function gM(e){this._internalRoot=e}gM.prototype.unstable_scheduleHydration=function(e){if(e){var t=L8();e={blockedOn:null,target:e,priority:t};for(var i=0;i<th.length&&t!==0&&t<th[i].priority;i++);th.splice(i,0,e),i===0&&I8(e)}};function MR(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function vM(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pk(){}function Qte(e,t,i,n,r){if(r){if(typeof n=="function"){var s=n;n=function(){var c=YA(o);s.call(c)}}var o=t9(t,n,e,0,null,!1,!1,"",pk);return e._reactRootContainer=o,e[iu]=o.current,Wy(e.nodeType===8?e.parentNode:e),Bf(),o}for(;r=e.lastChild;)e.removeChild(r);if(typeof n=="function"){var a=n;n=function(){var c=YA(l);a.call(c)}}var l=bR(e,0,!1,null,null,!1,!1,"",pk);return e._reactRootContainer=l,e[iu]=l.current,Wy(e.nodeType===8?e.parentNode:e),Bf(function(){mM(t,l,i,n)}),l}function yM(e,t,i,n,r){var s=i._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=YA(o);a.call(l)}}mM(t,o,e,r)}else o=Qte(i,t,e,r,n);return YA(o)}D8=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=W0(t.pendingLanes);i!==0&&(jL(t,i|1),Hs(t,Cn()),!(mi&6)&&(_g=Cn()+500,jh()))}break;case 13:Bf(function(){var n=nu(e,1);if(n!==null){var r=ps();ja(n,e,1,r)}}),AR(e,1)}};WL=function(e){if(e.tag===13){var t=nu(e,134217728);if(t!==null){var i=ps();ja(t,e,134217728,i)}AR(e,134217728)}};B8=function(e){if(e.tag===13){var t=bh(e),i=nu(e,t);if(i!==null){var n=ps();ja(i,e,t,n)}AR(e,t)}};L8=function(){return Di};R8=function(e,t){var i=Di;try{return Di=e,t()}finally{Di=i}};nD=function(e,t,i){switch(t){case"input":if(JP(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var r=lM(n);if(!r)throw Error(Qe(90));u8(n),JP(n,r)}}}break;case"textarea":d8(e,i);break;case"select":t=i.value,t!=null&&Wm(e,!!i.multiple,t,!1)}};x8=yR;w8=Bf;var Jte={usingClientEntryPoint:!1,Events:[Hx,_m,lM,v8,y8,yR]},Wv={findFiberByHostInstance:Qd,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Kte={bundleType:Wv.bundleType,version:Wv.version,rendererPackageName:Wv.rendererPackageName,rendererConfig:Wv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:uu.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=A8(e),e===null?null:e.stateNode},findFiberByHostInstance:Wv.findFiberByHostInstance||qte,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hw.isDisabled&&Hw.supportsFiber)try{rM=Hw.inject(Kte),zl=Hw}catch{}}bo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jte;bo.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!MR(t))throw Error(Qe(200));return Yte(e,t,null,i)};bo.createRoot=function(e,t){if(!MR(e))throw Error(Qe(299));var i=!1,n="",r=i9;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=bR(e,1,!1,null,null,i,!1,n,r),e[iu]=t.current,Wy(e.nodeType===8?e.parentNode:e),new SR(t)};bo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Qe(188)):(e=Object.keys(e).join(","),Error(Qe(268,e)));return e=A8(t),e=e===null?null:e.stateNode,e};bo.flushSync=function(e){return Bf(e)};bo.hydrate=function(e,t,i){if(!vM(t))throw Error(Qe(200));return yM(null,e,t,!0,i)};bo.hydrateRoot=function(e,t,i){if(!MR(e))throw Error(Qe(405));var n=i!=null&&i.hydratedSources||null,r=!1,s="",o=i9;if(i!=null&&(i.unstable_strictMode===!0&&(r=!0),i.identifierPrefix!==void 0&&(s=i.identifierPrefix),i.onRecoverableError!==void 0&&(o=i.onRecoverableError)),t=t9(t,null,e,1,i??null,r,!1,s,o),e[iu]=t.current,Wy(e),n)for(e=0;e<n.length;e++)i=n[e],r=i._getVersion,r=r(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,r]:t.mutableSourceEagerHydrationData.push(i,r);return new gM(t)};bo.render=function(e,t,i){if(!vM(t))throw Error(Qe(200));return yM(null,e,t,!1,i)};bo.unmountComponentAtNode=function(e){if(!vM(e))throw Error(Qe(40));return e._reactRootContainer?(Bf(function(){yM(null,null,e,!1,function(){e._reactRootContainer=null,e[iu]=null})}),!0):!1};bo.unstable_batchedUpdates=yR;bo.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!vM(i))throw Error(Qe(200));if(e==null||e._reactInternals===void 0)throw Error(Qe(38));return yM(e,t,i,!1,n)};bo.version="18.2.0-next-9e3b772b8-20220608";function n9(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n9)}catch(e){console.error(e)}}n9(),t8.exports=bo;var r9=t8.exports,s9,mk=r9;s9=VP.createRoot=mk.createRoot,VP.hydrateRoot=mk.hydrateRoot;/**
 * @remix-run/router v1.6.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ex(){return ex=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},ex.apply(this,arguments)}var Zd;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Zd||(Zd={}));const gk="popstate";function Zte(e){e===void 0&&(e={});function t(n,r){let{pathname:s,search:o,hash:a}=n.location;return FD("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function i(n,r){return typeof r=="string"?r:qA(r)}return eie(t,i,null,e)}function Wa(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function $te(){return Math.random().toString(36).substr(2,8)}function vk(e,t){return{usr:e.state,key:e.key,idx:t}}function FD(e,t,i,n){return i===void 0&&(i=null),ex({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?xM(t):t,{state:i,key:t&&t.key||n||$te()})}function qA(e){let{pathname:t="/",search:i="",hash:n=""}=e;return i&&i!=="?"&&(t+=i.charAt(0)==="?"?i:"?"+i),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function xM(e){let t={};if(e){let i=e.indexOf("#");i>=0&&(t.hash=e.substr(i),e=e.substr(0,i));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function eie(e,t,i,n){n===void 0&&(n={});let{window:r=document.defaultView,v5Compat:s=!1}=n,o=r.history,a=Zd.Pop,l=null,c=h();c==null&&(c=0,o.replaceState(ex({},o.state,{idx:c}),""));function h(){return(o.state||{idx:null}).idx}function u(){a=Zd.Pop;let m=h(),v=m==null?null:m-c;c=m,l&&l({action:a,location:g.location,delta:v})}function d(m,v){a=Zd.Push;let x=FD(g.location,m,v);i&&i(x,m),c=h()+1;let w=vk(x,c),b=g.createHref(x);try{o.pushState(w,"",b)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;r.location.assign(b)}s&&l&&l({action:a,location:g.location,delta:1})}function f(m,v){a=Zd.Replace;let x=FD(g.location,m,v);i&&i(x,m),c=h();let w=vk(x,c),b=g.createHref(x);o.replaceState(w,"",b),s&&l&&l({action:a,location:g.location,delta:0})}function p(m){let v=r.location.origin!=="null"?r.location.origin:r.location.href,x=typeof m=="string"?m:qA(m);return Wa(v,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,v)}let g={get action(){return a},get location(){return e(r,o)},listen(m){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(gk,u),l=m,()=>{r.removeEventListener(gk,u),l=null}},createHref(m){return t(r,m)},createURL:p,encodeLocation(m){let v=p(m);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:f,go(m){return o.go(m)}};return g}var yk;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(yk||(yk={}));function o9(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let i=t.endsWith("/")?t.length-1:t.length,n=e.charAt(i);return n&&n!=="/"?null:e.slice(i)||"/"}function tie(e,t){t===void 0&&(t="/");let{pathname:i,search:n="",hash:r=""}=typeof e=="string"?xM(e):e;return{pathname:i?i.startsWith("/")?i:iie(i,t):t,search:nie(n),hash:rie(r)}}function iie(e,t){let i=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?i.length>1&&i.pop():r!=="."&&i.push(r)}),i.length>1?i.join("/"):"/"}function qC(e,t,i,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+i+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function a9(e){return e.filter((t,i)=>i===0||t.route.path&&t.route.path.length>0)}function l9(e,t,i,n){n===void 0&&(n=!1);let r;typeof e=="string"?r=xM(e):(r=ex({},e),Wa(!r.pathname||!r.pathname.includes("?"),qC("?","pathname","search",r)),Wa(!r.pathname||!r.pathname.includes("#"),qC("#","pathname","hash",r)),Wa(!r.search||!r.search.includes("#"),qC("#","search","hash",r)));let s=e===""||r.pathname==="",o=s?"/":r.pathname,a;if(n||o==null)a=i;else{let u=t.length-1;if(o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),u-=1;r.pathname=d.join("/")}a=u>=0?t[u]:"/"}let l=tie(r,a),c=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&i.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}const c9=e=>e.join("/").replace(/\/\/+/g,"/"),nie=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,rie=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,u9=["post","put","patch","delete"];new Set(u9);const sie=["get",...u9];new Set(sie);/**
 * React Router v6.12.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ND(){return ND=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},ND.apply(this,arguments)}const h9=ae.createContext(null),jx=ae.createContext(null),ER=ae.createContext(null),wM=ae.createContext({outlet:null,matches:[],isDataRoute:!1});function oie(e,t){let{relative:i}=t===void 0?{}:t;_M()||Wa(!1);let{basename:n,navigator:r}=ae.useContext(jx),{hash:s,pathname:o,search:a}=f9(e,{relative:i}),l=o;return n!=="/"&&(l=o==="/"?n:c9([n,o])),r.createHref({pathname:l,search:a,hash:s})}function _M(){return ae.useContext(ER)!=null}function CR(){return _M()||Wa(!1),ae.useContext(ER).location}function d9(e){ae.useContext(jx).static||ae.useLayoutEffect(e)}function aie(){let{isDataRoute:e}=ae.useContext(wM);return e?die():lie()}function lie(){_M()||Wa(!1);let e=ae.useContext(h9),{basename:t,navigator:i}=ae.useContext(jx),{matches:n}=ae.useContext(wM),{pathname:r}=CR(),s=JSON.stringify(a9(n).map(l=>l.pathnameBase)),o=ae.useRef(!1);return d9(()=>{o.current=!0}),ae.useCallback(function(l,c){if(c===void 0&&(c={}),!o.current)return;if(typeof l=="number"){i.go(l);return}let h=l9(l,JSON.parse(s),r,c.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:c9([t,h.pathname])),(c.replace?i.replace:i.push)(h,c.state,c)},[t,i,s,r,e])}function f9(e,t){let{relative:i}=t===void 0?{}:t,{matches:n}=ae.useContext(wM),{pathname:r}=CR(),s=JSON.stringify(a9(n).map(o=>o.pathnameBase));return ae.useMemo(()=>l9(e,JSON.parse(s),r,i==="path"),[e,s,r,i])}var zD;(function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate"})(zD||(zD={}));var kD;(function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId"})(kD||(kD={}));function cie(e){let t=ae.useContext(h9);return t||Wa(!1),t}function uie(e){let t=ae.useContext(wM);return t||Wa(!1),t}function hie(e){let t=uie(),i=t.matches[t.matches.length-1];return i.route.id||Wa(!1),i.route.id}function die(){let{router:e}=cie(zD.UseNavigateStable),t=hie(kD.UseNavigateStable),i=ae.useRef(!1);return d9(()=>{i.current=!0}),ae.useCallback(function(r,s){s===void 0&&(s={}),i.current&&(typeof r=="number"?e.navigate(r):e.navigate(r,ND({fromRouteId:t},s)))},[e,t])}function fie(e){let{basename:t="/",children:i=null,location:n,navigationType:r=Zd.Pop,navigator:s,static:o=!1}=e;_M()&&Wa(!1);let a=t.replace(/^\/*/,"/"),l=ae.useMemo(()=>({basename:a,navigator:s,static:o}),[a,s,o]);typeof n=="string"&&(n=xM(n));let{pathname:c="/",search:h="",hash:u="",state:d=null,key:f="default"}=n,p=ae.useMemo(()=>{let g=o9(c,a);return g==null?null:{location:{pathname:g,search:h,hash:u,state:d,key:f},navigationType:r}},[a,c,h,u,d,f,r]);return p==null?null:ae.createElement(jx.Provider,{value:l},ae.createElement(ER.Provider,{children:i,value:p}))}var xk;(function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"})(xk||(xk={}));new Promise(()=>{});/**
 * React Router DOM v6.12.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function UD(){return UD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},UD.apply(this,arguments)}function pie(e,t){if(e==null)return{};var i={},n=Object.keys(e),r,s;for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&(i[r]=e[r]);return i}function mie(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function gie(e,t){return e.button===0&&(!t||t==="_self")&&!mie(e)}const vie=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],wk="startTransition";function yie(e){let{basename:t,children:i,window:n}=e,r=ae.useRef();r.current==null&&(r.current=Zte({window:n,v5Compat:!0}));let s=r.current,[o,a]=ae.useState({action:s.action,location:s.location}),l=ae.useCallback(c=>{wk in cz?cz[wk](()=>a(c)):a(c)},[a]);return ae.useLayoutEffect(()=>s.listen(l),[s,l]),ae.createElement(fie,{basename:t,children:i,location:o.location,navigationType:o.action,navigator:s})}const xie=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",wie=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_ie=ae.forwardRef(function(t,i){let{onClick:n,relative:r,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:h}=t,u=pie(t,vie),{basename:d}=ae.useContext(jx),f,p=!1;if(typeof c=="string"&&wie.test(c)&&(f=c,xie))try{let x=new URL(window.location.href),w=c.startsWith("//")?new URL(x.protocol+c):new URL(c),b=o9(w.pathname,d);w.origin===x.origin&&b!=null?c=b+w.search+w.hash:p=!0}catch{}let g=oie(c,{relative:r}),m=bie(c,{replace:o,state:a,target:l,preventScrollReset:h,relative:r});function v(x){n&&n(x),x.defaultPrevented||m(x)}return ae.createElement("a",UD({},u,{href:f||g,onClick:p||s?n:v,ref:i,target:l}))});var _k;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(_k||(_k={}));var bk;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(bk||(bk={}));function bie(e,t){let{target:i,replace:n,state:r,preventScrollReset:s,relative:o}=t===void 0?{}:t,a=aie(),l=CR(),c=f9(e,{relative:o});return ae.useCallback(h=>{if(gie(h,i)){h.preventDefault();let u=n!==void 0?n:qA(l)===qA(c);a(e,{replace:u,state:r,preventScrollReset:s,relative:o})}},[l,a,c,n,r,i,e,s,o])}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Wx="149",Rd={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Id={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},p9=0,GD=1,m9=2,Aie=3,g9=0,bM=1,fy=2,$d=3,Xl=0,Vs=1,za=2,Sie=2,Qc=0,df=1,HD=2,VD=3,jD=4,v9=5,Hd=100,y9=101,x9=102,WD=103,XD=104,w9=200,_9=201,b9=202,A9=203,TR=204,PR=205,S9=206,M9=207,E9=208,C9=209,T9=210,P9=0,D9=1,B9=2,QA=3,L9=4,R9=5,I9=6,O9=7,Xx=0,F9=1,N9=2,Xa=0,z9=1,k9=2,U9=3,DR=4,G9=5,AM=300,Bh=301,Lh=302,tx=303,ix=304,Jg=306,Rh=1e3,Mr=1001,bg=1002,gn=1003,nx=1004,Mie=1004,Km=1005,Eie=1005,rn=1006,SM=1007,Cie=1007,Yl=1008,Tie=1008,su=1009,H9=1010,V9=1011,BR=1012,j9=1013,lh=1014,Gc=1015,Ag=1016,W9=1017,X9=1018,ff=1020,Y9=1021,Ls=1023,q9=1024,Q9=1025,Sh=1026,Lf=1027,J9=1028,K9=1029,Z9=1030,$9=1031,e7=1033,iA=33776,nA=33777,rA=33778,sA=33779,YD=35840,qD=35841,QD=35842,JD=35843,t7=36196,KD=37492,ZD=37496,$D=37808,e3=37809,t3=37810,i3=37811,n3=37812,r3=37813,s3=37814,o3=37815,a3=37816,l3=37817,c3=37818,u3=37819,h3=37820,d3=37821,oA=36492,i7=36283,f3=36284,p3=36285,m3=36286,n7=2200,r7=2201,s7=2202,Sg=2300,Rf=2301,aA=2302,ef=2400,tf=2401,rx=2402,MM=2500,LR=2501,o7=0,RR=1,JA=2,Ih=3e3,Gi=3001,a7=3200,l7=3201,Wh=0,c7=1,Pie="",Ia="srgb",Mg="srgb-linear",Die=0,lA=7680,Bie=7681,Lie=7682,Rie=7683,Iie=34055,Oie=34056,Fie=5386,Nie=512,zie=513,kie=514,Uie=515,Gie=516,Hie=517,Vie=518,u7=519,sx=35044,pf=35048,jie=35040,Wie=35045,Xie=35049,Yie=35041,qie=35046,Qie=35050,Jie=35042,Kie="100",g3="300 es",KA=1035;class ec{addEventListener(t,i){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(i)===-1&&n[t].push(i)}hasEventListener(t,i){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(i)!==-1}removeEventListener(t,i){if(this._listeners===void 0)return;const r=this._listeners[t];if(r!==void 0){const s=r.indexOf(i);s!==-1&&r.splice(s,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const n=this._listeners[t.type];if(n!==void 0){t.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,t);t.target=null}}}const Ur=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Ak=1234567;const mf=Math.PI/180,ox=180/Math.PI;function vo(){const e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Ur[e&255]+Ur[e>>8&255]+Ur[e>>16&255]+Ur[e>>24&255]+"-"+Ur[t&255]+Ur[t>>8&255]+"-"+Ur[t>>16&15|64]+Ur[t>>24&255]+"-"+Ur[i&63|128]+Ur[i>>8&255]+"-"+Ur[i>>16&255]+Ur[i>>24&255]+Ur[n&255]+Ur[n>>8&255]+Ur[n>>16&255]+Ur[n>>24&255]).toLowerCase()}function Tn(e,t,i){return Math.max(t,Math.min(i,e))}function IR(e,t){return(e%t+t)%t}function Zie(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)}function $ie(e,t,i){return e!==t?(i-e)/(t-e):0}function py(e,t,i){return(1-i)*e+i*t}function ene(e,t,i,n){return py(e,t,1-Math.exp(-i*n))}function tne(e,t=1){return t-Math.abs(IR(e,t*2)-t)}function ine(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*(3-2*e))}function nne(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*e*(e*(e*6-15)+10))}function rne(e,t){return e+Math.floor(Math.random()*(t-e+1))}function sne(e,t){return e+Math.random()*(t-e)}function one(e){return e*(.5-Math.random())}function ane(e){e!==void 0&&(Ak=e);let t=Ak+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function lne(e){return e*mf}function cne(e){return e*ox}function v3(e){return(e&e-1)===0&&e!==0}function h7(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function ZA(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function une(e,t,i,n,r){const s=Math.cos,o=Math.sin,a=s(i/2),l=o(i/2),c=s((t+n)/2),h=o((t+n)/2),u=s((t-n)/2),d=o((t-n)/2),f=s((n-t)/2),p=o((n-t)/2);switch(r){case"XYX":e.set(a*h,l*u,l*d,a*c);break;case"YZY":e.set(l*d,a*h,l*u,a*c);break;case"ZXZ":e.set(l*u,l*d,a*h,a*c);break;case"XZX":e.set(a*h,l*p,l*f,a*c);break;case"YXY":e.set(l*f,a*h,l*p,a*c);break;case"ZYZ":e.set(l*p,l*f,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Hc(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function Ni(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var OR=Object.freeze({__proto__:null,DEG2RAD:mf,RAD2DEG:ox,ceilPowerOfTwo:h7,clamp:Tn,damp:ene,degToRad:lne,denormalize:Hc,euclideanModulo:IR,floorPowerOfTwo:ZA,generateUUID:vo,inverseLerp:$ie,isPowerOfTwo:v3,lerp:py,mapLinear:Zie,normalize:Ni,pingpong:tne,radToDeg:cne,randFloat:sne,randFloatSpread:one,randInt:rne,seededRandom:ane,setQuaternionFromProperEuler:une,smootherstep:nne,smoothstep:ine});class Ve{constructor(t=0,i=0){Ve.prototype.isVector2=!0,this.x=t,this.y=i}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,i){return this.x=t,this.y=i,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const i=this.x,n=this.y,r=t.elements;return this.x=r[0]*i+r[3]*n+r[6],this.y=r[1]*i+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this}clampLength(t,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const i=this.x-t.x,n=this.y-t.y;return i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this}lerpVectors(t,i,n){return this.x=t.x+(i.x-t.x)*n,this.y=t.y+(i.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t}fromBufferAttribute(t,i){return this.x=t.getX(i),this.y=t.getY(i),this}rotateAround(t,i){const n=Math.cos(i),r=Math.sin(i),s=this.x-t.x,o=this.y-t.y;return this.x=s*n-o*r+t.x,this.y=s*r+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class hs{constructor(){hs.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(t,i,n,r,s,o,a,l,c){const h=this.elements;return h[0]=t,h[1]=r,h[2]=a,h[3]=i,h[4]=s,h[5]=l,h[6]=n,h[7]=o,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const i=this.elements,n=t.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this}extractBasis(t,i,n){return t.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const i=t.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,i){const n=t.elements,r=i.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],h=n[4],u=n[7],d=n[2],f=n[5],p=n[8],g=r[0],m=r[3],v=r[6],x=r[1],w=r[4],b=r[7],M=r[2],A=r[5],T=r[8];return s[0]=o*g+a*x+l*M,s[3]=o*m+a*w+l*A,s[6]=o*v+a*b+l*T,s[1]=c*g+h*x+u*M,s[4]=c*m+h*w+u*A,s[7]=c*v+h*b+u*T,s[2]=d*g+f*x+p*M,s[5]=d*m+f*w+p*A,s[8]=d*v+f*b+p*T,this}multiplyScalar(t){const i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this}determinant(){const t=this.elements,i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],h=t[8];return i*o*h-i*a*c-n*s*h+n*a*l+r*s*c-r*o*l}invert(){const t=this.elements,i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],h=t[8],u=h*o-a*c,d=a*l-h*s,f=c*s-o*l,p=i*u+n*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const g=1/p;return t[0]=u*g,t[1]=(r*c-h*n)*g,t[2]=(a*n-r*o)*g,t[3]=d*g,t[4]=(h*i-r*l)*g,t[5]=(r*s-a*i)*g,t[6]=f*g,t[7]=(n*l-c*i)*g,t[8]=(o*i-n*s)*g,this}transpose(){let t;const i=this.elements;return t=i[1],i[1]=i[3],i[3]=t,t=i[2],i[2]=i[6],i[6]=t,t=i[5],i[5]=i[7],i[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this}setUvTransform(t,i,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+t,-r*c,r*l,-r*(-c*o+l*a)+a+i,0,0,1),this}scale(t,i){return this.premultiply(QC.makeScale(t,i)),this}rotate(t){return this.premultiply(QC.makeRotation(-t)),this}translate(t,i){return this.premultiply(QC.makeTranslation(t,i)),this}makeTranslation(t,i){return this.set(1,0,t,0,1,i,0,0,1),this}makeRotation(t){const i=Math.cos(t),n=Math.sin(t);return this.set(i,-n,0,n,i,0,0,0,1),this}makeScale(t,i){return this.set(t,0,0,0,i,0,0,0,1),this}equals(t){const i=this.elements,n=t.elements;for(let r=0;r<9;r++)if(i[r]!==n[r])return!1;return!0}fromArray(t,i=0){for(let n=0;n<9;n++)this.elements[n]=t[n+i];return this}toArray(t=[],i=0){const n=this.elements;return t[i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const QC=new hs;function d7(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}const hne={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Tm(e,t){return new hne[e](t)}function ax(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function gf(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function cA(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}const JC={[Ia]:{[Mg]:gf},[Mg]:{[Ia]:cA}},Vr={legacyMode:!0,get workingColorSpace(){return Mg},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,i){if(this.legacyMode||t===i||!t||!i)return e;if(JC[t]&&JC[t][i]!==void 0){const n=JC[t][i];return e.r=n(e.r),e.g=n(e.g),e.b=n(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},f7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Wn={r:0,g:0,b:0},wa={h:0,s:0,l:0},Vw={h:0,s:0,l:0};function KC(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*6*(2/3-i):e}function jw(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}class ct{constructor(t,i,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,i===void 0&&n===void 0?this.set(t):this.setRGB(t,i,n)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,i=Ia){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Vr.toWorkingColorSpace(this,i),this}setRGB(t,i,n,r=Vr.workingColorSpace){return this.r=t,this.g=i,this.b=n,Vr.toWorkingColorSpace(this,r),this}setHSL(t,i,n,r=Vr.workingColorSpace){if(t=IR(t,1),i=Tn(i,0,1),n=Tn(n,0,1),i===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+i):n+i-n*i,o=2*n-s;this.r=KC(o,s,t+1/3),this.g=KC(o,s,t),this.b=KC(o,s,t-1/3)}return Vr.toWorkingColorSpace(this,r),this}setStyle(t,i=Ia){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Vr.toWorkingColorSpace(this,i),n(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Vr.toWorkingColorSpace(this,i),n(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,h=parseFloat(s[3])/100;return n(s[4]),this.setHSL(l,c,h,i)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=r[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Vr.toWorkingColorSpace(this,i),this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Vr.toWorkingColorSpace(this,i),this}return t&&t.length>0?this.setColorName(t,i):this}setColorName(t,i=Ia){const n=f7[t.toLowerCase()];return n!==void 0?this.setHex(n,i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=gf(t.r),this.g=gf(t.g),this.b=gf(t.b),this}copyLinearToSRGB(t){return this.r=cA(t.r),this.g=cA(t.g),this.b=cA(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Ia){return Vr.fromWorkingColorSpace(jw(this,Wn),t),Tn(Wn.r*255,0,255)<<16^Tn(Wn.g*255,0,255)<<8^Tn(Wn.b*255,0,255)<<0}getHexString(t=Ia){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,i=Vr.workingColorSpace){Vr.fromWorkingColorSpace(jw(this,Wn),i);const n=Wn.r,r=Wn.g,s=Wn.b,o=Math.max(n,r,s),a=Math.min(n,r,s);let l,c;const h=(a+o)/2;if(a===o)l=0,c=0;else{const u=o-a;switch(c=h<=.5?u/(o+a):u/(2-o-a),o){case n:l=(r-s)/u+(r<s?6:0);break;case r:l=(s-n)/u+2;break;case s:l=(n-r)/u+4;break}l/=6}return t.h=l,t.s=c,t.l=h,t}getRGB(t,i=Vr.workingColorSpace){return Vr.fromWorkingColorSpace(jw(this,Wn),i),t.r=Wn.r,t.g=Wn.g,t.b=Wn.b,t}getStyle(t=Ia){return Vr.fromWorkingColorSpace(jw(this,Wn),t),t!==Ia?`color(${t} ${Wn.r} ${Wn.g} ${Wn.b})`:`rgb(${Wn.r*255|0},${Wn.g*255|0},${Wn.b*255|0})`}offsetHSL(t,i,n){return this.getHSL(wa),wa.h+=t,wa.s+=i,wa.l+=n,this.setHSL(wa.h,wa.s,wa.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,n){return this.r=t.r+(i.r-t.r)*n,this.g=t.g+(i.g-t.g)*n,this.b=t.b+(i.b-t.b)*n,this}lerpHSL(t,i){this.getHSL(wa),t.getHSL(Vw);const n=py(wa.h,Vw.h,i),r=py(wa.s,Vw.s,i),s=py(wa.l,Vw.l,i);return this.setHSL(n,r,s),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}ct.NAMES=f7;let vp;class FR{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let i;if(t instanceof HTMLCanvasElement)i=t;else{vp===void 0&&(vp=ax("canvas")),vp.width=t.width,vp.height=t.height;const n=vp.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),i=vp}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const i=ax("canvas");i.width=t.width,i.height=t.height;const n=i.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=gf(s[o]/255)*255;return n.putImageData(r,0,0),i}else if(t.data){const i=t.data.slice(0);for(let n=0;n<i.length;n++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[n]=Math.floor(gf(i[n]/255)*255):i[n]=gf(i[n]);return{data:i,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}class nf{constructor(t=null){this.isSource=!0,this.uuid=vo(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const i=t===void 0||typeof t=="string";if(!i&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(ZC(r[o].image)):s.push(ZC(r[o]))}else s=ZC(r);n.url=s}return i||(t.images[this.uuid]=n),n}}function ZC(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?FR.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let dne=0;class en extends ec{constructor(t=en.DEFAULT_IMAGE,i=en.DEFAULT_MAPPING,n=Mr,r=Mr,s=rn,o=Yl,a=Ls,l=su,c=en.DEFAULT_ANISOTROPY,h=Ih){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:dne++}),this.uuid=vo(),this.name="",this.source=new nf(t),this.mipmaps=[],this.mapping=i,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ve(0,0),this.repeat=new Ve(1,1),this.center=new Ve(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new hs,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=t===void 0||typeof t=="string";if(!i&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),i||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==AM)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Rh:t.x=t.x-Math.floor(t.x);break;case Mr:t.x=t.x<0?0:1;break;case bg:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Rh:t.y=t.y-Math.floor(t.y);break;case Mr:t.y=t.y<0?0:1;break;case bg:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}}en.DEFAULT_IMAGE=null;en.DEFAULT_MAPPING=AM;en.DEFAULT_ANISOTROPY=1;class Ci{constructor(t=0,i=0,n=0,r=1){Ci.prototype.isVector4=!0,this.x=t,this.y=i,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,i,n,r){return this.x=t,this.y=i,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this.w+=t.w*i,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const i=this.x,n=this.y,r=this.z,s=this.w,o=t.elements;return this.x=o[0]*i+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*i+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*i+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*i+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this}setAxisAngleFromRotationMatrix(t){let i,n,r,s;const l=t.elements,c=l[0],h=l[4],u=l[8],d=l[1],f=l[5],p=l[9],g=l[2],m=l[6],v=l[10];if(Math.abs(h-d)<.01&&Math.abs(u-g)<.01&&Math.abs(p-m)<.01){if(Math.abs(h+d)<.1&&Math.abs(u+g)<.1&&Math.abs(p+m)<.1&&Math.abs(c+f+v-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const w=(c+1)/2,b=(f+1)/2,M=(v+1)/2,A=(h+d)/4,T=(u+g)/4,S=(p+m)/4;return w>b&&w>M?w<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(w),r=A/n,s=T/n):b>M?b<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),n=A/r,s=S/r):M<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(M),n=T/s,r=S/s),this.set(n,r,s,i),this}let x=Math.sqrt((m-p)*(m-p)+(u-g)*(u-g)+(d-h)*(d-h));return Math.abs(x)<.001&&(x=1),this.x=(m-p)/x,this.y=(u-g)/x,this.z=(d-h)/x,this.w=Math.acos((c+f+v-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this.w=Math.max(t.w,Math.min(i.w,this.w)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this.w=Math.max(t,Math.min(i,this.w)),this}clampLength(t,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this}lerpVectors(t,i,n){return this.x=t.x+(i.x-t.x)*n,this.y=t.y+(i.y-t.y)*n,this.z=t.z+(i.z-t.z)*n,this.w=t.w+(i.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t}fromBufferAttribute(t,i){return this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this.w=t.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ja extends ec{constructor(t=1,i=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=i,this.depth=1,this.scissor=new Ci(0,0,t,i),this.scissorTest=!1,this.viewport=new Ci(0,0,t,i);const r={width:t,height:i,depth:1};this.texture=new en(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:rn,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(t,i,n=1){(this.width!==t||this.height!==i||this.depth!==n)&&(this.width=t,this.height=i,this.depth=n,this.texture.image.width=t,this.texture.image.height=i,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,i),this.scissor.set(0,0,t,i)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const i=Object.assign({},t.texture.image);return this.texture.source=new nf(i),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class EM extends en{constructor(t=null,i=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:i,height:n,depth:r},this.magFilter=gn,this.minFilter=gn,this.wrapR=Mr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class fne extends Ja{constructor(t=1,i=1,n=1){super(t,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new EM(null,t,i,n),this.texture.isRenderTargetTexture=!0}}class NR extends en{constructor(t=null,i=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:i,height:n,depth:r},this.magFilter=gn,this.minFilter=gn,this.wrapR=Mr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class pne extends Ja{constructor(t=1,i=1,n=1){super(t,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new NR(null,t,i,n),this.texture.isRenderTargetTexture=!0}}class mne extends Ja{constructor(t=1,i=1,n=1,r={}){super(t,i,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<n;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(t,i,n=1){if(this.width!==t||this.height!==i||this.depth!==n){this.width=t,this.height=i,this.depth=n;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=t,this.texture[r].image.height=i,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,i),this.scissor.set(0,0,t,i),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.texture.length=0;for(let i=0,n=t.texture.length;i<n;i++)this.texture[i]=t.texture[i].clone(),this.texture[i].isRenderTargetTexture=!0;return this}}class yr{constructor(t=0,i=0,n=0,r=1){this.isQuaternion=!0,this._x=t,this._y=i,this._z=n,this._w=r}static slerpFlat(t,i,n,r,s,o,a){let l=n[r+0],c=n[r+1],h=n[r+2],u=n[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],g=s[o+3];if(a===0){t[i+0]=l,t[i+1]=c,t[i+2]=h,t[i+3]=u;return}if(a===1){t[i+0]=d,t[i+1]=f,t[i+2]=p,t[i+3]=g;return}if(u!==g||l!==d||c!==f||h!==p){let m=1-a;const v=l*d+c*f+h*p+u*g,x=v>=0?1:-1,w=1-v*v;if(w>Number.EPSILON){const M=Math.sqrt(w),A=Math.atan2(M,v*x);m=Math.sin(m*A)/M,a=Math.sin(a*A)/M}const b=a*x;if(l=l*m+d*b,c=c*m+f*b,h=h*m+p*b,u=u*m+g*b,m===1-a){const M=1/Math.sqrt(l*l+c*c+h*h+u*u);l*=M,c*=M,h*=M,u*=M}}t[i]=l,t[i+1]=c,t[i+2]=h,t[i+3]=u}static multiplyQuaternionsFlat(t,i,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],h=n[r+3],u=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return t[i]=a*p+h*u+l*f-c*d,t[i+1]=l*p+h*d+c*u-a*f,t[i+2]=c*p+h*f+a*d-l*u,t[i+3]=h*p-a*u-l*d-c*f,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,i,n,r){return this._x=t,this._y=i,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,i){const n=t._x,r=t._y,s=t._z,o=t._order,a=Math.cos,l=Math.sin,c=a(n/2),h=a(r/2),u=a(s/2),d=l(n/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*h*u+c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u-d*f*p;break;case"YXZ":this._x=d*h*u+c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u+d*f*p;break;case"ZXY":this._x=d*h*u-c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u-d*f*p;break;case"ZYX":this._x=d*h*u-c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u+d*f*p;break;case"YZX":this._x=d*h*u+c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u-d*f*p;break;case"XZY":this._x=d*h*u-c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return i!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,i){const n=i/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const i=t.elements,n=i[0],r=i[4],s=i[8],o=i[1],a=i[5],l=i[9],c=i[2],h=i[6],u=i[10],d=n+a+u;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(h-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(n>a&&n>u){const f=2*Math.sqrt(1+n-a-u);this._w=(h-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>u){const f=2*Math.sqrt(1+a-n-u);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+h)/f}else{const f=2*Math.sqrt(1+u-n-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+h)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(t,i){let n=t.dot(i)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*i.z-t.z*i.y,this._y=t.z*i.x-t.x*i.z,this._z=t.x*i.y-t.y*i.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Tn(this.dot(t),-1,1)))}rotateTowards(t,i){const n=this.angleTo(t);if(n===0)return this;const r=Math.min(1,i/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,i){const n=t._x,r=t._y,s=t._z,o=t._w,a=i._x,l=i._y,c=i._z,h=i._w;return this._x=n*h+o*a+r*c-s*l,this._y=r*h+o*l+s*a-n*c,this._z=s*h+o*c+n*l-r*a,this._w=o*h-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(t,i){if(i===0)return this;if(i===1)return this.copy(t);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*t._w+n*t._x+r*t._y+s*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-i;return this._w=f*o+i*this._w,this._x=f*n+i*this._x,this._y=f*r+i*this._y,this._z=f*s+i*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),h=Math.atan2(c,a),u=Math.sin((1-i)*h)/c,d=Math.sin(i*h)/c;return this._w=o*u+this._w*d,this._x=n*u+this._x*d,this._y=r*u+this._y*d,this._z=s*u+this._z*d,this._onChangeCallback(),this}slerpQuaternions(t,i,n){return this.copy(t).slerp(i,n)}random(){const t=Math.random(),i=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(i*Math.cos(r),n*Math.sin(s),n*Math.cos(s),i*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,i=0){return this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t}fromBufferAttribute(t,i){return this._x=t.getX(i),this._y=t.getY(i),this._z=t.getZ(i),this._w=t.getW(i),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class te{constructor(t=0,i=0,n=0){te.prototype.isVector3=!0,this.x=t,this.y=i,this.z=n}set(t,i,n){return n===void 0&&(n=this.z),this.x=t,this.y=i,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this}applyEuler(t){return this.applyQuaternion(Sk.setFromEuler(t))}applyAxisAngle(t,i){return this.applyQuaternion(Sk.setFromAxisAngle(t,i))}applyMatrix3(t){const i=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*i+s[3]*n+s[6]*r,this.y=s[1]*i+s[4]*n+s[7]*r,this.z=s[2]*i+s[5]*n+s[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const i=this.x,n=this.y,r=this.z,s=t.elements,o=1/(s[3]*i+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*i+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*i+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*i+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(t){const i=this.x,n=this.y,r=this.z,s=t.x,o=t.y,a=t.z,l=t.w,c=l*i+o*r-a*n,h=l*n+a*i-s*r,u=l*r+s*n-o*i,d=-s*i-o*n-a*r;return this.x=c*l+d*-s+h*-a-u*-o,this.y=h*l+d*-o+u*-s-c*-a,this.z=u*l+d*-a+c*-o-h*-s,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const i=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*i+s[4]*n+s[8]*r,this.y=s[1]*i+s[5]*n+s[9]*r,this.z=s[2]*i+s[6]*n+s[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this}clampLength(t,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this}lerpVectors(t,i,n){return this.x=t.x+(i.x-t.x)*n,this.y=t.y+(i.y-t.y)*n,this.z=t.z+(i.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,i){const n=t.x,r=t.y,s=t.z,o=i.x,a=i.y,l=i.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(t){const i=t.lengthSq();if(i===0)return this.set(0,0,0);const n=t.dot(this)/i;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return $C.copy(this).projectOnVector(t),this.sub($C)}reflect(t){return this.sub($C.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const i=Math.sqrt(this.lengthSq()*t.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(t)/i;return Math.acos(Tn(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const i=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return i*i+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,i,n){const r=Math.sin(i)*t;return this.x=r*Math.sin(n),this.y=Math.cos(i)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,i,n){return this.x=t*Math.sin(i),this.y=n,this.z=t*Math.cos(i),this}setFromMatrixPosition(t){const i=t.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(t){const i=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=n,this.z=r,this}setFromMatrixColumn(t,i){return this.fromArray(t.elements,i*4)}setFromMatrix3Column(t,i){return this.fromArray(t.elements,i*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t}fromBufferAttribute(t,i){return this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,i=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(i),this.y=n*Math.sin(i),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const $C=new te,Sk=new yr;class Xh{constructor(t=new te(1/0,1/0,1/0),i=new te(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=i}set(t,i){return this.min.copy(t),this.max.copy(i),this}setFromArray(t){let i=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=t.length;l<c;l+=3){const h=t[l],u=t[l+1],d=t[l+2];h<i&&(i=h),u<n&&(n=u),d<r&&(r=d),h>s&&(s=h),u>o&&(o=u),d>a&&(a=d)}return this.min.set(i,n,r),this.max.set(s,o,a),this}setFromBufferAttribute(t){let i=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=t.count;l<c;l++){const h=t.getX(l),u=t.getY(l),d=t.getZ(l);h<i&&(i=h),u<n&&(n=u),d<r&&(r=d),h>s&&(s=h),u>o&&(o=u),d>a&&(a=d)}return this.min.set(i,n,r),this.max.set(s,o,a),this}setFromPoints(t){this.makeEmpty();for(let i=0,n=t.length;i<n;i++)this.expandByPoint(t[i]);return this}setFromCenterAndSize(t,i){const n=dd.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,i=!1){return this.makeEmpty(),this.expandByObject(t,i)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,i=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(n!==void 0)if(i&&n.attributes!=null&&n.attributes.position!==void 0){const s=n.attributes.position;for(let o=0,a=s.count;o<a;o++)dd.fromBufferAttribute(s,o).applyMatrix4(t.matrixWorld),this.expandByPoint(dd)}else n.boundingBox===null&&n.computeBoundingBox(),eT.copy(n.boundingBox),eT.applyMatrix4(t.matrixWorld),this.union(eT);const r=t.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],i);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,i){return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,dd),dd.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let i,n;return t.normal.x>0?(i=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(i=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(i+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(i+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(i+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(i+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),i<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Xv),Ww.subVectors(this.max,Xv),yp.subVectors(t.a,Xv),xp.subVectors(t.b,Xv),wp.subVectors(t.c,Xv),Su.subVectors(xp,yp),Mu.subVectors(wp,xp),fd.subVectors(yp,wp);let i=[0,-Su.z,Su.y,0,-Mu.z,Mu.y,0,-fd.z,fd.y,Su.z,0,-Su.x,Mu.z,0,-Mu.x,fd.z,0,-fd.x,-Su.y,Su.x,0,-Mu.y,Mu.x,0,-fd.y,fd.x,0];return!tT(i,yp,xp,wp,Ww)||(i=[1,0,0,0,1,0,0,0,1],!tT(i,yp,xp,wp,Ww))?!1:(Xw.crossVectors(Su,Mu),i=[Xw.x,Xw.y,Xw.z],tT(i,yp,xp,wp,Ww))}clampPoint(t,i){return i.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return dd.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(dd).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(hc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),hc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),hc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),hc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),hc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),hc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),hc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),hc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(hc),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const hc=[new te,new te,new te,new te,new te,new te,new te,new te],dd=new te,eT=new Xh,yp=new te,xp=new te,wp=new te,Su=new te,Mu=new te,fd=new te,Xv=new te,Ww=new te,Xw=new te,pd=new te;function tT(e,t,i,n,r){for(let s=0,o=e.length-3;s<=o;s+=3){pd.fromArray(e,s);const a=r.x*Math.abs(pd.x)+r.y*Math.abs(pd.y)+r.z*Math.abs(pd.z),l=t.dot(pd),c=i.dot(pd),h=n.dot(pd);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}const gne=new Xh,Yv=new te,iT=new te;class Yh{constructor(t=new te,i=-1){this.center=t,this.radius=i}set(t,i){return this.center.copy(t),this.radius=i,this}setFromPoints(t,i){const n=this.center;i!==void 0?n.copy(i):gne.setFromPoints(t).getCenter(n);let r=0;for(let s=0,o=t.length;s<o;s++)r=Math.max(r,n.distanceToSquared(t[s]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const i=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=i*i}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,i){const n=this.center.distanceToSquared(t);return i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Yv.subVectors(t,this.center);const i=Yv.lengthSq();if(i>this.radius*this.radius){const n=Math.sqrt(i),r=(n-this.radius)*.5;this.center.addScaledVector(Yv,r/n),this.radius+=r}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(iT.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Yv.copy(t.center).add(iT)),this.expandByPoint(Yv.copy(t.center).sub(iT))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const dc=new te,nT=new te,Yw=new te,Eu=new te,rT=new te,qw=new te,sT=new te;class Yx{constructor(t=new te,i=new te(0,0,-1)){this.origin=t,this.direction=i}set(t,i){return this.origin.copy(t),this.direction.copy(i),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,i){return i.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,dc)),this}closestPointToPoint(t,i){i.subVectors(t,this.origin);const n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const i=dc.subVectors(t,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(t):(dc.copy(this.direction).multiplyScalar(i).add(this.origin),dc.distanceToSquared(t))}distanceSqToSegment(t,i,n,r){nT.copy(t).add(i).multiplyScalar(.5),Yw.copy(i).sub(t).normalize(),Eu.copy(this.origin).sub(nT);const s=t.distanceTo(i)*.5,o=-this.direction.dot(Yw),a=Eu.dot(this.direction),l=-Eu.dot(Yw),c=Eu.lengthSq(),h=Math.abs(1-o*o);let u,d,f,p;if(h>0)if(u=o*l-a,d=o*a-l,p=s*h,u>=0)if(d>=-p)if(d<=p){const g=1/h;u*=g,d*=g,f=u*(u+o*d+2*a)+d*(o*u+d+2*l)+c}else d=s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;else d=-s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;else d<=-p?(u=Math.max(0,-(-o*s+a)),d=u>0?-s:Math.min(Math.max(-s,-l),s),f=-u*u+d*(d+2*l)+c):d<=p?(u=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(u=Math.max(0,-(o*s+a)),d=u>0?s:Math.min(Math.max(-s,-l),s),f=-u*u+d*(d+2*l)+c);else d=o>0?-s:s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),r&&r.copy(Yw).multiplyScalar(d).add(nT),f}intersectSphere(t,i){dc.subVectors(t.center,this.origin);const n=dc.dot(this.direction),r=dc.dot(dc)-n*n,s=t.radius*t.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return a<0&&l<0?null:a<0?this.at(l,i):this.at(a,i)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const i=t.normal.dot(this.direction);if(i===0)return t.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/i;return n>=0?n:null}intersectPlane(t,i){const n=this.distanceToPlane(t);return n===null?null:this.at(n,i)}intersectsPlane(t){const i=t.distanceToPoint(this.origin);return i===0||t.normal.dot(this.direction)*i<0}intersectBox(t,i){let n,r,s,o,a,l;const c=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,d=this.origin;return c>=0?(n=(t.min.x-d.x)*c,r=(t.max.x-d.x)*c):(n=(t.max.x-d.x)*c,r=(t.min.x-d.x)*c),h>=0?(s=(t.min.y-d.y)*h,o=(t.max.y-d.y)*h):(s=(t.max.y-d.y)*h,o=(t.min.y-d.y)*h),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),u>=0?(a=(t.min.z-d.z)*u,l=(t.max.z-d.z)*u):(a=(t.max.z-d.z)*u,l=(t.min.z-d.z)*u),n>l||a>r)||((a>n||n!==n)&&(n=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,i)}intersectsBox(t){return this.intersectBox(t,dc)!==null}intersectTriangle(t,i,n,r,s){rT.subVectors(i,t),qw.subVectors(n,t),sT.crossVectors(rT,qw);let o=this.direction.dot(sT),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Eu.subVectors(this.origin,t);const l=a*this.direction.dot(qw.crossVectors(Eu,qw));if(l<0)return null;const c=a*this.direction.dot(rT.cross(Eu));if(c<0||l+c>o)return null;const h=-a*Eu.dot(sT);return h<0?null:this.at(h/o,s)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Nt{constructor(){Nt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,i,n,r,s,o,a,l,c,h,u,d,f,p,g,m){const v=this.elements;return v[0]=t,v[4]=i,v[8]=n,v[12]=r,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=c,v[6]=h,v[10]=u,v[14]=d,v[3]=f,v[7]=p,v[11]=g,v[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Nt().fromArray(this.elements)}copy(t){const i=this.elements,n=t.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this}copyPosition(t){const i=this.elements,n=t.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this}setFromMatrix3(t){const i=t.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(t,i,n){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,i,n){return this.set(t.x,i.x,n.x,0,t.y,i.y,n.y,0,t.z,i.z,n.z,0,0,0,0,1),this}extractRotation(t){const i=this.elements,n=t.elements,r=1/_p.setFromMatrixColumn(t,0).length(),s=1/_p.setFromMatrixColumn(t,1).length(),o=1/_p.setFromMatrixColumn(t,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[3]=0,i[4]=n[4]*s,i[5]=n[5]*s,i[6]=n[6]*s,i[7]=0,i[8]=n[8]*o,i[9]=n[9]*o,i[10]=n[10]*o,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(t){const i=this.elements,n=t.x,r=t.y,s=t.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),h=Math.cos(s),u=Math.sin(s);if(t.order==="XYZ"){const d=o*h,f=o*u,p=a*h,g=a*u;i[0]=l*h,i[4]=-l*u,i[8]=c,i[1]=f+p*c,i[5]=d-g*c,i[9]=-a*l,i[2]=g-d*c,i[6]=p+f*c,i[10]=o*l}else if(t.order==="YXZ"){const d=l*h,f=l*u,p=c*h,g=c*u;i[0]=d+g*a,i[4]=p*a-f,i[8]=o*c,i[1]=o*u,i[5]=o*h,i[9]=-a,i[2]=f*a-p,i[6]=g+d*a,i[10]=o*l}else if(t.order==="ZXY"){const d=l*h,f=l*u,p=c*h,g=c*u;i[0]=d-g*a,i[4]=-o*u,i[8]=p+f*a,i[1]=f+p*a,i[5]=o*h,i[9]=g-d*a,i[2]=-o*c,i[6]=a,i[10]=o*l}else if(t.order==="ZYX"){const d=o*h,f=o*u,p=a*h,g=a*u;i[0]=l*h,i[4]=p*c-f,i[8]=d*c+g,i[1]=l*u,i[5]=g*c+d,i[9]=f*c-p,i[2]=-c,i[6]=a*l,i[10]=o*l}else if(t.order==="YZX"){const d=o*l,f=o*c,p=a*l,g=a*c;i[0]=l*h,i[4]=g-d*u,i[8]=p*u+f,i[1]=u,i[5]=o*h,i[9]=-a*h,i[2]=-c*h,i[6]=f*u+p,i[10]=d-g*u}else if(t.order==="XZY"){const d=o*l,f=o*c,p=a*l,g=a*c;i[0]=l*h,i[4]=-u,i[8]=c*h,i[1]=d*u+g,i[5]=o*h,i[9]=f*u-p,i[2]=p*u-f,i[6]=a*h,i[10]=g*u+d}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(t){return this.compose(vne,t,yne)}lookAt(t,i,n){const r=this.elements;return $s.subVectors(t,i),$s.lengthSq()===0&&($s.z=1),$s.normalize(),Cu.crossVectors(n,$s),Cu.lengthSq()===0&&(Math.abs(n.z)===1?$s.x+=1e-4:$s.z+=1e-4,$s.normalize(),Cu.crossVectors(n,$s)),Cu.normalize(),Qw.crossVectors($s,Cu),r[0]=Cu.x,r[4]=Qw.x,r[8]=$s.x,r[1]=Cu.y,r[5]=Qw.y,r[9]=$s.y,r[2]=Cu.z,r[6]=Qw.z,r[10]=$s.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,i){const n=t.elements,r=i.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],h=n[1],u=n[5],d=n[9],f=n[13],p=n[2],g=n[6],m=n[10],v=n[14],x=n[3],w=n[7],b=n[11],M=n[15],A=r[0],T=r[4],S=r[8],C=r[12],P=r[1],B=r[5],k=r[9],z=r[13],F=r[2],W=r[6],K=r[10],Z=r[14],U=r[3],X=r[7],V=r[11],q=r[15];return s[0]=o*A+a*P+l*F+c*U,s[4]=o*T+a*B+l*W+c*X,s[8]=o*S+a*k+l*K+c*V,s[12]=o*C+a*z+l*Z+c*q,s[1]=h*A+u*P+d*F+f*U,s[5]=h*T+u*B+d*W+f*X,s[9]=h*S+u*k+d*K+f*V,s[13]=h*C+u*z+d*Z+f*q,s[2]=p*A+g*P+m*F+v*U,s[6]=p*T+g*B+m*W+v*X,s[10]=p*S+g*k+m*K+v*V,s[14]=p*C+g*z+m*Z+v*q,s[3]=x*A+w*P+b*F+M*U,s[7]=x*T+w*B+b*W+M*X,s[11]=x*S+w*k+b*K+M*V,s[15]=x*C+w*z+b*Z+M*q,this}multiplyScalar(t){const i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this}determinant(){const t=this.elements,i=t[0],n=t[4],r=t[8],s=t[12],o=t[1],a=t[5],l=t[9],c=t[13],h=t[2],u=t[6],d=t[10],f=t[14],p=t[3],g=t[7],m=t[11],v=t[15];return p*(+s*l*u-r*c*u-s*a*d+n*c*d+r*a*f-n*l*f)+g*(+i*l*f-i*c*d+s*o*d-r*o*f+r*c*h-s*l*h)+m*(+i*c*u-i*a*f-s*o*u+n*o*f+s*a*h-n*c*h)+v*(-r*a*h-i*l*u+i*a*d+r*o*u-n*o*d+n*l*h)}transpose(){const t=this.elements;let i;return i=t[1],t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[6],t[6]=t[9],t[9]=i,i=t[3],t[3]=t[12],t[12]=i,i=t[7],t[7]=t[13],t[13]=i,i=t[11],t[11]=t[14],t[14]=i,this}setPosition(t,i,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=i,r[14]=n),this}invert(){const t=this.elements,i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],h=t[8],u=t[9],d=t[10],f=t[11],p=t[12],g=t[13],m=t[14],v=t[15],x=u*m*c-g*d*c+g*l*f-a*m*f-u*l*v+a*d*v,w=p*d*c-h*m*c-p*l*f+o*m*f+h*l*v-o*d*v,b=h*g*c-p*u*c+p*a*f-o*g*f-h*a*v+o*u*v,M=p*u*l-h*g*l-p*a*d+o*g*d+h*a*m-o*u*m,A=i*x+n*w+r*b+s*M;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/A;return t[0]=x*T,t[1]=(g*d*s-u*m*s-g*r*f+n*m*f+u*r*v-n*d*v)*T,t[2]=(a*m*s-g*l*s+g*r*c-n*m*c-a*r*v+n*l*v)*T,t[3]=(u*l*s-a*d*s-u*r*c+n*d*c+a*r*f-n*l*f)*T,t[4]=w*T,t[5]=(h*m*s-p*d*s+p*r*f-i*m*f-h*r*v+i*d*v)*T,t[6]=(p*l*s-o*m*s-p*r*c+i*m*c+o*r*v-i*l*v)*T,t[7]=(o*d*s-h*l*s+h*r*c-i*d*c-o*r*f+i*l*f)*T,t[8]=b*T,t[9]=(p*u*s-h*g*s-p*n*f+i*g*f+h*n*v-i*u*v)*T,t[10]=(o*g*s-p*a*s+p*n*c-i*g*c-o*n*v+i*a*v)*T,t[11]=(h*a*s-o*u*s-h*n*c+i*u*c+o*n*f-i*a*f)*T,t[12]=M*T,t[13]=(h*g*r-p*u*r+p*n*d-i*g*d-h*n*m+i*u*m)*T,t[14]=(p*a*r-o*g*r-p*n*l+i*g*l+o*n*m-i*a*m)*T,t[15]=(o*u*r-h*a*r+h*n*l-i*u*l-o*n*d+i*a*d)*T,this}scale(t){const i=this.elements,n=t.x,r=t.y,s=t.z;return i[0]*=n,i[4]*=r,i[8]*=s,i[1]*=n,i[5]*=r,i[9]*=s,i[2]*=n,i[6]*=r,i[10]*=s,i[3]*=n,i[7]*=r,i[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,n,r))}makeTranslation(t,i,n){return this.set(1,0,0,t,0,1,0,i,0,0,1,n,0,0,0,1),this}makeRotationX(t){const i=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this}makeRotationY(t){const i=Math.cos(t),n=Math.sin(t);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this}makeRotationZ(t){const i=Math.cos(t),n=Math.sin(t);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,i){const n=Math.cos(i),r=Math.sin(i),s=1-n,o=t.x,a=t.y,l=t.z,c=s*o,h=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,h*a+n,h*l-r*o,0,c*l-r*a,h*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(t,i,n){return this.set(t,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,i,n,r,s,o){return this.set(1,n,s,0,t,1,o,0,i,r,1,0,0,0,0,1),this}compose(t,i,n){const r=this.elements,s=i._x,o=i._y,a=i._z,l=i._w,c=s+s,h=o+o,u=a+a,d=s*c,f=s*h,p=s*u,g=o*h,m=o*u,v=a*u,x=l*c,w=l*h,b=l*u,M=n.x,A=n.y,T=n.z;return r[0]=(1-(g+v))*M,r[1]=(f+b)*M,r[2]=(p-w)*M,r[3]=0,r[4]=(f-b)*A,r[5]=(1-(d+v))*A,r[6]=(m+x)*A,r[7]=0,r[8]=(p+w)*T,r[9]=(m-x)*T,r[10]=(1-(d+g))*T,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,i,n){const r=this.elements;let s=_p.set(r[0],r[1],r[2]).length();const o=_p.set(r[4],r[5],r[6]).length(),a=_p.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),t.x=r[12],t.y=r[13],t.z=r[14],_a.copy(this);const c=1/s,h=1/o,u=1/a;return _a.elements[0]*=c,_a.elements[1]*=c,_a.elements[2]*=c,_a.elements[4]*=h,_a.elements[5]*=h,_a.elements[6]*=h,_a.elements[8]*=u,_a.elements[9]*=u,_a.elements[10]*=u,i.setFromRotationMatrix(_a),n.x=s,n.y=o,n.z=a,this}makePerspective(t,i,n,r,s,o){const a=this.elements,l=2*s/(i-t),c=2*s/(n-r),h=(i+t)/(i-t),u=(n+r)/(n-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,i,n,r,s,o){const a=this.elements,l=1/(i-t),c=1/(n-r),h=1/(o-s),u=(i+t)*l,d=(n+r)*c,f=(o+s)*h;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*h,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const i=this.elements,n=t.elements;for(let r=0;r<16;r++)if(i[r]!==n[r])return!1;return!0}fromArray(t,i=0){for(let n=0;n<16;n++)this.elements[n]=t[n+i];return this}toArray(t=[],i=0){const n=this.elements;return t[i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t[i+9]=n[9],t[i+10]=n[10],t[i+11]=n[11],t[i+12]=n[12],t[i+13]=n[13],t[i+14]=n[14],t[i+15]=n[15],t}}const _p=new te,_a=new Nt,vne=new te(0,0,0),yne=new te(1,1,1),Cu=new te,Qw=new te,$s=new te,Mk=new Nt,Ek=new yr;class Wf{constructor(t=0,i=0,n=0,r=Wf.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,n,r=this._order){return this._x=t,this._y=i,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,n=!0){const r=t.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],h=r[9],u=r[2],d=r[6],f=r[10];switch(i){case"XYZ":this._y=Math.asin(Tn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Tn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,s),this._z=0);break;case"ZXY":this._x=Math.asin(Tn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Tn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(Tn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-Tn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-h,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,i,n){return Mk.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Mk,i,n)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return Ek.setFromEuler(this),this.setFromQuaternion(Ek,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Wf.DEFAULT_ORDER="XYZ";class vf{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let xne=0;const Ck=new te,bp=new yr,fc=new Nt,Jw=new te,qv=new te,wne=new te,_ne=new yr,Tk=new te(1,0,0),Pk=new te(0,1,0),Dk=new te(0,0,1),bne={type:"added"},Bk={type:"removed"};class fi extends ec{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:xne++}),this.uuid=vo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=fi.DEFAULT_UP.clone();const t=new te,i=new Wf,n=new yr,r=new te(1,1,1);function s(){n.setFromEuler(i,!1)}function o(){i.setFromQuaternion(n,void 0,!1)}i._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Nt},normalMatrix:{value:new hs}}),this.matrix=new Nt,this.matrixWorld=new Nt,this.matrixAutoUpdate=fi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=fi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new vf,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return bp.setFromAxisAngle(t,i),this.quaternion.multiply(bp),this}rotateOnWorldAxis(t,i){return bp.setFromAxisAngle(t,i),this.quaternion.premultiply(bp),this}rotateX(t){return this.rotateOnAxis(Tk,t)}rotateY(t){return this.rotateOnAxis(Pk,t)}rotateZ(t){return this.rotateOnAxis(Dk,t)}translateOnAxis(t,i){return Ck.copy(t).applyQuaternion(this.quaternion),this.position.add(Ck.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(Tk,t)}translateY(t){return this.translateOnAxis(Pk,t)}translateZ(t){return this.translateOnAxis(Dk,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(fc.copy(this.matrixWorld).invert())}lookAt(t,i,n){t.isVector3?Jw.copy(t):Jw.set(t,i,n);const r=this.parent;this.updateWorldMatrix(!0,!1),qv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fc.lookAt(qv,Jw,this.up):fc.lookAt(Jw,qv,this.up),this.quaternion.setFromRotationMatrix(fc),r&&(fc.extractRotation(r.matrixWorld),bp.setFromRotationMatrix(fc),this.quaternion.premultiply(bp.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(bne)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(t);return i!==-1&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(Bk)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.parent=null,i.dispatchEvent(Bk)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),fc.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),fc.multiply(t.parent.matrixWorld)),t.applyMatrix4(fc),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(t,i);if(o!==void 0)return o}}getObjectsByProperty(t,i){let n=[];this[t]===i&&n.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(t,i);o.length>0&&(n=n.concat(o))}return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(qv,t,wne),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(qv,_ne,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverseVisible(t)}traverseAncestors(t){const i=this.parent;i!==null&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let n=0,r=i.length;n<r;n++){const s=i[n];(s.matrixWorldAutoUpdate===!0||t===!0)&&s.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const n=this.parent;if(t===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=t===void 0||typeof t=="string",n={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(t.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,h=l.length;c<h;c++){const u=l[c];s(t.shapes,u)}else s(t.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(t.materials,this.material[l]));r.material=a}else r.material=s(t.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(t.animations,l))}}if(i){const a=o(t.geometries),l=o(t.materials),c=o(t.textures),h=o(t.images),u=o(t.shapes),d=o(t.skeletons),f=o(t.animations),p=o(t.nodes);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),h.length>0&&(n.images=h),u.length>0&&(n.shapes=u),d.length>0&&(n.skeletons=d),f.length>0&&(n.animations=f),p.length>0&&(n.nodes=p)}return n.object=r,n;function o(a){const l=[];for(const c in a){const h=a[c];delete h.metadata,l.push(h)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),i===!0)for(let n=0;n<t.children.length;n++){const r=t.children[n];this.add(r.clone())}return this}}fi.DEFAULT_UP=new te(0,1,0);fi.DEFAULT_MATRIX_AUTO_UPDATE=!0;fi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ba=new te,pc=new te,oT=new te,mc=new te,Ap=new te,Sp=new te,Lk=new te,aT=new te,lT=new te,cT=new te;class Ko{constructor(t=new te,i=new te,n=new te){this.a=t,this.b=i,this.c=n}static getNormal(t,i,n,r){r.subVectors(n,i),ba.subVectors(t,i),r.cross(ba);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(t,i,n,r,s){ba.subVectors(r,i),pc.subVectors(n,i),oT.subVectors(t,i);const o=ba.dot(ba),a=ba.dot(pc),l=ba.dot(oT),c=pc.dot(pc),h=pc.dot(oT),u=o*c-a*a;if(u===0)return s.set(-2,-1,-1);const d=1/u,f=(c*l-a*h)*d,p=(o*h-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(t,i,n,r){return this.getBarycoord(t,i,n,r,mc),mc.x>=0&&mc.y>=0&&mc.x+mc.y<=1}static getUV(t,i,n,r,s,o,a,l){return this.getBarycoord(t,i,n,r,mc),l.set(0,0),l.addScaledVector(s,mc.x),l.addScaledVector(o,mc.y),l.addScaledVector(a,mc.z),l}static isFrontFacing(t,i,n,r){return ba.subVectors(n,i),pc.subVectors(t,i),ba.cross(pc).dot(r)<0}set(t,i,n){return this.a.copy(t),this.b.copy(i),this.c.copy(n),this}setFromPointsAndIndices(t,i,n,r){return this.a.copy(t[i]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,i,n,r){return this.a.fromBufferAttribute(t,i),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return ba.subVectors(this.c,this.b),pc.subVectors(this.a,this.b),ba.cross(pc).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Ko.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,i){return Ko.getBarycoord(t,this.a,this.b,this.c,i)}getUV(t,i,n,r,s){return Ko.getUV(t,this.a,this.b,this.c,i,n,r,s)}containsPoint(t){return Ko.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Ko.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,i){const n=this.a,r=this.b,s=this.c;let o,a;Ap.subVectors(r,n),Sp.subVectors(s,n),aT.subVectors(t,n);const l=Ap.dot(aT),c=Sp.dot(aT);if(l<=0&&c<=0)return i.copy(n);lT.subVectors(t,r);const h=Ap.dot(lT),u=Sp.dot(lT);if(h>=0&&u<=h)return i.copy(r);const d=l*u-h*c;if(d<=0&&l>=0&&h<=0)return o=l/(l-h),i.copy(n).addScaledVector(Ap,o);cT.subVectors(t,s);const f=Ap.dot(cT),p=Sp.dot(cT);if(p>=0&&f<=p)return i.copy(s);const g=f*c-l*p;if(g<=0&&c>=0&&p<=0)return a=c/(c-p),i.copy(n).addScaledVector(Sp,a);const m=h*p-f*u;if(m<=0&&u-h>=0&&f-p>=0)return Lk.subVectors(s,r),a=(u-h)/(u-h+(f-p)),i.copy(r).addScaledVector(Lk,a);const v=1/(m+g+d);return o=g*v,a=d*v,i.copy(n).addScaledVector(Ap,o).addScaledVector(Sp,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let Ane=0;class Gn extends ec{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Ane++}),this.uuid=vo(),this.name="",this.type="Material",this.blending=df,this.side=Xl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=TR,this.blendDst=PR,this.blendEquation=Hd,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=QA,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=u7,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=lA,this.stencilZFail=lA,this.stencilZPass=lA,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const i in t){const n=t[i];if(n===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}const r=this[i];if(r===void 0){console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.");continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[i]=n}}toJSON(t){const i=t===void 0||typeof t=="string";i&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==df&&(n.blending=this.blending),this.side!==Xl&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i){const s=r(t.textures),o=r(t.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const i=t.clippingPlanes;let n=null;if(i!==null){const r=i.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=i[s].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}class co extends Gn{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ct(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Xx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const In=new te,Kw=new Ve;class wi{constructor(t,i,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=i,this.count=t!==void 0?t.length/i:0,this.normalized=n,this.usage=sx,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,i,n){t*=this.itemSize,n*=i.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[t+r]=i.array[n+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let i=0,n=this.count;i<n;i++)Kw.fromBufferAttribute(this,i),Kw.applyMatrix3(t),this.setXY(i,Kw.x,Kw.y);else if(this.itemSize===3)for(let i=0,n=this.count;i<n;i++)In.fromBufferAttribute(this,i),In.applyMatrix3(t),this.setXYZ(i,In.x,In.y,In.z);return this}applyMatrix4(t){for(let i=0,n=this.count;i<n;i++)In.fromBufferAttribute(this,i),In.applyMatrix4(t),this.setXYZ(i,In.x,In.y,In.z);return this}applyNormalMatrix(t){for(let i=0,n=this.count;i<n;i++)In.fromBufferAttribute(this,i),In.applyNormalMatrix(t),this.setXYZ(i,In.x,In.y,In.z);return this}transformDirection(t){for(let i=0,n=this.count;i<n;i++)In.fromBufferAttribute(this,i),In.transformDirection(t),this.setXYZ(i,In.x,In.y,In.z);return this}set(t,i=0){return this.array.set(t,i),this}getX(t){let i=this.array[t*this.itemSize];return this.normalized&&(i=Hc(i,this.array)),i}setX(t,i){return this.normalized&&(i=Ni(i,this.array)),this.array[t*this.itemSize]=i,this}getY(t){let i=this.array[t*this.itemSize+1];return this.normalized&&(i=Hc(i,this.array)),i}setY(t,i){return this.normalized&&(i=Ni(i,this.array)),this.array[t*this.itemSize+1]=i,this}getZ(t){let i=this.array[t*this.itemSize+2];return this.normalized&&(i=Hc(i,this.array)),i}setZ(t,i){return this.normalized&&(i=Ni(i,this.array)),this.array[t*this.itemSize+2]=i,this}getW(t){let i=this.array[t*this.itemSize+3];return this.normalized&&(i=Hc(i,this.array)),i}setW(t,i){return this.normalized&&(i=Ni(i,this.array)),this.array[t*this.itemSize+3]=i,this}setXY(t,i,n){return t*=this.itemSize,this.normalized&&(i=Ni(i,this.array),n=Ni(n,this.array)),this.array[t+0]=i,this.array[t+1]=n,this}setXYZ(t,i,n,r){return t*=this.itemSize,this.normalized&&(i=Ni(i,this.array),n=Ni(n,this.array),r=Ni(r,this.array)),this.array[t+0]=i,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,i,n,r,s){return t*=this.itemSize,this.normalized&&(i=Ni(i,this.array),n=Ni(n,this.array),r=Ni(r,this.array),s=Ni(s,this.array)),this.array[t+0]=i,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==sx&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Sne extends wi{constructor(t,i,n){super(new Int8Array(t),i,n)}}class Mne extends wi{constructor(t,i,n){super(new Uint8Array(t),i,n)}}class Ene extends wi{constructor(t,i,n){super(new Uint8ClampedArray(t),i,n)}}class Cne extends wi{constructor(t,i,n){super(new Int16Array(t),i,n)}}class zR extends wi{constructor(t,i,n){super(new Uint16Array(t),i,n)}}class Tne extends wi{constructor(t,i,n){super(new Int32Array(t),i,n)}}class kR extends wi{constructor(t,i,n){super(new Uint32Array(t),i,n)}}class Pne extends wi{constructor(t,i,n){super(new Uint16Array(t),i,n),this.isFloat16BufferAttribute=!0}}class wt extends wi{constructor(t,i,n){super(new Float32Array(t),i,n)}}class Dne extends wi{constructor(t,i,n){super(new Float64Array(t),i,n)}}let Bne=0;const Ro=new Nt,uT=new fi,Mp=new te,eo=new Xh,Qv=new Xh,dr=new te;class Qt extends ec{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Bne++}),this.uuid=vo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(d7(t)?kR:zR)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,i){return this.attributes[t]=i,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,i,n=0){this.groups.push({start:t,count:i,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,i){this.drawRange.start=t,this.drawRange.count=i}applyMatrix4(t){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(t),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new hs().getNormalMatrix(t);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return Ro.makeRotationFromQuaternion(t),this.applyMatrix4(Ro),this}rotateX(t){return Ro.makeRotationX(t),this.applyMatrix4(Ro),this}rotateY(t){return Ro.makeRotationY(t),this.applyMatrix4(Ro),this}rotateZ(t){return Ro.makeRotationZ(t),this.applyMatrix4(Ro),this}translate(t,i,n){return Ro.makeTranslation(t,i,n),this.applyMatrix4(Ro),this}scale(t,i,n){return Ro.makeScale(t,i,n),this.applyMatrix4(Ro),this}lookAt(t){return uT.lookAt(t),uT.updateMatrix(),this.applyMatrix4(uT.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Mp).negate(),this.translate(Mp.x,Mp.y,Mp.z),this}setFromPoints(t){const i=[];for(let n=0,r=t.length;n<r;n++){const s=t[n];i.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new wt(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Xh);const t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new te(-1/0,-1/0,-1/0),new te(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),i)for(let n=0,r=i.length;n<r;n++){const s=i[n];eo.setFromBufferAttribute(s),this.morphTargetsRelative?(dr.addVectors(this.boundingBox.min,eo.min),this.boundingBox.expandByPoint(dr),dr.addVectors(this.boundingBox.max,eo.max),this.boundingBox.expandByPoint(dr)):(this.boundingBox.expandByPoint(eo.min),this.boundingBox.expandByPoint(eo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Yh);const t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new te,1/0);return}if(t){const n=this.boundingSphere.center;if(eo.setFromBufferAttribute(t),i)for(let s=0,o=i.length;s<o;s++){const a=i[s];Qv.setFromBufferAttribute(a),this.morphTargetsRelative?(dr.addVectors(eo.min,Qv.min),eo.expandByPoint(dr),dr.addVectors(eo.max,Qv.max),eo.expandByPoint(dr)):(eo.expandByPoint(Qv.min),eo.expandByPoint(Qv.max))}eo.getCenter(n);let r=0;for(let s=0,o=t.count;s<o;s++)dr.fromBufferAttribute(t,s),r=Math.max(r,n.distanceToSquared(dr));if(i)for(let s=0,o=i.length;s<o;s++){const a=i[s],l=this.morphTargetsRelative;for(let c=0,h=a.count;c<h;c++)dr.fromBufferAttribute(a,c),l&&(Mp.fromBufferAttribute(t,c),dr.add(Mp)),r=Math.max(r,n.distanceToSquared(dr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,i=this.attributes;if(t===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.array,r=i.position.array,s=i.normal.array,o=i.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new wi(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],h=[];for(let P=0;P<a;P++)c[P]=new te,h[P]=new te;const u=new te,d=new te,f=new te,p=new Ve,g=new Ve,m=new Ve,v=new te,x=new te;function w(P,B,k){u.fromArray(r,P*3),d.fromArray(r,B*3),f.fromArray(r,k*3),p.fromArray(o,P*2),g.fromArray(o,B*2),m.fromArray(o,k*2),d.sub(u),f.sub(u),g.sub(p),m.sub(p);const z=1/(g.x*m.y-m.x*g.y);isFinite(z)&&(v.copy(d).multiplyScalar(m.y).addScaledVector(f,-g.y).multiplyScalar(z),x.copy(f).multiplyScalar(g.x).addScaledVector(d,-m.x).multiplyScalar(z),c[P].add(v),c[B].add(v),c[k].add(v),h[P].add(x),h[B].add(x),h[k].add(x))}let b=this.groups;b.length===0&&(b=[{start:0,count:n.length}]);for(let P=0,B=b.length;P<B;++P){const k=b[P],z=k.start,F=k.count;for(let W=z,K=z+F;W<K;W+=3)w(n[W+0],n[W+1],n[W+2])}const M=new te,A=new te,T=new te,S=new te;function C(P){T.fromArray(s,P*3),S.copy(T);const B=c[P];M.copy(B),M.sub(T.multiplyScalar(T.dot(B))).normalize(),A.crossVectors(S,B);const z=A.dot(h[P])<0?-1:1;l[P*4]=M.x,l[P*4+1]=M.y,l[P*4+2]=M.z,l[P*4+3]=z}for(let P=0,B=b.length;P<B;++P){const k=b[P],z=k.start,F=k.count;for(let W=z,K=z+F;W<K;W+=3)C(n[W+0]),C(n[W+1]),C(n[W+2])}}computeVertexNormals(){const t=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new wi(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let d=0,f=n.count;d<f;d++)n.setXYZ(d,0,0,0);const r=new te,s=new te,o=new te,a=new te,l=new te,c=new te,h=new te,u=new te;if(t)for(let d=0,f=t.count;d<f;d+=3){const p=t.getX(d+0),g=t.getX(d+1),m=t.getX(d+2);r.fromBufferAttribute(i,p),s.fromBufferAttribute(i,g),o.fromBufferAttribute(i,m),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,g),c.fromBufferAttribute(n,m),a.add(h),l.add(h),c.add(h),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(g,l.x,l.y,l.z),n.setXYZ(m,c.x,c.y,c.z)}else for(let d=0,f=i.count;d<f;d+=3)r.fromBufferAttribute(i,d+0),s.fromBufferAttribute(i,d+1),o.fromBufferAttribute(i,d+2),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),n.setXYZ(d+0,h.x,h.y,h.z),n.setXYZ(d+1,h.x,h.y,h.z),n.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const t=this.attributes.normal;for(let i=0,n=t.count;i<n;i++)dr.fromBufferAttribute(t,i),dr.normalize(),t.setXYZ(i,dr.x,dr.y,dr.z)}toNonIndexed(){function t(a,l){const c=a.array,h=a.itemSize,u=a.normalized,d=new c.constructor(l.length*h);let f=0,p=0;for(let g=0,m=l.length;g<m;g++){a.isInterleavedBufferAttribute?f=l[g]*a.data.stride+a.offset:f=l[g]*h;for(let v=0;v<h;v++)d[p++]=c[f++]}return new wi(d,h,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new Qt,n=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=t(l,n);i.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let h=0,u=c.length;h<u;h++){const d=c[h],f=t(d,n);l.push(f)}i.morphAttributes[a]=l}i.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];i.addGroup(c.start,c.count,c.materialIndex)}return i}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(t[c]=l[c]);return t}t.data={attributes:{}};const i=this.index;i!==null&&(t.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const l in n){const c=n[l];t.data.attributes[l]=c.toJSON(t.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],h=[];for(let u=0,d=c.length;u<d;u++){const f=c[u];h.push(f.toJSON(t.data))}h.length>0&&(r[l]=h,s=!0)}s&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(i));const r=t.attributes;for(const c in r){const h=r[c];this.setAttribute(c,h.clone(i))}const s=t.morphAttributes;for(const c in s){const h=[],u=s[c];for(let d=0,f=u.length;d<f;d++)h.push(u[d].clone(i));this.morphAttributes[c]=h}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let c=0,h=o.length;c<h;c++){const u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}const a=t.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,t.parameters!==void 0&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const Rk=new Nt,Ep=new Yx,hT=new Yh,Jv=new te,Kv=new te,Zv=new te,dT=new te,Zw=new te,$w=new Ve,e_=new Ve,t_=new Ve,fT=new te,i_=new te;class $n extends fi{constructor(t=new Qt,i=new co){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t,i){return super.copy(t,i),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(t,i){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;i.fromBufferAttribute(r,t);const a=this.morphTargetInfluences;if(s&&a){Zw.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const h=a[l],u=s[l];h!==0&&(dT.fromBufferAttribute(u,t),o?Zw.addScaledVector(dT,h):Zw.addScaledVector(dT.sub(i),h))}i.add(Zw)}return this.isSkinnedMesh&&this.boneTransform(t,i),i}raycast(t,i){const n=this.geometry,r=this.material,s=this.matrixWorld;if(r===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),hT.copy(n.boundingSphere),hT.applyMatrix4(s),t.ray.intersectsSphere(hT)===!1)||(Rk.copy(s).invert(),Ep.copy(t.ray).applyMatrix4(Rk),n.boundingBox!==null&&Ep.intersectsBox(n.boundingBox)===!1))return;let o;const a=n.index,l=n.attributes.position,c=n.attributes.uv,h=n.attributes.uv2,u=n.groups,d=n.drawRange;if(a!==null)if(Array.isArray(r))for(let f=0,p=u.length;f<p;f++){const g=u[f],m=r[g.materialIndex],v=Math.max(g.start,d.start),x=Math.min(a.count,Math.min(g.start+g.count,d.start+d.count));for(let w=v,b=x;w<b;w+=3){const M=a.getX(w),A=a.getX(w+1),T=a.getX(w+2);o=n_(this,m,t,Ep,c,h,M,A,T),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=g.materialIndex,i.push(o))}}else{const f=Math.max(0,d.start),p=Math.min(a.count,d.start+d.count);for(let g=f,m=p;g<m;g+=3){const v=a.getX(g),x=a.getX(g+1),w=a.getX(g+2);o=n_(this,r,t,Ep,c,h,v,x,w),o&&(o.faceIndex=Math.floor(g/3),i.push(o))}}else if(l!==void 0)if(Array.isArray(r))for(let f=0,p=u.length;f<p;f++){const g=u[f],m=r[g.materialIndex],v=Math.max(g.start,d.start),x=Math.min(l.count,Math.min(g.start+g.count,d.start+d.count));for(let w=v,b=x;w<b;w+=3){const M=w,A=w+1,T=w+2;o=n_(this,m,t,Ep,c,h,M,A,T),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=g.materialIndex,i.push(o))}}else{const f=Math.max(0,d.start),p=Math.min(l.count,d.start+d.count);for(let g=f,m=p;g<m;g+=3){const v=g,x=g+1,w=g+2;o=n_(this,r,t,Ep,c,h,v,x,w),o&&(o.faceIndex=Math.floor(g/3),i.push(o))}}}}function Lne(e,t,i,n,r,s,o,a){let l;if(t.side===Vs?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,t.side===Xl,a),l===null)return null;i_.copy(a),i_.applyMatrix4(e.matrixWorld);const c=i.ray.origin.distanceTo(i_);return c<i.near||c>i.far?null:{distance:c,point:i_.clone(),object:e}}function n_(e,t,i,n,r,s,o,a,l){e.getVertexPosition(o,Jv),e.getVertexPosition(a,Kv),e.getVertexPosition(l,Zv);const c=Lne(e,t,i,n,Jv,Kv,Zv,fT);if(c){r&&($w.fromBufferAttribute(r,o),e_.fromBufferAttribute(r,a),t_.fromBufferAttribute(r,l),c.uv=Ko.getUV(fT,Jv,Kv,Zv,$w,e_,t_,new Ve)),s&&($w.fromBufferAttribute(s,o),e_.fromBufferAttribute(s,a),t_.fromBufferAttribute(s,l),c.uv2=Ko.getUV(fT,Jv,Kv,Zv,$w,e_,t_,new Ve));const h={a:o,b:a,c:l,normal:new te,materialIndex:0};Ko.getNormal(Jv,Kv,Zv,h.normal),c.face=h}return c}class qh extends Qt{constructor(t=1,i=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:i,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],h=[],u=[];let d=0,f=0;p("z","y","x",-1,-1,n,i,t,o,s,0),p("z","y","x",1,-1,n,i,-t,o,s,1),p("x","z","y",1,1,t,n,i,r,o,2),p("x","z","y",1,-1,t,n,-i,r,o,3),p("x","y","z",1,-1,t,i,n,r,s,4),p("x","y","z",-1,-1,t,i,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new wt(c,3)),this.setAttribute("normal",new wt(h,3)),this.setAttribute("uv",new wt(u,2));function p(g,m,v,x,w,b,M,A,T,S,C){const P=b/T,B=M/S,k=b/2,z=M/2,F=A/2,W=T+1,K=S+1;let Z=0,U=0;const X=new te;for(let V=0;V<K;V++){const q=V*B-z;for(let H=0;H<W;H++){const Q=H*P-k;X[g]=Q*x,X[m]=q*w,X[v]=F,c.push(X.x,X.y,X.z),X[g]=0,X[m]=0,X[v]=A>0?1:-1,h.push(X.x,X.y,X.z),u.push(H/T),u.push(1-V/S),Z+=1}}for(let V=0;V<S;V++)for(let q=0;q<T;q++){const H=d+q+W*V,Q=d+q+W*(V+1),J=d+(q+1)+W*(V+1),le=d+(q+1)+W*V;l.push(H,Q,le),l.push(Q,J,le),U+=6}a.addGroup(f,U,C),f+=U,d+=Z}}static fromJSON(t){return new qh(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Eg(e){const t={};for(const i in e){t[i]={};for(const n in e[i]){const r=e[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[i][n]=r.clone():Array.isArray(r)?t[i][n]=r.slice():t[i][n]=r}}return t}function ss(e){const t={};for(let i=0;i<e.length;i++){const n=Eg(e[i]);for(const r in n)t[r]=n[r]}return t}function Rne(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].clone());return t}function p7(e){return e.getRenderTarget()===null&&e.outputEncoding===Gi?Ia:Mg}const m7={clone:Eg,merge:ss};var Ine=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,One=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ql extends Gn{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Ine,this.fragmentShader=One,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Eg(t.uniforms),this.uniformsGroups=Rne(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const i=super.toJSON(t);i.glslVersion=this.glslVersion,i.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?i.uniforms[r]={type:"t",value:o.toJSON(t).uuid}:o&&o.isColor?i.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?i.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?i.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?i.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?i.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?i.uniforms[r]={type:"m4",value:o.toArray()}:i.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(i.extensions=n),i}}class qx extends fi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Nt,this.projectionMatrix=new Nt,this.projectionMatrixInverse=new Nt}copy(t,i){return super.copy(t,i),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(-i[8],-i[9],-i[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,i){super.updateWorldMatrix(t,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class $i extends qx{constructor(t=50,i=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,i){return super.copy(t,i),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const i=.5*this.getFilmHeight()/t;this.fov=ox*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(mf*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return ox*2*Math.atan(Math.tan(mf*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,i,n,r,s,o){this.aspect=t/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let i=t*Math.tan(mf*.5*this.fov)/this.zoom,n=2*i,r=this.aspect*n,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,i-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;a!==0&&(s+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,i,i-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const i=super.toJSON(t);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const Cp=-90,Tp=1;class UR extends fi{constructor(t,i,n){super(),this.type="CubeCamera",this.renderTarget=n;const r=new $i(Cp,Tp,t,i);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new $i(Cp,Tp,t,i);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new $i(Cp,Tp,t,i);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new $i(Cp,Tp,t,i);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new $i(Cp,Tp,t,i);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const c=new $i(Cp,Tp,t,i);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,-1),this.add(c)}update(t,i){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,o,a,l,c]=this.children,h=t.getRenderTarget(),u=t.toneMapping,d=t.xr.enabled;t.toneMapping=Xa,t.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(i,r),t.setRenderTarget(n,1),t.render(i,s),t.setRenderTarget(n,2),t.render(i,o),t.setRenderTarget(n,3),t.render(i,a),t.setRenderTarget(n,4),t.render(i,l),n.texture.generateMipmaps=f,t.setRenderTarget(n,5),t.render(i,c),t.setRenderTarget(h),t.toneMapping=u,t.xr.enabled=d,n.texture.needsPMREMUpdate=!0}}class Qx extends en{constructor(t,i,n,r,s,o,a,l,c,h){t=t!==void 0?t:[],i=i!==void 0?i:Bh,super(t,i,n,r,s,o,a,l,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class GR extends Ja{constructor(t=1,i={}){super(t,t,i),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},r=[n,n,n,n,n,n];this.texture=new Qx(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:rn}fromEquirectangularTexture(t,i){this.texture.type=i.type,this.texture.encoding=i.encoding,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new qh(5,5,5),s=new ql({name:"CubemapFromEquirect",uniforms:Eg(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Vs,blending:Qc});s.uniforms.tEquirect.value=i;const o=new $n(r,s),a=i.minFilter;return i.minFilter===Yl&&(i.minFilter=rn),new UR(1,10,this).update(t,o),i.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(t,i,n,r){const s=t.getRenderTarget();for(let o=0;o<6;o++)t.setRenderTarget(this,o),t.clear(i,n,r);t.setRenderTarget(s)}}const pT=new te,Fne=new te,Nne=new hs;class Qu{constructor(t=new te(1,0,0),i=0){this.isPlane=!0,this.normal=t,this.constant=i}set(t,i){return this.normal.copy(t),this.constant=i,this}setComponents(t,i,n,r){return this.normal.set(t,i,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,i){return this.normal.copy(t),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(t,i,n){const r=pT.subVectors(n,i).cross(Fne.subVectors(t,i)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,i){return i.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,i){const n=t.delta(pT),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(t.start)===0?i.copy(t.start):null;const s=-(t.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:i.copy(n).multiplyScalar(s).add(t.start)}intersectsLine(t){const i=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return i<0&&n>0||n<0&&i>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,i){const n=i||Nne.getNormalMatrix(t),r=this.coplanarPoint(pT).applyMatrix4(t),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Pp=new Yh,r_=new te;class CM{constructor(t=new Qu,i=new Qu,n=new Qu,r=new Qu,s=new Qu,o=new Qu){this.planes=[t,i,n,r,s,o]}set(t,i,n,r,s,o){const a=this.planes;return a[0].copy(t),a[1].copy(i),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(t){const i=this.planes;for(let n=0;n<6;n++)i[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const i=this.planes,n=t.elements,r=n[0],s=n[1],o=n[2],a=n[3],l=n[4],c=n[5],h=n[6],u=n[7],d=n[8],f=n[9],p=n[10],g=n[11],m=n[12],v=n[13],x=n[14],w=n[15];return i[0].setComponents(a-r,u-l,g-d,w-m).normalize(),i[1].setComponents(a+r,u+l,g+d,w+m).normalize(),i[2].setComponents(a+s,u+c,g+f,w+v).normalize(),i[3].setComponents(a-s,u-c,g-f,w-v).normalize(),i[4].setComponents(a-o,u-h,g-p,w-x).normalize(),i[5].setComponents(a+o,u+h,g+p,w+x).normalize(),this}intersectsObject(t){const i=t.geometry;return i.boundingSphere===null&&i.computeBoundingSphere(),Pp.copy(i.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Pp)}intersectsSprite(t){return Pp.center.set(0,0,0),Pp.radius=.7071067811865476,Pp.applyMatrix4(t.matrixWorld),this.intersectsSphere(Pp)}intersectsSphere(t){const i=this.planes,n=t.center,r=-t.radius;for(let s=0;s<6;s++)if(i[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(t){const i=this.planes;for(let n=0;n<6;n++){const r=i[n];if(r_.x=r.normal.x>0?t.max.x:t.min.x,r_.y=r.normal.y>0?t.max.y:t.min.y,r_.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(r_)<0)return!1}return!0}containsPoint(t){const i=this.planes;for(let n=0;n<6;n++)if(i[n].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function g7(){let e=null,t=!1,i=null,n=null;function r(s,o){i(s,o),n=e.requestAnimationFrame(r)}return{start:function(){t!==!0&&i!==null&&(n=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(s){i=s},setContext:function(s){e=s}}}function zne(e,t){const i=t.isWebGL2,n=new WeakMap;function r(c,h){const u=c.array,d=c.usage,f=e.createBuffer();e.bindBuffer(h,f),e.bufferData(h,u,d),c.onUploadCallback();let p;if(u instanceof Float32Array)p=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(i)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(u instanceof Int16Array)p=5122;else if(u instanceof Uint32Array)p=5125;else if(u instanceof Int32Array)p=5124;else if(u instanceof Int8Array)p=5120;else if(u instanceof Uint8Array)p=5121;else if(u instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,h,u){const d=h.array,f=h.updateRange;e.bindBuffer(u,c),f.count===-1?e.bufferSubData(u,0,d):(i?e.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):e.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),h.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const h=n.get(c);h&&(e.deleteBuffer(h.buffer),n.delete(c))}function l(c,h){if(c.isGLBufferAttribute){const d=n.get(c);(!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const u=n.get(c);u===void 0?n.set(c,r(c,h)):u.version<c.version&&(s(u.buffer,c,h),u.version=c.version)}return{get:o,remove:a,update:l}}class Kg extends Qt{constructor(t=1,i=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:i,widthSegments:n,heightSegments:r};const s=t/2,o=i/2,a=Math.floor(n),l=Math.floor(r),c=a+1,h=l+1,u=t/a,d=i/l,f=[],p=[],g=[],m=[];for(let v=0;v<h;v++){const x=v*d-o;for(let w=0;w<c;w++){const b=w*u-s;p.push(b,-x,0),g.push(0,0,1),m.push(w/a),m.push(1-v/l)}}for(let v=0;v<l;v++)for(let x=0;x<a;x++){const w=x+c*v,b=x+c*(v+1),M=x+1+c*(v+1),A=x+1+c*v;f.push(w,b,A),f.push(b,M,A)}this.setIndex(f),this.setAttribute("position",new wt(p,3)),this.setAttribute("normal",new wt(g,3)),this.setAttribute("uv",new wt(m,2))}static fromJSON(t){return new Kg(t.width,t.height,t.widthSegments,t.heightSegments)}}var kne=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Une=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Gne=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Hne=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Vne=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,jne=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Wne="vec3 transformed = vec3( position );",Xne=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Yne=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,qne=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Qne=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Jne=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Kne=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Zne=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,$ne=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,ere=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,tre=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,ire=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,nre=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,rre=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,sre=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,ore=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,are=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,lre=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,cre=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,ure=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,hre="gl_FragColor = linearToOutputTexel( gl_FragColor );",dre=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,fre=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,pre=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,mre=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,gre=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,vre=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,yre=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,xre=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,wre=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,_re=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,bre=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Are=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Sre=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Mre=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Ere=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Cre=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Tre=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,Pre=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Dre=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Bre=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Lre=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Rre=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,Ire=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Ore=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Fre=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Nre=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,zre=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,kre=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Ure=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Gre=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Hre=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Vre=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,jre=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Wre=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Xre=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Yre=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,qre=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Qre=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Jre=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Kre=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Zre=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,$re=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,ese=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,tse=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,ise=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,nse=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,rse=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,sse=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,ose=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,ase=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,lse=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,cse=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,use=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,hse=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dse=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,fse=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,pse=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,mse=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,gse=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,vse=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,yse=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,xse=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,wse=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,_se=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,bse=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Ase=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Sse=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Mse=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Ese=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Cse=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Tse=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,Pse=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,Dse=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,Bse=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,Lse=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Rse=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Ise=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,Ose=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Fse=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Nse=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,zse=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,kse=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Use=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Gse=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Hse=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Vse=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,jse=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Wse=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Xse=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Yse=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,qse=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Qse=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Jse=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Kse=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Zse=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$se=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,eoe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,toe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,ioe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,noe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,roe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,soe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ooe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,aoe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,loe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,coe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,uoe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hoe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,doe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,foe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,poe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,moe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,goe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ii={alphamap_fragment:kne,alphamap_pars_fragment:Une,alphatest_fragment:Gne,alphatest_pars_fragment:Hne,aomap_fragment:Vne,aomap_pars_fragment:jne,begin_vertex:Wne,beginnormal_vertex:Xne,bsdfs:Yne,iridescence_fragment:qne,bumpmap_pars_fragment:Qne,clipping_planes_fragment:Jne,clipping_planes_pars_fragment:Kne,clipping_planes_pars_vertex:Zne,clipping_planes_vertex:$ne,color_fragment:ere,color_pars_fragment:tre,color_pars_vertex:ire,color_vertex:nre,common:rre,cube_uv_reflection_fragment:sre,defaultnormal_vertex:ore,displacementmap_pars_vertex:are,displacementmap_vertex:lre,emissivemap_fragment:cre,emissivemap_pars_fragment:ure,encodings_fragment:hre,encodings_pars_fragment:dre,envmap_fragment:fre,envmap_common_pars_fragment:pre,envmap_pars_fragment:mre,envmap_pars_vertex:gre,envmap_physical_pars_fragment:Tre,envmap_vertex:vre,fog_vertex:yre,fog_pars_vertex:xre,fog_fragment:wre,fog_pars_fragment:_re,gradientmap_pars_fragment:bre,lightmap_fragment:Are,lightmap_pars_fragment:Sre,lights_lambert_fragment:Mre,lights_lambert_pars_fragment:Ere,lights_pars_begin:Cre,lights_toon_fragment:Pre,lights_toon_pars_fragment:Dre,lights_phong_fragment:Bre,lights_phong_pars_fragment:Lre,lights_physical_fragment:Rre,lights_physical_pars_fragment:Ire,lights_fragment_begin:Ore,lights_fragment_maps:Fre,lights_fragment_end:Nre,logdepthbuf_fragment:zre,logdepthbuf_pars_fragment:kre,logdepthbuf_pars_vertex:Ure,logdepthbuf_vertex:Gre,map_fragment:Hre,map_pars_fragment:Vre,map_particle_fragment:jre,map_particle_pars_fragment:Wre,metalnessmap_fragment:Xre,metalnessmap_pars_fragment:Yre,morphcolor_vertex:qre,morphnormal_vertex:Qre,morphtarget_pars_vertex:Jre,morphtarget_vertex:Kre,normal_fragment_begin:Zre,normal_fragment_maps:$re,normal_pars_fragment:ese,normal_pars_vertex:tse,normal_vertex:ise,normalmap_pars_fragment:nse,clearcoat_normal_fragment_begin:rse,clearcoat_normal_fragment_maps:sse,clearcoat_pars_fragment:ose,iridescence_pars_fragment:ase,output_fragment:lse,packing:cse,premultiplied_alpha_fragment:use,project_vertex:hse,dithering_fragment:dse,dithering_pars_fragment:fse,roughnessmap_fragment:pse,roughnessmap_pars_fragment:mse,shadowmap_pars_fragment:gse,shadowmap_pars_vertex:vse,shadowmap_vertex:yse,shadowmask_pars_fragment:xse,skinbase_vertex:wse,skinning_pars_vertex:_se,skinning_vertex:bse,skinnormal_vertex:Ase,specularmap_fragment:Sse,specularmap_pars_fragment:Mse,tonemapping_fragment:Ese,tonemapping_pars_fragment:Cse,transmission_fragment:Tse,transmission_pars_fragment:Pse,uv_pars_fragment:Dse,uv_pars_vertex:Bse,uv_vertex:Lse,uv2_pars_fragment:Rse,uv2_pars_vertex:Ise,uv2_vertex:Ose,worldpos_vertex:Fse,background_vert:Nse,background_frag:zse,backgroundCube_vert:kse,backgroundCube_frag:Use,cube_vert:Gse,cube_frag:Hse,depth_vert:Vse,depth_frag:jse,distanceRGBA_vert:Wse,distanceRGBA_frag:Xse,equirect_vert:Yse,equirect_frag:qse,linedashed_vert:Qse,linedashed_frag:Jse,meshbasic_vert:Kse,meshbasic_frag:Zse,meshlambert_vert:$se,meshlambert_frag:eoe,meshmatcap_vert:toe,meshmatcap_frag:ioe,meshnormal_vert:noe,meshnormal_frag:roe,meshphong_vert:soe,meshphong_frag:ooe,meshphysical_vert:aoe,meshphysical_frag:loe,meshtoon_vert:coe,meshtoon_frag:uoe,points_vert:hoe,points_frag:doe,shadow_vert:foe,shadow_frag:poe,sprite_vert:moe,sprite_frag:goe},rt={common:{diffuse:{value:new ct(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new hs},uv2Transform:{value:new hs},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ve(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ct(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ct(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new hs}},sprite:{diffuse:{value:new ct(16777215)},opacity:{value:1},center:{value:new Ve(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new hs}}},Fa={basic:{uniforms:ss([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.fog]),vertexShader:ii.meshbasic_vert,fragmentShader:ii.meshbasic_frag},lambert:{uniforms:ss([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,rt.lights,{emissive:{value:new ct(0)}}]),vertexShader:ii.meshlambert_vert,fragmentShader:ii.meshlambert_frag},phong:{uniforms:ss([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,rt.lights,{emissive:{value:new ct(0)},specular:{value:new ct(1118481)},shininess:{value:30}}]),vertexShader:ii.meshphong_vert,fragmentShader:ii.meshphong_frag},standard:{uniforms:ss([rt.common,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.roughnessmap,rt.metalnessmap,rt.fog,rt.lights,{emissive:{value:new ct(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ii.meshphysical_vert,fragmentShader:ii.meshphysical_frag},toon:{uniforms:ss([rt.common,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.gradientmap,rt.fog,rt.lights,{emissive:{value:new ct(0)}}]),vertexShader:ii.meshtoon_vert,fragmentShader:ii.meshtoon_frag},matcap:{uniforms:ss([rt.common,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,{matcap:{value:null}}]),vertexShader:ii.meshmatcap_vert,fragmentShader:ii.meshmatcap_frag},points:{uniforms:ss([rt.points,rt.fog]),vertexShader:ii.points_vert,fragmentShader:ii.points_frag},dashed:{uniforms:ss([rt.common,rt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ii.linedashed_vert,fragmentShader:ii.linedashed_frag},depth:{uniforms:ss([rt.common,rt.displacementmap]),vertexShader:ii.depth_vert,fragmentShader:ii.depth_frag},normal:{uniforms:ss([rt.common,rt.bumpmap,rt.normalmap,rt.displacementmap,{opacity:{value:1}}]),vertexShader:ii.meshnormal_vert,fragmentShader:ii.meshnormal_frag},sprite:{uniforms:ss([rt.sprite,rt.fog]),vertexShader:ii.sprite_vert,fragmentShader:ii.sprite_frag},background:{uniforms:{uvTransform:{value:new hs},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ii.background_vert,fragmentShader:ii.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ii.backgroundCube_vert,fragmentShader:ii.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ii.cube_vert,fragmentShader:ii.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ii.equirect_vert,fragmentShader:ii.equirect_frag},distanceRGBA:{uniforms:ss([rt.common,rt.displacementmap,{referencePosition:{value:new te},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ii.distanceRGBA_vert,fragmentShader:ii.distanceRGBA_frag},shadow:{uniforms:ss([rt.lights,rt.fog,{color:{value:new ct(0)},opacity:{value:1}}]),vertexShader:ii.shadow_vert,fragmentShader:ii.shadow_frag}};Fa.physical={uniforms:ss([Fa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Ve(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new ct(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Ve},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ct(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new ct(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ii.meshphysical_vert,fragmentShader:ii.meshphysical_frag};const s_={r:0,b:0,g:0};function voe(e,t,i,n,r,s,o){const a=new ct(0);let l=s===!0?0:1,c,h,u=null,d=0,f=null;function p(m,v){let x=!1,w=v.isScene===!0?v.background:null;w&&w.isTexture&&(w=(v.backgroundBlurriness>0?i:t).get(w));const b=e.xr,M=b.getSession&&b.getSession();M&&M.environmentBlendMode==="additive"&&(w=null),w===null?g(a,l):w&&w.isColor&&(g(w,1),x=!0),(e.autoClear||x)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),w&&(w.isCubeTexture||w.mapping===Jg)?(h===void 0&&(h=new $n(new qh(1,1,1),new ql({name:"BackgroundCubeMaterial",uniforms:Eg(Fa.backgroundCube.uniforms),vertexShader:Fa.backgroundCube.vertexShader,fragmentShader:Fa.backgroundCube.fragmentShader,side:Vs,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(A,T,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=w,h.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,h.material.toneMapped=w.encoding!==Gi,(u!==w||d!==w.version||f!==e.toneMapping)&&(h.material.needsUpdate=!0,u=w,d=w.version,f=e.toneMapping),h.layers.enableAll(),m.unshift(h,h.geometry,h.material,0,0,null)):w&&w.isTexture&&(c===void 0&&(c=new $n(new Kg(2,2),new ql({name:"BackgroundMaterial",uniforms:Eg(Fa.background.uniforms),vertexShader:Fa.background.vertexShader,fragmentShader:Fa.background.fragmentShader,side:Xl,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=w,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=w.encoding!==Gi,w.matrixAutoUpdate===!0&&w.updateMatrix(),c.material.uniforms.uvTransform.value.copy(w.matrix),(u!==w||d!==w.version||f!==e.toneMapping)&&(c.material.needsUpdate=!0,u=w,d=w.version,f=e.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null))}function g(m,v){m.getRGB(s_,p7(e)),n.buffers.color.setClear(s_.r,s_.g,s_.b,v,o)}return{getClearColor:function(){return a},setClearColor:function(m,v=1){a.set(m),l=v,g(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,g(a,l)},render:p}}function yoe(e,t,i,n){const r=e.getParameter(34921),s=n.isWebGL2?null:t.get("OES_vertex_array_object"),o=n.isWebGL2||s!==null,a={},l=m(null);let c=l,h=!1;function u(F,W,K,Z,U){let X=!1;if(o){const V=g(Z,K,W);c!==V&&(c=V,f(c.object)),X=v(F,Z,K,U),X&&x(F,Z,K,U)}else{const V=W.wireframe===!0;(c.geometry!==Z.id||c.program!==K.id||c.wireframe!==V)&&(c.geometry=Z.id,c.program=K.id,c.wireframe=V,X=!0)}U!==null&&i.update(U,34963),(X||h)&&(h=!1,S(F,W,K,Z),U!==null&&e.bindBuffer(34963,i.get(U).buffer))}function d(){return n.isWebGL2?e.createVertexArray():s.createVertexArrayOES()}function f(F){return n.isWebGL2?e.bindVertexArray(F):s.bindVertexArrayOES(F)}function p(F){return n.isWebGL2?e.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function g(F,W,K){const Z=K.wireframe===!0;let U=a[F.id];U===void 0&&(U={},a[F.id]=U);let X=U[W.id];X===void 0&&(X={},U[W.id]=X);let V=X[Z];return V===void 0&&(V=m(d()),X[Z]=V),V}function m(F){const W=[],K=[],Z=[];for(let U=0;U<r;U++)W[U]=0,K[U]=0,Z[U]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:W,enabledAttributes:K,attributeDivisors:Z,object:F,attributes:{},index:null}}function v(F,W,K,Z){const U=c.attributes,X=W.attributes;let V=0;const q=K.getAttributes();for(const H in q)if(q[H].location>=0){const J=U[H];let le=X[H];if(le===void 0&&(H==="instanceMatrix"&&F.instanceMatrix&&(le=F.instanceMatrix),H==="instanceColor"&&F.instanceColor&&(le=F.instanceColor)),J===void 0||J.attribute!==le||le&&J.data!==le.data)return!0;V++}return c.attributesNum!==V||c.index!==Z}function x(F,W,K,Z){const U={},X=W.attributes;let V=0;const q=K.getAttributes();for(const H in q)if(q[H].location>=0){let J=X[H];J===void 0&&(H==="instanceMatrix"&&F.instanceMatrix&&(J=F.instanceMatrix),H==="instanceColor"&&F.instanceColor&&(J=F.instanceColor));const le={};le.attribute=J,J&&J.data&&(le.data=J.data),U[H]=le,V++}c.attributes=U,c.attributesNum=V,c.index=Z}function w(){const F=c.newAttributes;for(let W=0,K=F.length;W<K;W++)F[W]=0}function b(F){M(F,0)}function M(F,W){const K=c.newAttributes,Z=c.enabledAttributes,U=c.attributeDivisors;K[F]=1,Z[F]===0&&(e.enableVertexAttribArray(F),Z[F]=1),U[F]!==W&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,W),U[F]=W)}function A(){const F=c.newAttributes,W=c.enabledAttributes;for(let K=0,Z=W.length;K<Z;K++)W[K]!==F[K]&&(e.disableVertexAttribArray(K),W[K]=0)}function T(F,W,K,Z,U,X){n.isWebGL2===!0&&(K===5124||K===5125)?e.vertexAttribIPointer(F,W,K,U,X):e.vertexAttribPointer(F,W,K,Z,U,X)}function S(F,W,K,Z){if(n.isWebGL2===!1&&(F.isInstancedMesh||Z.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;w();const U=Z.attributes,X=K.getAttributes(),V=W.defaultAttributeValues;for(const q in X){const H=X[q];if(H.location>=0){let Q=U[q];if(Q===void 0&&(q==="instanceMatrix"&&F.instanceMatrix&&(Q=F.instanceMatrix),q==="instanceColor"&&F.instanceColor&&(Q=F.instanceColor)),Q!==void 0){const J=Q.normalized,le=Q.itemSize,j=i.get(Q);if(j===void 0)continue;const ve=j.buffer,pe=j.type,me=j.bytesPerElement;if(Q.isInterleavedBufferAttribute){const de=Q.data,Se=de.stride,ce=Q.offset;if(de.isInstancedInterleavedBuffer){for(let se=0;se<H.locationSize;se++)M(H.location+se,de.meshPerAttribute);F.isInstancedMesh!==!0&&Z._maxInstanceCount===void 0&&(Z._maxInstanceCount=de.meshPerAttribute*de.count)}else for(let se=0;se<H.locationSize;se++)b(H.location+se);e.bindBuffer(34962,ve);for(let se=0;se<H.locationSize;se++)T(H.location+se,le/H.locationSize,pe,J,Se*me,(ce+le/H.locationSize*se)*me)}else{if(Q.isInstancedBufferAttribute){for(let de=0;de<H.locationSize;de++)M(H.location+de,Q.meshPerAttribute);F.isInstancedMesh!==!0&&Z._maxInstanceCount===void 0&&(Z._maxInstanceCount=Q.meshPerAttribute*Q.count)}else for(let de=0;de<H.locationSize;de++)b(H.location+de);e.bindBuffer(34962,ve);for(let de=0;de<H.locationSize;de++)T(H.location+de,le/H.locationSize,pe,J,le*me,le/H.locationSize*de*me)}}else if(V!==void 0){const J=V[q];if(J!==void 0)switch(J.length){case 2:e.vertexAttrib2fv(H.location,J);break;case 3:e.vertexAttrib3fv(H.location,J);break;case 4:e.vertexAttrib4fv(H.location,J);break;default:e.vertexAttrib1fv(H.location,J)}}}}A()}function C(){k();for(const F in a){const W=a[F];for(const K in W){const Z=W[K];for(const U in Z)p(Z[U].object),delete Z[U];delete W[K]}delete a[F]}}function P(F){if(a[F.id]===void 0)return;const W=a[F.id];for(const K in W){const Z=W[K];for(const U in Z)p(Z[U].object),delete Z[U];delete W[K]}delete a[F.id]}function B(F){for(const W in a){const K=a[W];if(K[F.id]===void 0)continue;const Z=K[F.id];for(const U in Z)p(Z[U].object),delete Z[U];delete K[F.id]}}function k(){z(),h=!0,c!==l&&(c=l,f(c.object))}function z(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:k,resetDefaultState:z,dispose:C,releaseStatesOfGeometry:P,releaseStatesOfProgram:B,initAttributes:w,enableAttribute:b,disableUnusedAttributes:A}}function xoe(e,t,i,n){const r=n.isWebGL2;let s;function o(c){s=c}function a(c,h){e.drawArrays(s,c,h),i.update(h,s,1)}function l(c,h,u){if(u===0)return;let d,f;if(r)d=e,f="drawArraysInstanced";else if(d=t.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,h,u),i.update(h,s,u)}this.setMode=o,this.render=a,this.renderInstances=l}function woe(e,t,i){let n;function r(){if(n!==void 0)return n;if(t.has("EXT_texture_filter_anisotropic")===!0){const T=t.get("EXT_texture_filter_anisotropic");n=e.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(T){if(T==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";T="mediump"}return T==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext;let a=i.precision!==void 0?i.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||t.has("WEBGL_draw_buffers"),h=i.logarithmicDepthBuffer===!0,u=e.getParameter(34930),d=e.getParameter(35660),f=e.getParameter(3379),p=e.getParameter(34076),g=e.getParameter(34921),m=e.getParameter(36347),v=e.getParameter(36348),x=e.getParameter(36349),w=d>0,b=o||t.has("OES_texture_float"),M=w&&b,A=o?e.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:g,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:x,vertexTextures:w,floatFragmentTextures:b,floatVertexTextures:M,maxSamples:A}}function _oe(e){const t=this;let i=null,n=0,r=!1,s=!1;const o=new Qu,a=new hs,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,d){const f=u.length!==0||d||n!==0||r;return r=d,n=u.length,f},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,d){i=h(u,d,0)},this.setState=function(u,d,f){const p=u.clippingPlanes,g=u.clipIntersection,m=u.clipShadows,v=e.get(u);if(!r||p===null||p.length===0||s&&!m)s?h(null):c();else{const x=s?0:n,w=x*4;let b=v.clippingState||null;l.value=b,b=h(p,d,w,f);for(let M=0;M!==w;++M)b[M]=i[M];v.clippingState=b,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=x}};function c(){l.value!==i&&(l.value=i,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function h(u,d,f,p){const g=u!==null?u.length:0;let m=null;if(g!==0){if(m=l.value,p!==!0||m===null){const v=f+g*4,x=d.matrixWorldInverse;a.getNormalMatrix(x),(m===null||m.length<v)&&(m=new Float32Array(v));for(let w=0,b=f;w!==g;++w,b+=4)o.copy(u[w]).applyMatrix4(x,a),o.normal.toArray(m,b),m[b+3]=o.constant}l.value=m,l.needsUpdate=!0}return t.numPlanes=g,t.numIntersection=0,m}}function boe(e){let t=new WeakMap;function i(o,a){return a===tx?o.mapping=Bh:a===ix&&(o.mapping=Lh),o}function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===tx||a===ix)if(t.has(o)){const l=t.get(o).texture;return i(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new GR(l.height/2);return c.fromEquirectangularTexture(e,o),t.set(o,c),o.addEventListener("dispose",r),i(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=t.get(a);l!==void 0&&(t.delete(a),l.dispose())}function s(){t=new WeakMap}return{get:n,dispose:s}}class Ya extends qx{constructor(t=-1,i=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=i,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(t,i){return super.copy(t,i),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,i,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-t,o=n+t,a=r+i,l=r-i;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=h*this.view.offsetY,l=a-h*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const i=super.toJSON(t);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}const Pm=4,Ik=[.125,.215,.35,.446,.526,.582],Vd=20,mT=new Ya,Ok=new ct;let gT=null;const Od=(1+Math.sqrt(5))/2,Dp=1/Od,Fk=[new te(1,1,1),new te(-1,1,1),new te(1,1,-1),new te(-1,1,-1),new te(0,Od,Dp),new te(0,Od,-Dp),new te(Dp,0,Od),new te(-Dp,0,Od),new te(Od,Dp,0),new te(-Od,Dp,0)];class y3{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,i=0,n=.1,r=100){gT=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(t,n,r,s),i>0&&this._blur(s,0,0,i),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(t,i=null){return this._fromTexture(t,i)}fromCubemap(t,i=null){return this._fromTexture(t,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=kk(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=zk(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(gT),t.scissorTest=!1,o_(t,0,0,t.width,t.height)}_fromTexture(t,i){t.mapping===Bh||t.mapping===Lh?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),gT=this._renderer.getRenderTarget();const n=i||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,n={magFilter:rn,minFilter:rn,generateMipmaps:!1,type:Ag,format:Ls,encoding:Ih,depthBuffer:!1},r=Nk(t,i,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Nk(t,i,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Aoe(s)),this._blurMaterial=Soe(s,t,i)}return r}_compileMaterial(t){const i=new $n(this._lodPlanes[0],t);this._renderer.compile(i,mT)}_sceneToCubeUV(t,i,n,r){const a=new $i(90,1,i,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,u=h.autoClear,d=h.toneMapping;h.getClearColor(Ok),h.toneMapping=Xa,h.autoClear=!1;const f=new co({name:"PMREM.Background",side:Vs,depthWrite:!1,depthTest:!1}),p=new $n(new qh,f);let g=!1;const m=t.background;m?m.isColor&&(f.color.copy(m),t.background=null,g=!0):(f.color.copy(Ok),g=!0);for(let v=0;v<6;v++){const x=v%3;x===0?(a.up.set(0,l[v],0),a.lookAt(c[v],0,0)):x===1?(a.up.set(0,0,l[v]),a.lookAt(0,c[v],0)):(a.up.set(0,l[v],0),a.lookAt(0,0,c[v]));const w=this._cubeSize;o_(r,x*w,v>2?w:0,w,w),h.setRenderTarget(r),g&&h.render(p,a),h.render(t,a)}p.geometry.dispose(),p.material.dispose(),h.toneMapping=d,h.autoClear=u,t.background=m}_textureToCubeUV(t,i){const n=this._renderer,r=t.mapping===Bh||t.mapping===Lh;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=kk()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=zk());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new $n(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=t;const l=this._cubeSize;o_(i,0,0,3*l,2*l),n.setRenderTarget(i),n.render(o,mT)}_applyPMREM(t){const i=this._renderer,n=i.autoClear;i.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=Fk[(r-1)%Fk.length];this._blur(t,r-1,r,s,o)}i.autoClear=n}_blur(t,i,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(t,o,i,n,r,"latitudinal",s),this._halfBlur(o,t,n,n,r,"longitudinal",s)}_halfBlur(t,i,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,u=new $n(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[n]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*Vd-1),g=s/p,m=isFinite(s)?1+Math.floor(h*g):Vd;m>Vd&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Vd}`);const v=[];let x=0;for(let T=0;T<Vd;++T){const S=T/g,C=Math.exp(-S*S/2);v.push(C),T===0?x+=C:T<m&&(x+=2*C)}for(let T=0;T<v.length;T++)v[T]=v[T]/x;d.envMap.value=t.texture,d.samples.value=m,d.weights.value=v,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:w}=this;d.dTheta.value=p,d.mipInt.value=w-n;const b=this._sizeLods[r],M=3*b*(r>w-Pm?r-w+Pm:0),A=4*(this._cubeSize-b);o_(i,M,A,3*b,2*b),l.setRenderTarget(i),l.render(u,mT)}}function Aoe(e){const t=[],i=[],n=[];let r=e;const s=e-Pm+1+Ik.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);i.push(a);let l=1/a;o>e-Pm?l=Ik[o-e+Pm-1]:o===0&&(l=0),n.push(l);const c=1/(a-2),h=-c,u=1+c,d=[h,h,u,h,u,u,h,h,u,u,h,u],f=6,p=6,g=3,m=2,v=1,x=new Float32Array(g*p*f),w=new Float32Array(m*p*f),b=new Float32Array(v*p*f);for(let A=0;A<f;A++){const T=A%3*2/3-1,S=A>2?0:-1,C=[T,S,0,T+2/3,S,0,T+2/3,S+1,0,T,S,0,T+2/3,S+1,0,T,S+1,0];x.set(C,g*p*A),w.set(d,m*p*A);const P=[A,A,A,A,A,A];b.set(P,v*p*A)}const M=new Qt;M.setAttribute("position",new wi(x,g)),M.setAttribute("uv",new wi(w,m)),M.setAttribute("faceIndex",new wi(b,v)),t.push(M),r>Pm&&r--}return{lodPlanes:t,sizeLods:i,sigmas:n}}function Nk(e,t,i){const n=new Ja(e,t,i);return n.texture.mapping=Jg,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function o_(e,t,i,n,r){e.viewport.set(t,i,n,r),e.scissor.set(t,i,n,r)}function Soe(e,t,i){const n=new Float32Array(Vd),r=new te(0,1,0);return new ql({name:"SphericalGaussianBlur",defines:{n:Vd,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:HR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Qc,depthTest:!1,depthWrite:!1})}function zk(){return new ql({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:HR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Qc,depthTest:!1,depthWrite:!1})}function kk(){return new ql({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:HR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Qc,depthTest:!1,depthWrite:!1})}function HR(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Moe(e){let t=new WeakMap,i=null;function n(a){if(a&&a.isTexture){const l=a.mapping,c=l===tx||l===ix,h=l===Bh||l===Lh;if(c||h)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let u=t.get(a);return i===null&&(i=new y3(e)),u=c?i.fromEquirectangular(a,u):i.fromCubemap(a,u),t.set(a,u),u.texture}else{if(t.has(a))return t.get(a).texture;{const u=a.image;if(c&&u&&u.height>0||h&&u&&r(u)){i===null&&(i=new y3(e));const d=c?i.fromEquirectangular(a):i.fromCubemap(a);return t.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0;const c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function o(){t=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:o}}function Eoe(e){const t={};function i(n){if(t[n]!==void 0)return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(n){return i(n)!==null},init:function(n){n.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(n){const r=i(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function Coe(e,t,i,n){const r={},s=new WeakMap;function o(u){const d=u.target;d.index!==null&&t.remove(d.index);for(const p in d.attributes)t.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(t.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function a(u,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,i.memory.geometries++),d}function l(u){const d=u.attributes;for(const p in d)t.update(d[p],34962);const f=u.morphAttributes;for(const p in f){const g=f[p];for(let m=0,v=g.length;m<v;m++)t.update(g[m],34962)}}function c(u){const d=[],f=u.index,p=u.attributes.position;let g=0;if(f!==null){const x=f.array;g=f.version;for(let w=0,b=x.length;w<b;w+=3){const M=x[w+0],A=x[w+1],T=x[w+2];d.push(M,A,A,T,T,M)}}else{const x=p.array;g=p.version;for(let w=0,b=x.length/3-1;w<b;w+=3){const M=w+0,A=w+1,T=w+2;d.push(M,A,A,T,T,M)}}const m=new(d7(d)?kR:zR)(d,1);m.version=g;const v=s.get(u);v&&t.remove(v),s.set(u,m)}function h(u){const d=s.get(u);if(d){const f=u.index;f!==null&&d.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:h}}function Toe(e,t,i,n){const r=n.isWebGL2;let s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function h(d,f){e.drawElements(s,f,a,d*l),i.update(f,s,1)}function u(d,f,p){if(p===0)return;let g,m;if(r)g=e,m="drawElementsInstanced";else if(g=t.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",g===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[m](s,f,a,d*l,p),i.update(f,s,p)}this.setMode=o,this.setIndex=c,this.render=h,this.renderInstances=u}function Poe(e){const t={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(i.calls++,o){case 4:i.triangles+=a*(s/3);break;case 1:i.lines+=a*(s/2);break;case 3:i.lines+=a*(s-1);break;case 2:i.lines+=a*s;break;case 0:i.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:t,render:i,programs:null,autoReset:!0,reset:r,update:n}}function Doe(e,t){return e[0]-t[0]}function Boe(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Loe(e,t,i){const n={},r=new Float32Array(8),s=new WeakMap,o=new Ci,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,h,u,d){const f=c.morphTargetInfluences;if(t.isWebGL2===!0){const g=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,m=g!==void 0?g.length:0;let v=s.get(h);if(v===void 0||v.count!==m){let K=function(){F.dispose(),s.delete(h),h.removeEventListener("dispose",K)};var p=K;v!==void 0&&v.texture.dispose();const b=h.morphAttributes.position!==void 0,M=h.morphAttributes.normal!==void 0,A=h.morphAttributes.color!==void 0,T=h.morphAttributes.position||[],S=h.morphAttributes.normal||[],C=h.morphAttributes.color||[];let P=0;b===!0&&(P=1),M===!0&&(P=2),A===!0&&(P=3);let B=h.attributes.position.count*P,k=1;B>t.maxTextureSize&&(k=Math.ceil(B/t.maxTextureSize),B=t.maxTextureSize);const z=new Float32Array(B*k*4*m),F=new EM(z,B,k,m);F.type=Gc,F.needsUpdate=!0;const W=P*4;for(let Z=0;Z<m;Z++){const U=T[Z],X=S[Z],V=C[Z],q=B*k*4*Z;for(let H=0;H<U.count;H++){const Q=H*W;b===!0&&(o.fromBufferAttribute(U,H),z[q+Q+0]=o.x,z[q+Q+1]=o.y,z[q+Q+2]=o.z,z[q+Q+3]=0),M===!0&&(o.fromBufferAttribute(X,H),z[q+Q+4]=o.x,z[q+Q+5]=o.y,z[q+Q+6]=o.z,z[q+Q+7]=0),A===!0&&(o.fromBufferAttribute(V,H),z[q+Q+8]=o.x,z[q+Q+9]=o.y,z[q+Q+10]=o.z,z[q+Q+11]=V.itemSize===4?o.w:1)}}v={count:m,texture:F,size:new Ve(B,k)},s.set(h,v),h.addEventListener("dispose",K)}let x=0;for(let b=0;b<f.length;b++)x+=f[b];const w=h.morphTargetsRelative?1:1-x;d.getUniforms().setValue(e,"morphTargetBaseInfluence",w),d.getUniforms().setValue(e,"morphTargetInfluences",f),d.getUniforms().setValue(e,"morphTargetsTexture",v.texture,i),d.getUniforms().setValue(e,"morphTargetsTextureSize",v.size)}else{const g=f===void 0?0:f.length;let m=n[h.id];if(m===void 0||m.length!==g){m=[];for(let M=0;M<g;M++)m[M]=[M,0];n[h.id]=m}for(let M=0;M<g;M++){const A=m[M];A[0]=M,A[1]=f[M]}m.sort(Boe);for(let M=0;M<8;M++)M<g&&m[M][1]?(a[M][0]=m[M][0],a[M][1]=m[M][1]):(a[M][0]=Number.MAX_SAFE_INTEGER,a[M][1]=0);a.sort(Doe);const v=h.morphAttributes.position,x=h.morphAttributes.normal;let w=0;for(let M=0;M<8;M++){const A=a[M],T=A[0],S=A[1];T!==Number.MAX_SAFE_INTEGER&&S?(v&&h.getAttribute("morphTarget"+M)!==v[T]&&h.setAttribute("morphTarget"+M,v[T]),x&&h.getAttribute("morphNormal"+M)!==x[T]&&h.setAttribute("morphNormal"+M,x[T]),r[M]=S,w+=S):(v&&h.hasAttribute("morphTarget"+M)===!0&&h.deleteAttribute("morphTarget"+M),x&&h.hasAttribute("morphNormal"+M)===!0&&h.deleteAttribute("morphNormal"+M),r[M]=0)}const b=h.morphTargetsRelative?1:1-w;d.getUniforms().setValue(e,"morphTargetBaseInfluence",b),d.getUniforms().setValue(e,"morphTargetInfluences",r)}}return{update:l}}function Roe(e,t,i,n){let r=new WeakMap;function s(l){const c=n.render.frame,h=l.geometry,u=t.get(l,h);return r.get(u)!==c&&(t.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.update(l.instanceMatrix,34962),l.instanceColor!==null&&i.update(l.instanceColor,34962)),u}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),i.remove(c.instanceMatrix),c.instanceColor!==null&&i.remove(c.instanceColor)}return{update:s,dispose:o}}const v7=new en,y7=new EM,x7=new NR,w7=new Qx,Uk=[],Gk=[],Hk=new Float32Array(16),Vk=new Float32Array(9),jk=new Float32Array(4);function Zg(e,t,i){const n=e[0];if(n<=0||n>0)return e;const r=t*i;let s=Uk[r];if(s===void 0&&(s=new Float32Array(r),Uk[r]=s),t!==0){n.toArray(s,0);for(let o=1,a=0;o!==t;++o)a+=i,e[o].toArray(s,a)}return s}function ir(e,t){if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(e[i]!==t[i])return!1;return!0}function nr(e,t){for(let i=0,n=t.length;i<n;i++)e[i]=t[i]}function TM(e,t){let i=Gk[t];i===void 0&&(i=new Int32Array(t),Gk[t]=i);for(let n=0;n!==t;++n)i[n]=e.allocateTextureUnit();return i}function Ioe(e,t){const i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function Ooe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(ir(i,t))return;e.uniform2fv(this.addr,t),nr(i,t)}}function Foe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(t.r!==void 0)(i[0]!==t.r||i[1]!==t.g||i[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(ir(i,t))return;e.uniform3fv(this.addr,t),nr(i,t)}}function Noe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(ir(i,t))return;e.uniform4fv(this.addr,t),nr(i,t)}}function zoe(e,t){const i=this.cache,n=t.elements;if(n===void 0){if(ir(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),nr(i,t)}else{if(ir(i,n))return;jk.set(n),e.uniformMatrix2fv(this.addr,!1,jk),nr(i,n)}}function koe(e,t){const i=this.cache,n=t.elements;if(n===void 0){if(ir(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),nr(i,t)}else{if(ir(i,n))return;Vk.set(n),e.uniformMatrix3fv(this.addr,!1,Vk),nr(i,n)}}function Uoe(e,t){const i=this.cache,n=t.elements;if(n===void 0){if(ir(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),nr(i,t)}else{if(ir(i,n))return;Hk.set(n),e.uniformMatrix4fv(this.addr,!1,Hk),nr(i,n)}}function Goe(e,t){const i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function Hoe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(ir(i,t))return;e.uniform2iv(this.addr,t),nr(i,t)}}function Voe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(ir(i,t))return;e.uniform3iv(this.addr,t),nr(i,t)}}function joe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(ir(i,t))return;e.uniform4iv(this.addr,t),nr(i,t)}}function Woe(e,t){const i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function Xoe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(ir(i,t))return;e.uniform2uiv(this.addr,t),nr(i,t)}}function Yoe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(ir(i,t))return;e.uniform3uiv(this.addr,t),nr(i,t)}}function qoe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(ir(i,t))return;e.uniform4uiv(this.addr,t),nr(i,t)}}function Qoe(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(t||v7,r)}function Joe(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(t||x7,r)}function Koe(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(t||w7,r)}function Zoe(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(t||y7,r)}function $oe(e){switch(e){case 5126:return Ioe;case 35664:return Ooe;case 35665:return Foe;case 35666:return Noe;case 35674:return zoe;case 35675:return koe;case 35676:return Uoe;case 5124:case 35670:return Goe;case 35667:case 35671:return Hoe;case 35668:case 35672:return Voe;case 35669:case 35673:return joe;case 5125:return Woe;case 36294:return Xoe;case 36295:return Yoe;case 36296:return qoe;case 35678:case 36198:case 36298:case 36306:case 35682:return Qoe;case 35679:case 36299:case 36307:return Joe;case 35680:case 36300:case 36308:case 36293:return Koe;case 36289:case 36303:case 36311:case 36292:return Zoe}}function eae(e,t){e.uniform1fv(this.addr,t)}function tae(e,t){const i=Zg(t,this.size,2);e.uniform2fv(this.addr,i)}function iae(e,t){const i=Zg(t,this.size,3);e.uniform3fv(this.addr,i)}function nae(e,t){const i=Zg(t,this.size,4);e.uniform4fv(this.addr,i)}function rae(e,t){const i=Zg(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function sae(e,t){const i=Zg(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function oae(e,t){const i=Zg(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function aae(e,t){e.uniform1iv(this.addr,t)}function lae(e,t){e.uniform2iv(this.addr,t)}function cae(e,t){e.uniform3iv(this.addr,t)}function uae(e,t){e.uniform4iv(this.addr,t)}function hae(e,t){e.uniform1uiv(this.addr,t)}function dae(e,t){e.uniform2uiv(this.addr,t)}function fae(e,t){e.uniform3uiv(this.addr,t)}function pae(e,t){e.uniform4uiv(this.addr,t)}function mae(e,t,i){const n=this.cache,r=t.length,s=TM(i,r);ir(n,s)||(e.uniform1iv(this.addr,s),nr(n,s));for(let o=0;o!==r;++o)i.setTexture2D(t[o]||v7,s[o])}function gae(e,t,i){const n=this.cache,r=t.length,s=TM(i,r);ir(n,s)||(e.uniform1iv(this.addr,s),nr(n,s));for(let o=0;o!==r;++o)i.setTexture3D(t[o]||x7,s[o])}function vae(e,t,i){const n=this.cache,r=t.length,s=TM(i,r);ir(n,s)||(e.uniform1iv(this.addr,s),nr(n,s));for(let o=0;o!==r;++o)i.setTextureCube(t[o]||w7,s[o])}function yae(e,t,i){const n=this.cache,r=t.length,s=TM(i,r);ir(n,s)||(e.uniform1iv(this.addr,s),nr(n,s));for(let o=0;o!==r;++o)i.setTexture2DArray(t[o]||y7,s[o])}function xae(e){switch(e){case 5126:return eae;case 35664:return tae;case 35665:return iae;case 35666:return nae;case 35674:return rae;case 35675:return sae;case 35676:return oae;case 5124:case 35670:return aae;case 35667:case 35671:return lae;case 35668:case 35672:return cae;case 35669:case 35673:return uae;case 5125:return hae;case 36294:return dae;case 36295:return fae;case 36296:return pae;case 35678:case 36198:case 36298:case 36306:case 35682:return mae;case 35679:case 36299:case 36307:return gae;case 35680:case 36300:case 36308:case 36293:return vae;case 36289:case 36303:case 36311:case 36292:return yae}}class wae{constructor(t,i,n){this.id=t,this.addr=n,this.cache=[],this.setValue=$oe(i.type)}}class _ae{constructor(t,i,n){this.id=t,this.addr=n,this.cache=[],this.size=i.size,this.setValue=xae(i.type)}}class bae{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,i,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(t,i[a.id],n)}}}const vT=/(\w+)(\])?(\[|\.)?/g;function Wk(e,t){e.seq.push(t),e.map[t.id]=t}function Aae(e,t,i){const n=e.name,r=n.length;for(vT.lastIndex=0;;){const s=vT.exec(n),o=vT.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){Wk(i,c===void 0?new wae(a,e,t):new _ae(a,e,t));break}else{let u=i.map[a];u===void 0&&(u=new bae(a),Wk(i,u)),i=u}}}class uA{constructor(t,i){this.seq=[],this.map={};const n=t.getProgramParameter(i,35718);for(let r=0;r<n;++r){const s=t.getActiveUniform(i,r),o=t.getUniformLocation(i,s.name);Aae(s,o,this)}}setValue(t,i,n,r){const s=this.map[i];s!==void 0&&s.setValue(t,n,r)}setOptional(t,i,n){const r=i[n];r!==void 0&&this.setValue(t,n,r)}static upload(t,i,n,r){for(let s=0,o=i.length;s!==o;++s){const a=i[s],l=n[a.id];l.needsUpdate!==!1&&a.setValue(t,l.value,r)}}static seqWithValue(t,i){const n=[];for(let r=0,s=t.length;r!==s;++r){const o=t[r];o.id in i&&n.push(o)}return n}}function Xk(e,t,i){const n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),n}let Sae=0;function Mae(e,t){const i=e.split(`
`),n=[],r=Math.max(t-6,0),s=Math.min(t+6,i.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===t?">":" "} ${a}: ${i[o]}`)}return n.join(`
`)}function Eae(e){switch(e){case Ih:return["Linear","( value )"];case Gi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function Yk(e,t,i){const n=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();if(n&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return i.toUpperCase()+`

`+r+`

`+Mae(e.getShaderSource(t),o)}else return r}function Cae(e,t){const i=Eae(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function Tae(e,t){let i;switch(t){case z9:i="Linear";break;case k9:i="Reinhard";break;case U9:i="OptimizedCineon";break;case DR:i="ACESFilmic";break;case G9:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Pae(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Y0).join(`
`)}function Dae(e){const t=[];for(const i in e){const n=e[i];n!==!1&&t.push("#define "+i+" "+n)}return t.join(`
`)}function Bae(e,t){const i={},n=e.getProgramParameter(t,35721);for(let r=0;r<n;r++){const s=e.getActiveAttrib(t,r),o=s.name;let a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),i[o]={type:s.type,location:e.getAttribLocation(t,o),locationSize:a}}return i}function Y0(e){return e!==""}function qk(e,t){const i=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Qk(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const Lae=/^[ \t]*#include +<([\w\d./]+)>/gm;function x3(e){return e.replace(Lae,Rae)}function Rae(e,t){const i=ii[t];if(i===void 0)throw new Error("Can not resolve #include <"+t+">");return x3(i)}const Iae=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Jk(e){return e.replace(Iae,Oae)}function Oae(e,t,i,n){let r="";for(let s=parseInt(t);s<parseInt(i);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Kk(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function Fae(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===bM?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===fy?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===$d&&(t="SHADOWMAP_TYPE_VSM"),t}function Nae(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Bh:case Lh:t="ENVMAP_TYPE_CUBE";break;case Jg:t="ENVMAP_TYPE_CUBE_UV";break}return t}function zae(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Lh:t="ENVMAP_MODE_REFRACTION";break}return t}function kae(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case Xx:t="ENVMAP_BLENDING_MULTIPLY";break;case F9:t="ENVMAP_BLENDING_MIX";break;case N9:t="ENVMAP_BLENDING_ADD";break}return t}function Uae(e){const t=e.envMapCubeUVHeight;if(t===null)return null;const i=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function Gae(e,t,i,n){const r=e.getContext(),s=i.defines;let o=i.vertexShader,a=i.fragmentShader;const l=Fae(i),c=Nae(i),h=zae(i),u=kae(i),d=Uae(i),f=i.isWebGL2?"":Pae(i),p=Dae(s),g=r.createProgram();let m,v,x=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(m=[p].filter(Y0).join(`
`),m.length>0&&(m+=`
`),v=[f,p].filter(Y0).join(`
`),v.length>0&&(v+=`
`)):(m=[Kk(i),"#define SHADER_NAME "+i.shaderName,p,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Y0).join(`
`),v=[f,Kk(i),"#define SHADER_NAME "+i.shaderName,p,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.envMap?"#define "+h:"",i.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Xa?"#define TONE_MAPPING":"",i.toneMapping!==Xa?ii.tonemapping_pars_fragment:"",i.toneMapping!==Xa?Tae("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",ii.encodings_pars_fragment,Cae("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Y0).join(`
`)),o=x3(o),o=qk(o,i),o=Qk(o,i),a=x3(a),a=qk(a,i),a=Qk(a,i),o=Jk(o),a=Jk(a),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(x=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,v=["#define varying in",i.glslVersion===g3?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===g3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const w=x+m+o,b=x+v+a,M=Xk(r,35633,w),A=Xk(r,35632,b);if(r.attachShader(g,M),r.attachShader(g,A),i.index0AttributeName!==void 0?r.bindAttribLocation(g,0,i.index0AttributeName):i.morphTargets===!0&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g),e.debug.checkShaderErrors){const C=r.getProgramInfoLog(g).trim(),P=r.getShaderInfoLog(M).trim(),B=r.getShaderInfoLog(A).trim();let k=!0,z=!0;if(r.getProgramParameter(g,35714)===!1){k=!1;const F=Yk(r,M,"vertex"),W=Yk(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,35715)+`

Program Info Log: `+C+`
`+F+`
`+W)}else C!==""?console.warn("THREE.WebGLProgram: Program Info Log:",C):(P===""||B==="")&&(z=!1);z&&(this.diagnostics={runnable:k,programLog:C,vertexShader:{log:P,prefix:m},fragmentShader:{log:B,prefix:v}})}r.deleteShader(M),r.deleteShader(A);let T;this.getUniforms=function(){return T===void 0&&(T=new uA(r,g)),T};let S;return this.getAttributes=function(){return S===void 0&&(S=Bae(r,g)),S},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.name=i.shaderName,this.id=Sae++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=M,this.fragmentShader=A,this}let Hae=0;class Vae{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const i=t.vertexShader,n=t.fragmentShader,r=this._getShaderStage(i),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(t);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(t){const i=this.materialCache.get(t);for(const n of i)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const i=this.materialCache;let n=i.get(t);return n===void 0&&(n=new Set,i.set(t,n)),n}_getShaderStage(t){const i=this.shaderCache;let n=i.get(t);return n===void 0&&(n=new jae(t),i.set(t,n)),n}}class jae{constructor(t){this.id=Hae++,this.code=t,this.usedTimes=0}}function Wae(e,t,i,n,r,s,o){const a=new vf,l=new Vae,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(S,C,P,B,k){const z=B.fog,F=k.geometry,W=S.isMeshStandardMaterial?B.environment:null,K=(S.isMeshStandardMaterial?i:t).get(S.envMap||W),Z=K&&K.mapping===Jg?K.image.height:null,U=p[S.type];S.precision!==null&&(f=r.getMaxPrecision(S.precision),f!==S.precision&&console.warn("THREE.WebGLProgram.getParameters:",S.precision,"not supported, using",f,"instead."));const X=F.morphAttributes.position||F.morphAttributes.normal||F.morphAttributes.color,V=X!==void 0?X.length:0;let q=0;F.morphAttributes.position!==void 0&&(q=1),F.morphAttributes.normal!==void 0&&(q=2),F.morphAttributes.color!==void 0&&(q=3);let H,Q,J,le;if(U){const Se=Fa[U];H=Se.vertexShader,Q=Se.fragmentShader}else H=S.vertexShader,Q=S.fragmentShader,l.update(S),J=l.getVertexShaderID(S),le=l.getFragmentShaderID(S);const j=e.getRenderTarget(),ve=S.alphaTest>0,pe=S.clearcoat>0,me=S.iridescence>0;return{isWebGL2:h,shaderID:U,shaderName:S.type,vertexShader:H,fragmentShader:Q,defines:S.defines,customVertexShaderID:J,customFragmentShaderID:le,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:f,instancing:k.isInstancedMesh===!0,instancingColor:k.isInstancedMesh===!0&&k.instanceColor!==null,supportsVertexTextures:d,outputEncoding:j===null?e.outputEncoding:j.isXRRenderTarget===!0?j.texture.encoding:Ih,map:!!S.map,matcap:!!S.matcap,envMap:!!K,envMapMode:K&&K.mapping,envMapCubeUVHeight:Z,lightMap:!!S.lightMap,aoMap:!!S.aoMap,emissiveMap:!!S.emissiveMap,bumpMap:!!S.bumpMap,normalMap:!!S.normalMap,objectSpaceNormalMap:S.normalMapType===c7,tangentSpaceNormalMap:S.normalMapType===Wh,decodeVideoTexture:!!S.map&&S.map.isVideoTexture===!0&&S.map.encoding===Gi,clearcoat:pe,clearcoatMap:pe&&!!S.clearcoatMap,clearcoatRoughnessMap:pe&&!!S.clearcoatRoughnessMap,clearcoatNormalMap:pe&&!!S.clearcoatNormalMap,iridescence:me,iridescenceMap:me&&!!S.iridescenceMap,iridescenceThicknessMap:me&&!!S.iridescenceThicknessMap,displacementMap:!!S.displacementMap,roughnessMap:!!S.roughnessMap,metalnessMap:!!S.metalnessMap,specularMap:!!S.specularMap,specularIntensityMap:!!S.specularIntensityMap,specularColorMap:!!S.specularColorMap,opaque:S.transparent===!1&&S.blending===df,alphaMap:!!S.alphaMap,alphaTest:ve,gradientMap:!!S.gradientMap,sheen:S.sheen>0,sheenColorMap:!!S.sheenColorMap,sheenRoughnessMap:!!S.sheenRoughnessMap,transmission:S.transmission>0,transmissionMap:!!S.transmissionMap,thicknessMap:!!S.thicknessMap,combine:S.combine,vertexTangents:!!S.normalMap&&!!F.attributes.tangent,vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!F.attributes.color&&F.attributes.color.itemSize===4,vertexUvs:!!S.map||!!S.bumpMap||!!S.normalMap||!!S.specularMap||!!S.alphaMap||!!S.emissiveMap||!!S.roughnessMap||!!S.metalnessMap||!!S.clearcoatMap||!!S.clearcoatRoughnessMap||!!S.clearcoatNormalMap||!!S.iridescenceMap||!!S.iridescenceThicknessMap||!!S.displacementMap||!!S.transmissionMap||!!S.thicknessMap||!!S.specularIntensityMap||!!S.specularColorMap||!!S.sheenColorMap||!!S.sheenRoughnessMap,uvsVertexOnly:!(S.map||S.bumpMap||S.normalMap||S.specularMap||S.alphaMap||S.emissiveMap||S.roughnessMap||S.metalnessMap||S.clearcoatNormalMap||S.iridescenceMap||S.iridescenceThicknessMap||S.transmission>0||S.transmissionMap||S.thicknessMap||S.specularIntensityMap||S.specularColorMap||S.sheen>0||S.sheenColorMap||S.sheenRoughnessMap)&&!!S.displacementMap,fog:!!z,useFog:S.fog===!0,fogExp2:z&&z.isFogExp2,flatShading:!!S.flatShading,sizeAttenuation:S.sizeAttenuation,logarithmicDepthBuffer:u,skinning:k.isSkinnedMesh===!0,morphTargets:F.morphAttributes.position!==void 0,morphNormals:F.morphAttributes.normal!==void 0,morphColors:F.morphAttributes.color!==void 0,morphTargetsCount:V,morphTextureStride:q,numDirLights:C.directional.length,numPointLights:C.point.length,numSpotLights:C.spot.length,numSpotLightMaps:C.spotLightMap.length,numRectAreaLights:C.rectArea.length,numHemiLights:C.hemi.length,numDirLightShadows:C.directionalShadowMap.length,numPointLightShadows:C.pointShadowMap.length,numSpotLightShadows:C.spotShadowMap.length,numSpotLightShadowsWithMaps:C.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:S.dithering,shadowMapEnabled:e.shadowMap.enabled&&P.length>0,shadowMapType:e.shadowMap.type,toneMapping:S.toneMapped?e.toneMapping:Xa,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===za,flipSided:S.side===Vs,useDepthPacking:!!S.depthPacking,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionDerivatives:S.extensions&&S.extensions.derivatives,extensionFragDepth:S.extensions&&S.extensions.fragDepth,extensionDrawBuffers:S.extensions&&S.extensions.drawBuffers,extensionShaderTextureLOD:S.extensions&&S.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||n.has("EXT_shader_texture_lod"),customProgramCacheKey:S.customProgramCacheKey()}}function m(S){const C=[];if(S.shaderID?C.push(S.shaderID):(C.push(S.customVertexShaderID),C.push(S.customFragmentShaderID)),S.defines!==void 0)for(const P in S.defines)C.push(P),C.push(S.defines[P]);return S.isRawShaderMaterial===!1&&(v(C,S),x(C,S),C.push(e.outputEncoding)),C.push(S.customProgramCacheKey),C.join()}function v(S,C){S.push(C.precision),S.push(C.outputEncoding),S.push(C.envMapMode),S.push(C.envMapCubeUVHeight),S.push(C.combine),S.push(C.vertexUvs),S.push(C.fogExp2),S.push(C.sizeAttenuation),S.push(C.morphTargetsCount),S.push(C.morphAttributeCount),S.push(C.numDirLights),S.push(C.numPointLights),S.push(C.numSpotLights),S.push(C.numSpotLightMaps),S.push(C.numHemiLights),S.push(C.numRectAreaLights),S.push(C.numDirLightShadows),S.push(C.numPointLightShadows),S.push(C.numSpotLightShadows),S.push(C.numSpotLightShadowsWithMaps),S.push(C.shadowMapType),S.push(C.toneMapping),S.push(C.numClippingPlanes),S.push(C.numClipIntersection),S.push(C.depthPacking)}function x(S,C){a.disableAll(),C.isWebGL2&&a.enable(0),C.supportsVertexTextures&&a.enable(1),C.instancing&&a.enable(2),C.instancingColor&&a.enable(3),C.map&&a.enable(4),C.matcap&&a.enable(5),C.envMap&&a.enable(6),C.lightMap&&a.enable(7),C.aoMap&&a.enable(8),C.emissiveMap&&a.enable(9),C.bumpMap&&a.enable(10),C.normalMap&&a.enable(11),C.objectSpaceNormalMap&&a.enable(12),C.tangentSpaceNormalMap&&a.enable(13),C.clearcoat&&a.enable(14),C.clearcoatMap&&a.enable(15),C.clearcoatRoughnessMap&&a.enable(16),C.clearcoatNormalMap&&a.enable(17),C.iridescence&&a.enable(18),C.iridescenceMap&&a.enable(19),C.iridescenceThicknessMap&&a.enable(20),C.displacementMap&&a.enable(21),C.specularMap&&a.enable(22),C.roughnessMap&&a.enable(23),C.metalnessMap&&a.enable(24),C.gradientMap&&a.enable(25),C.alphaMap&&a.enable(26),C.alphaTest&&a.enable(27),C.vertexColors&&a.enable(28),C.vertexAlphas&&a.enable(29),C.vertexUvs&&a.enable(30),C.vertexTangents&&a.enable(31),C.uvsVertexOnly&&a.enable(32),S.push(a.mask),a.disableAll(),C.fog&&a.enable(0),C.useFog&&a.enable(1),C.flatShading&&a.enable(2),C.logarithmicDepthBuffer&&a.enable(3),C.skinning&&a.enable(4),C.morphTargets&&a.enable(5),C.morphNormals&&a.enable(6),C.morphColors&&a.enable(7),C.premultipliedAlpha&&a.enable(8),C.shadowMapEnabled&&a.enable(9),C.physicallyCorrectLights&&a.enable(10),C.doubleSided&&a.enable(11),C.flipSided&&a.enable(12),C.useDepthPacking&&a.enable(13),C.dithering&&a.enable(14),C.specularIntensityMap&&a.enable(15),C.specularColorMap&&a.enable(16),C.transmission&&a.enable(17),C.transmissionMap&&a.enable(18),C.thicknessMap&&a.enable(19),C.sheen&&a.enable(20),C.sheenColorMap&&a.enable(21),C.sheenRoughnessMap&&a.enable(22),C.decodeVideoTexture&&a.enable(23),C.opaque&&a.enable(24),S.push(a.mask)}function w(S){const C=p[S.type];let P;if(C){const B=Fa[C];P=m7.clone(B.uniforms)}else P=S.uniforms;return P}function b(S,C){let P;for(let B=0,k=c.length;B<k;B++){const z=c[B];if(z.cacheKey===C){P=z,++P.usedTimes;break}}return P===void 0&&(P=new Gae(e,C,S,s),c.push(P)),P}function M(S){if(--S.usedTimes===0){const C=c.indexOf(S);c[C]=c[c.length-1],c.pop(),S.destroy()}}function A(S){l.remove(S)}function T(){l.dispose()}return{getParameters:g,getProgramCacheKey:m,getUniforms:w,acquireProgram:b,releaseProgram:M,releaseShaderCache:A,programs:c,dispose:T}}function Xae(){let e=new WeakMap;function t(s){let o=e.get(s);return o===void 0&&(o={},e.set(s,o)),o}function i(s){e.delete(s)}function n(s,o,a){e.get(s)[o]=a}function r(){e=new WeakMap}return{get:t,remove:i,update:n,dispose:r}}function Yae(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Zk(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function $k(){const e=[];let t=0;const i=[],n=[],r=[];function s(){t=0,i.length=0,n.length=0,r.length=0}function o(u,d,f,p,g,m){let v=e[t];return v===void 0?(v={id:u.id,object:u,geometry:d,material:f,groupOrder:p,renderOrder:u.renderOrder,z:g,group:m},e[t]=v):(v.id=u.id,v.object=u,v.geometry=d,v.material=f,v.groupOrder=p,v.renderOrder=u.renderOrder,v.z=g,v.group=m),t++,v}function a(u,d,f,p,g,m){const v=o(u,d,f,p,g,m);f.transmission>0?n.push(v):f.transparent===!0?r.push(v):i.push(v)}function l(u,d,f,p,g,m){const v=o(u,d,f,p,g,m);f.transmission>0?n.unshift(v):f.transparent===!0?r.unshift(v):i.unshift(v)}function c(u,d){i.length>1&&i.sort(u||Yae),n.length>1&&n.sort(d||Zk),r.length>1&&r.sort(d||Zk)}function h(){for(let u=t,d=e.length;u<d;u++){const f=e[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:i,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:h,sort:c}}function qae(){let e=new WeakMap;function t(n,r){const s=e.get(n);let o;return s===void 0?(o=new $k,e.set(n,[o])):r>=s.length?(o=new $k,s.push(o)):o=s[r],o}function i(){e=new WeakMap}return{get:t,dispose:i}}function Qae(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={direction:new te,color:new ct};break;case"SpotLight":i={position:new te,direction:new te,color:new ct,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new te,color:new ct,distance:0,decay:0};break;case"HemisphereLight":i={direction:new te,skyColor:new ct,groundColor:new ct};break;case"RectAreaLight":i={color:new ct,position:new te,halfWidth:new te,halfHeight:new te};break}return e[t.id]=i,i}}}function Jae(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ve};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ve};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ve,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=i,i}}}let Kae=0;function Zae(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function $ae(e,t){const i=new Qae,n=Jae(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)r.probe.push(new te);const s=new te,o=new Nt,a=new Nt;function l(h,u){let d=0,f=0,p=0;for(let B=0;B<9;B++)r.probe[B].set(0,0,0);let g=0,m=0,v=0,x=0,w=0,b=0,M=0,A=0,T=0,S=0;h.sort(Zae);const C=u!==!0?Math.PI:1;for(let B=0,k=h.length;B<k;B++){const z=h[B],F=z.color,W=z.intensity,K=z.distance,Z=z.shadow&&z.shadow.map?z.shadow.map.texture:null;if(z.isAmbientLight)d+=F.r*W*C,f+=F.g*W*C,p+=F.b*W*C;else if(z.isLightProbe)for(let U=0;U<9;U++)r.probe[U].addScaledVector(z.sh.coefficients[U],W);else if(z.isDirectionalLight){const U=i.get(z);if(U.color.copy(z.color).multiplyScalar(z.intensity*C),z.castShadow){const X=z.shadow,V=n.get(z);V.shadowBias=X.bias,V.shadowNormalBias=X.normalBias,V.shadowRadius=X.radius,V.shadowMapSize=X.mapSize,r.directionalShadow[g]=V,r.directionalShadowMap[g]=Z,r.directionalShadowMatrix[g]=z.shadow.matrix,b++}r.directional[g]=U,g++}else if(z.isSpotLight){const U=i.get(z);U.position.setFromMatrixPosition(z.matrixWorld),U.color.copy(F).multiplyScalar(W*C),U.distance=K,U.coneCos=Math.cos(z.angle),U.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),U.decay=z.decay,r.spot[v]=U;const X=z.shadow;if(z.map&&(r.spotLightMap[T]=z.map,T++,X.updateMatrices(z),z.castShadow&&S++),r.spotLightMatrix[v]=X.matrix,z.castShadow){const V=n.get(z);V.shadowBias=X.bias,V.shadowNormalBias=X.normalBias,V.shadowRadius=X.radius,V.shadowMapSize=X.mapSize,r.spotShadow[v]=V,r.spotShadowMap[v]=Z,A++}v++}else if(z.isRectAreaLight){const U=i.get(z);U.color.copy(F).multiplyScalar(W),U.halfWidth.set(z.width*.5,0,0),U.halfHeight.set(0,z.height*.5,0),r.rectArea[x]=U,x++}else if(z.isPointLight){const U=i.get(z);if(U.color.copy(z.color).multiplyScalar(z.intensity*C),U.distance=z.distance,U.decay=z.decay,z.castShadow){const X=z.shadow,V=n.get(z);V.shadowBias=X.bias,V.shadowNormalBias=X.normalBias,V.shadowRadius=X.radius,V.shadowMapSize=X.mapSize,V.shadowCameraNear=X.camera.near,V.shadowCameraFar=X.camera.far,r.pointShadow[m]=V,r.pointShadowMap[m]=Z,r.pointShadowMatrix[m]=z.shadow.matrix,M++}r.point[m]=U,m++}else if(z.isHemisphereLight){const U=i.get(z);U.skyColor.copy(z.color).multiplyScalar(W*C),U.groundColor.copy(z.groundColor).multiplyScalar(W*C),r.hemi[w]=U,w++}}x>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=rt.LTC_FLOAT_1,r.rectAreaLTC2=rt.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=rt.LTC_HALF_1,r.rectAreaLTC2=rt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const P=r.hash;(P.directionalLength!==g||P.pointLength!==m||P.spotLength!==v||P.rectAreaLength!==x||P.hemiLength!==w||P.numDirectionalShadows!==b||P.numPointShadows!==M||P.numSpotShadows!==A||P.numSpotMaps!==T)&&(r.directional.length=g,r.spot.length=v,r.rectArea.length=x,r.point.length=m,r.hemi.length=w,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=M,r.pointShadowMap.length=M,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=M,r.spotLightMatrix.length=A+T-S,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=S,P.directionalLength=g,P.pointLength=m,P.spotLength=v,P.rectAreaLength=x,P.hemiLength=w,P.numDirectionalShadows=b,P.numPointShadows=M,P.numSpotShadows=A,P.numSpotMaps=T,r.version=Kae++)}function c(h,u){let d=0,f=0,p=0,g=0,m=0;const v=u.matrixWorldInverse;for(let x=0,w=h.length;x<w;x++){const b=h[x];if(b.isDirectionalLight){const M=r.directional[d];M.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(v),d++}else if(b.isSpotLight){const M=r.spot[p];M.position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(v),M.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(v),p++}else if(b.isRectAreaLight){const M=r.rectArea[g];M.position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(v),a.identity(),o.copy(b.matrixWorld),o.premultiply(v),a.extractRotation(o),M.halfWidth.set(b.width*.5,0,0),M.halfHeight.set(0,b.height*.5,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),g++}else if(b.isPointLight){const M=r.point[f];M.position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(v),f++}else if(b.isHemisphereLight){const M=r.hemi[m];M.direction.setFromMatrixPosition(b.matrixWorld),M.direction.transformDirection(v),m++}}}return{setup:l,setupView:c,state:r}}function eU(e,t){const i=new $ae(e,t),n=[],r=[];function s(){n.length=0,r.length=0}function o(u){n.push(u)}function a(u){r.push(u)}function l(u){i.setup(n,u)}function c(u){i.setupView(n,u)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function ele(e,t){let i=new WeakMap;function n(s,o=0){const a=i.get(s);let l;return a===void 0?(l=new eU(e,t),i.set(s,[l])):o>=a.length?(l=new eU(e,t),a.push(l)):l=a[o],l}function r(){i=new WeakMap}return{get:n,dispose:r}}class VR extends Gn{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=a7,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class jR extends Gn{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new te,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}const tle=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,ile=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function nle(e,t,i){let n=new CM;const r=new Ve,s=new Ve,o=new Ci,a=new VR({depthPacking:l7}),l=new jR,c={},h=i.maxTextureSize,u={[Xl]:Vs,[Vs]:Xl,[za]:za},d=new ql({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ve},radius:{value:4}},vertexShader:tle,fragmentShader:ile}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new Qt;p.setAttribute("position",new wi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new $n(p,d),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=bM,this.render=function(b,M,A){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||b.length===0)return;const T=e.getRenderTarget(),S=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),P=e.state;P.setBlending(Qc),P.buffers.color.setClear(1,1,1,1),P.buffers.depth.setTest(!0),P.setScissorTest(!1);for(let B=0,k=b.length;B<k;B++){const z=b[B],F=z.shadow;if(F===void 0){console.warn("THREE.WebGLShadowMap:",z,"has no shadow.");continue}if(F.autoUpdate===!1&&F.needsUpdate===!1)continue;r.copy(F.mapSize);const W=F.getFrameExtents();if(r.multiply(W),s.copy(F.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/W.x),r.x=s.x*W.x,F.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/W.y),r.y=s.y*W.y,F.mapSize.y=s.y)),F.map===null){const Z=this.type!==$d?{minFilter:gn,magFilter:gn}:{};F.map=new Ja(r.x,r.y,Z),F.map.texture.name=z.name+".shadowMap",F.camera.updateProjectionMatrix()}e.setRenderTarget(F.map),e.clear();const K=F.getViewportCount();for(let Z=0;Z<K;Z++){const U=F.getViewport(Z);o.set(s.x*U.x,s.y*U.y,s.x*U.z,s.y*U.w),P.viewport(o),F.updateMatrices(z,Z),n=F.getFrustum(),w(M,A,F.camera,z,this.type)}F.isPointLightShadow!==!0&&this.type===$d&&v(F,A),F.needsUpdate=!1}m.needsUpdate=!1,e.setRenderTarget(T,S,C)};function v(b,M){const A=t.update(g);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new Ja(r.x,r.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,e.setRenderTarget(b.mapPass),e.clear(),e.renderBufferDirect(M,null,A,d,g,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,e.setRenderTarget(b.map),e.clear(),e.renderBufferDirect(M,null,A,f,g,null)}function x(b,M,A,T,S,C){let P=null;const B=A.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(B!==void 0)P=B;else if(P=A.isPointLight===!0?l:a,e.localClippingEnabled&&M.clipShadows===!0&&Array.isArray(M.clippingPlanes)&&M.clippingPlanes.length!==0||M.displacementMap&&M.displacementScale!==0||M.alphaMap&&M.alphaTest>0||M.map&&M.alphaTest>0){const k=P.uuid,z=M.uuid;let F=c[k];F===void 0&&(F={},c[k]=F);let W=F[z];W===void 0&&(W=P.clone(),F[z]=W),P=W}return P.visible=M.visible,P.wireframe=M.wireframe,C===$d?P.side=M.shadowSide!==null?M.shadowSide:M.side:P.side=M.shadowSide!==null?M.shadowSide:u[M.side],P.alphaMap=M.alphaMap,P.alphaTest=M.alphaTest,P.map=M.map,P.clipShadows=M.clipShadows,P.clippingPlanes=M.clippingPlanes,P.clipIntersection=M.clipIntersection,P.displacementMap=M.displacementMap,P.displacementScale=M.displacementScale,P.displacementBias=M.displacementBias,P.wireframeLinewidth=M.wireframeLinewidth,P.linewidth=M.linewidth,A.isPointLight===!0&&P.isMeshDistanceMaterial===!0&&(P.referencePosition.setFromMatrixPosition(A.matrixWorld),P.nearDistance=T,P.farDistance=S),P}function w(b,M,A,T,S){if(b.visible===!1)return;if(b.layers.test(M.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&S===$d)&&(!b.frustumCulled||n.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,b.matrixWorld);const B=t.update(b),k=b.material;if(Array.isArray(k)){const z=B.groups;for(let F=0,W=z.length;F<W;F++){const K=z[F],Z=k[K.materialIndex];if(Z&&Z.visible){const U=x(b,Z,T,A.near,A.far,S);e.renderBufferDirect(A,null,B,U,b,K)}}}else if(k.visible){const z=x(b,k,T,A.near,A.far,S);e.renderBufferDirect(A,null,B,z,b,null)}}const P=b.children;for(let B=0,k=P.length;B<k;B++)w(P[B],M,A,T,S)}}function rle(e,t,i){const n=i.isWebGL2;function r(){let Y=!1;const oe=new Ci;let ye=null;const Fe=new Ci(0,0,0,0);return{setMask:function(Xe){ye!==Xe&&!Y&&(e.colorMask(Xe,Xe,Xe,Xe),ye=Xe)},setLocked:function(Xe){Y=Xe},setClear:function(Xe,pt,ei,ui,ar){ar===!0&&(Xe*=ui,pt*=ui,ei*=ui),oe.set(Xe,pt,ei,ui),Fe.equals(oe)===!1&&(e.clearColor(Xe,pt,ei,ui),Fe.copy(oe))},reset:function(){Y=!1,ye=null,Fe.set(-1,0,0,0)}}}function s(){let Y=!1,oe=null,ye=null,Fe=null;return{setTest:function(Xe){Xe?ve(2929):pe(2929)},setMask:function(Xe){oe!==Xe&&!Y&&(e.depthMask(Xe),oe=Xe)},setFunc:function(Xe){if(ye!==Xe){switch(Xe){case P9:e.depthFunc(512);break;case D9:e.depthFunc(519);break;case B9:e.depthFunc(513);break;case QA:e.depthFunc(515);break;case L9:e.depthFunc(514);break;case R9:e.depthFunc(518);break;case I9:e.depthFunc(516);break;case O9:e.depthFunc(517);break;default:e.depthFunc(515)}ye=Xe}},setLocked:function(Xe){Y=Xe},setClear:function(Xe){Fe!==Xe&&(e.clearDepth(Xe),Fe=Xe)},reset:function(){Y=!1,oe=null,ye=null,Fe=null}}}function o(){let Y=!1,oe=null,ye=null,Fe=null,Xe=null,pt=null,ei=null,ui=null,ar=null;return{setTest:function(Dt){Y||(Dt?ve(2960):pe(2960))},setMask:function(Dt){oe!==Dt&&!Y&&(e.stencilMask(Dt),oe=Dt)},setFunc:function(Dt,un,Oi){(ye!==Dt||Fe!==un||Xe!==Oi)&&(e.stencilFunc(Dt,un,Oi),ye=Dt,Fe=un,Xe=Oi)},setOp:function(Dt,un,Oi){(pt!==Dt||ei!==un||ui!==Oi)&&(e.stencilOp(Dt,un,Oi),pt=Dt,ei=un,ui=Oi)},setLocked:function(Dt){Y=Dt},setClear:function(Dt){ar!==Dt&&(e.clearStencil(Dt),ar=Dt)},reset:function(){Y=!1,oe=null,ye=null,Fe=null,Xe=null,pt=null,ei=null,ui=null,ar=null}}}const a=new r,l=new s,c=new o,h=new WeakMap,u=new WeakMap;let d={},f={},p=new WeakMap,g=[],m=null,v=!1,x=null,w=null,b=null,M=null,A=null,T=null,S=null,C=!1,P=null,B=null,k=null,z=null,F=null;const W=e.getParameter(35661);let K=!1,Z=0;const U=e.getParameter(7938);U.indexOf("WebGL")!==-1?(Z=parseFloat(/^WebGL (\d)/.exec(U)[1]),K=Z>=1):U.indexOf("OpenGL ES")!==-1&&(Z=parseFloat(/^OpenGL ES (\d)/.exec(U)[1]),K=Z>=2);let X=null,V={};const q=e.getParameter(3088),H=e.getParameter(2978),Q=new Ci().fromArray(q),J=new Ci().fromArray(H);function le(Y,oe,ye){const Fe=new Uint8Array(4),Xe=e.createTexture();e.bindTexture(Y,Xe),e.texParameteri(Y,10241,9728),e.texParameteri(Y,10240,9728);for(let pt=0;pt<ye;pt++)e.texImage2D(oe+pt,0,6408,1,1,0,6408,5121,Fe);return Xe}const j={};j[3553]=le(3553,3553,1),j[34067]=le(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ve(2929),l.setFunc(QA),Le(!1),ze(GD),ve(2884),be(Qc);function ve(Y){d[Y]!==!0&&(e.enable(Y),d[Y]=!0)}function pe(Y){d[Y]!==!1&&(e.disable(Y),d[Y]=!1)}function me(Y,oe){return f[Y]!==oe?(e.bindFramebuffer(Y,oe),f[Y]=oe,n&&(Y===36009&&(f[36160]=oe),Y===36160&&(f[36009]=oe)),!0):!1}function de(Y,oe){let ye=g,Fe=!1;if(Y)if(ye=p.get(oe),ye===void 0&&(ye=[],p.set(oe,ye)),Y.isWebGLMultipleRenderTargets){const Xe=Y.texture;if(ye.length!==Xe.length||ye[0]!==36064){for(let pt=0,ei=Xe.length;pt<ei;pt++)ye[pt]=36064+pt;ye.length=Xe.length,Fe=!0}}else ye[0]!==36064&&(ye[0]=36064,Fe=!0);else ye[0]!==1029&&(ye[0]=1029,Fe=!0);Fe&&(i.isWebGL2?e.drawBuffers(ye):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(ye))}function Se(Y){return m!==Y?(e.useProgram(Y),m=Y,!0):!1}const ce={[Hd]:32774,[y9]:32778,[x9]:32779};if(n)ce[WD]=32775,ce[XD]=32776;else{const Y=t.get("EXT_blend_minmax");Y!==null&&(ce[WD]=Y.MIN_EXT,ce[XD]=Y.MAX_EXT)}const se={[w9]:0,[_9]:1,[b9]:768,[TR]:770,[T9]:776,[E9]:774,[S9]:772,[A9]:769,[PR]:771,[C9]:775,[M9]:773};function be(Y,oe,ye,Fe,Xe,pt,ei,ui){if(Y===Qc){v===!0&&(pe(3042),v=!1);return}if(v===!1&&(ve(3042),v=!0),Y!==v9){if(Y!==x||ui!==C){if((w!==Hd||A!==Hd)&&(e.blendEquation(32774),w=Hd,A=Hd),ui)switch(Y){case df:e.blendFuncSeparate(1,771,1,771);break;case HD:e.blendFunc(1,1);break;case VD:e.blendFuncSeparate(0,769,0,1);break;case jD:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Y);break}else switch(Y){case df:e.blendFuncSeparate(770,771,1,771);break;case HD:e.blendFunc(770,1);break;case VD:e.blendFuncSeparate(0,769,0,1);break;case jD:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Y);break}b=null,M=null,T=null,S=null,x=Y,C=ui}return}Xe=Xe||oe,pt=pt||ye,ei=ei||Fe,(oe!==w||Xe!==A)&&(e.blendEquationSeparate(ce[oe],ce[Xe]),w=oe,A=Xe),(ye!==b||Fe!==M||pt!==T||ei!==S)&&(e.blendFuncSeparate(se[ye],se[Fe],se[pt],se[ei]),b=ye,M=Fe,T=pt,S=ei),x=Y,C=!1}function Ee(Y,oe){Y.side===za?pe(2884):ve(2884);let ye=Y.side===Vs;oe&&(ye=!ye),Le(ye),Y.blending===df&&Y.transparent===!1?be(Qc):be(Y.blending,Y.blendEquation,Y.blendSrc,Y.blendDst,Y.blendEquationAlpha,Y.blendSrcAlpha,Y.blendDstAlpha,Y.premultipliedAlpha),l.setFunc(Y.depthFunc),l.setTest(Y.depthTest),l.setMask(Y.depthWrite),a.setMask(Y.colorWrite);const Fe=Y.stencilWrite;c.setTest(Fe),Fe&&(c.setMask(Y.stencilWriteMask),c.setFunc(Y.stencilFunc,Y.stencilRef,Y.stencilFuncMask),c.setOp(Y.stencilFail,Y.stencilZFail,Y.stencilZPass)),Ge(Y.polygonOffset,Y.polygonOffsetFactor,Y.polygonOffsetUnits),Y.alphaToCoverage===!0?ve(32926):pe(32926)}function Le(Y){P!==Y&&(Y?e.frontFace(2304):e.frontFace(2305),P=Y)}function ze(Y){Y!==p9?(ve(2884),Y!==B&&(Y===GD?e.cullFace(1029):Y===m9?e.cullFace(1028):e.cullFace(1032))):pe(2884),B=Y}function Oe(Y){Y!==k&&(K&&e.lineWidth(Y),k=Y)}function Ge(Y,oe,ye){Y?(ve(32823),(z!==oe||F!==ye)&&(e.polygonOffset(oe,ye),z=oe,F=ye)):pe(32823)}function tt(Y){Y?ve(3089):pe(3089)}function ot(Y){Y===void 0&&(Y=33984+W-1),X!==Y&&(e.activeTexture(Y),X=Y)}function N(Y,oe,ye){ye===void 0&&(X===null?ye=33984+W-1:ye=X);let Fe=V[ye];Fe===void 0&&(Fe={type:void 0,texture:void 0},V[ye]=Fe),(Fe.type!==Y||Fe.texture!==oe)&&(X!==ye&&(e.activeTexture(ye),X=ye),e.bindTexture(Y,oe||j[Y]),Fe.type=Y,Fe.texture=oe)}function R(){const Y=V[X];Y!==void 0&&Y.type!==void 0&&(e.bindTexture(Y.type,null),Y.type=void 0,Y.texture=void 0)}function ie(){try{e.compressedTexImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function xe(){try{e.compressedTexImage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function Me(){try{e.texSubImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function Te(){try{e.texSubImage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function qe(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function De(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function ue(){try{e.texStorage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function He(){try{e.texStorage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function ne(){try{e.texImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function we(){try{e.texImage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function Re(Y){Q.equals(Y)===!1&&(e.scissor(Y.x,Y.y,Y.z,Y.w),Q.copy(Y))}function Ne(Y){J.equals(Y)===!1&&(e.viewport(Y.x,Y.y,Y.z,Y.w),J.copy(Y))}function $e(Y,oe){let ye=u.get(oe);ye===void 0&&(ye=new WeakMap,u.set(oe,ye));let Fe=ye.get(Y);Fe===void 0&&(Fe=e.getUniformBlockIndex(oe,Y.name),ye.set(Y,Fe))}function xt(Y,oe){const Fe=u.get(oe).get(Y);h.get(oe)!==Fe&&(e.uniformBlockBinding(oe,Fe,Y.__bindingPointIndex),h.set(oe,Fe))}function kt(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),n===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},X=null,V={},f={},p=new WeakMap,g=[],m=null,v=!1,x=null,w=null,b=null,M=null,A=null,T=null,S=null,C=!1,P=null,B=null,k=null,z=null,F=null,Q.set(0,0,e.canvas.width,e.canvas.height),J.set(0,0,e.canvas.width,e.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:ve,disable:pe,bindFramebuffer:me,drawBuffers:de,useProgram:Se,setBlending:be,setMaterial:Ee,setFlipSided:Le,setCullFace:ze,setLineWidth:Oe,setPolygonOffset:Ge,setScissorTest:tt,activeTexture:ot,bindTexture:N,unbindTexture:R,compressedTexImage2D:ie,compressedTexImage3D:xe,texImage2D:ne,texImage3D:we,updateUBOMapping:$e,uniformBlockBinding:xt,texStorage2D:ue,texStorage3D:He,texSubImage2D:Me,texSubImage3D:Te,compressedTexSubImage2D:qe,compressedTexSubImage3D:De,scissor:Re,viewport:Ne,reset:kt}}function sle(e,t,i,n,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,u=r.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let g;const m=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(N,R){return v?new OffscreenCanvas(N,R):ax("canvas")}function w(N,R,ie,xe){let Me=1;if((N.width>xe||N.height>xe)&&(Me=xe/Math.max(N.width,N.height)),Me<1||R===!0)if(typeof HTMLImageElement<"u"&&N instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&N instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&N instanceof ImageBitmap){const Te=R?ZA:Math.floor,qe=Te(Me*N.width),De=Te(Me*N.height);g===void 0&&(g=x(qe,De));const ue=ie?x(qe,De):g;return ue.width=qe,ue.height=De,ue.getContext("2d").drawImage(N,0,0,qe,De),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+N.width+"x"+N.height+") to ("+qe+"x"+De+")."),ue}else return"data"in N&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+N.width+"x"+N.height+")."),N;return N}function b(N){return v3(N.width)&&v3(N.height)}function M(N){return a?!1:N.wrapS!==Mr||N.wrapT!==Mr||N.minFilter!==gn&&N.minFilter!==rn}function A(N,R){return N.generateMipmaps&&R&&N.minFilter!==gn&&N.minFilter!==rn}function T(N){e.generateMipmap(N)}function S(N,R,ie,xe,Me=!1){if(a===!1)return R;if(N!==null){if(e[N]!==void 0)return e[N];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+N+"'")}let Te=R;return R===6403&&(ie===5126&&(Te=33326),ie===5131&&(Te=33325),ie===5121&&(Te=33321)),R===33319&&(ie===5126&&(Te=33328),ie===5131&&(Te=33327),ie===5121&&(Te=33323)),R===6408&&(ie===5126&&(Te=34836),ie===5131&&(Te=34842),ie===5121&&(Te=xe===Gi&&Me===!1?35907:32856),ie===32819&&(Te=32854),ie===32820&&(Te=32855)),(Te===33325||Te===33326||Te===33327||Te===33328||Te===34842||Te===34836)&&t.get("EXT_color_buffer_float"),Te}function C(N,R,ie){return A(N,ie)===!0||N.isFramebufferTexture&&N.minFilter!==gn&&N.minFilter!==rn?Math.log2(Math.max(R.width,R.height))+1:N.mipmaps!==void 0&&N.mipmaps.length>0?N.mipmaps.length:N.isCompressedTexture&&Array.isArray(N.image)?R.mipmaps.length:1}function P(N){return N===gn||N===nx||N===Km?9728:9729}function B(N){const R=N.target;R.removeEventListener("dispose",B),z(R),R.isVideoTexture&&p.delete(R)}function k(N){const R=N.target;R.removeEventListener("dispose",k),W(R)}function z(N){const R=n.get(N);if(R.__webglInit===void 0)return;const ie=N.source,xe=m.get(ie);if(xe){const Me=xe[R.__cacheKey];Me.usedTimes--,Me.usedTimes===0&&F(N),Object.keys(xe).length===0&&m.delete(ie)}n.remove(N)}function F(N){const R=n.get(N);e.deleteTexture(R.__webglTexture);const ie=N.source,xe=m.get(ie);delete xe[R.__cacheKey],o.memory.textures--}function W(N){const R=N.texture,ie=n.get(N),xe=n.get(R);if(xe.__webglTexture!==void 0&&(e.deleteTexture(xe.__webglTexture),o.memory.textures--),N.depthTexture&&N.depthTexture.dispose(),N.isWebGLCubeRenderTarget)for(let Me=0;Me<6;Me++)e.deleteFramebuffer(ie.__webglFramebuffer[Me]),ie.__webglDepthbuffer&&e.deleteRenderbuffer(ie.__webglDepthbuffer[Me]);else{if(e.deleteFramebuffer(ie.__webglFramebuffer),ie.__webglDepthbuffer&&e.deleteRenderbuffer(ie.__webglDepthbuffer),ie.__webglMultisampledFramebuffer&&e.deleteFramebuffer(ie.__webglMultisampledFramebuffer),ie.__webglColorRenderbuffer)for(let Me=0;Me<ie.__webglColorRenderbuffer.length;Me++)ie.__webglColorRenderbuffer[Me]&&e.deleteRenderbuffer(ie.__webglColorRenderbuffer[Me]);ie.__webglDepthRenderbuffer&&e.deleteRenderbuffer(ie.__webglDepthRenderbuffer)}if(N.isWebGLMultipleRenderTargets)for(let Me=0,Te=R.length;Me<Te;Me++){const qe=n.get(R[Me]);qe.__webglTexture&&(e.deleteTexture(qe.__webglTexture),o.memory.textures--),n.remove(R[Me])}n.remove(R),n.remove(N)}let K=0;function Z(){K=0}function U(){const N=K;return N>=l&&console.warn("THREE.WebGLTextures: Trying to use "+N+" texture units while this GPU supports only "+l),K+=1,N}function X(N){const R=[];return R.push(N.wrapS),R.push(N.wrapT),R.push(N.wrapR||0),R.push(N.magFilter),R.push(N.minFilter),R.push(N.anisotropy),R.push(N.internalFormat),R.push(N.format),R.push(N.type),R.push(N.generateMipmaps),R.push(N.premultiplyAlpha),R.push(N.flipY),R.push(N.unpackAlignment),R.push(N.encoding),R.join()}function V(N,R){const ie=n.get(N);if(N.isVideoTexture&&tt(N),N.isRenderTargetTexture===!1&&N.version>0&&ie.__version!==N.version){const xe=N.image;if(xe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(xe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{pe(ie,N,R);return}}i.bindTexture(3553,ie.__webglTexture,33984+R)}function q(N,R){const ie=n.get(N);if(N.version>0&&ie.__version!==N.version){pe(ie,N,R);return}i.bindTexture(35866,ie.__webglTexture,33984+R)}function H(N,R){const ie=n.get(N);if(N.version>0&&ie.__version!==N.version){pe(ie,N,R);return}i.bindTexture(32879,ie.__webglTexture,33984+R)}function Q(N,R){const ie=n.get(N);if(N.version>0&&ie.__version!==N.version){me(ie,N,R);return}i.bindTexture(34067,ie.__webglTexture,33984+R)}const J={[Rh]:10497,[Mr]:33071,[bg]:33648},le={[gn]:9728,[nx]:9984,[Km]:9986,[rn]:9729,[SM]:9985,[Yl]:9987};function j(N,R,ie){if(ie?(e.texParameteri(N,10242,J[R.wrapS]),e.texParameteri(N,10243,J[R.wrapT]),(N===32879||N===35866)&&e.texParameteri(N,32882,J[R.wrapR]),e.texParameteri(N,10240,le[R.magFilter]),e.texParameteri(N,10241,le[R.minFilter])):(e.texParameteri(N,10242,33071),e.texParameteri(N,10243,33071),(N===32879||N===35866)&&e.texParameteri(N,32882,33071),(R.wrapS!==Mr||R.wrapT!==Mr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(N,10240,P(R.magFilter)),e.texParameteri(N,10241,P(R.minFilter)),R.minFilter!==gn&&R.minFilter!==rn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){const xe=t.get("EXT_texture_filter_anisotropic");if(R.magFilter===gn||R.minFilter!==Km&&R.minFilter!==Yl||R.type===Gc&&t.has("OES_texture_float_linear")===!1||a===!1&&R.type===Ag&&t.has("OES_texture_half_float_linear")===!1)return;(R.anisotropy>1||n.get(R).__currentAnisotropy)&&(e.texParameterf(N,xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(R.anisotropy,r.getMaxAnisotropy())),n.get(R).__currentAnisotropy=R.anisotropy)}}function ve(N,R){let ie=!1;N.__webglInit===void 0&&(N.__webglInit=!0,R.addEventListener("dispose",B));const xe=R.source;let Me=m.get(xe);Me===void 0&&(Me={},m.set(xe,Me));const Te=X(R);if(Te!==N.__cacheKey){Me[Te]===void 0&&(Me[Te]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,ie=!0),Me[Te].usedTimes++;const qe=Me[N.__cacheKey];qe!==void 0&&(Me[N.__cacheKey].usedTimes--,qe.usedTimes===0&&F(R)),N.__cacheKey=Te,N.__webglTexture=Me[Te].texture}return ie}function pe(N,R,ie){let xe=3553;(R.isDataArrayTexture||R.isCompressedArrayTexture)&&(xe=35866),R.isData3DTexture&&(xe=32879);const Me=ve(N,R),Te=R.source;i.bindTexture(xe,N.__webglTexture,33984+ie);const qe=n.get(Te);if(Te.version!==qe.__version||Me===!0){i.activeTexture(33984+ie),e.pixelStorei(37440,R.flipY),e.pixelStorei(37441,R.premultiplyAlpha),e.pixelStorei(3317,R.unpackAlignment),e.pixelStorei(37443,0);const De=M(R)&&b(R.image)===!1;let ue=w(R.image,De,!1,h);ue=ot(R,ue);const He=b(ue)||a,ne=s.convert(R.format,R.encoding);let we=s.convert(R.type),Re=S(R.internalFormat,ne,we,R.encoding,R.isVideoTexture);j(xe,R,He);let Ne;const $e=R.mipmaps,xt=a&&R.isVideoTexture!==!0,kt=qe.__version===void 0||Me===!0,Y=C(R,ue,He);if(R.isDepthTexture)Re=6402,a?R.type===Gc?Re=36012:R.type===lh?Re=33190:R.type===ff?Re=35056:Re=33189:R.type===Gc&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),R.format===Sh&&Re===6402&&R.type!==BR&&R.type!==lh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),R.type=lh,we=s.convert(R.type)),R.format===Lf&&Re===6402&&(Re=34041,R.type!==ff&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),R.type=ff,we=s.convert(R.type))),kt&&(xt?i.texStorage2D(3553,1,Re,ue.width,ue.height):i.texImage2D(3553,0,Re,ue.width,ue.height,0,ne,we,null));else if(R.isDataTexture)if($e.length>0&&He){xt&&kt&&i.texStorage2D(3553,Y,Re,$e[0].width,$e[0].height);for(let oe=0,ye=$e.length;oe<ye;oe++)Ne=$e[oe],xt?i.texSubImage2D(3553,oe,0,0,Ne.width,Ne.height,ne,we,Ne.data):i.texImage2D(3553,oe,Re,Ne.width,Ne.height,0,ne,we,Ne.data);R.generateMipmaps=!1}else xt?(kt&&i.texStorage2D(3553,Y,Re,ue.width,ue.height),i.texSubImage2D(3553,0,0,0,ue.width,ue.height,ne,we,ue.data)):i.texImage2D(3553,0,Re,ue.width,ue.height,0,ne,we,ue.data);else if(R.isCompressedTexture)if(R.isCompressedArrayTexture){xt&&kt&&i.texStorage3D(35866,Y,Re,$e[0].width,$e[0].height,ue.depth);for(let oe=0,ye=$e.length;oe<ye;oe++)Ne=$e[oe],R.format!==Ls?ne!==null?xt?i.compressedTexSubImage3D(35866,oe,0,0,0,Ne.width,Ne.height,ue.depth,ne,Ne.data,0,0):i.compressedTexImage3D(35866,oe,Re,Ne.width,Ne.height,ue.depth,0,Ne.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):xt?i.texSubImage3D(35866,oe,0,0,0,Ne.width,Ne.height,ue.depth,ne,we,Ne.data):i.texImage3D(35866,oe,Re,Ne.width,Ne.height,ue.depth,0,ne,we,Ne.data)}else{xt&&kt&&i.texStorage2D(3553,Y,Re,$e[0].width,$e[0].height);for(let oe=0,ye=$e.length;oe<ye;oe++)Ne=$e[oe],R.format!==Ls?ne!==null?xt?i.compressedTexSubImage2D(3553,oe,0,0,Ne.width,Ne.height,ne,Ne.data):i.compressedTexImage2D(3553,oe,Re,Ne.width,Ne.height,0,Ne.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):xt?i.texSubImage2D(3553,oe,0,0,Ne.width,Ne.height,ne,we,Ne.data):i.texImage2D(3553,oe,Re,Ne.width,Ne.height,0,ne,we,Ne.data)}else if(R.isDataArrayTexture)xt?(kt&&i.texStorage3D(35866,Y,Re,ue.width,ue.height,ue.depth),i.texSubImage3D(35866,0,0,0,0,ue.width,ue.height,ue.depth,ne,we,ue.data)):i.texImage3D(35866,0,Re,ue.width,ue.height,ue.depth,0,ne,we,ue.data);else if(R.isData3DTexture)xt?(kt&&i.texStorage3D(32879,Y,Re,ue.width,ue.height,ue.depth),i.texSubImage3D(32879,0,0,0,0,ue.width,ue.height,ue.depth,ne,we,ue.data)):i.texImage3D(32879,0,Re,ue.width,ue.height,ue.depth,0,ne,we,ue.data);else if(R.isFramebufferTexture){if(kt)if(xt)i.texStorage2D(3553,Y,Re,ue.width,ue.height);else{let oe=ue.width,ye=ue.height;for(let Fe=0;Fe<Y;Fe++)i.texImage2D(3553,Fe,Re,oe,ye,0,ne,we,null),oe>>=1,ye>>=1}}else if($e.length>0&&He){xt&&kt&&i.texStorage2D(3553,Y,Re,$e[0].width,$e[0].height);for(let oe=0,ye=$e.length;oe<ye;oe++)Ne=$e[oe],xt?i.texSubImage2D(3553,oe,0,0,ne,we,Ne):i.texImage2D(3553,oe,Re,ne,we,Ne);R.generateMipmaps=!1}else xt?(kt&&i.texStorage2D(3553,Y,Re,ue.width,ue.height),i.texSubImage2D(3553,0,0,0,ne,we,ue)):i.texImage2D(3553,0,Re,ne,we,ue);A(R,He)&&T(xe),qe.__version=Te.version,R.onUpdate&&R.onUpdate(R)}N.__version=R.version}function me(N,R,ie){if(R.image.length!==6)return;const xe=ve(N,R),Me=R.source;i.bindTexture(34067,N.__webglTexture,33984+ie);const Te=n.get(Me);if(Me.version!==Te.__version||xe===!0){i.activeTexture(33984+ie),e.pixelStorei(37440,R.flipY),e.pixelStorei(37441,R.premultiplyAlpha),e.pixelStorei(3317,R.unpackAlignment),e.pixelStorei(37443,0);const qe=R.isCompressedTexture||R.image[0].isCompressedTexture,De=R.image[0]&&R.image[0].isDataTexture,ue=[];for(let oe=0;oe<6;oe++)!qe&&!De?ue[oe]=w(R.image[oe],!1,!0,c):ue[oe]=De?R.image[oe].image:R.image[oe],ue[oe]=ot(R,ue[oe]);const He=ue[0],ne=b(He)||a,we=s.convert(R.format,R.encoding),Re=s.convert(R.type),Ne=S(R.internalFormat,we,Re,R.encoding),$e=a&&R.isVideoTexture!==!0,xt=Te.__version===void 0||xe===!0;let kt=C(R,He,ne);j(34067,R,ne);let Y;if(qe){$e&&xt&&i.texStorage2D(34067,kt,Ne,He.width,He.height);for(let oe=0;oe<6;oe++){Y=ue[oe].mipmaps;for(let ye=0;ye<Y.length;ye++){const Fe=Y[ye];R.format!==Ls?we!==null?$e?i.compressedTexSubImage2D(34069+oe,ye,0,0,Fe.width,Fe.height,we,Fe.data):i.compressedTexImage2D(34069+oe,ye,Ne,Fe.width,Fe.height,0,Fe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):$e?i.texSubImage2D(34069+oe,ye,0,0,Fe.width,Fe.height,we,Re,Fe.data):i.texImage2D(34069+oe,ye,Ne,Fe.width,Fe.height,0,we,Re,Fe.data)}}}else{Y=R.mipmaps,$e&&xt&&(Y.length>0&&kt++,i.texStorage2D(34067,kt,Ne,ue[0].width,ue[0].height));for(let oe=0;oe<6;oe++)if(De){$e?i.texSubImage2D(34069+oe,0,0,0,ue[oe].width,ue[oe].height,we,Re,ue[oe].data):i.texImage2D(34069+oe,0,Ne,ue[oe].width,ue[oe].height,0,we,Re,ue[oe].data);for(let ye=0;ye<Y.length;ye++){const Xe=Y[ye].image[oe].image;$e?i.texSubImage2D(34069+oe,ye+1,0,0,Xe.width,Xe.height,we,Re,Xe.data):i.texImage2D(34069+oe,ye+1,Ne,Xe.width,Xe.height,0,we,Re,Xe.data)}}else{$e?i.texSubImage2D(34069+oe,0,0,0,we,Re,ue[oe]):i.texImage2D(34069+oe,0,Ne,we,Re,ue[oe]);for(let ye=0;ye<Y.length;ye++){const Fe=Y[ye];$e?i.texSubImage2D(34069+oe,ye+1,0,0,we,Re,Fe.image[oe]):i.texImage2D(34069+oe,ye+1,Ne,we,Re,Fe.image[oe])}}}A(R,ne)&&T(34067),Te.__version=Me.version,R.onUpdate&&R.onUpdate(R)}N.__version=R.version}function de(N,R,ie,xe,Me){const Te=s.convert(ie.format,ie.encoding),qe=s.convert(ie.type),De=S(ie.internalFormat,Te,qe,ie.encoding);n.get(R).__hasExternalTextures||(Me===32879||Me===35866?i.texImage3D(Me,0,De,R.width,R.height,R.depth,0,Te,qe,null):i.texImage2D(Me,0,De,R.width,R.height,0,Te,qe,null)),i.bindFramebuffer(36160,N),Ge(R)?d.framebufferTexture2DMultisampleEXT(36160,xe,Me,n.get(ie).__webglTexture,0,Oe(R)):(Me===3553||Me>=34069&&Me<=34074)&&e.framebufferTexture2D(36160,xe,Me,n.get(ie).__webglTexture,0),i.bindFramebuffer(36160,null)}function Se(N,R,ie){if(e.bindRenderbuffer(36161,N),R.depthBuffer&&!R.stencilBuffer){let xe=33189;if(ie||Ge(R)){const Me=R.depthTexture;Me&&Me.isDepthTexture&&(Me.type===Gc?xe=36012:Me.type===lh&&(xe=33190));const Te=Oe(R);Ge(R)?d.renderbufferStorageMultisampleEXT(36161,Te,xe,R.width,R.height):e.renderbufferStorageMultisample(36161,Te,xe,R.width,R.height)}else e.renderbufferStorage(36161,xe,R.width,R.height);e.framebufferRenderbuffer(36160,36096,36161,N)}else if(R.depthBuffer&&R.stencilBuffer){const xe=Oe(R);ie&&Ge(R)===!1?e.renderbufferStorageMultisample(36161,xe,35056,R.width,R.height):Ge(R)?d.renderbufferStorageMultisampleEXT(36161,xe,35056,R.width,R.height):e.renderbufferStorage(36161,34041,R.width,R.height),e.framebufferRenderbuffer(36160,33306,36161,N)}else{const xe=R.isWebGLMultipleRenderTargets===!0?R.texture:[R.texture];for(let Me=0;Me<xe.length;Me++){const Te=xe[Me],qe=s.convert(Te.format,Te.encoding),De=s.convert(Te.type),ue=S(Te.internalFormat,qe,De,Te.encoding),He=Oe(R);ie&&Ge(R)===!1?e.renderbufferStorageMultisample(36161,He,ue,R.width,R.height):Ge(R)?d.renderbufferStorageMultisampleEXT(36161,He,ue,R.width,R.height):e.renderbufferStorage(36161,ue,R.width,R.height)}}e.bindRenderbuffer(36161,null)}function ce(N,R){if(R&&R.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,N),!(R.depthTexture&&R.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(R.depthTexture).__webglTexture||R.depthTexture.image.width!==R.width||R.depthTexture.image.height!==R.height)&&(R.depthTexture.image.width=R.width,R.depthTexture.image.height=R.height,R.depthTexture.needsUpdate=!0),V(R.depthTexture,0);const xe=n.get(R.depthTexture).__webglTexture,Me=Oe(R);if(R.depthTexture.format===Sh)Ge(R)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,xe,0,Me):e.framebufferTexture2D(36160,36096,3553,xe,0);else if(R.depthTexture.format===Lf)Ge(R)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,xe,0,Me):e.framebufferTexture2D(36160,33306,3553,xe,0);else throw new Error("Unknown depthTexture format")}function se(N){const R=n.get(N),ie=N.isWebGLCubeRenderTarget===!0;if(N.depthTexture&&!R.__autoAllocateDepthBuffer){if(ie)throw new Error("target.depthTexture not supported in Cube render targets");ce(R.__webglFramebuffer,N)}else if(ie){R.__webglDepthbuffer=[];for(let xe=0;xe<6;xe++)i.bindFramebuffer(36160,R.__webglFramebuffer[xe]),R.__webglDepthbuffer[xe]=e.createRenderbuffer(),Se(R.__webglDepthbuffer[xe],N,!1)}else i.bindFramebuffer(36160,R.__webglFramebuffer),R.__webglDepthbuffer=e.createRenderbuffer(),Se(R.__webglDepthbuffer,N,!1);i.bindFramebuffer(36160,null)}function be(N,R,ie){const xe=n.get(N);R!==void 0&&de(xe.__webglFramebuffer,N,N.texture,36064,3553),ie!==void 0&&se(N)}function Ee(N){const R=N.texture,ie=n.get(N),xe=n.get(R);N.addEventListener("dispose",k),N.isWebGLMultipleRenderTargets!==!0&&(xe.__webglTexture===void 0&&(xe.__webglTexture=e.createTexture()),xe.__version=R.version,o.memory.textures++);const Me=N.isWebGLCubeRenderTarget===!0,Te=N.isWebGLMultipleRenderTargets===!0,qe=b(N)||a;if(Me){ie.__webglFramebuffer=[];for(let De=0;De<6;De++)ie.__webglFramebuffer[De]=e.createFramebuffer()}else{if(ie.__webglFramebuffer=e.createFramebuffer(),Te)if(r.drawBuffers){const De=N.texture;for(let ue=0,He=De.length;ue<He;ue++){const ne=n.get(De[ue]);ne.__webglTexture===void 0&&(ne.__webglTexture=e.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&N.samples>0&&Ge(N)===!1){const De=Te?R:[R];ie.__webglMultisampledFramebuffer=e.createFramebuffer(),ie.__webglColorRenderbuffer=[],i.bindFramebuffer(36160,ie.__webglMultisampledFramebuffer);for(let ue=0;ue<De.length;ue++){const He=De[ue];ie.__webglColorRenderbuffer[ue]=e.createRenderbuffer(),e.bindRenderbuffer(36161,ie.__webglColorRenderbuffer[ue]);const ne=s.convert(He.format,He.encoding),we=s.convert(He.type),Re=S(He.internalFormat,ne,we,He.encoding,N.isXRRenderTarget===!0),Ne=Oe(N);e.renderbufferStorageMultisample(36161,Ne,Re,N.width,N.height),e.framebufferRenderbuffer(36160,36064+ue,36161,ie.__webglColorRenderbuffer[ue])}e.bindRenderbuffer(36161,null),N.depthBuffer&&(ie.__webglDepthRenderbuffer=e.createRenderbuffer(),Se(ie.__webglDepthRenderbuffer,N,!0)),i.bindFramebuffer(36160,null)}}if(Me){i.bindTexture(34067,xe.__webglTexture),j(34067,R,qe);for(let De=0;De<6;De++)de(ie.__webglFramebuffer[De],N,R,36064,34069+De);A(R,qe)&&T(34067),i.unbindTexture()}else if(Te){const De=N.texture;for(let ue=0,He=De.length;ue<He;ue++){const ne=De[ue],we=n.get(ne);i.bindTexture(3553,we.__webglTexture),j(3553,ne,qe),de(ie.__webglFramebuffer,N,ne,36064+ue,3553),A(ne,qe)&&T(3553)}i.unbindTexture()}else{let De=3553;(N.isWebGL3DRenderTarget||N.isWebGLArrayRenderTarget)&&(a?De=N.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(De,xe.__webglTexture),j(De,R,qe),de(ie.__webglFramebuffer,N,R,36064,De),A(R,qe)&&T(De),i.unbindTexture()}N.depthBuffer&&se(N)}function Le(N){const R=b(N)||a,ie=N.isWebGLMultipleRenderTargets===!0?N.texture:[N.texture];for(let xe=0,Me=ie.length;xe<Me;xe++){const Te=ie[xe];if(A(Te,R)){const qe=N.isWebGLCubeRenderTarget?34067:3553,De=n.get(Te).__webglTexture;i.bindTexture(qe,De),T(qe),i.unbindTexture()}}}function ze(N){if(a&&N.samples>0&&Ge(N)===!1){const R=N.isWebGLMultipleRenderTargets?N.texture:[N.texture],ie=N.width,xe=N.height;let Me=16384;const Te=[],qe=N.stencilBuffer?33306:36096,De=n.get(N),ue=N.isWebGLMultipleRenderTargets===!0;if(ue)for(let He=0;He<R.length;He++)i.bindFramebuffer(36160,De.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+He,36161,null),i.bindFramebuffer(36160,De.__webglFramebuffer),e.framebufferTexture2D(36009,36064+He,3553,null,0);i.bindFramebuffer(36008,De.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,De.__webglFramebuffer);for(let He=0;He<R.length;He++){Te.push(36064+He),N.depthBuffer&&Te.push(qe);const ne=De.__ignoreDepthValues!==void 0?De.__ignoreDepthValues:!1;if(ne===!1&&(N.depthBuffer&&(Me|=256),N.stencilBuffer&&(Me|=1024)),ue&&e.framebufferRenderbuffer(36008,36064,36161,De.__webglColorRenderbuffer[He]),ne===!0&&(e.invalidateFramebuffer(36008,[qe]),e.invalidateFramebuffer(36009,[qe])),ue){const we=n.get(R[He]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,we,0)}e.blitFramebuffer(0,0,ie,xe,0,0,ie,xe,Me,9728),f&&e.invalidateFramebuffer(36008,Te)}if(i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),ue)for(let He=0;He<R.length;He++){i.bindFramebuffer(36160,De.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+He,36161,De.__webglColorRenderbuffer[He]);const ne=n.get(R[He]).__webglTexture;i.bindFramebuffer(36160,De.__webglFramebuffer),e.framebufferTexture2D(36009,36064+He,3553,ne,0)}i.bindFramebuffer(36009,De.__webglMultisampledFramebuffer)}}function Oe(N){return Math.min(u,N.samples)}function Ge(N){const R=n.get(N);return a&&N.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&R.__useRenderToTexture!==!1}function tt(N){const R=o.render.frame;p.get(N)!==R&&(p.set(N,R),N.update())}function ot(N,R){const ie=N.encoding,xe=N.format,Me=N.type;return N.isCompressedTexture===!0||N.isVideoTexture===!0||N.format===KA||ie!==Ih&&(ie===Gi?a===!1?t.has("EXT_sRGB")===!0&&xe===Ls?(N.format=KA,N.minFilter=rn,N.generateMipmaps=!1):R=FR.sRGBToLinear(R):(xe!==Ls||Me!==su)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ie)),R}this.allocateTextureUnit=U,this.resetTextureUnits=Z,this.setTexture2D=V,this.setTexture2DArray=q,this.setTexture3D=H,this.setTextureCube=Q,this.rebindTextures=be,this.setupRenderTarget=Ee,this.updateRenderTargetMipmap=Le,this.updateMultisampleRenderTarget=ze,this.setupDepthRenderbuffer=se,this.setupFrameBufferTexture=de,this.useMultisampledRTT=Ge}function _7(e,t,i){const n=i.isWebGL2;function r(s,o=null){let a;if(s===su)return 5121;if(s===W9)return 32819;if(s===X9)return 32820;if(s===H9)return 5120;if(s===V9)return 5122;if(s===BR)return 5123;if(s===j9)return 5124;if(s===lh)return 5125;if(s===Gc)return 5126;if(s===Ag)return n?5131:(a=t.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===Y9)return 6406;if(s===Ls)return 6408;if(s===q9)return 6409;if(s===Q9)return 6410;if(s===Sh)return 6402;if(s===Lf)return 34041;if(s===KA)return a=t.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===J9)return 6403;if(s===K9)return 36244;if(s===Z9)return 33319;if(s===$9)return 33320;if(s===e7)return 36249;if(s===iA||s===nA||s===rA||s===sA)if(o===Gi)if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===iA)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===nA)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===rA)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===sA)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=t.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===iA)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===nA)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===rA)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===sA)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===YD||s===qD||s===QD||s===JD)if(a=t.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===YD)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===qD)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===QD)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===JD)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===t7)return a=t.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===KD||s===ZD)if(a=t.get("WEBGL_compressed_texture_etc"),a!==null){if(s===KD)return o===Gi?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===ZD)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===$D||s===e3||s===t3||s===i3||s===n3||s===r3||s===s3||s===o3||s===a3||s===l3||s===c3||s===u3||s===h3||s===d3)if(a=t.get("WEBGL_compressed_texture_astc"),a!==null){if(s===$D)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===e3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===t3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===i3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===n3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===r3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===s3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===o3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===a3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===l3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===c3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===u3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===h3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===d3)return o===Gi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===oA)if(a=t.get("EXT_texture_compression_bptc"),a!==null){if(s===oA)return o===Gi?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===i7||s===f3||s===p3||s===m3)if(a=t.get("EXT_texture_compression_rgtc"),a!==null){if(s===oA)return a.COMPRESSED_RED_RGTC1_EXT;if(s===f3)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===p3)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===m3)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===ff?n?34042:(a=t.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):e[s]!==void 0?e[s]:null}return{convert:r}}class b7 extends $i{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}class Vc extends fi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const ole={type:"move"};class yT{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Vc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Vc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new te,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new te),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Vc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new te,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new te),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const i=this._hand;if(i)for(const n of t.hand.values())this._getHandJoint(i,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,i,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(t&&i.session.visibilityState!=="visible-blurred"){if(c&&t.hand){o=!0;for(const g of t.hand.values()){const m=i.getJointPose(g,n),v=this._getHandJoint(c,g);m!==null&&(v.matrix.fromArray(m.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=m.radius),v.visible=m!==null}const h=c.joints["index-finger-tip"],u=c.joints["thumb-tip"],d=h.position.distanceTo(u.position),f=.02,p=.005;c.inputState.pinching&&d>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!c.inputState.pinching&&d<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else l!==null&&t.gripSpace&&(s=i.getPose(t.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=i.getPose(t.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(ole)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(t,i){if(t.joints[i.jointName]===void 0){const n=new Vc;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[i.jointName]=n,t.add(n)}return t.joints[i.jointName]}}class A7 extends en{constructor(t,i,n,r,s,o,a,l,c,h){if(h=h!==void 0?h:Sh,h!==Sh&&h!==Lf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&h===Sh&&(n=lh),n===void 0&&h===Lf&&(n=ff),super(null,r,s,o,a,l,h,n,c),this.isDepthTexture=!0,this.image={width:t,height:i},this.magFilter=a!==void 0?a:gn,this.minFilter=l!==void 0?l:gn,this.flipY=!1,this.generateMipmaps=!1}}class ale extends ec{constructor(t,i){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,h=null,u=null,d=null,f=null,p=null;const g=i.getContextAttributes();let m=null,v=null;const x=[],w=[],b=new Set,M=new Map,A=new $i;A.layers.enable(1),A.viewport=new Ci;const T=new $i;T.layers.enable(2),T.viewport=new Ci;const S=[A,T],C=new b7;C.layers.enable(1),C.layers.enable(2);let P=null,B=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(H){let Q=x[H];return Q===void 0&&(Q=new yT,x[H]=Q),Q.getTargetRaySpace()},this.getControllerGrip=function(H){let Q=x[H];return Q===void 0&&(Q=new yT,x[H]=Q),Q.getGripSpace()},this.getHand=function(H){let Q=x[H];return Q===void 0&&(Q=new yT,x[H]=Q),Q.getHandSpace()};function k(H){const Q=w.indexOf(H.inputSource);if(Q===-1)return;const J=x[Q];J!==void 0&&J.dispatchEvent({type:H.type,data:H.inputSource})}function z(){r.removeEventListener("select",k),r.removeEventListener("selectstart",k),r.removeEventListener("selectend",k),r.removeEventListener("squeeze",k),r.removeEventListener("squeezestart",k),r.removeEventListener("squeezeend",k),r.removeEventListener("end",z),r.removeEventListener("inputsourceschange",F);for(let H=0;H<x.length;H++){const Q=w[H];Q!==null&&(w[H]=null,x[H].disconnect(Q))}P=null,B=null,t.setRenderTarget(m),f=null,d=null,u=null,r=null,v=null,q.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(H){s=H,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(H){a=H,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(H){c=H},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(H){if(r=H,r!==null){if(m=t.getRenderTarget(),r.addEventListener("select",k),r.addEventListener("selectstart",k),r.addEventListener("selectend",k),r.addEventListener("squeeze",k),r.addEventListener("squeezestart",k),r.addEventListener("squeezeend",k),r.addEventListener("end",z),r.addEventListener("inputsourceschange",F),g.xrCompatible!==!0&&await i.makeXRCompatible(),r.renderState.layers===void 0||t.capabilities.isWebGL2===!1){const Q={antialias:r.renderState.layers===void 0?g.antialias:!0,alpha:g.alpha,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,i,Q),r.updateRenderState({baseLayer:f}),v=new Ja(f.framebufferWidth,f.framebufferHeight,{format:Ls,type:su,encoding:t.outputEncoding,stencilBuffer:g.stencil})}else{let Q=null,J=null,le=null;g.depth&&(le=g.stencil?35056:33190,Q=g.stencil?Lf:Sh,J=g.stencil?ff:lh);const j={colorFormat:32856,depthFormat:le,scaleFactor:s};u=new XRWebGLBinding(r,i),d=u.createProjectionLayer(j),r.updateRenderState({layers:[d]}),v=new Ja(d.textureWidth,d.textureHeight,{format:Ls,type:su,depthTexture:new A7(d.textureWidth,d.textureHeight,J,void 0,void 0,void 0,void 0,void 0,void 0,Q),stencilBuffer:g.stencil,encoding:t.outputEncoding,samples:g.antialias?4:0});const ve=t.properties.get(v);ve.__ignoreDepthValues=d.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),q.setContext(r),q.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};function F(H){for(let Q=0;Q<H.removed.length;Q++){const J=H.removed[Q],le=w.indexOf(J);le>=0&&(w[le]=null,x[le].disconnect(J))}for(let Q=0;Q<H.added.length;Q++){const J=H.added[Q];let le=w.indexOf(J);if(le===-1){for(let ve=0;ve<x.length;ve++)if(ve>=w.length){w.push(J),le=ve;break}else if(w[ve]===null){w[ve]=J,le=ve;break}if(le===-1)break}const j=x[le];j&&j.connect(J)}}const W=new te,K=new te;function Z(H,Q,J){W.setFromMatrixPosition(Q.matrixWorld),K.setFromMatrixPosition(J.matrixWorld);const le=W.distanceTo(K),j=Q.projectionMatrix.elements,ve=J.projectionMatrix.elements,pe=j[14]/(j[10]-1),me=j[14]/(j[10]+1),de=(j[9]+1)/j[5],Se=(j[9]-1)/j[5],ce=(j[8]-1)/j[0],se=(ve[8]+1)/ve[0],be=pe*ce,Ee=pe*se,Le=le/(-ce+se),ze=Le*-ce;Q.matrixWorld.decompose(H.position,H.quaternion,H.scale),H.translateX(ze),H.translateZ(Le),H.matrixWorld.compose(H.position,H.quaternion,H.scale),H.matrixWorldInverse.copy(H.matrixWorld).invert();const Oe=pe+Le,Ge=me+Le,tt=be-ze,ot=Ee+(le-ze),N=de*me/Ge*Oe,R=Se*me/Ge*Oe;H.projectionMatrix.makePerspective(tt,ot,N,R,Oe,Ge)}function U(H,Q){Q===null?H.matrixWorld.copy(H.matrix):H.matrixWorld.multiplyMatrices(Q.matrixWorld,H.matrix),H.matrixWorldInverse.copy(H.matrixWorld).invert()}this.updateCamera=function(H){if(r===null)return;C.near=T.near=A.near=H.near,C.far=T.far=A.far=H.far,(P!==C.near||B!==C.far)&&(r.updateRenderState({depthNear:C.near,depthFar:C.far}),P=C.near,B=C.far);const Q=H.parent,J=C.cameras;U(C,Q);for(let j=0;j<J.length;j++)U(J[j],Q);C.matrixWorld.decompose(C.position,C.quaternion,C.scale),H.matrix.copy(C.matrix),H.matrix.decompose(H.position,H.quaternion,H.scale);const le=H.children;for(let j=0,ve=le.length;j<ve;j++)le[j].updateMatrixWorld(!0);J.length===2?Z(C,A,T):C.projectionMatrix.copy(A.projectionMatrix)},this.getCamera=function(){return C},this.getFoveation=function(){if(!(d===null&&f===null))return l},this.setFoveation=function(H){l=H,d!==null&&(d.fixedFoveation=H),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=H)},this.getPlanes=function(){return b};let X=null;function V(H,Q){if(h=Q.getViewerPose(c||o),p=Q,h!==null){const J=h.views;f!==null&&(t.setRenderTargetFramebuffer(v,f.framebuffer),t.setRenderTarget(v));let le=!1;J.length!==C.cameras.length&&(C.cameras.length=0,le=!0);for(let j=0;j<J.length;j++){const ve=J[j];let pe=null;if(f!==null)pe=f.getViewport(ve);else{const de=u.getViewSubImage(d,ve);pe=de.viewport,j===0&&(t.setRenderTargetTextures(v,de.colorTexture,d.ignoreDepthValues?void 0:de.depthStencilTexture),t.setRenderTarget(v))}let me=S[j];me===void 0&&(me=new $i,me.layers.enable(j),me.viewport=new Ci,S[j]=me),me.matrix.fromArray(ve.transform.matrix),me.projectionMatrix.fromArray(ve.projectionMatrix),me.viewport.set(pe.x,pe.y,pe.width,pe.height),j===0&&C.matrix.copy(me.matrix),le===!0&&C.cameras.push(me)}}for(let J=0;J<x.length;J++){const le=w[J],j=x[J];le!==null&&j!==void 0&&j.update(le,Q,c||o)}if(X&&X(H,Q),Q.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:Q.detectedPlanes});let J=null;for(const le of b)Q.detectedPlanes.has(le)||(J===null&&(J=[]),J.push(le));if(J!==null)for(const le of J)b.delete(le),M.delete(le),n.dispatchEvent({type:"planeremoved",data:le});for(const le of Q.detectedPlanes)if(!b.has(le))b.add(le),M.set(le,Q.lastChangedTime),n.dispatchEvent({type:"planeadded",data:le});else{const j=M.get(le);le.lastChangedTime>j&&(M.set(le,le.lastChangedTime),n.dispatchEvent({type:"planechanged",data:le}))}}p=null}const q=new g7;q.setAnimationLoop(V),this.setAnimationLoop=function(H){X=H},this.dispose=function(){}}}function lle(e,t){function i(g,m){m.color.getRGB(g.fogColor.value,p7(e)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)}function n(g,m,v,x,w){m.isMeshBasicMaterial||m.isMeshLambertMaterial?r(g,m):m.isMeshToonMaterial?(r(g,m),h(g,m)):m.isMeshPhongMaterial?(r(g,m),c(g,m)):m.isMeshStandardMaterial?(r(g,m),u(g,m),m.isMeshPhysicalMaterial&&d(g,m,w)):m.isMeshMatcapMaterial?(r(g,m),f(g,m)):m.isMeshDepthMaterial?r(g,m):m.isMeshDistanceMaterial?(r(g,m),p(g,m)):m.isMeshNormalMaterial?r(g,m):m.isLineBasicMaterial?(s(g,m),m.isLineDashedMaterial&&o(g,m)):m.isPointsMaterial?a(g,m,v,x):m.isSpriteMaterial?l(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function r(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.bumpMap&&(g.bumpMap.value=m.bumpMap,g.bumpScale.value=m.bumpScale,m.side===Vs&&(g.bumpScale.value*=-1)),m.displacementMap&&(g.displacementMap.value=m.displacementMap,g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap),m.normalMap&&(g.normalMap.value=m.normalMap,g.normalScale.value.copy(m.normalScale),m.side===Vs&&g.normalScale.value.negate()),m.specularMap&&(g.specularMap.value=m.specularMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);const v=t.get(m).envMap;if(v&&(g.envMap.value=v,g.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;const b=e.physicallyCorrectLights!==!0?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*b}m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity);let x;m.map?x=m.map:m.specularMap?x=m.specularMap:m.displacementMap?x=m.displacementMap:m.normalMap?x=m.normalMap:m.bumpMap?x=m.bumpMap:m.roughnessMap?x=m.roughnessMap:m.metalnessMap?x=m.metalnessMap:m.alphaMap?x=m.alphaMap:m.emissiveMap?x=m.emissiveMap:m.clearcoatMap?x=m.clearcoatMap:m.clearcoatNormalMap?x=m.clearcoatNormalMap:m.clearcoatRoughnessMap?x=m.clearcoatRoughnessMap:m.iridescenceMap?x=m.iridescenceMap:m.iridescenceThicknessMap?x=m.iridescenceThicknessMap:m.specularIntensityMap?x=m.specularIntensityMap:m.specularColorMap?x=m.specularColorMap:m.transmissionMap?x=m.transmissionMap:m.thicknessMap?x=m.thicknessMap:m.sheenColorMap?x=m.sheenColorMap:m.sheenRoughnessMap&&(x=m.sheenRoughnessMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),g.uvTransform.value.copy(x.matrix));let w;m.aoMap?w=m.aoMap:m.lightMap&&(w=m.lightMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),g.uv2Transform.value.copy(w.matrix))}function s(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity}function o(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}function a(g,m,v,x){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*v,g.scale.value=x*.5,m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);let w;m.map?w=m.map:m.alphaMap&&(w=m.alphaMap),w!==void 0&&(w.matrixAutoUpdate===!0&&w.updateMatrix(),g.uvTransform.value.copy(w.matrix))}function l(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);let v;m.map?v=m.map:m.alphaMap&&(v=m.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),g.uvTransform.value.copy(v.matrix))}function c(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}function h(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}function u(g,m){g.roughness.value=m.roughness,g.metalness.value=m.metalness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap),t.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}function d(g,m,v){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),g.clearcoatNormalMap.value=m.clearcoatNormalMap,m.side===Vs&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap)),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=v.texture,g.transmissionSamplerSize.value.set(v.width,v.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap)}function f(g,m){m.matcap&&(g.matcap.value=m.matcap)}function p(g,m){g.referencePosition.value.copy(m.referencePosition),g.nearDistance.value=m.nearDistance,g.farDistance.value=m.farDistance}return{refreshFogUniforms:i,refreshMaterialUniforms:n}}function cle(e,t,i,n){let r={},s={},o=[];const a=i.isWebGL2?e.getParameter(35375):0;function l(x,w){const b=w.program;n.uniformBlockBinding(x,b)}function c(x,w){let b=r[x.id];b===void 0&&(p(x),b=h(x),r[x.id]=b,x.addEventListener("dispose",m));const M=w.program;n.updateUBOMapping(x,M);const A=t.render.frame;s[x.id]!==A&&(d(x),s[x.id]=A)}function h(x){const w=u();x.__bindingPointIndex=w;const b=e.createBuffer(),M=x.__size,A=x.usage;return e.bindBuffer(35345,b),e.bufferData(35345,M,A),e.bindBuffer(35345,null),e.bindBufferBase(35345,w,b),b}function u(){for(let x=0;x<a;x++)if(o.indexOf(x)===-1)return o.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(x){const w=r[x.id],b=x.uniforms,M=x.__cache;e.bindBuffer(35345,w);for(let A=0,T=b.length;A<T;A++){const S=b[A];if(f(S,A,M)===!0){const C=S.__offset,P=Array.isArray(S.value)?S.value:[S.value];let B=0;for(let k=0;k<P.length;k++){const z=P[k],F=g(z);typeof z=="number"?(S.__data[0]=z,e.bufferSubData(35345,C+B,S.__data)):z.isMatrix3?(S.__data[0]=z.elements[0],S.__data[1]=z.elements[1],S.__data[2]=z.elements[2],S.__data[3]=z.elements[0],S.__data[4]=z.elements[3],S.__data[5]=z.elements[4],S.__data[6]=z.elements[5],S.__data[7]=z.elements[0],S.__data[8]=z.elements[6],S.__data[9]=z.elements[7],S.__data[10]=z.elements[8],S.__data[11]=z.elements[0]):(z.toArray(S.__data,B),B+=F.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,C,S.__data)}}e.bindBuffer(35345,null)}function f(x,w,b){const M=x.value;if(b[w]===void 0){if(typeof M=="number")b[w]=M;else{const A=Array.isArray(M)?M:[M],T=[];for(let S=0;S<A.length;S++)T.push(A[S].clone());b[w]=T}return!0}else if(typeof M=="number"){if(b[w]!==M)return b[w]=M,!0}else{const A=Array.isArray(b[w])?b[w]:[b[w]],T=Array.isArray(M)?M:[M];for(let S=0;S<A.length;S++){const C=A[S];if(C.equals(T[S])===!1)return C.copy(T[S]),!0}}return!1}function p(x){const w=x.uniforms;let b=0;const M=16;let A=0;for(let T=0,S=w.length;T<S;T++){const C=w[T],P={boundary:0,storage:0},B=Array.isArray(C.value)?C.value:[C.value];for(let k=0,z=B.length;k<z;k++){const F=B[k],W=g(F);P.boundary+=W.boundary,P.storage+=W.storage}if(C.__data=new Float32Array(P.storage/Float32Array.BYTES_PER_ELEMENT),C.__offset=b,T>0){A=b%M;const k=M-A;A!==0&&k-P.boundary<0&&(b+=M-A,C.__offset=b)}b+=P.storage}return A=b%M,A>0&&(b+=M-A),x.__size=b,x.__cache={},this}function g(x){const w={boundary:0,storage:0};return typeof x=="number"?(w.boundary=4,w.storage=4):x.isVector2?(w.boundary=8,w.storage=8):x.isVector3||x.isColor?(w.boundary=16,w.storage=12):x.isVector4?(w.boundary=16,w.storage=16):x.isMatrix3?(w.boundary=48,w.storage=48):x.isMatrix4?(w.boundary=64,w.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),w}function m(x){const w=x.target;w.removeEventListener("dispose",m);const b=o.indexOf(w.__bindingPointIndex);o.splice(b,1),e.deleteBuffer(r[w.id]),delete r[w.id],delete s[w.id]}function v(){for(const x in r)e.deleteBuffer(r[x]);o=[],r={},s={}}return{bind:l,update:c,dispose:v}}function ule(){const e=ax("canvas");return e.style.display="block",e}function WR(e={}){this.isWebGLRenderer=!0;const t=e.canvas!==void 0?e.canvas:ule(),i=e.context!==void 0?e.context:null,n=e.depth!==void 0?e.depth:!0,r=e.stencil!==void 0?e.stencil:!0,s=e.antialias!==void 0?e.antialias:!1,o=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,a=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",c=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1;let h;i!==null?h=i.getContextAttributes().alpha:h=e.alpha!==void 0?e.alpha:!1;let u=null,d=null;const f=[],p=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ih,this.physicallyCorrectLights=!1,this.toneMapping=Xa,this.toneMappingExposure=1;const g=this;let m=!1,v=0,x=0,w=null,b=-1,M=null;const A=new Ci,T=new Ci;let S=null,C=t.width,P=t.height,B=1,k=null,z=null;const F=new Ci(0,0,C,P),W=new Ci(0,0,C,P);let K=!1;const Z=new CM;let U=!1,X=!1,V=null;const q=new Nt,H=new Ve,Q=new te,J={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function le(){return w===null?B:1}let j=i;function ve(O,ee){for(let he=0;he<O.length;he++){const $=O[he],fe=t.getContext($,ee);if(fe!==null)return fe}return null}try{const O={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Wx}`),t.addEventListener("webglcontextlost",Re,!1),t.addEventListener("webglcontextrestored",Ne,!1),t.addEventListener("webglcontextcreationerror",$e,!1),j===null){const ee=["webgl2","webgl","experimental-webgl"];if(g.isWebGL1Renderer===!0&&ee.shift(),j=ve(ee,O),j===null)throw ve(ee)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}j.getShaderPrecisionFormat===void 0&&(j.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(O){throw console.error("THREE.WebGLRenderer: "+O.message),O}let pe,me,de,Se,ce,se,be,Ee,Le,ze,Oe,Ge,tt,ot,N,R,ie,xe,Me,Te,qe,De,ue,He;function ne(){pe=new Eoe(j),me=new woe(j,pe,e),pe.init(me),De=new _7(j,pe,me),de=new rle(j,pe,me),Se=new Poe,ce=new Xae,se=new sle(j,pe,de,ce,me,De,Se),be=new boe(g),Ee=new Moe(g),Le=new zne(j,me),ue=new yoe(j,pe,Le,me),ze=new Coe(j,Le,Se,ue),Oe=new Roe(j,ze,Le,Se),Me=new Loe(j,me,se),R=new _oe(ce),Ge=new Wae(g,be,Ee,pe,me,ue,R),tt=new lle(g,ce),ot=new qae,N=new ele(pe,me),xe=new voe(g,be,Ee,de,Oe,h,o),ie=new nle(g,Oe,me),He=new cle(j,Se,me,de),Te=new xoe(j,pe,Se,me),qe=new Toe(j,pe,Se,me),Se.programs=Ge.programs,g.capabilities=me,g.extensions=pe,g.properties=ce,g.renderLists=ot,g.shadowMap=ie,g.state=de,g.info=Se}ne();const we=new ale(g,j);this.xr=we,this.getContext=function(){return j},this.getContextAttributes=function(){return j.getContextAttributes()},this.forceContextLoss=function(){const O=pe.get("WEBGL_lose_context");O&&O.loseContext()},this.forceContextRestore=function(){const O=pe.get("WEBGL_lose_context");O&&O.restoreContext()},this.getPixelRatio=function(){return B},this.setPixelRatio=function(O){O!==void 0&&(B=O,this.setSize(C,P,!1))},this.getSize=function(O){return O.set(C,P)},this.setSize=function(O,ee,he){if(we.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}C=O,P=ee,t.width=Math.floor(O*B),t.height=Math.floor(ee*B),he!==!1&&(t.style.width=O+"px",t.style.height=ee+"px"),this.setViewport(0,0,O,ee)},this.getDrawingBufferSize=function(O){return O.set(C*B,P*B).floor()},this.setDrawingBufferSize=function(O,ee,he){C=O,P=ee,B=he,t.width=Math.floor(O*he),t.height=Math.floor(ee*he),this.setViewport(0,0,O,ee)},this.getCurrentViewport=function(O){return O.copy(A)},this.getViewport=function(O){return O.copy(F)},this.setViewport=function(O,ee,he,$){O.isVector4?F.set(O.x,O.y,O.z,O.w):F.set(O,ee,he,$),de.viewport(A.copy(F).multiplyScalar(B).floor())},this.getScissor=function(O){return O.copy(W)},this.setScissor=function(O,ee,he,$){O.isVector4?W.set(O.x,O.y,O.z,O.w):W.set(O,ee,he,$),de.scissor(T.copy(W).multiplyScalar(B).floor())},this.getScissorTest=function(){return K},this.setScissorTest=function(O){de.setScissorTest(K=O)},this.setOpaqueSort=function(O){k=O},this.setTransparentSort=function(O){z=O},this.getClearColor=function(O){return O.copy(xe.getClearColor())},this.setClearColor=function(){xe.setClearColor.apply(xe,arguments)},this.getClearAlpha=function(){return xe.getClearAlpha()},this.setClearAlpha=function(){xe.setClearAlpha.apply(xe,arguments)},this.clear=function(O=!0,ee=!0,he=!0){let $=0;O&&($|=16384),ee&&($|=256),he&&($|=1024),j.clear($)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Re,!1),t.removeEventListener("webglcontextrestored",Ne,!1),t.removeEventListener("webglcontextcreationerror",$e,!1),ot.dispose(),N.dispose(),ce.dispose(),be.dispose(),Ee.dispose(),Oe.dispose(),ue.dispose(),He.dispose(),Ge.dispose(),we.dispose(),we.removeEventListener("sessionstart",Fe),we.removeEventListener("sessionend",Xe),V&&(V.dispose(),V=null),pt.stop()};function Re(O){O.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function Ne(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;const O=Se.autoReset,ee=ie.enabled,he=ie.autoUpdate,$=ie.needsUpdate,fe=ie.type;ne(),Se.autoReset=O,ie.enabled=ee,ie.autoUpdate=he,ie.needsUpdate=$,ie.type=fe}function $e(O){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",O.statusMessage)}function xt(O){const ee=O.target;ee.removeEventListener("dispose",xt),kt(ee)}function kt(O){Y(O),ce.remove(O)}function Y(O){const ee=ce.get(O).programs;ee!==void 0&&(ee.forEach(function(he){Ge.releaseProgram(he)}),O.isShaderMaterial&&Ge.releaseShaderCache(O))}this.renderBufferDirect=function(O,ee,he,$,fe,We){ee===null&&(ee=J);const Ke=fe.isMesh&&fe.matrixWorld.determinant()<0,nt=yv(O,ee,he,$,fe);de.setMaterial($,Ke);let st=he.index,_t=1;$.wireframe===!0&&(st=ze.getWireframeAttribute(he),_t=2);const mt=he.drawRange,ht=he.attributes.position;let ni=mt.start*_t,Ai=(mt.start+mt.count)*_t;We!==null&&(ni=Math.max(ni,We.start*_t),Ai=Math.min(Ai,(We.start+We.count)*_t)),st!==null?(ni=Math.max(ni,0),Ai=Math.min(Ai,st.count)):ht!=null&&(ni=Math.max(ni,0),Ai=Math.min(Ai,ht.count));const wn=Ai-ni;if(wn<0||wn===1/0)return;ue.setup(fe,$,nt,he,st);let wr,Gt=Te;if(st!==null&&(wr=Le.get(st),Gt=qe,Gt.setIndex(wr)),fe.isMesh)$.wireframe===!0?(de.setLineWidth($.wireframeLinewidth*le()),Gt.setMode(1)):Gt.setMode(4);else if(fe.isLine){let at=$.linewidth;at===void 0&&(at=1),de.setLineWidth(at*le()),fe.isLineSegments?Gt.setMode(1):fe.isLineLoop?Gt.setMode(2):Gt.setMode(3)}else fe.isPoints?Gt.setMode(0):fe.isSprite&&Gt.setMode(4);if(fe.isInstancedMesh)Gt.renderInstances(ni,wn,fe.count);else if(he.isInstancedBufferGeometry){const at=he._maxInstanceCount!==void 0?he._maxInstanceCount:1/0,pa=Math.min(he.instanceCount,at);Gt.renderInstances(ni,wn,pa)}else Gt.render(ni,wn)},this.compile=function(O,ee){function he($,fe,We){$.transparent===!0&&$.side===za&&$.forceSinglePass===!1?($.side=Vs,$.needsUpdate=!0,Oi($,fe,We),$.side=Xl,$.needsUpdate=!0,Oi($,fe,We),$.side=za):Oi($,fe,We)}d=N.get(O),d.init(),p.push(d),O.traverseVisible(function($){$.isLight&&$.layers.test(ee.layers)&&(d.pushLight($),$.castShadow&&d.pushShadow($))}),d.setupLights(g.physicallyCorrectLights),O.traverse(function($){const fe=$.material;if(fe)if(Array.isArray(fe))for(let We=0;We<fe.length;We++){const Ke=fe[We];he(Ke,O,$)}else he(fe,O,$)}),p.pop(),d=null};let oe=null;function ye(O){oe&&oe(O)}function Fe(){pt.stop()}function Xe(){pt.start()}const pt=new g7;pt.setAnimationLoop(ye),typeof self<"u"&&pt.setContext(self),this.setAnimationLoop=function(O){oe=O,we.setAnimationLoop(O),O===null?pt.stop():pt.start()},we.addEventListener("sessionstart",Fe),we.addEventListener("sessionend",Xe),this.render=function(O,ee){if(ee!==void 0&&ee.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(m===!0)return;O.matrixWorldAutoUpdate===!0&&O.updateMatrixWorld(),ee.parent===null&&ee.matrixWorldAutoUpdate===!0&&ee.updateMatrixWorld(),we.enabled===!0&&we.isPresenting===!0&&(we.cameraAutoUpdate===!0&&we.updateCamera(ee),ee=we.getCamera()),O.isScene===!0&&O.onBeforeRender(g,O,ee,w),d=N.get(O,p.length),d.init(),p.push(d),q.multiplyMatrices(ee.projectionMatrix,ee.matrixWorldInverse),Z.setFromProjectionMatrix(q),X=this.localClippingEnabled,U=R.init(this.clippingPlanes,X),u=ot.get(O,f.length),u.init(),f.push(u),ei(O,ee,0,g.sortObjects),u.finish(),g.sortObjects===!0&&u.sort(k,z),U===!0&&R.beginShadows();const he=d.state.shadowsArray;if(ie.render(he,O,ee),U===!0&&R.endShadows(),this.info.autoReset===!0&&this.info.reset(),xe.render(u,O),d.setupLights(g.physicallyCorrectLights),ee.isArrayCamera){const $=ee.cameras;for(let fe=0,We=$.length;fe<We;fe++){const Ke=$[fe];ui(u,O,Ke,Ke.viewport)}}else ui(u,O,ee);w!==null&&(se.updateMultisampleRenderTarget(w),se.updateRenderTargetMipmap(w)),O.isScene===!0&&O.onAfterRender(g,O,ee),ue.resetDefaultState(),b=-1,M=null,p.pop(),p.length>0?d=p[p.length-1]:d=null,f.pop(),f.length>0?u=f[f.length-1]:u=null};function ei(O,ee,he,$){if(O.visible===!1)return;if(O.layers.test(ee.layers)){if(O.isGroup)he=O.renderOrder;else if(O.isLOD)O.autoUpdate===!0&&O.update(ee);else if(O.isLight)d.pushLight(O),O.castShadow&&d.pushShadow(O);else if(O.isSprite){if(!O.frustumCulled||Z.intersectsSprite(O)){$&&Q.setFromMatrixPosition(O.matrixWorld).applyMatrix4(q);const Ke=Oe.update(O),nt=O.material;nt.visible&&u.push(O,Ke,nt,he,Q.z,null)}}else if((O.isMesh||O.isLine||O.isPoints)&&(O.isSkinnedMesh&&O.skeleton.frame!==Se.render.frame&&(O.skeleton.update(),O.skeleton.frame=Se.render.frame),!O.frustumCulled||Z.intersectsObject(O))){$&&Q.setFromMatrixPosition(O.matrixWorld).applyMatrix4(q);const Ke=Oe.update(O),nt=O.material;if(Array.isArray(nt)){const st=Ke.groups;for(let _t=0,mt=st.length;_t<mt;_t++){const ht=st[_t],ni=nt[ht.materialIndex];ni&&ni.visible&&u.push(O,Ke,ni,he,Q.z,ht)}}else nt.visible&&u.push(O,Ke,nt,he,Q.z,null)}}const We=O.children;for(let Ke=0,nt=We.length;Ke<nt;Ke++)ei(We[Ke],ee,he,$)}function ui(O,ee,he,$){const fe=O.opaque,We=O.transmissive,Ke=O.transparent;d.setupLightsView(he),U===!0&&R.setGlobalState(g.clippingPlanes,he),We.length>0&&ar(fe,ee,he),$&&de.viewport(A.copy($)),fe.length>0&&Dt(fe,ee,he),We.length>0&&Dt(We,ee,he),Ke.length>0&&Dt(Ke,ee,he),de.buffers.depth.setTest(!0),de.buffers.depth.setMask(!0),de.buffers.color.setMask(!0),de.setPolygonOffset(!1)}function ar(O,ee,he){const $=me.isWebGL2;V===null&&(V=new Ja(1,1,{generateMipmaps:!0,type:pe.has("EXT_color_buffer_half_float")?Ag:su,minFilter:Yl,samples:$&&s===!0?4:0})),g.getDrawingBufferSize(H),$?V.setSize(H.x,H.y):V.setSize(ZA(H.x),ZA(H.y));const fe=g.getRenderTarget();g.setRenderTarget(V),g.clear();const We=g.toneMapping;g.toneMapping=Xa,Dt(O,ee,he),g.toneMapping=We,se.updateMultisampleRenderTarget(V),se.updateRenderTargetMipmap(V),g.setRenderTarget(fe)}function Dt(O,ee,he){const $=ee.isScene===!0?ee.overrideMaterial:null;for(let fe=0,We=O.length;fe<We;fe++){const Ke=O[fe],nt=Ke.object,st=Ke.geometry,_t=$===null?Ke.material:$,mt=Ke.group;nt.layers.test(he.layers)&&un(nt,ee,he,st,_t,mt)}}function un(O,ee,he,$,fe,We){O.onBeforeRender(g,ee,he,$,fe,We),O.modelViewMatrix.multiplyMatrices(he.matrixWorldInverse,O.matrixWorld),O.normalMatrix.getNormalMatrix(O.modelViewMatrix),fe.onBeforeRender(g,ee,he,$,O,We),fe.transparent===!0&&fe.side===za&&fe.forceSinglePass===!1?(fe.side=Vs,fe.needsUpdate=!0,g.renderBufferDirect(he,ee,$,fe,O,We),fe.side=Xl,fe.needsUpdate=!0,g.renderBufferDirect(he,ee,$,fe,O,We),fe.side=za):g.renderBufferDirect(he,ee,$,fe,O,We),O.onAfterRender(g,ee,he,$,fe,We)}function Oi(O,ee,he){ee.isScene!==!0&&(ee=J);const $=ce.get(O),fe=d.state.lights,We=d.state.shadowsArray,Ke=fe.state.version,nt=Ge.getParameters(O,fe.state,We,ee,he),st=Ge.getProgramCacheKey(nt);let _t=$.programs;$.environment=O.isMeshStandardMaterial?ee.environment:null,$.fog=ee.fog,$.envMap=(O.isMeshStandardMaterial?Ee:be).get(O.envMap||$.environment),_t===void 0&&(O.addEventListener("dispose",xt),_t=new Map,$.programs=_t);let mt=_t.get(st);if(mt!==void 0){if($.currentProgram===mt&&$.lightsStateVersion===Ke)return td(O,nt),mt}else nt.uniforms=Ge.getUniforms(O),O.onBuild(he,nt,g),O.onBeforeCompile(nt,g),mt=Ge.acquireProgram(nt,st),_t.set(st,mt),$.uniforms=nt.uniforms;const ht=$.uniforms;(!O.isShaderMaterial&&!O.isRawShaderMaterial||O.clipping===!0)&&(ht.clippingPlanes=R.uniform),td(O,nt),$.needsLights=id(O),$.lightsStateVersion=Ke,$.needsLights&&(ht.ambientLightColor.value=fe.state.ambient,ht.lightProbe.value=fe.state.probe,ht.directionalLights.value=fe.state.directional,ht.directionalLightShadows.value=fe.state.directionalShadow,ht.spotLights.value=fe.state.spot,ht.spotLightShadows.value=fe.state.spotShadow,ht.rectAreaLights.value=fe.state.rectArea,ht.ltc_1.value=fe.state.rectAreaLTC1,ht.ltc_2.value=fe.state.rectAreaLTC2,ht.pointLights.value=fe.state.point,ht.pointLightShadows.value=fe.state.pointShadow,ht.hemisphereLights.value=fe.state.hemi,ht.directionalShadowMap.value=fe.state.directionalShadowMap,ht.directionalShadowMatrix.value=fe.state.directionalShadowMatrix,ht.spotShadowMap.value=fe.state.spotShadowMap,ht.spotLightMatrix.value=fe.state.spotLightMatrix,ht.spotLightMap.value=fe.state.spotLightMap,ht.pointShadowMap.value=fe.state.pointShadowMap,ht.pointShadowMatrix.value=fe.state.pointShadowMatrix);const ni=mt.getUniforms(),Ai=uA.seqWithValue(ni.seq,ht);return $.currentProgram=mt,$.uniformsList=Ai,mt}function td(O,ee){const he=ce.get(O);he.outputEncoding=ee.outputEncoding,he.instancing=ee.instancing,he.skinning=ee.skinning,he.morphTargets=ee.morphTargets,he.morphNormals=ee.morphNormals,he.morphColors=ee.morphColors,he.morphTargetsCount=ee.morphTargetsCount,he.numClippingPlanes=ee.numClippingPlanes,he.numIntersection=ee.numClipIntersection,he.vertexAlphas=ee.vertexAlphas,he.vertexTangents=ee.vertexTangents,he.toneMapping=ee.toneMapping}function yv(O,ee,he,$,fe){ee.isScene!==!0&&(ee=J),se.resetTextureUnits();const We=ee.fog,Ke=$.isMeshStandardMaterial?ee.environment:null,nt=w===null?g.outputEncoding:w.isXRRenderTarget===!0?w.texture.encoding:Ih,st=($.isMeshStandardMaterial?Ee:be).get($.envMap||Ke),_t=$.vertexColors===!0&&!!he.attributes.color&&he.attributes.color.itemSize===4,mt=!!$.normalMap&&!!he.attributes.tangent,ht=!!he.morphAttributes.position,ni=!!he.morphAttributes.normal,Ai=!!he.morphAttributes.color,wn=$.toneMapped?g.toneMapping:Xa,wr=he.morphAttributes.position||he.morphAttributes.normal||he.morphAttributes.color,Gt=wr!==void 0?wr.length:0,at=ce.get($),pa=d.state.lights;if(U===!0&&(X===!0||O!==M)){const jt=O===M&&$.id===b;R.setState($,O,jt)}let ki=!1;$.version===at.__version?(at.needsLights&&at.lightsStateVersion!==pa.state.version||at.outputEncoding!==nt||fe.isInstancedMesh&&at.instancing===!1||!fe.isInstancedMesh&&at.instancing===!0||fe.isSkinnedMesh&&at.skinning===!1||!fe.isSkinnedMesh&&at.skinning===!0||at.envMap!==st||$.fog===!0&&at.fog!==We||at.numClippingPlanes!==void 0&&(at.numClippingPlanes!==R.numPlanes||at.numIntersection!==R.numIntersection)||at.vertexAlphas!==_t||at.vertexTangents!==mt||at.morphTargets!==ht||at.morphNormals!==ni||at.morphColors!==Ai||at.toneMapping!==wn||me.isWebGL2===!0&&at.morphTargetsCount!==Gt)&&(ki=!0):(ki=!0,at.__version=$.version);let _r=at.currentProgram;ki===!0&&(_r=Oi($,ee,fe));let rc=!1,lr=!1,Lr=!1;const bt=_r.getUniforms(),Jt=at.uniforms;if(de.useProgram(_r.program)&&(rc=!0,lr=!0,Lr=!0),$.id!==b&&(b=$.id,lr=!0),rc||M!==O){if(bt.setValue(j,"projectionMatrix",O.projectionMatrix),me.logarithmicDepthBuffer&&bt.setValue(j,"logDepthBufFC",2/(Math.log(O.far+1)/Math.LN2)),M!==O&&(M=O,lr=!0,Lr=!0),$.isShaderMaterial||$.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshStandardMaterial||$.envMap){const jt=bt.map.cameraPosition;jt!==void 0&&jt.setValue(j,Q.setFromMatrixPosition(O.matrixWorld))}($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial)&&bt.setValue(j,"isOrthographic",O.isOrthographicCamera===!0),($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial||$.isShadowMaterial||fe.isSkinnedMesh)&&bt.setValue(j,"viewMatrix",O.matrixWorldInverse)}if(fe.isSkinnedMesh){bt.setOptional(j,fe,"bindMatrix"),bt.setOptional(j,fe,"bindMatrixInverse");const jt=fe.skeleton;jt&&(me.floatVertexTextures?(jt.boneTexture===null&&jt.computeBoneTexture(),bt.setValue(j,"boneTexture",jt.boneTexture,se),bt.setValue(j,"boneTextureSize",jt.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Rr=he.morphAttributes;if((Rr.position!==void 0||Rr.normal!==void 0||Rr.color!==void 0&&me.isWebGL2===!0)&&Me.update(fe,he,$,_r),(lr||at.receiveShadow!==fe.receiveShadow)&&(at.receiveShadow=fe.receiveShadow,bt.setValue(j,"receiveShadow",fe.receiveShadow)),$.isMeshGouraudMaterial&&$.envMap!==null&&(Jt.envMap.value=st,Jt.flipEnvMap.value=st.isCubeTexture&&st.isRenderTargetTexture===!1?-1:1),lr&&(bt.setValue(j,"toneMappingExposure",g.toneMappingExposure),at.needsLights&&np(Jt,Lr),We&&$.fog===!0&&tt.refreshFogUniforms(Jt,We),tt.refreshMaterialUniforms(Jt,$,B,P,V),uA.upload(j,at.uniformsList,Jt,se)),$.isShaderMaterial&&$.uniformsNeedUpdate===!0&&(uA.upload(j,at.uniformsList,Jt,se),$.uniformsNeedUpdate=!1),$.isSpriteMaterial&&bt.setValue(j,"center",fe.center),bt.setValue(j,"modelViewMatrix",fe.modelViewMatrix),bt.setValue(j,"normalMatrix",fe.normalMatrix),bt.setValue(j,"modelMatrix",fe.matrixWorld),$.isShaderMaterial||$.isRawShaderMaterial){const jt=$.uniformsGroups;for(let hn=0,ma=jt.length;hn<ma;hn++)if(me.isWebGL2){const So=jt[hn];He.update(So,_r),He.bind(So,_r)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return _r}function np(O,ee){O.ambientLightColor.needsUpdate=ee,O.lightProbe.needsUpdate=ee,O.directionalLights.needsUpdate=ee,O.directionalLightShadows.needsUpdate=ee,O.pointLights.needsUpdate=ee,O.pointLightShadows.needsUpdate=ee,O.spotLights.needsUpdate=ee,O.spotLightShadows.needsUpdate=ee,O.rectAreaLights.needsUpdate=ee,O.hemisphereLights.needsUpdate=ee}function id(O){return O.isMeshLambertMaterial||O.isMeshToonMaterial||O.isMeshPhongMaterial||O.isMeshStandardMaterial||O.isShadowMaterial||O.isShaderMaterial&&O.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(O,ee,he){ce.get(O.texture).__webglTexture=ee,ce.get(O.depthTexture).__webglTexture=he;const $=ce.get(O);$.__hasExternalTextures=!0,$.__hasExternalTextures&&($.__autoAllocateDepthBuffer=he===void 0,$.__autoAllocateDepthBuffer||pe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),$.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(O,ee){const he=ce.get(O);he.__webglFramebuffer=ee,he.__useDefaultFramebuffer=ee===void 0},this.setRenderTarget=function(O,ee=0,he=0){w=O,v=ee,x=he;let $=!0,fe=null,We=!1,Ke=!1;if(O){const st=ce.get(O);st.__useDefaultFramebuffer!==void 0?(de.bindFramebuffer(36160,null),$=!1):st.__webglFramebuffer===void 0?se.setupRenderTarget(O):st.__hasExternalTextures&&se.rebindTextures(O,ce.get(O.texture).__webglTexture,ce.get(O.depthTexture).__webglTexture);const _t=O.texture;(_t.isData3DTexture||_t.isDataArrayTexture||_t.isCompressedArrayTexture)&&(Ke=!0);const mt=ce.get(O).__webglFramebuffer;O.isWebGLCubeRenderTarget?(fe=mt[ee],We=!0):me.isWebGL2&&O.samples>0&&se.useMultisampledRTT(O)===!1?fe=ce.get(O).__webglMultisampledFramebuffer:fe=mt,A.copy(O.viewport),T.copy(O.scissor),S=O.scissorTest}else A.copy(F).multiplyScalar(B).floor(),T.copy(W).multiplyScalar(B).floor(),S=K;if(de.bindFramebuffer(36160,fe)&&me.drawBuffers&&$&&de.drawBuffers(O,fe),de.viewport(A),de.scissor(T),de.setScissorTest(S),We){const st=ce.get(O.texture);j.framebufferTexture2D(36160,36064,34069+ee,st.__webglTexture,he)}else if(Ke){const st=ce.get(O.texture),_t=ee||0;j.framebufferTextureLayer(36160,36064,st.__webglTexture,he||0,_t)}b=-1},this.readRenderTargetPixels=function(O,ee,he,$,fe,We,Ke){if(!(O&&O.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let nt=ce.get(O).__webglFramebuffer;if(O.isWebGLCubeRenderTarget&&Ke!==void 0&&(nt=nt[Ke]),nt){de.bindFramebuffer(36160,nt);try{const st=O.texture,_t=st.format,mt=st.type;if(_t!==Ls&&De.convert(_t)!==j.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const ht=mt===Ag&&(pe.has("EXT_color_buffer_half_float")||me.isWebGL2&&pe.has("EXT_color_buffer_float"));if(mt!==su&&De.convert(mt)!==j.getParameter(35738)&&!(mt===Gc&&(me.isWebGL2||pe.has("OES_texture_float")||pe.has("WEBGL_color_buffer_float")))&&!ht){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ee>=0&&ee<=O.width-$&&he>=0&&he<=O.height-fe&&j.readPixels(ee,he,$,fe,De.convert(_t),De.convert(mt),We)}finally{const st=w!==null?ce.get(w).__webglFramebuffer:null;de.bindFramebuffer(36160,st)}}},this.copyFramebufferToTexture=function(O,ee,he=0){const $=Math.pow(2,-he),fe=Math.floor(ee.image.width*$),We=Math.floor(ee.image.height*$);se.setTexture2D(ee,0),j.copyTexSubImage2D(3553,he,0,0,O.x,O.y,fe,We),de.unbindTexture()},this.copyTextureToTexture=function(O,ee,he,$=0){const fe=ee.image.width,We=ee.image.height,Ke=De.convert(he.format),nt=De.convert(he.type);se.setTexture2D(he,0),j.pixelStorei(37440,he.flipY),j.pixelStorei(37441,he.premultiplyAlpha),j.pixelStorei(3317,he.unpackAlignment),ee.isDataTexture?j.texSubImage2D(3553,$,O.x,O.y,fe,We,Ke,nt,ee.image.data):ee.isCompressedTexture?j.compressedTexSubImage2D(3553,$,O.x,O.y,ee.mipmaps[0].width,ee.mipmaps[0].height,Ke,ee.mipmaps[0].data):j.texSubImage2D(3553,$,O.x,O.y,Ke,nt,ee.image),$===0&&he.generateMipmaps&&j.generateMipmap(3553),de.unbindTexture()},this.copyTextureToTexture3D=function(O,ee,he,$,fe=0){if(g.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const We=O.max.x-O.min.x+1,Ke=O.max.y-O.min.y+1,nt=O.max.z-O.min.z+1,st=De.convert($.format),_t=De.convert($.type);let mt;if($.isData3DTexture)se.setTexture3D($,0),mt=32879;else if($.isDataArrayTexture)se.setTexture2DArray($,0),mt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}j.pixelStorei(37440,$.flipY),j.pixelStorei(37441,$.premultiplyAlpha),j.pixelStorei(3317,$.unpackAlignment);const ht=j.getParameter(3314),ni=j.getParameter(32878),Ai=j.getParameter(3316),wn=j.getParameter(3315),wr=j.getParameter(32877),Gt=he.isCompressedTexture?he.mipmaps[0]:he.image;j.pixelStorei(3314,Gt.width),j.pixelStorei(32878,Gt.height),j.pixelStorei(3316,O.min.x),j.pixelStorei(3315,O.min.y),j.pixelStorei(32877,O.min.z),he.isDataTexture||he.isData3DTexture?j.texSubImage3D(mt,fe,ee.x,ee.y,ee.z,We,Ke,nt,st,_t,Gt.data):he.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),j.compressedTexSubImage3D(mt,fe,ee.x,ee.y,ee.z,We,Ke,nt,st,Gt.data)):j.texSubImage3D(mt,fe,ee.x,ee.y,ee.z,We,Ke,nt,st,_t,Gt),j.pixelStorei(3314,ht),j.pixelStorei(32878,ni),j.pixelStorei(3316,Ai),j.pixelStorei(3315,wn),j.pixelStorei(32877,wr),fe===0&&$.generateMipmaps&&j.generateMipmap(mt),de.unbindTexture()},this.initTexture=function(O){O.isCubeTexture?se.setTextureCube(O,0):O.isData3DTexture?se.setTexture3D(O,0):O.isDataArrayTexture||O.isCompressedArrayTexture?se.setTexture2DArray(O,0):se.setTexture2D(O,0),de.unbindTexture()},this.resetState=function(){v=0,x=0,w=null,de.reset(),ue.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class S7 extends WR{}S7.prototype.isWebGL1Renderer=!0;class PM{constructor(t,i=25e-5){this.isFogExp2=!0,this.name="",this.color=new ct(t),this.density=i}clone(){return new PM(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class DM{constructor(t,i=1,n=1e3){this.isFog=!0,this.name="",this.color=new ct(t),this.near=i,this.far=n}clone(){return new DM(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class $A extends fi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,i){return super.copy(t,i),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const i=super.toJSON(t);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(t){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=t}}class Jx{constructor(t,i){this.isInterleavedBuffer=!0,this.array=t,this.stride=i,this.count=t!==void 0?t.length/i:0,this.usage=sx,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=vo()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,i,n){t*=this.stride,n*=i.stride;for(let r=0,s=this.stride;r<s;r++)this.array[t+r]=i.array[n+r];return this}set(t,i=0){return this.array.set(t,i),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=vo()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(i,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=vo()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ts=new te;class Oh{constructor(t,i,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=i,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let i=0,n=this.data.count;i<n;i++)ts.fromBufferAttribute(this,i),ts.applyMatrix4(t),this.setXYZ(i,ts.x,ts.y,ts.z);return this}applyNormalMatrix(t){for(let i=0,n=this.count;i<n;i++)ts.fromBufferAttribute(this,i),ts.applyNormalMatrix(t),this.setXYZ(i,ts.x,ts.y,ts.z);return this}transformDirection(t){for(let i=0,n=this.count;i<n;i++)ts.fromBufferAttribute(this,i),ts.transformDirection(t),this.setXYZ(i,ts.x,ts.y,ts.z);return this}setX(t,i){return this.normalized&&(i=Ni(i,this.array)),this.data.array[t*this.data.stride+this.offset]=i,this}setY(t,i){return this.normalized&&(i=Ni(i,this.array)),this.data.array[t*this.data.stride+this.offset+1]=i,this}setZ(t,i){return this.normalized&&(i=Ni(i,this.array)),this.data.array[t*this.data.stride+this.offset+2]=i,this}setW(t,i){return this.normalized&&(i=Ni(i,this.array)),this.data.array[t*this.data.stride+this.offset+3]=i,this}getX(t){let i=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(i=Hc(i,this.array)),i}getY(t){let i=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(i=Hc(i,this.array)),i}getZ(t){let i=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(i=Hc(i,this.array)),i}getW(t){let i=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(i=Hc(i,this.array)),i}setXY(t,i,n){return t=t*this.data.stride+this.offset,this.normalized&&(i=Ni(i,this.array),n=Ni(n,this.array)),this.data.array[t+0]=i,this.data.array[t+1]=n,this}setXYZ(t,i,n,r){return t=t*this.data.stride+this.offset,this.normalized&&(i=Ni(i,this.array),n=Ni(n,this.array),r=Ni(r,this.array)),this.data.array[t+0]=i,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,i,n,r,s){return t=t*this.data.stride+this.offset,this.normalized&&(i=Ni(i,this.array),n=Ni(n,this.array),r=Ni(r,this.array),s=Ni(s,this.array)),this.data.array[t+0]=i,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=s,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)i.push(this.data.array[r+s])}return new wi(new this.array.constructor(i),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Oh(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)i.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class XR extends Gn{constructor(t){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ct(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}let Bp;const $v=new te,Lp=new te,Rp=new te,Ip=new Ve,e0=new Ve,M7=new Nt,a_=new te,t0=new te,l_=new te,tU=new Ve,xT=new Ve,iU=new Ve;class E7 extends fi{constructor(t){if(super(),this.isSprite=!0,this.type="Sprite",Bp===void 0){Bp=new Qt;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Jx(i,5);Bp.setIndex([0,1,2,0,2,3]),Bp.setAttribute("position",new Oh(n,3,0,!1)),Bp.setAttribute("uv",new Oh(n,2,3,!1))}this.geometry=Bp,this.material=t!==void 0?t:new XR,this.center=new Ve(.5,.5)}raycast(t,i){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Lp.setFromMatrixScale(this.matrixWorld),M7.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Rp.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Lp.multiplyScalar(-Rp.z);const n=this.material.rotation;let r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;c_(a_.set(-.5,-.5,0),Rp,o,Lp,r,s),c_(t0.set(.5,-.5,0),Rp,o,Lp,r,s),c_(l_.set(.5,.5,0),Rp,o,Lp,r,s),tU.set(0,0),xT.set(1,0),iU.set(1,1);let a=t.ray.intersectTriangle(a_,t0,l_,!1,$v);if(a===null&&(c_(t0.set(-.5,.5,0),Rp,o,Lp,r,s),xT.set(0,1),a=t.ray.intersectTriangle(a_,l_,t0,!1,$v),a===null))return;const l=t.ray.origin.distanceTo($v);l<t.near||l>t.far||i.push({distance:l,point:$v.clone(),uv:Ko.getUV($v,a_,t0,l_,tU,xT,iU,new Ve),face:null,object:this})}copy(t,i){return super.copy(t,i),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}}function c_(e,t,i,n,r,s){Ip.subVectors(e,i).addScalar(.5).multiply(n),r!==void 0?(e0.x=s*Ip.x-r*Ip.y,e0.y=r*Ip.x+s*Ip.y):e0.copy(Ip),e.copy(t),e.x+=e0.x,e.y+=e0.y,e.applyMatrix4(M7)}const u_=new te,nU=new te;class C7 extends fi{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const i=t.levels;for(let n=0,r=i.length;n<r;n++){const s=i[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=t.autoUpdate,this}addLevel(t,i=0,n=0){i=Math.abs(i);const r=this.levels;let s;for(s=0;s<r.length&&!(i<r[s].distance);s++);return r.splice(s,0,{distance:i,hysteresis:n,object:t}),this.add(t),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const i=this.levels;if(i.length>0){let n,r;for(n=1,r=i.length;n<r;n++){let s=i[n].distance;if(i[n].object.visible&&(s-=s*i[n].hysteresis),t<s)break}return i[n-1].object}return null}raycast(t,i){if(this.levels.length>0){u_.setFromMatrixPosition(this.matrixWorld);const r=t.ray.origin.distanceTo(u_);this.getObjectForDistance(r).raycast(t,i)}}update(t){const i=this.levels;if(i.length>1){u_.setFromMatrixPosition(t.matrixWorld),nU.setFromMatrixPosition(this.matrixWorld);const n=u_.distanceTo(nU)/t.zoom;i[0].object.visible=!0;let r,s;for(r=1,s=i.length;r<s;r++){let o=i[r].distance;if(i[r].object.visible&&(o-=o*i[r].hysteresis),n>=o)i[r-1].object.visible=!1,i[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)i[r].object.visible=!1}}toJSON(t){const i=super.toJSON(t);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];i.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return i}}const rU=new te,sU=new Ci,oU=new Ci,hle=new te,aU=new Nt;class YR extends $n{constructor(t,i){super(t,i),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Nt,this.bindMatrixInverse=new Nt}copy(t,i){return super.copy(t,i),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,i){this.skeleton=t,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Ci,i=this.geometry.attributes.skinWeight;for(let n=0,r=i.count;n<r;n++){t.fromBufferAttribute(i,n);const s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),i.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,i){const n=this.skeleton,r=this.geometry;sU.fromBufferAttribute(r.attributes.skinIndex,t),oU.fromBufferAttribute(r.attributes.skinWeight,t),rU.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let s=0;s<4;s++){const o=oU.getComponent(s);if(o!==0){const a=sU.getComponent(s);aU.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),i.addScaledVector(hle.copy(rU).applyMatrix4(aU),o)}}return i.applyMatrix4(this.bindMatrixInverse)}}class BM extends fi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Zm extends en{constructor(t=null,i=1,n=1,r,s,o,a,l,c=gn,h=gn,u,d){super(null,o,a,l,c,h,r,s,u,d),this.isDataTexture=!0,this.image={data:t,width:i,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const lU=new Nt,dle=new Nt;class Kx{constructor(t=[],i=[]){this.uuid=vo(),this.bones=t.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),i.length===0)this.calculateInverses();else if(t.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Nt)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,i=this.bones.length;t<i;t++){const n=new Nt;this.bones[t]&&n.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let t=0,i=this.bones.length;t<i;t++){const n=this.bones[t];n&&n.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,i=this.bones.length;t<i;t++){const n=this.bones[t];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const t=this.bones,i=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=t.length;s<o;s++){const a=t[s]?t[s].matrixWorld:dle;lU.multiplyMatrices(a,i[s]),lU.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new Kx(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(this.bones.length*4);t=h7(t),t=Math.max(t,4);const i=new Float32Array(t*t*4);i.set(this.boneMatrices);const n=new Zm(i,t,t,Ls,Gc);return n.needsUpdate=!0,this.boneMatrices=i,this.boneTexture=n,this.boneTextureSize=t,this}getBoneByName(t){for(let i=0,n=this.bones.length;i<n;i++){const r=this.bones[i];if(r.name===t)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,i){this.uuid=t.uuid;for(let n=0,r=t.bones.length;n<r;n++){const s=t.bones[n];let o=i[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new BM),this.bones.push(o),this.boneInverses.push(new Nt().fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const i=this.bones,n=this.boneInverses;for(let r=0,s=i.length;r<s;r++){const o=i[r];t.bones.push(o.uuid);const a=n[r];t.boneInverses.push(a.toArray())}return t}}class Cg extends wi{constructor(t,i,n,r=1){super(t,i,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}const cU=new Nt,uU=new Nt,h_=[],fle=new Nt,i0=new $n;class qR extends $n{constructor(t,i,n){super(t,i),this.isInstancedMesh=!0,this.instanceMatrix=new Cg(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let r=0;r<n;r++)this.setMatrixAt(r,fle)}copy(t,i){return super.copy(t,i),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,i){i.fromArray(this.instanceColor.array,t*3)}getMatrixAt(t,i){i.fromArray(this.instanceMatrix.array,t*16)}raycast(t,i){const n=this.matrixWorld,r=this.count;if(i0.geometry=this.geometry,i0.material=this.material,i0.material!==void 0)for(let s=0;s<r;s++){this.getMatrixAt(s,cU),uU.multiplyMatrices(n,cU),i0.matrixWorld=uU,i0.raycast(t,h_);for(let o=0,a=h_.length;o<a;o++){const l=h_[o];l.instanceId=s,l.object=this,i.push(l)}h_.length=0}}setColorAt(t,i){this.instanceColor===null&&(this.instanceColor=new Cg(new Float32Array(this.instanceMatrix.count*3),3)),i.toArray(this.instanceColor.array,t*3)}setMatrixAt(t,i){i.toArray(this.instanceMatrix.array,t*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Zr extends Gn{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ct(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const hU=new te,dU=new te,fU=new Nt,wT=new Yx,d_=new Yh;class ou extends fi{constructor(t=new Qt,i=new Zr){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t,i){return super.copy(t,i),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.index===null){const i=t.attributes.position,n=[0];for(let r=1,s=i.count;r<s;r++)hU.fromBufferAttribute(i,r-1),dU.fromBufferAttribute(i,r),n[r]=n[r-1],n[r]+=hU.distanceTo(dU);t.setAttribute("lineDistance",new wt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,i){const n=this.geometry,r=this.matrixWorld,s=t.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),d_.copy(n.boundingSphere),d_.applyMatrix4(r),d_.radius+=s,t.ray.intersectsSphere(d_)===!1)return;fU.copy(r).invert(),wT.copy(t.ray).applyMatrix4(fU);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new te,h=new te,u=new te,d=new te,f=this.isLineSegments?2:1,p=n.index,m=n.attributes.position;if(p!==null){const v=Math.max(0,o.start),x=Math.min(p.count,o.start+o.count);for(let w=v,b=x-1;w<b;w+=f){const M=p.getX(w),A=p.getX(w+1);if(c.fromBufferAttribute(m,M),h.fromBufferAttribute(m,A),wT.distanceSqToSegment(c,h,d,u)>l)continue;d.applyMatrix4(this.matrixWorld);const S=t.ray.origin.distanceTo(d);S<t.near||S>t.far||i.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else{const v=Math.max(0,o.start),x=Math.min(m.count,o.start+o.count);for(let w=v,b=x-1;w<b;w+=f){if(c.fromBufferAttribute(m,w),h.fromBufferAttribute(m,w+1),wT.distanceSqToSegment(c,h,d,u)>l)continue;d.applyMatrix4(this.matrixWorld);const A=t.ray.origin.distanceTo(d);A<t.near||A>t.far||i.push({distance:A,point:u.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const pU=new te,mU=new te;class el extends ou{constructor(t,i){super(t,i),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.index===null){const i=t.attributes.position,n=[];for(let r=0,s=i.count;r<s;r+=2)pU.fromBufferAttribute(i,r),mU.fromBufferAttribute(i,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+pU.distanceTo(mU);t.setAttribute("lineDistance",new wt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class QR extends ou{constructor(t,i){super(t,i),this.isLineLoop=!0,this.type="LineLoop"}}class Zx extends Gn{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ct(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const gU=new Nt,w3=new Yx,f_=new Yh,p_=new te;let JR=class extends fi{constructor(t=new Qt,i=new Zx){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t,i){return super.copy(t,i),this.material=t.material,this.geometry=t.geometry,this}raycast(t,i){const n=this.geometry,r=this.matrixWorld,s=t.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),f_.copy(n.boundingSphere),f_.applyMatrix4(r),f_.radius+=s,t.ray.intersectsSphere(f_)===!1)return;gU.copy(r).invert(),w3.copy(t.ray).applyMatrix4(gU);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=n.index,u=n.attributes.position;if(c!==null){const d=Math.max(0,o.start),f=Math.min(c.count,o.start+o.count);for(let p=d,g=f;p<g;p++){const m=c.getX(p);p_.fromBufferAttribute(u,m),vU(p_,m,l,r,t,i,this)}}else{const d=Math.max(0,o.start),f=Math.min(u.count,o.start+o.count);for(let p=d,g=f;p<g;p++)p_.fromBufferAttribute(u,p),vU(p_,p,l,r,t,i,this)}}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function vU(e,t,i,n,r,s,o){const a=w3.distanceSqToPoint(e);if(a<i){const l=new te;w3.closestPointToPoint(e,l),l.applyMatrix4(n);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:t,face:null,object:o})}}class ple extends en{constructor(t,i,n,r,s,o,a,l,c){super(t,i,n,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:rn,this.magFilter=s!==void 0?s:rn,this.generateMipmaps=!1;const h=this;function u(){h.needsUpdate=!0,t.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;"requestVideoFrameCallback"in t===!1&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class mle extends en{constructor(t,i,n){super({width:t,height:i}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=gn,this.minFilter=gn,this.generateMipmaps=!1,this.needsUpdate=!0}}class KR extends en{constructor(t,i,n,r,s,o,a,l,c,h,u,d){super(null,o,a,l,c,h,r,s,u,d),this.isCompressedTexture=!0,this.image={width:i,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class gle extends KR{constructor(t,i,n,r,s,o){super(t,i,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Mr}}class vle extends en{constructor(t,i,n,r,s,o,a,l,c){super(t,i,n,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class tl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,i){const n=this.getUtoTmapping(t);return this.getPoint(n,i)}getPoints(t=5){const i=[];for(let n=0;n<=t;n++)i.push(this.getPoint(n/t));return i}getSpacedPoints(t=5){const i=[];for(let n=0;n<=t;n++)i.push(this.getPointAt(n/t));return i}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let n,r=this.getPoint(0),s=0;i.push(0);for(let o=1;o<=t;o++)n=this.getPoint(o/t),s+=n.distanceTo(r),i.push(s),r=n;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,i){const n=this.getLengths();let r=0;const s=n.length;let o;i?o=i:o=t*n[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=n[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,n[r]===o)return r/(s-1);const h=n[r],d=n[r+1]-h,f=(o-h)/d;return(r+f)/(s-1)}getTangent(t,i){let r=t-1e-4,s=t+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=i||(o.isVector2?new Ve:new te);return l.copy(a).sub(o).normalize(),l}getTangentAt(t,i){const n=this.getUtoTmapping(t);return this.getTangent(n,i)}computeFrenetFrames(t,i){const n=new te,r=[],s=[],o=[],a=new te,l=new Nt;for(let f=0;f<=t;f++){const p=f/t;r[f]=this.getTangentAt(p,new te)}s[0]=new te,o[0]=new te;let c=Number.MAX_VALUE;const h=Math.abs(r[0].x),u=Math.abs(r[0].y),d=Math.abs(r[0].z);h<=c&&(c=h,n.set(1,0,0)),u<=c&&(c=u,n.set(0,1,0)),d<=c&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=t;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(Tn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(i===!0){let f=Math.acos(Tn(s[0].dot(s[t]),-1,1));f/=t,r[0].dot(a.crossVectors(s[0],s[t]))>0&&(f=-f);for(let p=1;p<=t;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class LM extends tl{constructor(t=0,i=0,n=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=i,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(t,i){const n=i||new Ve,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+t*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const h=Math.cos(this.aRotation),u=Math.sin(this.aRotation),d=l-this.aX,f=c-this.aY;l=d*h-f*u+this.aX,c=d*u+f*h+this.aY}return n.set(l,c)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}class T7 extends LM{constructor(t,i,n,r,s,o){super(t,i,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function ZR(){let e=0,t=0,i=0,n=0;function r(s,o,a,l){e=s,t=a,i=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,u){let d=(o-s)/c-(a-s)/(c+h)+(a-o)/h,f=(a-o)/h-(l-o)/(h+u)+(l-a)/u;d*=h,f*=h,r(o,a,d,f)},calc:function(s){const o=s*s,a=o*s;return e+t*s+i*o+n*a}}}const m_=new te,_T=new ZR,bT=new ZR,AT=new ZR;class P7 extends tl{constructor(t=[],i=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=i,this.curveType=n,this.tension=r}getPoint(t,i=new te){const n=i,r=this.points,s=r.length,o=(s-(this.closed?0:1))*t;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,h;this.closed||a>0?c=r[(a-1)%s]:(m_.subVectors(r[0],r[1]).add(r[0]),c=m_);const u=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?h=r[(a+2)%s]:(m_.subVectors(r[s-1],r[s-2]).add(r[s-1]),h=m_),this.curveType==="centripetal"||this.curveType==="chordal"){const f=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(u),f),g=Math.pow(u.distanceToSquared(d),f),m=Math.pow(d.distanceToSquared(h),f);g<1e-4&&(g=1),p<1e-4&&(p=g),m<1e-4&&(m=g),_T.initNonuniformCatmullRom(c.x,u.x,d.x,h.x,p,g,m),bT.initNonuniformCatmullRom(c.y,u.y,d.y,h.y,p,g,m),AT.initNonuniformCatmullRom(c.z,u.z,d.z,h.z,p,g,m)}else this.curveType==="catmullrom"&&(_T.initCatmullRom(c.x,u.x,d.x,h.x,this.tension),bT.initCatmullRom(c.y,u.y,d.y,h.y,this.tension),AT.initCatmullRom(c.z,u.z,d.z,h.z,this.tension));return n.set(_T.calc(l),bT.calc(l),AT.calc(l)),n}copy(t){super.copy(t),this.points=[];for(let i=0,n=t.points.length;i<n;i++){const r=t.points[i];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let i=0,n=this.points.length;i<n;i++){const r=this.points[i];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let i=0,n=t.points.length;i<n;i++){const r=t.points[i];this.points.push(new te().fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function yU(e,t,i,n,r){const s=(n-t)*.5,o=(r-i)*.5,a=e*e,l=e*a;return(2*i-2*n+s+o)*l+(-3*i+3*n-2*s-o)*a+s*e+i}function yle(e,t){const i=1-e;return i*i*t}function xle(e,t){return 2*(1-e)*e*t}function wle(e,t){return e*e*t}function my(e,t,i,n){return yle(e,t)+xle(e,i)+wle(e,n)}function _le(e,t){const i=1-e;return i*i*i*t}function ble(e,t){const i=1-e;return 3*i*i*e*t}function Ale(e,t){return 3*(1-e)*e*e*t}function Sle(e,t){return e*e*e*t}function gy(e,t,i,n,r){return _le(e,t)+ble(e,i)+Ale(e,n)+Sle(e,r)}class $R extends tl{constructor(t=new Ve,i=new Ve,n=new Ve,r=new Ve){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=i,this.v2=n,this.v3=r}getPoint(t,i=new Ve){const n=i,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(gy(t,r.x,s.x,o.x,a.x),gy(t,r.y,s.y,o.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class D7 extends tl{constructor(t=new te,i=new te,n=new te,r=new te){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=i,this.v2=n,this.v3=r}getPoint(t,i=new te){const n=i,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(gy(t,r.x,s.x,o.x,a.x),gy(t,r.y,s.y,o.y,a.y),gy(t,r.z,s.z,o.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class RM extends tl{constructor(t=new Ve,i=new Ve){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=i}getPoint(t,i=new Ve){const n=i;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,i){return this.getPoint(t,i)}getTangent(t,i){const n=i||new Ve;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class B7 extends tl{constructor(t=new te,i=new te){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=i}getPoint(t,i=new te){const n=i;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,i){return this.getPoint(t,i)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class eI extends tl{constructor(t=new Ve,i=new Ve,n=new Ve){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=i,this.v2=n}getPoint(t,i=new Ve){const n=i,r=this.v0,s=this.v1,o=this.v2;return n.set(my(t,r.x,s.x,o.x),my(t,r.y,s.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class tI extends tl{constructor(t=new te,i=new te,n=new te){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=i,this.v2=n}getPoint(t,i=new te){const n=i,r=this.v0,s=this.v1,o=this.v2;return n.set(my(t,r.x,s.x,o.x),my(t,r.y,s.y,o.y),my(t,r.z,s.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class iI extends tl{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,i=new Ve){const n=i,r=this.points,s=(r.length-1)*t,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],h=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return n.set(yU(a,l.x,c.x,h.x,u.x),yU(a,l.y,c.y,h.y,u.y)),n}copy(t){super.copy(t),this.points=[];for(let i=0,n=t.points.length;i<n;i++){const r=t.points[i];this.points.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let i=0,n=this.points.length;i<n;i++){const r=this.points[i];t.points.push(r.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let i=0,n=t.points.length;i<n;i++){const r=t.points[i];this.points.push(new Ve().fromArray(r))}return this}}var nI=Object.freeze({__proto__:null,ArcCurve:T7,CatmullRomCurve3:P7,CubicBezierCurve:$R,CubicBezierCurve3:D7,EllipseCurve:LM,LineCurve:RM,LineCurve3:B7,QuadraticBezierCurve:eI,QuadraticBezierCurve3:tI,SplineCurve:iI});class L7 extends tl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);t.equals(i)||this.curves.push(new RM(i,t))}getPoint(t,i){const n=t*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,i)}s++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let i=0;for(let n=0,r=this.curves.length;n<r;n++)i+=this.curves[n].getLength(),t.push(i);return this.cacheLengths=t,t}getSpacedPoints(t=40){const i=[];for(let n=0;n<=t;n++)i.push(this.getPoint(n/t));return this.autoClose&&i.push(i[0]),i}getPoints(t=12){const i=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?t*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?t*o.points.length:t,l=o.getPoints(a);for(let c=0;c<l.length;c++){const h=l[c];n&&n.equals(h)||(i.push(h),n=h)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(t){super.copy(t),this.curves=[];for(let i=0,n=t.curves.length;i<n;i++){const r=t.curves[i];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let i=0,n=this.curves.length;i<n;i++){const r=this.curves[i];t.curves.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let i=0,n=t.curves.length;i<n;i++){const r=t.curves[i];this.curves.push(new nI[r.type]().fromJSON(r))}return this}}class lx extends L7{constructor(t){super(),this.type="Path",this.currentPoint=new Ve,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let i=1,n=t.length;i<n;i++)this.lineTo(t[i].x,t[i].y);return this}moveTo(t,i){return this.currentPoint.set(t,i),this}lineTo(t,i){const n=new RM(this.currentPoint.clone(),new Ve(t,i));return this.curves.push(n),this.currentPoint.set(t,i),this}quadraticCurveTo(t,i,n,r){const s=new eI(this.currentPoint.clone(),new Ve(t,i),new Ve(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(t,i,n,r,s,o){const a=new $R(this.currentPoint.clone(),new Ve(t,i),new Ve(n,r),new Ve(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(t){const i=[this.currentPoint.clone()].concat(t),n=new iI(i);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,i,n,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(t+a,i+l,n,r,s,o),this}absarc(t,i,n,r,s,o){return this.absellipse(t,i,n,n,r,s,o),this}ellipse(t,i,n,r,s,o,a,l){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(t+c,i+h,n,r,s,o,a,l),this}absellipse(t,i,n,r,s,o,a,l){const c=new LM(t,i,n,r,s,o,a,l);if(this.curves.length>0){const u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class $g extends Qt{constructor(t=[new Ve(0,-.5),new Ve(.5,0),new Ve(0,.5)],i=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:t,segments:i,phiStart:n,phiLength:r},i=Math.floor(i),r=Tn(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],h=1/i,u=new te,d=new Ve,f=new te,p=new te,g=new te;let m=0,v=0;for(let x=0;x<=t.length-1;x++)switch(x){case 0:m=t[x+1].x-t[x].x,v=t[x+1].y-t[x].y,f.x=v*1,f.y=-m,f.z=v*0,g.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case t.length-1:l.push(g.x,g.y,g.z);break;default:m=t[x+1].x-t[x].x,v=t[x+1].y-t[x].y,f.x=v*1,f.y=-m,f.z=v*0,p.copy(f),f.x+=g.x,f.y+=g.y,f.z+=g.z,f.normalize(),l.push(f.x,f.y,f.z),g.copy(p)}for(let x=0;x<=i;x++){const w=n+x*h*r,b=Math.sin(w),M=Math.cos(w);for(let A=0;A<=t.length-1;A++){u.x=t[A].x*b,u.y=t[A].y,u.z=t[A].x*M,o.push(u.x,u.y,u.z),d.x=x/i,d.y=A/(t.length-1),a.push(d.x,d.y);const T=l[3*A+0]*b,S=l[3*A+1],C=l[3*A+0]*M;c.push(T,S,C)}}for(let x=0;x<i;x++)for(let w=0;w<t.length-1;w++){const b=w+x*t.length,M=b,A=b+t.length,T=b+t.length+1,S=b+1;s.push(M,A,S),s.push(T,S,A)}this.setIndex(s),this.setAttribute("position",new wt(o,3)),this.setAttribute("uv",new wt(a,2)),this.setAttribute("normal",new wt(c,3))}static fromJSON(t){return new $g(t.points,t.segments,t.phiStart,t.phiLength)}}class $x extends $g{constructor(t=1,i=1,n=4,r=8){const s=new lx;s.absarc(0,-i/2,t,Math.PI*1.5,0),s.absarc(0,i/2,t,0,Math.PI*.5),super(s.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:t,height:i,capSegments:n,radialSegments:r}}static fromJSON(t){return new $x(t.radius,t.length,t.capSegments,t.radialSegments)}}class e1 extends Qt{constructor(t=1,i=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:i,thetaStart:n,thetaLength:r},i=Math.max(3,i);const s=[],o=[],a=[],l=[],c=new te,h=new Ve;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let u=0,d=3;u<=i;u++,d+=3){const f=n+u/i*r;c.x=t*Math.cos(f),c.y=t*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),h.x=(o[d]/t+1)/2,h.y=(o[d+1]/t+1)/2,l.push(h.x,h.y)}for(let u=1;u<=i;u++)s.push(u,u+1,0);this.setIndex(s),this.setAttribute("position",new wt(o,3)),this.setAttribute("normal",new wt(a,3)),this.setAttribute("uv",new wt(l,2))}static fromJSON(t){return new e1(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class Xf extends Qt{constructor(t=1,i=1,n=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:i,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const h=[],u=[],d=[],f=[];let p=0;const g=[],m=n/2;let v=0;x(),o===!1&&(t>0&&w(!0),i>0&&w(!1)),this.setIndex(h),this.setAttribute("position",new wt(u,3)),this.setAttribute("normal",new wt(d,3)),this.setAttribute("uv",new wt(f,2));function x(){const b=new te,M=new te;let A=0;const T=(i-t)/n;for(let S=0;S<=s;S++){const C=[],P=S/s,B=P*(i-t)+t;for(let k=0;k<=r;k++){const z=k/r,F=z*l+a,W=Math.sin(F),K=Math.cos(F);M.x=B*W,M.y=-P*n+m,M.z=B*K,u.push(M.x,M.y,M.z),b.set(W,T,K).normalize(),d.push(b.x,b.y,b.z),f.push(z,1-P),C.push(p++)}g.push(C)}for(let S=0;S<r;S++)for(let C=0;C<s;C++){const P=g[C][S],B=g[C+1][S],k=g[C+1][S+1],z=g[C][S+1];h.push(P,B,z),h.push(B,k,z),A+=6}c.addGroup(v,A,0),v+=A}function w(b){const M=p,A=new Ve,T=new te;let S=0;const C=b===!0?t:i,P=b===!0?1:-1;for(let k=1;k<=r;k++)u.push(0,m*P,0),d.push(0,P,0),f.push(.5,.5),p++;const B=p;for(let k=0;k<=r;k++){const F=k/r*l+a,W=Math.cos(F),K=Math.sin(F);T.x=C*K,T.y=m*P,T.z=C*W,u.push(T.x,T.y,T.z),d.push(0,P,0),A.x=W*.5+.5,A.y=K*.5*P+.5,f.push(A.x,A.y),p++}for(let k=0;k<r;k++){const z=M+k,F=B+k;b===!0?h.push(F,F+1,z):h.push(F+1,F,z),S+=3}c.addGroup(v,S,b===!0?1:2),v+=S}}static fromJSON(t){return new Xf(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class t1 extends Xf{constructor(t=1,i=1,n=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,t,i,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:i,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(t){return new t1(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class hu extends Qt{constructor(t=[],i=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:i,radius:n,detail:r};const s=[],o=[];a(r),c(n),h(),this.setAttribute("position",new wt(s,3)),this.setAttribute("normal",new wt(s.slice(),3)),this.setAttribute("uv",new wt(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(x){const w=new te,b=new te,M=new te;for(let A=0;A<i.length;A+=3)f(i[A+0],w),f(i[A+1],b),f(i[A+2],M),l(w,b,M,x)}function l(x,w,b,M){const A=M+1,T=[];for(let S=0;S<=A;S++){T[S]=[];const C=x.clone().lerp(b,S/A),P=w.clone().lerp(b,S/A),B=A-S;for(let k=0;k<=B;k++)k===0&&S===A?T[S][k]=C:T[S][k]=C.clone().lerp(P,k/B)}for(let S=0;S<A;S++)for(let C=0;C<2*(A-S)-1;C++){const P=Math.floor(C/2);C%2===0?(d(T[S][P+1]),d(T[S+1][P]),d(T[S][P])):(d(T[S][P+1]),d(T[S+1][P+1]),d(T[S+1][P]))}}function c(x){const w=new te;for(let b=0;b<s.length;b+=3)w.x=s[b+0],w.y=s[b+1],w.z=s[b+2],w.normalize().multiplyScalar(x),s[b+0]=w.x,s[b+1]=w.y,s[b+2]=w.z}function h(){const x=new te;for(let w=0;w<s.length;w+=3){x.x=s[w+0],x.y=s[w+1],x.z=s[w+2];const b=m(x)/2/Math.PI+.5,M=v(x)/Math.PI+.5;o.push(b,1-M)}p(),u()}function u(){for(let x=0;x<o.length;x+=6){const w=o[x+0],b=o[x+2],M=o[x+4],A=Math.max(w,b,M),T=Math.min(w,b,M);A>.9&&T<.1&&(w<.2&&(o[x+0]+=1),b<.2&&(o[x+2]+=1),M<.2&&(o[x+4]+=1))}}function d(x){s.push(x.x,x.y,x.z)}function f(x,w){const b=x*3;w.x=t[b+0],w.y=t[b+1],w.z=t[b+2]}function p(){const x=new te,w=new te,b=new te,M=new te,A=new Ve,T=new Ve,S=new Ve;for(let C=0,P=0;C<s.length;C+=9,P+=6){x.set(s[C+0],s[C+1],s[C+2]),w.set(s[C+3],s[C+4],s[C+5]),b.set(s[C+6],s[C+7],s[C+8]),A.set(o[P+0],o[P+1]),T.set(o[P+2],o[P+3]),S.set(o[P+4],o[P+5]),M.copy(x).add(w).add(b).divideScalar(3);const B=m(M);g(A,P+0,x,B),g(T,P+2,w,B),g(S,P+4,b,B)}}function g(x,w,b,M){M<0&&x.x===1&&(o[w]=x.x-1),b.x===0&&b.z===0&&(o[w]=M/2/Math.PI+.5)}function m(x){return Math.atan2(x.z,-x.x)}function v(x){return Math.atan2(-x.y,Math.sqrt(x.x*x.x+x.z*x.z))}}static fromJSON(t){return new hu(t.vertices,t.indices,t.radius,t.details)}}class i1 extends hu{constructor(t=1,i=0){const n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,t,i),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new i1(t.radius,t.detail)}}const g_=new te,v_=new te,ST=new te,y_=new Ko;class R7 extends Qt{constructor(t=null,i=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:t,thresholdAngle:i},t!==null){const r=Math.pow(10,4),s=Math.cos(mf*i),o=t.getIndex(),a=t.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],h=["a","b","c"],u=new Array(3),d={},f=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:g,b:m,c:v}=y_;if(g.fromBufferAttribute(a,c[0]),m.fromBufferAttribute(a,c[1]),v.fromBufferAttribute(a,c[2]),y_.getNormal(ST),u[0]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,u[1]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,u[2]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,!(u[0]===u[1]||u[1]===u[2]||u[2]===u[0]))for(let x=0;x<3;x++){const w=(x+1)%3,b=u[x],M=u[w],A=y_[h[x]],T=y_[h[w]],S=`${b}_${M}`,C=`${M}_${b}`;C in d&&d[C]?(ST.dot(d[C].normal)<=s&&(f.push(A.x,A.y,A.z),f.push(T.x,T.y,T.z)),d[C]=null):S in d||(d[S]={index0:c[x],index1:c[w],normal:ST.clone()})}}for(const p in d)if(d[p]){const{index0:g,index1:m}=d[p];g_.fromBufferAttribute(a,g),v_.fromBufferAttribute(a,m),f.push(g_.x,g_.y,g_.z),f.push(v_.x,v_.y,v_.z)}this.setAttribute("position",new wt(f,3))}}}class yf extends lx{constructor(t){super(t),this.uuid=vo(),this.type="Shape",this.holes=[]}getPointsHoles(t){const i=[];for(let n=0,r=this.holes.length;n<r;n++)i[n]=this.holes[n].getPoints(t);return i}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let i=0,n=t.holes.length;i<n;i++){const r=t.holes[i];this.holes.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let i=0,n=this.holes.length;i<n;i++){const r=this.holes[i];t.holes.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let i=0,n=t.holes.length;i<n;i++){const r=t.holes[i];this.holes.push(new lx().fromJSON(r))}return this}}const Mle={triangulate:function(e,t,i=2){const n=t&&t.length,r=n?t[0]*i:e.length;let s=I7(e,0,r,i,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,u,d,f;if(n&&(s=Dle(e,t,s,i)),e.length>80*i){a=c=e[0],l=h=e[1];for(let p=i;p<r;p+=i)u=e[p],d=e[p+1],u<a&&(a=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);f=Math.max(c-a,h-l),f=f!==0?32767/f:0}return cx(s,o,i,a,l,f,0),o}};function I7(e,t,i,n,r){let s,o;if(r===Gle(e,t,i,n)>0)for(s=t;s<i;s+=n)o=xU(s,e[s],e[s+1],o);else for(s=i-n;s>=t;s-=n)o=xU(s,e[s],e[s+1],o);return o&&IM(o,o.next)&&(hx(o),o=o.next),o}function If(e,t){if(!e)return e;t||(t=e);let i=e,n;do if(n=!1,!i.steiner&&(IM(i,i.next)||sn(i.prev,i,i.next)===0)){if(hx(i),i=t=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==t);return t}function cx(e,t,i,n,r,s,o){if(!e)return;!o&&s&&Ole(e,n,r,s);let a=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,s?Cle(e,n,r,s):Ele(e)){t.push(l.i/i|0),t.push(e.i/i|0),t.push(c.i/i|0),hx(e),e=c.next,a=c.next;continue}if(e=c,e===a){o?o===1?(e=Tle(If(e),t,i),cx(e,t,i,n,r,s,2)):o===2&&Ple(e,t,i,n,r,s):cx(If(e),t,i,n,r,s,1);break}}}function Ele(e){const t=e.prev,i=e,n=e.next;if(sn(t,i,n)>=0)return!1;const r=t.x,s=i.x,o=n.x,a=t.y,l=i.y,c=n.y,h=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c;let p=n.next;for(;p!==t;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&Dm(r,a,s,l,o,c,p.x,p.y)&&sn(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Cle(e,t,i,n){const r=e.prev,s=e,o=e.next;if(sn(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,h=r.y,u=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<u?h<d?h:d:u<d?u:d,g=a>l?a>c?a:c:l>c?l:c,m=h>u?h>d?h:d:u>d?u:d,v=_3(f,p,t,i,n),x=_3(g,m,t,i,n);let w=e.prevZ,b=e.nextZ;for(;w&&w.z>=v&&b&&b.z<=x;){if(w.x>=f&&w.x<=g&&w.y>=p&&w.y<=m&&w!==r&&w!==o&&Dm(a,h,l,u,c,d,w.x,w.y)&&sn(w.prev,w,w.next)>=0||(w=w.prevZ,b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==o&&Dm(a,h,l,u,c,d,b.x,b.y)&&sn(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;w&&w.z>=v;){if(w.x>=f&&w.x<=g&&w.y>=p&&w.y<=m&&w!==r&&w!==o&&Dm(a,h,l,u,c,d,w.x,w.y)&&sn(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;b&&b.z<=x;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==o&&Dm(a,h,l,u,c,d,b.x,b.y)&&sn(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Tle(e,t,i){let n=e;do{const r=n.prev,s=n.next.next;!IM(r,s)&&O7(r,n,n.next,s)&&ux(r,s)&&ux(s,r)&&(t.push(r.i/i|0),t.push(n.i/i|0),t.push(s.i/i|0),hx(n),hx(n.next),n=e=s),n=n.next}while(n!==e);return If(n)}function Ple(e,t,i,n,r,s){let o=e;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&zle(o,a)){let l=F7(o,a);o=If(o,o.next),l=If(l,l.next),cx(o,t,i,n,r,s,0),cx(l,t,i,n,r,s,0);return}a=a.next}o=o.next}while(o!==e)}function Dle(e,t,i,n){const r=[];let s,o,a,l,c;for(s=0,o=t.length;s<o;s++)a=t[s]*n,l=s<o-1?t[s+1]*n:e.length,c=I7(e,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(Nle(c));for(r.sort(Ble),s=0;s<r.length;s++)i=Lle(r[s],i);return i}function Ble(e,t){return e.x-t.x}function Lle(e,t){const i=Rle(e,t);if(!i)return t;const n=F7(i,e);return If(n,n.next),If(i,i.next)}function Rle(e,t){let i=t,n=-1/0,r;const s=e.x,o=e.y;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){const d=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(d<=s&&d>n&&(n=d,r=i.x<i.next.x?i:i.next,d===s))return r}i=i.next}while(i!==t);if(!r)return null;const a=r,l=r.x,c=r.y;let h=1/0,u;i=r;do s>=i.x&&i.x>=l&&s!==i.x&&Dm(o<c?s:n,o,l,c,o<c?n:s,o,i.x,i.y)&&(u=Math.abs(o-i.y)/(s-i.x),ux(i,e)&&(u<h||u===h&&(i.x>r.x||i.x===r.x&&Ile(r,i)))&&(r=i,h=u)),i=i.next;while(i!==a);return r}function Ile(e,t){return sn(e.prev,e,t.prev)<0&&sn(t.next,e,e.next)<0}function Ole(e,t,i,n){let r=e;do r.z===0&&(r.z=_3(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,Fle(r)}function Fle(e){let t,i,n,r,s,o,a,l,c=1;do{for(i=e,e=null,s=null,o=0;i;){for(o++,n=i,a=0,t=0;t<c&&(a++,n=n.nextZ,!!n);t++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;i=n}s.nextZ=null,c*=2}while(o>1);return e}function _3(e,t,i,n,r){return e=(e-i)*r|0,t=(t-n)*r|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Nle(e){let t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function Dm(e,t,i,n,r,s,o,a){return(r-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(n-a)>=(i-o)*(t-a)&&(i-o)*(s-a)>=(r-o)*(n-a)}function zle(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!kle(e,t)&&(ux(e,t)&&ux(t,e)&&Ule(e,t)&&(sn(e.prev,e,t.prev)||sn(e,t.prev,t))||IM(e,t)&&sn(e.prev,e,e.next)>0&&sn(t.prev,t,t.next)>0)}function sn(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function IM(e,t){return e.x===t.x&&e.y===t.y}function O7(e,t,i,n){const r=w_(sn(e,t,i)),s=w_(sn(e,t,n)),o=w_(sn(i,n,e)),a=w_(sn(i,n,t));return!!(r!==s&&o!==a||r===0&&x_(e,i,t)||s===0&&x_(e,n,t)||o===0&&x_(i,e,n)||a===0&&x_(i,t,n))}function x_(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function w_(e){return e>0?1:e<0?-1:0}function kle(e,t){let i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&O7(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function ux(e,t){return sn(e.prev,e,e.next)<0?sn(e,t,e.next)>=0&&sn(e,e.prev,t)>=0:sn(e,t,e.prev)<0||sn(e,e.next,t)<0}function Ule(e,t){let i=e,n=!1;const r=(e.x+t.x)/2,s=(e.y+t.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==e);return n}function F7(e,t){const i=new b3(e.i,e.x,e.y),n=new b3(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function xU(e,t,i,n){const r=new b3(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function hx(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function b3(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gle(e,t,i,n){let r=0;for(let s=t,o=i-n;s<i;s+=n)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}class Ul{static area(t){const i=t.length;let n=0;for(let r=i-1,s=0;s<i;r=s++)n+=t[r].x*t[s].y-t[s].x*t[r].y;return n*.5}static isClockWise(t){return Ul.area(t)<0}static triangulateShape(t,i){const n=[],r=[],s=[];wU(t),_U(n,t);let o=t.length;i.forEach(wU);for(let l=0;l<i.length;l++)r.push(o),o+=i[l].length,_U(n,i[l]);const a=Mle.triangulate(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function wU(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function _U(e,t){for(let i=0;i<t.length;i++)e.push(t[i].x),e.push(t[i].y)}class n1 extends Qt{constructor(t=new yf([new Ve(.5,.5),new Ve(-.5,.5),new Ve(-.5,-.5),new Ve(.5,-.5)]),i={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:i},t=Array.isArray(t)?t:[t];const n=this,r=[],s=[];for(let a=0,l=t.length;a<l;a++){const c=t[a];o(c)}this.setAttribute("position",new wt(r,3)),this.setAttribute("uv",new wt(s,2)),this.computeVertexNormals();function o(a){const l=[],c=i.curveSegments!==void 0?i.curveSegments:12,h=i.steps!==void 0?i.steps:1,u=i.depth!==void 0?i.depth:1;let d=i.bevelEnabled!==void 0?i.bevelEnabled:!0,f=i.bevelThickness!==void 0?i.bevelThickness:.2,p=i.bevelSize!==void 0?i.bevelSize:f-.1,g=i.bevelOffset!==void 0?i.bevelOffset:0,m=i.bevelSegments!==void 0?i.bevelSegments:3;const v=i.extrudePath,x=i.UVGenerator!==void 0?i.UVGenerator:Hle;let w,b=!1,M,A,T,S;v&&(w=v.getSpacedPoints(h),b=!0,d=!1,M=v.computeFrenetFrames(h,!1),A=new te,T=new te,S=new te),d||(m=0,f=0,p=0,g=0);const C=a.extractPoints(c);let P=C.shape;const B=C.holes;if(!Ul.isClockWise(P)){P=P.reverse();for(let ce=0,se=B.length;ce<se;ce++){const be=B[ce];Ul.isClockWise(be)&&(B[ce]=be.reverse())}}const z=Ul.triangulateShape(P,B),F=P;for(let ce=0,se=B.length;ce<se;ce++){const be=B[ce];P=P.concat(be)}function W(ce,se,be){return se||console.error("THREE.ExtrudeGeometry: vec does not exist"),se.clone().multiplyScalar(be).add(ce)}const K=P.length,Z=z.length;function U(ce,se,be){let Ee,Le,ze;const Oe=ce.x-se.x,Ge=ce.y-se.y,tt=be.x-ce.x,ot=be.y-ce.y,N=Oe*Oe+Ge*Ge,R=Oe*ot-Ge*tt;if(Math.abs(R)>Number.EPSILON){const ie=Math.sqrt(N),xe=Math.sqrt(tt*tt+ot*ot),Me=se.x-Ge/ie,Te=se.y+Oe/ie,qe=be.x-ot/xe,De=be.y+tt/xe,ue=((qe-Me)*ot-(De-Te)*tt)/(Oe*ot-Ge*tt);Ee=Me+Oe*ue-ce.x,Le=Te+Ge*ue-ce.y;const He=Ee*Ee+Le*Le;if(He<=2)return new Ve(Ee,Le);ze=Math.sqrt(He/2)}else{let ie=!1;Oe>Number.EPSILON?tt>Number.EPSILON&&(ie=!0):Oe<-Number.EPSILON?tt<-Number.EPSILON&&(ie=!0):Math.sign(Ge)===Math.sign(ot)&&(ie=!0),ie?(Ee=-Ge,Le=Oe,ze=Math.sqrt(N)):(Ee=Oe,Le=Ge,ze=Math.sqrt(N/2))}return new Ve(Ee/ze,Le/ze)}const X=[];for(let ce=0,se=F.length,be=se-1,Ee=ce+1;ce<se;ce++,be++,Ee++)be===se&&(be=0),Ee===se&&(Ee=0),X[ce]=U(F[ce],F[be],F[Ee]);const V=[];let q,H=X.concat();for(let ce=0,se=B.length;ce<se;ce++){const be=B[ce];q=[];for(let Ee=0,Le=be.length,ze=Le-1,Oe=Ee+1;Ee<Le;Ee++,ze++,Oe++)ze===Le&&(ze=0),Oe===Le&&(Oe=0),q[Ee]=U(be[Ee],be[ze],be[Oe]);V.push(q),H=H.concat(q)}for(let ce=0;ce<m;ce++){const se=ce/m,be=f*Math.cos(se*Math.PI/2),Ee=p*Math.sin(se*Math.PI/2)+g;for(let Le=0,ze=F.length;Le<ze;Le++){const Oe=W(F[Le],X[Le],Ee);ve(Oe.x,Oe.y,-be)}for(let Le=0,ze=B.length;Le<ze;Le++){const Oe=B[Le];q=V[Le];for(let Ge=0,tt=Oe.length;Ge<tt;Ge++){const ot=W(Oe[Ge],q[Ge],Ee);ve(ot.x,ot.y,-be)}}}const Q=p+g;for(let ce=0;ce<K;ce++){const se=d?W(P[ce],H[ce],Q):P[ce];b?(T.copy(M.normals[0]).multiplyScalar(se.x),A.copy(M.binormals[0]).multiplyScalar(se.y),S.copy(w[0]).add(T).add(A),ve(S.x,S.y,S.z)):ve(se.x,se.y,0)}for(let ce=1;ce<=h;ce++)for(let se=0;se<K;se++){const be=d?W(P[se],H[se],Q):P[se];b?(T.copy(M.normals[ce]).multiplyScalar(be.x),A.copy(M.binormals[ce]).multiplyScalar(be.y),S.copy(w[ce]).add(T).add(A),ve(S.x,S.y,S.z)):ve(be.x,be.y,u/h*ce)}for(let ce=m-1;ce>=0;ce--){const se=ce/m,be=f*Math.cos(se*Math.PI/2),Ee=p*Math.sin(se*Math.PI/2)+g;for(let Le=0,ze=F.length;Le<ze;Le++){const Oe=W(F[Le],X[Le],Ee);ve(Oe.x,Oe.y,u+be)}for(let Le=0,ze=B.length;Le<ze;Le++){const Oe=B[Le];q=V[Le];for(let Ge=0,tt=Oe.length;Ge<tt;Ge++){const ot=W(Oe[Ge],q[Ge],Ee);b?ve(ot.x,ot.y+w[h-1].y,w[h-1].x+be):ve(ot.x,ot.y,u+be)}}}J(),le();function J(){const ce=r.length/3;if(d){let se=0,be=K*se;for(let Ee=0;Ee<Z;Ee++){const Le=z[Ee];pe(Le[2]+be,Le[1]+be,Le[0]+be)}se=h+m*2,be=K*se;for(let Ee=0;Ee<Z;Ee++){const Le=z[Ee];pe(Le[0]+be,Le[1]+be,Le[2]+be)}}else{for(let se=0;se<Z;se++){const be=z[se];pe(be[2],be[1],be[0])}for(let se=0;se<Z;se++){const be=z[se];pe(be[0]+K*h,be[1]+K*h,be[2]+K*h)}}n.addGroup(ce,r.length/3-ce,0)}function le(){const ce=r.length/3;let se=0;j(F,se),se+=F.length;for(let be=0,Ee=B.length;be<Ee;be++){const Le=B[be];j(Le,se),se+=Le.length}n.addGroup(ce,r.length/3-ce,1)}function j(ce,se){let be=ce.length;for(;--be>=0;){const Ee=be;let Le=be-1;Le<0&&(Le=ce.length-1);for(let ze=0,Oe=h+m*2;ze<Oe;ze++){const Ge=K*ze,tt=K*(ze+1),ot=se+Ee+Ge,N=se+Le+Ge,R=se+Le+tt,ie=se+Ee+tt;me(ot,N,R,ie)}}}function ve(ce,se,be){l.push(ce),l.push(se),l.push(be)}function pe(ce,se,be){de(ce),de(se),de(be);const Ee=r.length/3,Le=x.generateTopUV(n,r,Ee-3,Ee-2,Ee-1);Se(Le[0]),Se(Le[1]),Se(Le[2])}function me(ce,se,be,Ee){de(ce),de(se),de(Ee),de(se),de(be),de(Ee);const Le=r.length/3,ze=x.generateSideWallUV(n,r,Le-6,Le-3,Le-2,Le-1);Se(ze[0]),Se(ze[1]),Se(ze[3]),Se(ze[1]),Se(ze[2]),Se(ze[3])}function de(ce){r.push(l[ce*3+0]),r.push(l[ce*3+1]),r.push(l[ce*3+2])}function Se(ce){s.push(ce.x),s.push(ce.y)}}}toJSON(){const t=super.toJSON(),i=this.parameters.shapes,n=this.parameters.options;return Vle(i,n,t)}static fromJSON(t,i){const n=[];for(let s=0,o=t.shapes.length;s<o;s++){const a=i[t.shapes[s]];n.push(a)}const r=t.options.extrudePath;return r!==void 0&&(t.options.extrudePath=new nI[r.type]().fromJSON(r)),new n1(n,t.options)}}const Hle={generateTopUV:function(e,t,i,n,r){const s=t[i*3],o=t[i*3+1],a=t[n*3],l=t[n*3+1],c=t[r*3],h=t[r*3+1];return[new Ve(s,o),new Ve(a,l),new Ve(c,h)]},generateSideWallUV:function(e,t,i,n,r,s){const o=t[i*3],a=t[i*3+1],l=t[i*3+2],c=t[n*3],h=t[n*3+1],u=t[n*3+2],d=t[r*3],f=t[r*3+1],p=t[r*3+2],g=t[s*3],m=t[s*3+1],v=t[s*3+2];return Math.abs(a-h)<Math.abs(o-c)?[new Ve(o,1-l),new Ve(c,1-u),new Ve(d,1-p),new Ve(g,1-v)]:[new Ve(a,1-l),new Ve(h,1-u),new Ve(f,1-p),new Ve(m,1-v)]}};function Vle(e,t,i){if(i.shapes=[],Array.isArray(e))for(let n=0,r=e.length;n<r;n++){const s=e[n];i.shapes.push(s.uuid)}else i.shapes.push(e.uuid);return i.options=Object.assign({},t),t.extrudePath!==void 0&&(i.options.extrudePath=t.extrudePath.toJSON()),i}class r1 extends hu{constructor(t=1,i=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,t,i),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new r1(t.radius,t.detail)}}class ev extends hu{constructor(t=1,i=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,t,i),this.type="OctahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new ev(t.radius,t.detail)}}class s1 extends Qt{constructor(t=.5,i=1,n=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:i,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n),r=Math.max(1,r);const a=[],l=[],c=[],h=[];let u=t;const d=(i-t)/r,f=new te,p=new Ve;for(let g=0;g<=r;g++){for(let m=0;m<=n;m++){const v=s+m/n*o;f.x=u*Math.cos(v),f.y=u*Math.sin(v),l.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/i+1)/2,p.y=(f.y/i+1)/2,h.push(p.x,p.y)}u+=d}for(let g=0;g<r;g++){const m=g*(n+1);for(let v=0;v<n;v++){const x=v+m,w=x,b=x+n+1,M=x+n+2,A=x+1;a.push(w,b,A),a.push(b,M,A)}}this.setIndex(a),this.setAttribute("position",new wt(l,3)),this.setAttribute("normal",new wt(c,3)),this.setAttribute("uv",new wt(h,2))}static fromJSON(t){return new s1(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class o1 extends Qt{constructor(t=new yf([new Ve(0,.5),new Ve(-.5,-.5),new Ve(.5,-.5)]),i=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:i};const n=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(t)===!1)c(t);else for(let h=0;h<t.length;h++)c(t[h]),this.addGroup(a,l,h),a+=l,l=0;this.setIndex(n),this.setAttribute("position",new wt(r,3)),this.setAttribute("normal",new wt(s,3)),this.setAttribute("uv",new wt(o,2));function c(h){const u=r.length/3,d=h.extractPoints(i);let f=d.shape;const p=d.holes;Ul.isClockWise(f)===!1&&(f=f.reverse());for(let m=0,v=p.length;m<v;m++){const x=p[m];Ul.isClockWise(x)===!0&&(p[m]=x.reverse())}const g=Ul.triangulateShape(f,p);for(let m=0,v=p.length;m<v;m++){const x=p[m];f=f.concat(x)}for(let m=0,v=f.length;m<v;m++){const x=f[m];r.push(x.x,x.y,0),s.push(0,0,1),o.push(x.x,x.y)}for(let m=0,v=g.length;m<v;m++){const x=g[m],w=x[0]+u,b=x[1]+u,M=x[2]+u;n.push(w,b,M),l+=3}}}toJSON(){const t=super.toJSON(),i=this.parameters.shapes;return jle(i,t)}static fromJSON(t,i){const n=[];for(let r=0,s=t.shapes.length;r<s;r++){const o=i[t.shapes[r]];n.push(o)}return new o1(n,t.curveSegments)}}function jle(e,t){if(t.shapes=[],Array.isArray(e))for(let i=0,n=e.length;i<n;i++){const r=e[i];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}class tv extends Qt{constructor(t=1,i=32,n=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:i,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},i=Math.max(3,Math.floor(i)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let c=0;const h=[],u=new te,d=new te,f=[],p=[],g=[],m=[];for(let v=0;v<=n;v++){const x=[],w=v/n;let b=0;v==0&&o==0?b=.5/i:v==n&&l==Math.PI&&(b=-.5/i);for(let M=0;M<=i;M++){const A=M/i;u.x=-t*Math.cos(r+A*s)*Math.sin(o+w*a),u.y=t*Math.cos(o+w*a),u.z=t*Math.sin(r+A*s)*Math.sin(o+w*a),p.push(u.x,u.y,u.z),d.copy(u).normalize(),g.push(d.x,d.y,d.z),m.push(A+b,1-w),x.push(c++)}h.push(x)}for(let v=0;v<n;v++)for(let x=0;x<i;x++){const w=h[v][x+1],b=h[v][x],M=h[v+1][x],A=h[v+1][x+1];(v!==0||o>0)&&f.push(w,b,A),(v!==n-1||l<Math.PI)&&f.push(b,M,A)}this.setIndex(f),this.setAttribute("position",new wt(p,3)),this.setAttribute("normal",new wt(g,3)),this.setAttribute("uv",new wt(m,2))}static fromJSON(t){return new tv(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class a1 extends hu{constructor(t=1,i=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,t,i),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new a1(t.radius,t.detail)}}class l1 extends Qt{constructor(t=1,i=.4,n=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:i,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],l=[],c=[],h=new te,u=new te,d=new te;for(let f=0;f<=n;f++)for(let p=0;p<=r;p++){const g=p/r*s,m=f/n*Math.PI*2;u.x=(t+i*Math.cos(m))*Math.cos(g),u.y=(t+i*Math.cos(m))*Math.sin(g),u.z=i*Math.sin(m),a.push(u.x,u.y,u.z),h.x=t*Math.cos(g),h.y=t*Math.sin(g),d.subVectors(u,h).normalize(),l.push(d.x,d.y,d.z),c.push(p/r),c.push(f/n)}for(let f=1;f<=n;f++)for(let p=1;p<=r;p++){const g=(r+1)*f+p-1,m=(r+1)*(f-1)+p-1,v=(r+1)*(f-1)+p,x=(r+1)*f+p;o.push(g,m,x),o.push(m,v,x)}this.setIndex(o),this.setAttribute("position",new wt(a,3)),this.setAttribute("normal",new wt(l,3)),this.setAttribute("uv",new wt(c,2))}static fromJSON(t){return new l1(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class c1 extends Qt{constructor(t=1,i=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:i,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],l=[],c=[],h=[],u=new te,d=new te,f=new te,p=new te,g=new te,m=new te,v=new te;for(let w=0;w<=n;++w){const b=w/n*s*Math.PI*2;x(b,s,o,t,f),x(b+.01,s,o,t,p),m.subVectors(p,f),v.addVectors(p,f),g.crossVectors(m,v),v.crossVectors(g,m),g.normalize(),v.normalize();for(let M=0;M<=r;++M){const A=M/r*Math.PI*2,T=-i*Math.cos(A),S=i*Math.sin(A);u.x=f.x+(T*v.x+S*g.x),u.y=f.y+(T*v.y+S*g.y),u.z=f.z+(T*v.z+S*g.z),l.push(u.x,u.y,u.z),d.subVectors(u,f).normalize(),c.push(d.x,d.y,d.z),h.push(w/n),h.push(M/r)}}for(let w=1;w<=n;w++)for(let b=1;b<=r;b++){const M=(r+1)*(w-1)+(b-1),A=(r+1)*w+(b-1),T=(r+1)*w+b,S=(r+1)*(w-1)+b;a.push(M,A,S),a.push(A,T,S)}this.setIndex(a),this.setAttribute("position",new wt(l,3)),this.setAttribute("normal",new wt(c,3)),this.setAttribute("uv",new wt(h,2));function x(w,b,M,A,T){const S=Math.cos(w),C=Math.sin(w),P=M/b*w,B=Math.cos(P);T.x=A*(2+B)*.5*S,T.y=A*(2+B)*C*.5,T.z=A*Math.sin(P)*.5}}static fromJSON(t){return new c1(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class u1 extends Qt{constructor(t=new tI(new te(-1,-1,0),new te(-1,1,0),new te(1,1,0)),i=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:i,radius:n,radialSegments:r,closed:s};const o=t.computeFrenetFrames(i,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new te,l=new te,c=new Ve;let h=new te;const u=[],d=[],f=[],p=[];g(),this.setIndex(p),this.setAttribute("position",new wt(u,3)),this.setAttribute("normal",new wt(d,3)),this.setAttribute("uv",new wt(f,2));function g(){for(let w=0;w<i;w++)m(w);m(s===!1?i:0),x(),v()}function m(w){h=t.getPointAt(w/i,h);const b=o.normals[w],M=o.binormals[w];for(let A=0;A<=r;A++){const T=A/r*Math.PI*2,S=Math.sin(T),C=-Math.cos(T);l.x=C*b.x+S*M.x,l.y=C*b.y+S*M.y,l.z=C*b.z+S*M.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=h.x+n*l.x,a.y=h.y+n*l.y,a.z=h.z+n*l.z,u.push(a.x,a.y,a.z)}}function v(){for(let w=1;w<=i;w++)for(let b=1;b<=r;b++){const M=(r+1)*(w-1)+(b-1),A=(r+1)*w+(b-1),T=(r+1)*w+b,S=(r+1)*(w-1)+b;p.push(M,A,S),p.push(A,T,S)}}function x(){for(let w=0;w<=i;w++)for(let b=0;b<=r;b++)c.x=w/i,c.y=b/r,f.push(c.x,c.y)}}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new u1(new nI[t.path.type]().fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class N7 extends Qt{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},t!==null){const i=[],n=new Set,r=new te,s=new te;if(t.index!==null){const o=t.attributes.position,a=t.index;let l=t.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,h=l.length;c<h;++c){const u=l[c],d=u.start,f=u.count;for(let p=d,g=d+f;p<g;p+=3)for(let m=0;m<3;m++){const v=a.getX(p+m),x=a.getX(p+(m+1)%3);r.fromBufferAttribute(o,v),s.fromBufferAttribute(o,x),bU(r,s,n)===!0&&(i.push(r.x,r.y,r.z),i.push(s.x,s.y,s.z))}}}else{const o=t.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const h=3*a+c,u=3*a+(c+1)%3;r.fromBufferAttribute(o,h),s.fromBufferAttribute(o,u),bU(r,s,n)===!0&&(i.push(r.x,r.y,r.z),i.push(s.x,s.y,s.z))}}this.setAttribute("position",new wt(i,3))}}}function bU(e,t,i){const n=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,r=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return i.has(n)===!0||i.has(r)===!0?!1:(i.add(n),i.add(r),!0)}var AU=Object.freeze({__proto__:null,BoxGeometry:qh,CapsuleGeometry:$x,CircleGeometry:e1,ConeGeometry:t1,CylinderGeometry:Xf,DodecahedronGeometry:i1,EdgesGeometry:R7,ExtrudeGeometry:n1,IcosahedronGeometry:r1,LatheGeometry:$g,OctahedronGeometry:ev,PlaneGeometry:Kg,PolyhedronGeometry:hu,RingGeometry:s1,ShapeGeometry:o1,SphereGeometry:tv,TetrahedronGeometry:a1,TorusGeometry:l1,TorusKnotGeometry:c1,TubeGeometry:u1,WireframeGeometry:N7});class z7 extends Gn{constructor(t){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ct(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}}class k7 extends ql{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class h1 extends Gn{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ct(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ct(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Wh,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class tc extends h1{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ve(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Tn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(i){this.ior=(1+.4*i)/(1-.4*i)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ct(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ct(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ct(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!=t>0&&this.version++,this._iridescence=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}class U7 extends Gn{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ct(16777215),this.specular=new ct(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ct(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Wh,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Xx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class G7 extends Gn{constructor(t){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ct(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ct(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Wh,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class H7 extends Gn{constructor(t){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Wh,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}class V7 extends Gn{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ct(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ct(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Wh,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Xx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class j7 extends Gn{constructor(t){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ct(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Wh,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this.fog=t.fog,this}}class W7 extends Zr{constructor(t){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}function jo(e,t,i){return rI(e)?new e.constructor(e.subarray(t,i!==void 0?i:e.length)):e.slice(t,i)}function rf(e,t,i){return!e||!i&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)}function rI(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function X7(e){function t(r,s){return e[r]-e[s]}const i=e.length,n=new Array(i);for(let r=0;r!==i;++r)n[r]=r;return n.sort(t),n}function A3(e,t,i){const n=e.length,r=new e.constructor(n);for(let s=0,o=0;o!==n;++s){const a=i[s]*t;for(let l=0;l!==t;++l)r[o++]=e[a+l]}return r}function sI(e,t,i,n){let r=1,s=e[0];for(;s!==void 0&&s[n]===void 0;)s=e[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(t.push(s.time),i.push.apply(i,o)),s=e[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(t.push(s.time),o.toArray(i,i.length)),s=e[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(t.push(s.time),i.push(o)),s=e[r++];while(s!==void 0)}function Wle(e,t,i,n,r=30){const s=e.clone();s.name=t;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],h=c.getValueSize(),u=[],d=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*r;if(!(p<i||p>=n)){u.push(c.times[f]);for(let g=0;g<h;++g)d.push(c.values[f*h+g])}}u.length!==0&&(c.times=rf(u,c.times.constructor),c.values=rf(d,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function Xle(e,t=0,i=e,n=30){n<=0&&(n=30);const r=i.tracks.length,s=t/n;for(let o=0;o<r;++o){const a=i.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=e.tracks.find(function(v){return v.name===a.name&&v.ValueTypeName===l});if(c===void 0)continue;let h=0;const u=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=u/3);let d=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);const p=a.times.length-1;let g;if(s<=a.times[0]){const v=h,x=u-h;g=jo(a.values,v,x)}else if(s>=a.times[p]){const v=p*u+h,x=v+u-h;g=jo(a.values,v,x)}else{const v=a.createInterpolant(),x=h,w=u-h;v.evaluate(s),g=jo(v.resultBuffer,x,w)}l==="quaternion"&&new yr().fromArray(g).normalize().conjugate().toArray(g);const m=c.times.length;for(let v=0;v<m;++v){const x=v*f+d;if(l==="quaternion")yr.multiplyQuaternionsFlat(c.values,x,g,0,c.values,x);else{const w=f-d*2;for(let b=0;b<w;++b)c.values[x+b]-=g[b]}}}return e.blendMode=LR,e}var Yle=Object.freeze({__proto__:null,arraySlice:jo,convertArray:rf,flattenJSON:sI,getKeyframeOrder:X7,isTypedArray:rI,makeClipAdditive:Xle,sortedArray:A3,subclip:Wle});class iv{constructor(t,i,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new i.constructor(n),this.sampleValues=i,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const i=this.parameterPositions;let n=this._cachedIndex,r=i[n],s=i[n-1];e:{t:{let o;i:{n:if(!(t<r)){for(let a=n+2;;){if(r===void 0){if(t<s)break n;return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=i[++n],t<r)break t}o=i.length;break i}if(!(t>=s)){const a=i[1];t<a&&(n=2,s=a);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=i[--n-1],t>=s)break t}o=n,n=0;break i}break e}for(;n<o;){const a=n+o>>>1;t<i[a]?o=a:n=a+1}if(r=i[n],s=i[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const i=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=t*r;for(let o=0;o!==r;++o)i[o]=n[s+o];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Y7 extends iv{constructor(t,i,n,r){super(t,i,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ef,endingEnd:ef}}intervalChanged_(t,i,n){const r=this.parameterPositions;let s=t-2,o=t+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case tf:s=t,a=2*i-n;break;case rx:s=r.length-2,a=i+r[s]-r[s+1];break;default:s=t,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case tf:o=t,l=2*n-i;break;case rx:o=1,l=n+r[1]-r[0];break;default:o=t-1,l=i}const c=(n-i)*.5,h=this.valueSize;this._weightPrev=c/(i-a),this._weightNext=c/(l-n),this._offsetPrev=s*h,this._offsetNext=o*h}interpolate_(t,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=t*a,c=l-a,h=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(n-i)/(r-i),g=p*p,m=g*p,v=-d*m+2*d*g-d*p,x=(1+d)*m+(-1.5-2*d)*g+(-.5+d)*p+1,w=(-1-f)*m+(1.5+f)*g+.5*p,b=f*m-f*g;for(let M=0;M!==a;++M)s[M]=v*o[h+M]+x*o[c+M]+w*o[l+M]+b*o[u+M];return s}}class oI extends iv{constructor(t,i,n,r){super(t,i,n,r)}interpolate_(t,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=t*a,c=l-a,h=(n-i)/(r-i),u=1-h;for(let d=0;d!==a;++d)s[d]=o[c+d]*u+o[l+d]*h;return s}}class q7 extends iv{constructor(t,i,n,r){super(t,i,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class il{constructor(t,i,n,r){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=rf(i,this.TimeBufferType),this.values=rf(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const i=t.constructor;let n;if(i.toJSON!==this.toJSON)n=i.toJSON(t);else{n={name:t.name,times:rf(t.times,Array),values:rf(t.values,Array)};const r=t.getInterpolation();r!==t.DefaultInterpolation&&(n.interpolation=r)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new q7(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new oI(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Y7(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let i;switch(t){case Sg:i=this.InterpolantFactoryMethodDiscrete;break;case Rf:i=this.InterpolantFactoryMethodLinear;break;case aA:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Sg;case this.InterpolantFactoryMethodLinear:return Rf;case this.InterpolantFactoryMethodSmooth:return aA}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const i=this.times;for(let n=0,r=i.length;n!==r;++n)i[n]+=t}return this}scale(t){if(t!==1){const i=this.times;for(let n=0,r=i.length;n!==r;++n)i[n]*=t}return this}trim(t,i){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<t;)++s;for(;o!==-1&&n[o]>i;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=jo(n,s,o),this.values=jo(this.values,s*a,o*a)}return this}validate(){let t=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),t=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),t=!1;break}o=l}if(r!==void 0&&rI(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),t=!1;break}}return t}optimize(){const t=jo(this.times),i=jo(this.values),n=this.getValueSize(),r=this.getInterpolation()===aA,s=t.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=t[a],h=t[a+1];if(c!==h&&(a!==1||c!==t[0]))if(r)l=!0;else{const u=a*n,d=u-n,f=u+n;for(let p=0;p!==n;++p){const g=i[u+p];if(g!==i[d+p]||g!==i[f+p]){l=!0;break}}}if(l){if(a!==o){t[o]=t[a];const u=a*n,d=o*n;for(let f=0;f!==n;++f)i[d+f]=i[u+f]}++o}}if(s>0){t[o]=t[s];for(let a=s*n,l=o*n,c=0;c!==n;++c)i[l+c]=i[a+c];++o}return o!==t.length?(this.times=jo(t,0,o),this.values=jo(i,0,o*n)):(this.times=t,this.values=i),this}clone(){const t=jo(this.times,0),i=jo(this.values,0),n=this.constructor,r=new n(this.name,t,i);return r.createInterpolant=this.createInterpolant,r}}il.prototype.TimeBufferType=Float32Array;il.prototype.ValueBufferType=Float32Array;il.prototype.DefaultInterpolation=Rf;class Yf extends il{}Yf.prototype.ValueTypeName="bool";Yf.prototype.ValueBufferType=Array;Yf.prototype.DefaultInterpolation=Sg;Yf.prototype.InterpolantFactoryMethodLinear=void 0;Yf.prototype.InterpolantFactoryMethodSmooth=void 0;class aI extends il{}aI.prototype.ValueTypeName="color";class Tg extends il{}Tg.prototype.ValueTypeName="number";class Q7 extends iv{constructor(t,i,n,r){super(t,i,n,r)}interpolate_(t,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-i)/(r-i);let c=t*a;for(let h=c+a;c!==h;c+=4)yr.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Fh extends il{InterpolantFactoryMethodLinear(t){return new Q7(this.times,this.values,this.getValueSize(),t)}}Fh.prototype.ValueTypeName="quaternion";Fh.prototype.DefaultInterpolation=Rf;Fh.prototype.InterpolantFactoryMethodSmooth=void 0;class qf extends il{}qf.prototype.ValueTypeName="string";qf.prototype.ValueBufferType=Array;qf.prototype.DefaultInterpolation=Sg;qf.prototype.InterpolantFactoryMethodLinear=void 0;qf.prototype.InterpolantFactoryMethodSmooth=void 0;class Pg extends il{}Pg.prototype.ValueTypeName="vector";class Dg{constructor(t,i=-1,n,r=MM){this.name=t,this.tracks=n,this.duration=i,this.blendMode=r,this.uuid=vo(),this.duration<0&&this.resetDuration()}static parse(t){const i=[],n=t.tracks,r=1/(t.fps||1);for(let o=0,a=n.length;o!==a;++o)i.push(Qle(n[o]).scale(r));const s=new this(t.name,t.duration,i,t.blendMode);return s.uuid=t.uuid,s}static toJSON(t){const i=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:i,uuid:t.uuid,blendMode:t.blendMode};for(let s=0,o=n.length;s!==o;++s)i.push(il.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(t,i,n,r){const s=i.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const h=X7(l);l=A3(l,1,h),c=A3(c,1,h),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new Tg(".morphTargetInfluences["+i[a].name+"]",l,c).scale(1/n))}return new this(t,-1,o)}static findByName(t,i){let n=t;if(!Array.isArray(t)){const r=t;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===i)return n[r];return null}static CreateClipsFromMorphTargetSequences(t,i,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=t.length;a<l;a++){const c=t[a],h=c.name.match(s);if(h&&h.length>1){const u=h[1];let d=r[u];d||(r[u]=d=[]),d.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],i,n));return o}static parseAnimation(t,i){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(u,d,f,p,g){if(f.length!==0){const m=[],v=[];sI(f,m,v,p),m.length!==0&&g.push(new u(d,m,v))}},r=[],s=t.name||"default",o=t.fps||30,a=t.blendMode;let l=t.length||-1;const c=t.hierarchy||[];for(let u=0;u<c.length;u++){const d=c[u].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let g=0;g<d[p].morphTargets.length;g++)f[d[p].morphTargets[g]]=-1;for(const g in f){const m=[],v=[];for(let x=0;x!==d[p].morphTargets.length;++x){const w=d[p];m.push(w.time),v.push(w.morphTarget===g?1:0)}r.push(new Tg(".morphTargetInfluence["+g+"]",m,v))}l=f.length*o}else{const f=".bones["+i[u].name+"]";n(Pg,f+".position",d,"pos",r),n(Fh,f+".quaternion",d,"rot",r),n(Pg,f+".scale",d,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const t=this.tracks;let i=0;for(let n=0,r=t.length;n!==r;++n){const s=this.tracks[n];i=Math.max(i,s.times[s.times.length-1])}return this.duration=i,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let i=0;i<this.tracks.length;i++)t=t&&this.tracks[i].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let i=0;i<this.tracks.length;i++)t.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function qle(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Tg;case"vector":case"vector2":case"vector3":case"vector4":return Pg;case"color":return aI;case"quaternion":return Fh;case"bool":case"boolean":return Yf;case"string":return qf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function Qle(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=qle(e.type);if(e.times===void 0){const i=[],n=[];sI(e.keys,i,n,"value"),e.times=i,e.values=n}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const Of={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class lI{constructor(t,i,n){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=i,this.onError=n,this.itemStart=function(h){a++,s===!1&&r.onStart!==void 0&&r.onStart(h,o,a),s=!0},this.itemEnd=function(h){o++,r.onProgress!==void 0&&r.onProgress(h,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(h){r.onError!==void 0&&r.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,u){return c.push(h,u),this},this.removeHandler=function(h){const u=c.indexOf(h);return u!==-1&&c.splice(u,2),this},this.getHandler=function(h){for(let u=0,d=c.length;u<d;u+=2){const f=c[u],p=c[u+1];if(f.global&&(f.lastIndex=0),f.test(h))return p}return null}}}const Bm=new lI;let ws=class{constructor(t){this.manager=t!==void 0?t:Bm,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const n=this;return new Promise(function(r,s){n.load(t,r,i,s)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}};const gc={};class Jle extends Error{constructor(t,i){super(t),this.response=i}}class wo extends ws{constructor(t){super(t)}load(t,i,n,r){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=Of.get(t);if(s!==void 0)return this.manager.itemStart(t),setTimeout(()=>{i&&i(s),this.manager.itemEnd(t)},0),s;if(gc[t]!==void 0){gc[t].push({onLoad:i,onProgress:n,onError:r});return}gc[t]=[],gc[t].push({onLoad:i,onProgress:n,onError:r});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const h=gc[t],u=c.body.getReader(),d=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=d?parseInt(d):0,p=f!==0;let g=0;const m=new ReadableStream({start(v){x();function x(){u.read().then(({done:w,value:b})=>{if(w)v.close();else{g+=b.byteLength;const M=new ProgressEvent("progress",{lengthComputable:p,loaded:g,total:f});for(let A=0,T=h.length;A<T;A++){const S=h[A];S.onProgress&&S.onProgress(M)}v.enqueue(b),x()}})}}});return new Response(m)}else throw new Jle(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>new DOMParser().parseFromString(h,a));case"json":return c.json();default:if(a===void 0)return c.text();{const u=/charset="?([^;"\s]*)"?/i.exec(a),d=u&&u[1]?u[1].toLowerCase():void 0,f=new TextDecoder(d);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{Of.add(t,c);const h=gc[t];delete gc[t];for(let u=0,d=h.length;u<d;u++){const f=h[u];f.onLoad&&f.onLoad(c)}}).catch(c=>{const h=gc[t];if(h===void 0)throw this.manager.itemError(t),c;delete gc[t];for(let u=0,d=h.length;u<d;u++){const f=h[u];f.onError&&f.onError(c)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class Kle extends ws{constructor(t){super(t)}load(t,i,n,r){const s=this,o=new wo(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(t)}},n,r)}parse(t){const i=[];for(let n=0;n<t.length;n++){const r=Dg.parse(t[n]);i.push(r)}return i}}class Zle extends ws{constructor(t){super(t)}load(t,i,n,r){const s=this,o=[],a=new KR,l=new wo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function h(u){l.load(t[u],function(d){const f=s.parse(d,!0);o[u]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,c===6&&(f.mipmapCount===1&&(a.minFilter=rn),a.image=o,a.format=f.format,a.needsUpdate=!0,i&&i(a))},n,r)}if(Array.isArray(t))for(let u=0,d=t.length;u<d;++u)h(u);else l.load(t,function(u){const d=s.parse(u,!0);if(d.isCubemap){const f=d.mipmaps.length/d.mipmapCount;for(let p=0;p<f;p++){o[p]={mipmaps:[]};for(let g=0;g<d.mipmapCount;g++)o[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+g]),o[p].format=d.format,o[p].width=d.width,o[p].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;d.mipmapCount===1&&(a.minFilter=rn),a.format=d.format,a.needsUpdate=!0,i&&i(a)},n,r);return a}}class dx extends ws{constructor(t){super(t)}load(t,i,n,r){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,o=Of.get(t);if(o!==void 0)return s.manager.itemStart(t),setTimeout(function(){i&&i(o),s.manager.itemEnd(t)},0),o;const a=ax("img");function l(){h(),Of.add(t,this),i&&i(this),s.manager.itemEnd(t)}function c(u){h(),r&&r(u),s.manager.itemError(t),s.manager.itemEnd(t)}function h(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),t.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(t),a.src=t,a}}class $le extends ws{constructor(t){super(t)}load(t,i,n,r){const s=new Qx,o=new dx(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(t[c],function(h){s.images[c]=h,a++,a===6&&(s.needsUpdate=!0,i&&i(s))},void 0,r)}for(let c=0;c<t.length;++c)l(c);return s}}class ece extends ws{constructor(t){super(t)}load(t,i,n,r){const s=this,o=new Zm,a=new wo(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(t,function(l){const c=s.parse(l);c&&(c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:Mr,o.wrapT=c.wrapT!==void 0?c.wrapT:Mr,o.magFilter=c.magFilter!==void 0?c.magFilter:rn,o.minFilter=c.minFilter!==void 0?c.minFilter:rn,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Yl),c.mipmapCount===1&&(o.minFilter=rn),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,i&&i(o,c))},n,r),o}}class d1 extends ws{constructor(t){super(t)}load(t,i,n,r){const s=new en,o=new dx(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(a){s.image=a,s.needsUpdate=!0,i!==void 0&&i(s)},n,r),s}}class Qh extends fi{constructor(t,i=1){super(),this.isLight=!0,this.type="Light",this.color=new ct(t),this.intensity=i}dispose(){}copy(t,i){return super.copy(t,i),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const i=super.toJSON(t);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}class J7 extends Qh{constructor(t,i,n){super(t,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(fi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ct(i)}copy(t,i){return super.copy(t,i),this.groundColor.copy(t.groundColor),this}}const MT=new Nt,SU=new te,MU=new te;class cI{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ve(512,512),this.map=null,this.mapPass=null,this.matrix=new Nt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new CM,this._frameExtents=new Ve(1,1),this._viewportCount=1,this._viewports=[new Ci(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const i=this.camera,n=this.matrix;SU.setFromMatrixPosition(t.matrixWorld),i.position.copy(SU),MU.setFromMatrixPosition(t.target.matrixWorld),i.lookAt(MU),i.updateMatrixWorld(),MT.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(MT),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(MT)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class tce extends cI{constructor(){super(new $i(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const i=this.camera,n=ox*2*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=t.distance||i.far;(n!==i.fov||r!==i.aspect||s!==i.far)&&(i.fov=n,i.aspect=r,i.far=s,i.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class uI extends Qh{constructor(t,i,n=0,r=Math.PI/3,s=0,o=2){super(t,i),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(fi.DEFAULT_UP),this.updateMatrix(),this.target=new fi,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new tce}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,i){return super.copy(t,i),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const EU=new Nt,n0=new te,ET=new te;class ice extends cI{constructor(){super(new $i(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ve(4,2),this._viewportCount=6,this._viewports=[new Ci(2,1,1,1),new Ci(0,1,1,1),new Ci(3,1,1,1),new Ci(1,1,1,1),new Ci(3,0,1,1),new Ci(1,0,1,1)],this._cubeDirections=[new te(1,0,0),new te(-1,0,0),new te(0,0,1),new te(0,0,-1),new te(0,1,0),new te(0,-1,0)],this._cubeUps=[new te(0,1,0),new te(0,1,0),new te(0,1,0),new te(0,1,0),new te(0,0,1),new te(0,0,-1)]}updateMatrices(t,i=0){const n=this.camera,r=this.matrix,s=t.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),n0.setFromMatrixPosition(t.matrixWorld),n.position.copy(n0),ET.copy(n.position),ET.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(ET),n.updateMatrixWorld(),r.makeTranslation(-n0.x,-n0.y,-n0.z),EU.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(EU)}}class hI extends Qh{constructor(t,i,n=0,r=2){super(t,i),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new ice}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,i){return super.copy(t,i),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class nce extends cI{constructor(){super(new Ya(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class dI extends Qh{constructor(t,i){super(t,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(fi.DEFAULT_UP),this.updateMatrix(),this.target=new fi,this.shadow=new nce}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class K7 extends Qh{constructor(t,i){super(t,i),this.isAmbientLight=!0,this.type="AmbientLight"}}class Z7 extends Qh{constructor(t,i,n=10,r=10){super(t,i),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const i=super.toJSON(t);return i.object.width=this.width,i.object.height=this.height,i}}class $7{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new te)}set(t){for(let i=0;i<9;i++)this.coefficients[i].copy(t[i]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,i){const n=t.x,r=t.y,s=t.z,o=this.coefficients;return i.copy(o[0]).multiplyScalar(.282095),i.addScaledVector(o[1],.488603*r),i.addScaledVector(o[2],.488603*s),i.addScaledVector(o[3],.488603*n),i.addScaledVector(o[4],1.092548*(n*r)),i.addScaledVector(o[5],1.092548*(r*s)),i.addScaledVector(o[6],.315392*(3*s*s-1)),i.addScaledVector(o[7],1.092548*(n*s)),i.addScaledVector(o[8],.546274*(n*n-r*r)),i}getIrradianceAt(t,i){const n=t.x,r=t.y,s=t.z,o=this.coefficients;return i.copy(o[0]).multiplyScalar(.886227),i.addScaledVector(o[1],2*.511664*r),i.addScaledVector(o[2],2*.511664*s),i.addScaledVector(o[3],2*.511664*n),i.addScaledVector(o[4],2*.429043*n*r),i.addScaledVector(o[5],2*.429043*r*s),i.addScaledVector(o[6],.743125*s*s-.247708),i.addScaledVector(o[7],2*.429043*n*s),i.addScaledVector(o[8],.429043*(n*n-r*r)),i}add(t){for(let i=0;i<9;i++)this.coefficients[i].add(t.coefficients[i]);return this}addScaledSH(t,i){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],i);return this}scale(t){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(t);return this}lerp(t,i){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],i);return this}equals(t){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(t.coefficients[i]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,i=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,i+r*3);return this}toArray(t=[],i=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,i+r*3);return t}static getBasisAt(t,i){const n=t.x,r=t.y,s=t.z;i[0]=.282095,i[1]=.488603*r,i[2]=.488603*s,i[3]=.488603*n,i[4]=1.092548*n*r,i[5]=1.092548*r*s,i[6]=.315392*(3*s*s-1),i[7]=1.092548*n*s,i[8]=.546274*(n*n-r*r)}}class OM extends Qh{constructor(t=new $7,i=1){super(void 0,i),this.isLightProbe=!0,this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const i=super.toJSON(t);return i.object.sh=this.sh.toArray(),i}}class FM extends ws{constructor(t){super(t),this.textures={}}load(t,i,n,r){const s=this,o=new wo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(t,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(t)}},n,r)}parse(t){const i=this.textures;function n(s){return i[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),i[s]}const r=FM.createMaterialFromType(t.type);if(t.uuid!==void 0&&(r.uuid=t.uuid),t.name!==void 0&&(r.name=t.name),t.color!==void 0&&r.color!==void 0&&r.color.setHex(t.color),t.roughness!==void 0&&(r.roughness=t.roughness),t.metalness!==void 0&&(r.metalness=t.metalness),t.sheen!==void 0&&(r.sheen=t.sheen),t.sheenColor!==void 0&&(r.sheenColor=new ct().setHex(t.sheenColor)),t.sheenRoughness!==void 0&&(r.sheenRoughness=t.sheenRoughness),t.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(t.emissive),t.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(t.specular),t.specularIntensity!==void 0&&(r.specularIntensity=t.specularIntensity),t.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(t.specularColor),t.shininess!==void 0&&(r.shininess=t.shininess),t.clearcoat!==void 0&&(r.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=t.clearcoatRoughness),t.iridescence!==void 0&&(r.iridescence=t.iridescence),t.iridescenceIOR!==void 0&&(r.iridescenceIOR=t.iridescenceIOR),t.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=t.iridescenceThicknessRange),t.transmission!==void 0&&(r.transmission=t.transmission),t.thickness!==void 0&&(r.thickness=t.thickness),t.attenuationDistance!==void 0&&(r.attenuationDistance=t.attenuationDistance),t.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(t.attenuationColor),t.fog!==void 0&&(r.fog=t.fog),t.flatShading!==void 0&&(r.flatShading=t.flatShading),t.blending!==void 0&&(r.blending=t.blending),t.combine!==void 0&&(r.combine=t.combine),t.side!==void 0&&(r.side=t.side),t.shadowSide!==void 0&&(r.shadowSide=t.shadowSide),t.opacity!==void 0&&(r.opacity=t.opacity),t.transparent!==void 0&&(r.transparent=t.transparent),t.alphaTest!==void 0&&(r.alphaTest=t.alphaTest),t.depthTest!==void 0&&(r.depthTest=t.depthTest),t.depthWrite!==void 0&&(r.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(r.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(r.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(r.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(r.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(r.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(r.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(r.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(r.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(r.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(r.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(r.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(r.rotation=t.rotation),t.linewidth!==1&&(r.linewidth=t.linewidth),t.dashSize!==void 0&&(r.dashSize=t.dashSize),t.gapSize!==void 0&&(r.gapSize=t.gapSize),t.scale!==void 0&&(r.scale=t.scale),t.polygonOffset!==void 0&&(r.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=t.polygonOffsetUnits),t.dithering!==void 0&&(r.dithering=t.dithering),t.alphaToCoverage!==void 0&&(r.alphaToCoverage=t.alphaToCoverage),t.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=t.premultipliedAlpha),t.forceSinglePass!==void 0&&(r.forceSinglePass=t.forceSinglePass),t.visible!==void 0&&(r.visible=t.visible),t.toneMapped!==void 0&&(r.toneMapped=t.toneMapped),t.userData!==void 0&&(r.userData=t.userData),t.vertexColors!==void 0&&(typeof t.vertexColors=="number"?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),t.uniforms!==void 0)for(const s in t.uniforms){const o=t.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=new ct().setHex(o.value);break;case"v2":r.uniforms[s].value=new Ve().fromArray(o.value);break;case"v3":r.uniforms[s].value=new te().fromArray(o.value);break;case"v4":r.uniforms[s].value=new Ci().fromArray(o.value);break;case"m3":r.uniforms[s].value=new hs().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Nt().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(t.defines!==void 0&&(r.defines=t.defines),t.vertexShader!==void 0&&(r.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(r.fragmentShader=t.fragmentShader),t.glslVersion!==void 0&&(r.glslVersion=t.glslVersion),t.extensions!==void 0)for(const s in t.extensions)r.extensions[s]=t.extensions[s];if(t.size!==void 0&&(r.size=t.size),t.sizeAttenuation!==void 0&&(r.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(r.map=n(t.map)),t.matcap!==void 0&&(r.matcap=n(t.matcap)),t.alphaMap!==void 0&&(r.alphaMap=n(t.alphaMap)),t.bumpMap!==void 0&&(r.bumpMap=n(t.bumpMap)),t.bumpScale!==void 0&&(r.bumpScale=t.bumpScale),t.normalMap!==void 0&&(r.normalMap=n(t.normalMap)),t.normalMapType!==void 0&&(r.normalMapType=t.normalMapType),t.normalScale!==void 0){let s=t.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Ve().fromArray(s)}return t.displacementMap!==void 0&&(r.displacementMap=n(t.displacementMap)),t.displacementScale!==void 0&&(r.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(r.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(r.roughnessMap=n(t.roughnessMap)),t.metalnessMap!==void 0&&(r.metalnessMap=n(t.metalnessMap)),t.emissiveMap!==void 0&&(r.emissiveMap=n(t.emissiveMap)),t.emissiveIntensity!==void 0&&(r.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(r.specularMap=n(t.specularMap)),t.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(t.specularIntensityMap)),t.specularColorMap!==void 0&&(r.specularColorMap=n(t.specularColorMap)),t.envMap!==void 0&&(r.envMap=n(t.envMap)),t.envMapIntensity!==void 0&&(r.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(r.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(r.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(r.lightMap=n(t.lightMap)),t.lightMapIntensity!==void 0&&(r.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(r.aoMap=n(t.aoMap)),t.aoMapIntensity!==void 0&&(r.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(r.gradientMap=n(t.gradientMap)),t.clearcoatMap!==void 0&&(r.clearcoatMap=n(t.clearcoatMap)),t.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),t.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Ve().fromArray(t.clearcoatNormalScale)),t.iridescenceMap!==void 0&&(r.iridescenceMap=n(t.iridescenceMap)),t.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(t.iridescenceThicknessMap)),t.transmissionMap!==void 0&&(r.transmissionMap=n(t.transmissionMap)),t.thicknessMap!==void 0&&(r.thicknessMap=n(t.thicknessMap)),t.sheenColorMap!==void 0&&(r.sheenColorMap=n(t.sheenColorMap)),t.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(t.sheenRoughnessMap)),r}setTextures(t){return this.textures=t,this}static createMaterialFromType(t){const i={ShadowMaterial:z7,SpriteMaterial:XR,RawShaderMaterial:k7,ShaderMaterial:ql,PointsMaterial:Zx,MeshPhysicalMaterial:tc,MeshStandardMaterial:h1,MeshPhongMaterial:U7,MeshToonMaterial:G7,MeshNormalMaterial:H7,MeshLambertMaterial:V7,MeshDepthMaterial:VR,MeshDistanceMaterial:jR,MeshBasicMaterial:co,MeshMatcapMaterial:j7,LineDashedMaterial:W7,LineBasicMaterial:Zr,Material:Gn};return new i[t]}}class Gl{static decodeText(t){if(typeof TextDecoder<"u")return new TextDecoder().decode(t);let i="";for(let n=0,r=t.length;n<r;n++)i+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(t){const i=t.lastIndexOf("/");return i===-1?"./":t.slice(0,i+1)}static resolveURL(t,i){return typeof t!="string"||t===""?"":(/^https?:\/\//i.test(i)&&/^\//.test(t)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:i+t)}}class eX extends Qt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){const t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}class tX extends ws{constructor(t){super(t)}load(t,i,n,r){const s=this,o=new wo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(t,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(t)}},n,r)}parse(t){const i={},n={};function r(f,p){if(i[p]!==void 0)return i[p];const m=f.interleavedBuffers[p],v=s(f,m.buffer),x=Tm(m.type,v),w=new Jx(x,m.stride);return w.uuid=m.uuid,i[p]=w,w}function s(f,p){if(n[p]!==void 0)return n[p];const m=f.arrayBuffers[p],v=new Uint32Array(m).buffer;return n[p]=v,v}const o=t.isInstancedBufferGeometry?new eX:new Qt,a=t.data.index;if(a!==void 0){const f=Tm(a.type,a.array);o.setIndex(new wi(f,1))}const l=t.data.attributes;for(const f in l){const p=l[f];let g;if(p.isInterleavedBufferAttribute){const m=r(t.data,p.data);g=new Oh(m,p.itemSize,p.offset,p.normalized)}else{const m=Tm(p.type,p.array),v=p.isInstancedBufferAttribute?Cg:wi;g=new v(m,p.itemSize,p.normalized)}p.name!==void 0&&(g.name=p.name),p.usage!==void 0&&g.setUsage(p.usage),p.updateRange!==void 0&&(g.updateRange.offset=p.updateRange.offset,g.updateRange.count=p.updateRange.count),o.setAttribute(f,g)}const c=t.data.morphAttributes;if(c)for(const f in c){const p=c[f],g=[];for(let m=0,v=p.length;m<v;m++){const x=p[m];let w;if(x.isInterleavedBufferAttribute){const b=r(t.data,x.data);w=new Oh(b,x.itemSize,x.offset,x.normalized)}else{const b=Tm(x.type,x.array);w=new wi(b,x.itemSize,x.normalized)}x.name!==void 0&&(w.name=x.name),g.push(w)}o.morphAttributes[f]=g}t.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const u=t.data.groups||t.data.drawcalls||t.data.offsets;if(u!==void 0)for(let f=0,p=u.length;f!==p;++f){const g=u[f];o.addGroup(g.start,g.count,g.materialIndex)}const d=t.data.boundingSphere;if(d!==void 0){const f=new te;d.center!==void 0&&f.fromArray(d.center),o.boundingSphere=new Yh(f,d.radius)}return t.name&&(o.name=t.name),t.userData&&(o.userData=t.userData),o}}class rce extends ws{constructor(t){super(t)}load(t,i,n,r){const s=this,o=this.path===""?Gl.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;const a=new wo(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(l){let c=null;try{c=JSON.parse(l)}catch(u){r!==void 0&&r(u),console.error("THREE:ObjectLoader: Can't parse "+t+".",u.message);return}const h=c.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+t)),console.error("THREE.ObjectLoader: Can't load "+t);return}s.parse(c,i)},n,r)}async loadAsync(t,i){const n=this,r=this.path===""?Gl.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||r;const s=new wo(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(t,i),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+t);return await n.parseAsync(a)}parse(t,i){const n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),s=this.parseGeometries(t.geometries,r),o=this.parseImages(t.images,function(){i!==void 0&&i(c)}),a=this.parseTextures(t.textures,o),l=this.parseMaterials(t.materials,a),c=this.parseObject(t.object,s,l,a,n),h=this.parseSkeletons(t.skeletons,c);if(this.bindSkeletons(c,h),i!==void 0){let u=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){u=!0;break}u===!1&&i(c)}return c}async parseAsync(t){const i=this.parseAnimations(t.animations),n=this.parseShapes(t.shapes),r=this.parseGeometries(t.geometries,n),s=await this.parseImagesAsync(t.images),o=this.parseTextures(t.textures,s),a=this.parseMaterials(t.materials,o),l=this.parseObject(t.object,r,a,o,i),c=this.parseSkeletons(t.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(t){const i={};if(t!==void 0)for(let n=0,r=t.length;n<r;n++){const s=new yf().fromJSON(t[n]);i[s.uuid]=s}return i}parseSkeletons(t,i){const n={},r={};if(i.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),t!==void 0)for(let s=0,o=t.length;s<o;s++){const a=new Kx().fromJSON(t[s],r);n[a.uuid]=a}return n}parseGeometries(t,i){const n={};if(t!==void 0){const r=new tX;for(let s=0,o=t.length;s<o;s++){let a;const l=t[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in AU?a=AU[l.type].fromJSON(l,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),a.isBufferGeometry===!0&&l.userData!==void 0&&(a.userData=l.userData),n[l.uuid]=a}}return n}parseMaterials(t,i){const n={},r={};if(t!==void 0){const s=new FM;s.setTextures(i);for(let o=0,a=t.length;o<a;o++){const l=t[o];n[l.uuid]===void 0&&(n[l.uuid]=s.parse(l)),r[l.uuid]=n[l.uuid]}}return r}parseAnimations(t){const i={};if(t!==void 0)for(let n=0;n<t.length;n++){const r=t[n],s=Dg.parse(r);i[s.uuid]=s}return i}parseImages(t,i){const n=this,r={};let s;function o(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return o(h)}else return l.data?{data:Tm(l.type,l.data),width:l.width,height:l.height}:null}if(t!==void 0&&t.length>0){const l=new lI(i);s=new dx(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,h=t.length;c<h;c++){const u=t[c],d=u.url;if(Array.isArray(d)){const f=[];for(let p=0,g=d.length;p<g;p++){const m=d[p],v=a(m);v!==null&&(v instanceof HTMLImageElement?f.push(v):f.push(new Zm(v.data,v.width,v.height)))}r[u.uuid]=new nf(f)}else{const f=a(u.url);r[u.uuid]=new nf(f)}}}return r}async parseImagesAsync(t){const i=this,n={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:i.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:Tm(o.type,o.data),width:o.width,height:o.height}:null}if(t!==void 0&&t.length>0){r=new dx(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=t.length;o<a;o++){const l=t[o],c=l.url;if(Array.isArray(c)){const h=[];for(let u=0,d=c.length;u<d;u++){const f=c[u],p=await s(f);p!==null&&(p instanceof HTMLImageElement?h.push(p):h.push(new Zm(p.data,p.width,p.height)))}n[l.uuid]=new nf(h)}else{const h=await s(l.url);n[l.uuid]=new nf(h)}}}return n}parseTextures(t,i){function n(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(t!==void 0)for(let s=0,o=t.length;s<o;s++){const a=t[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),i[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=i[a.image],c=l.data;let h;Array.isArray(c)?(h=new Qx,c.length===6&&(h.needsUpdate=!0)):(c&&c.data?h=new Zm:h=new en,c&&(h.needsUpdate=!0)),h.source=l,h.uuid=a.uuid,a.name!==void 0&&(h.name=a.name),a.mapping!==void 0&&(h.mapping=n(a.mapping,sce)),a.offset!==void 0&&h.offset.fromArray(a.offset),a.repeat!==void 0&&h.repeat.fromArray(a.repeat),a.center!==void 0&&h.center.fromArray(a.center),a.rotation!==void 0&&(h.rotation=a.rotation),a.wrap!==void 0&&(h.wrapS=n(a.wrap[0],CU),h.wrapT=n(a.wrap[1],CU)),a.format!==void 0&&(h.format=a.format),a.type!==void 0&&(h.type=a.type),a.encoding!==void 0&&(h.encoding=a.encoding),a.minFilter!==void 0&&(h.minFilter=n(a.minFilter,TU)),a.magFilter!==void 0&&(h.magFilter=n(a.magFilter,TU)),a.anisotropy!==void 0&&(h.anisotropy=a.anisotropy),a.flipY!==void 0&&(h.flipY=a.flipY),a.generateMipmaps!==void 0&&(h.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(h.unpackAlignment=a.unpackAlignment),a.userData!==void 0&&(h.userData=a.userData),r[a.uuid]=h}return r}parseObject(t,i,n,r,s){let o;function a(d){return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),i[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const f=[];for(let p=0,g=d.length;p<g;p++){const m=d[p];n[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),f.push(n[m])}return f}return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),n[d]}}function c(d){return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}let h,u;switch(t.type){case"Scene":o=new $A,t.background!==void 0&&(Number.isInteger(t.background)?o.background=new ct(t.background):o.background=c(t.background)),t.environment!==void 0&&(o.environment=c(t.environment)),t.fog!==void 0&&(t.fog.type==="Fog"?o.fog=new DM(t.fog.color,t.fog.near,t.fog.far):t.fog.type==="FogExp2"&&(o.fog=new PM(t.fog.color,t.fog.density))),t.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=t.backgroundBlurriness),t.backgroundIntensity!==void 0&&(o.backgroundIntensity=t.backgroundIntensity);break;case"PerspectiveCamera":o=new $i(t.fov,t.aspect,t.near,t.far),t.focus!==void 0&&(o.focus=t.focus),t.zoom!==void 0&&(o.zoom=t.zoom),t.filmGauge!==void 0&&(o.filmGauge=t.filmGauge),t.filmOffset!==void 0&&(o.filmOffset=t.filmOffset),t.view!==void 0&&(o.view=Object.assign({},t.view));break;case"OrthographicCamera":o=new Ya(t.left,t.right,t.top,t.bottom,t.near,t.far),t.zoom!==void 0&&(o.zoom=t.zoom),t.view!==void 0&&(o.view=Object.assign({},t.view));break;case"AmbientLight":o=new K7(t.color,t.intensity);break;case"DirectionalLight":o=new dI(t.color,t.intensity);break;case"PointLight":o=new hI(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":o=new Z7(t.color,t.intensity,t.width,t.height);break;case"SpotLight":o=new uI(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":o=new J7(t.color,t.groundColor,t.intensity);break;case"LightProbe":o=new OM().fromJSON(t);break;case"SkinnedMesh":h=a(t.geometry),u=l(t.material),o=new YR(h,u),t.bindMode!==void 0&&(o.bindMode=t.bindMode),t.bindMatrix!==void 0&&o.bindMatrix.fromArray(t.bindMatrix),t.skeleton!==void 0&&(o.skeleton=t.skeleton);break;case"Mesh":h=a(t.geometry),u=l(t.material),o=new $n(h,u);break;case"InstancedMesh":h=a(t.geometry),u=l(t.material);const d=t.count,f=t.instanceMatrix,p=t.instanceColor;o=new qR(h,u,d),o.instanceMatrix=new Cg(new Float32Array(f.array),16),p!==void 0&&(o.instanceColor=new Cg(new Float32Array(p.array),p.itemSize));break;case"LOD":o=new C7;break;case"Line":o=new ou(a(t.geometry),l(t.material));break;case"LineLoop":o=new QR(a(t.geometry),l(t.material));break;case"LineSegments":o=new el(a(t.geometry),l(t.material));break;case"PointCloud":case"Points":o=new JR(a(t.geometry),l(t.material));break;case"Sprite":o=new E7(l(t.material));break;case"Group":o=new Vc;break;case"Bone":o=new BM;break;default:o=new fi}if(o.uuid=t.uuid,t.name!==void 0&&(o.name=t.name),t.matrix!==void 0?(o.matrix.fromArray(t.matrix),t.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=t.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(t.position!==void 0&&o.position.fromArray(t.position),t.rotation!==void 0&&o.rotation.fromArray(t.rotation),t.quaternion!==void 0&&o.quaternion.fromArray(t.quaternion),t.scale!==void 0&&o.scale.fromArray(t.scale)),t.castShadow!==void 0&&(o.castShadow=t.castShadow),t.receiveShadow!==void 0&&(o.receiveShadow=t.receiveShadow),t.shadow&&(t.shadow.bias!==void 0&&(o.shadow.bias=t.shadow.bias),t.shadow.normalBias!==void 0&&(o.shadow.normalBias=t.shadow.normalBias),t.shadow.radius!==void 0&&(o.shadow.radius=t.shadow.radius),t.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(t.shadow.mapSize),t.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(t.shadow.camera))),t.visible!==void 0&&(o.visible=t.visible),t.frustumCulled!==void 0&&(o.frustumCulled=t.frustumCulled),t.renderOrder!==void 0&&(o.renderOrder=t.renderOrder),t.userData!==void 0&&(o.userData=t.userData),t.layers!==void 0&&(o.layers.mask=t.layers),t.children!==void 0){const d=t.children;for(let f=0;f<d.length;f++)o.add(this.parseObject(d[f],i,n,r,s))}if(t.animations!==void 0){const d=t.animations;for(let f=0;f<d.length;f++){const p=d[f];o.animations.push(s[p])}}if(t.type==="LOD"){t.autoUpdate!==void 0&&(o.autoUpdate=t.autoUpdate);const d=t.levels;for(let f=0;f<d.length;f++){const p=d[f],g=o.getObjectByProperty("uuid",p.object);g!==void 0&&o.addLevel(g,p.distance,p.hysteresis)}}return o}bindSkeletons(t,i){Object.keys(i).length!==0&&t.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=i[n.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}}const sce={UVMapping:AM,CubeReflectionMapping:Bh,CubeRefractionMapping:Lh,EquirectangularReflectionMapping:tx,EquirectangularRefractionMapping:ix,CubeUVReflectionMapping:Jg},CU={RepeatWrapping:Rh,ClampToEdgeWrapping:Mr,MirroredRepeatWrapping:bg},TU={NearestFilter:gn,NearestMipmapNearestFilter:nx,NearestMipmapLinearFilter:Km,LinearFilter:rn,LinearMipmapNearestFilter:SM,LinearMipmapLinearFilter:Yl};class iX extends ws{constructor(t){super(t),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,i,n,r){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,o=Of.get(t);if(o!==void 0)return s.manager.itemStart(t),setTimeout(function(){i&&i(o),s.manager.itemEnd(t)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(t,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Of.add(t,l),i&&i(l),s.manager.itemEnd(t)}).catch(function(l){r&&r(l),s.manager.itemError(t),s.manager.itemEnd(t)}),s.manager.itemStart(t)}}let __,fI=class{static getContext(){return __===void 0&&(__=new(window.AudioContext||window.webkitAudioContext)),__}static setContext(t){__=t}};class oce extends ws{constructor(t){super(t)}load(t,i,n,r){const s=this,o=new wo(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(a){try{const l=a.slice(0);fI.getContext().decodeAudioData(l,function(h){i(h)})}catch(l){r?r(l):console.error(l),s.manager.itemError(t)}},n,r)}}class ace extends OM{constructor(t,i,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const r=new ct().set(t),s=new ct().set(i),o=new te(r.r,r.g,r.b),a=new te(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}class lce extends OM{constructor(t,i=1){super(void 0,i),this.isAmbientLightProbe=!0;const n=new ct().set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const PU=new Nt,DU=new Nt,md=new Nt;class cce{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new $i,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new $i,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const i=this._cache;if(i.focus!==t.focus||i.fov!==t.fov||i.aspect!==t.aspect*this.aspect||i.near!==t.near||i.far!==t.far||i.zoom!==t.zoom||i.eyeSep!==this.eyeSep){i.focus=t.focus,i.fov=t.fov,i.aspect=t.aspect*this.aspect,i.near=t.near,i.far=t.far,i.zoom=t.zoom,i.eyeSep=this.eyeSep,md.copy(t.projectionMatrix);const r=i.eyeSep/2,s=r*i.near/i.focus,o=i.near*Math.tan(mf*i.fov*.5)/i.zoom;let a,l;DU.elements[12]=-r,PU.elements[12]=r,a=-o*i.aspect+s,l=o*i.aspect+s,md.elements[0]=2*i.near/(l-a),md.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(md),a=-o*i.aspect-s,l=o*i.aspect-s,md.elements[0]=2*i.near/(l-a),md.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(md)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(DU),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(PU)}}class pI{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=BU(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=BU();t=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=t}return t}}function BU(){return(typeof performance>"u"?Date:performance).now()}const gd=new te,LU=new yr,uce=new te,vd=new te;class hce extends fi{constructor(){super(),this.type="AudioListener",this.context=fI.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new pI}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const i=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(gd,LU,uce),vd.set(0,0,-1).applyQuaternion(LU),i.positionX){const r=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(gd.x,r),i.positionY.linearRampToValueAtTime(gd.y,r),i.positionZ.linearRampToValueAtTime(gd.z,r),i.forwardX.linearRampToValueAtTime(vd.x,r),i.forwardY.linearRampToValueAtTime(vd.y,r),i.forwardZ.linearRampToValueAtTime(vd.z,r),i.upX.linearRampToValueAtTime(n.x,r),i.upY.linearRampToValueAtTime(n.y,r),i.upZ.linearRampToValueAtTime(n.z,r)}else i.setPosition(gd.x,gd.y,gd.z),i.setOrientation(vd.x,vd.y,vd.z,n.x,n.y,n.z)}}let nX=class extends fi{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+t;const i=this.context.createBufferSource();return i.buffer=this.buffer,i.loop=this.loop,i.loopStart=this.loopStart,i.loopEnd=this.loopEnd,i.onended=this.onEnded.bind(this),i.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=i,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,i=this.filters.length;t<i;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,i=this.filters.length;t<i;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),this._connected===!0?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}};const yd=new te,RU=new yr,dce=new te,xd=new te;class fce extends nX{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,i,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=n,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(yd,RU,dce),xd.set(0,0,1).applyQuaternion(RU);const i=this.panner;if(i.positionX){const n=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(yd.x,n),i.positionY.linearRampToValueAtTime(yd.y,n),i.positionZ.linearRampToValueAtTime(yd.z,n),i.orientationX.linearRampToValueAtTime(xd.x,n),i.orientationY.linearRampToValueAtTime(xd.y,n),i.orientationZ.linearRampToValueAtTime(xd.z,n)}else i.setPosition(yd.x,yd.y,yd.z),i.setOrientation(xd.x,xd.y,xd.z)}}class pce{constructor(t,i=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=i,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const i=this.getFrequencyData();for(let n=0;n<i.length;n++)t+=i[n];return t/i.length}}class rX{constructor(t,i,n){this.binding=t,this.valueSize=n;let r,s,o;switch(i){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,i){const n=this.buffer,r=this.valueSize,s=t*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)n[s+a]=n[a];o=i}else{o+=i;const a=i/o;this._mixBufferRegion(n,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(t){const i=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const i=this.valueSize,n=this.buffer,r=t*i+i,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=i*this._origIndex;this._mixBufferRegion(n,r,l,1-s,i)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*i,1,i);for(let l=i,c=i+i;l!==c;++l)if(n[l]!==n[l+i]){a.setValue(n,r);break}}saveOriginalState(){const t=this.binding,i=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(i,r);for(let s=n,o=r;s!==o;++s)i[s]=i[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=this.valueSize*3;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,i=t+this.valueSize;for(let n=t;n<i;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[i+n]=this.buffer[t+n]}_select(t,i,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)t[i+o]=t[n+o]}_slerp(t,i,n,r){yr.slerpFlat(t,i,t,i,t,n,r)}_slerpAdditive(t,i,n,r,s){const o=this._workIndex*s;yr.multiplyQuaternionsFlat(t,o,t,i,t,n),yr.slerpFlat(t,i,t,i,t,o,r)}_lerp(t,i,n,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=i+a;t[l]=t[l]*o+t[n+a]*r}}_lerpAdditive(t,i,n,r,s){for(let o=0;o!==s;++o){const a=i+o;t[a]=t[a]+t[n+o]*r}}}const mI="\\[\\]\\.:\\/",mce=new RegExp("["+mI+"]","g"),gI="[^"+mI+"]",gce="[^"+mI.replace("\\.","")+"]",vce=/((?:WC+[\/:])*)/.source.replace("WC",gI),yce=/(WCOD+)?/.source.replace("WCOD",gce),xce=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",gI),wce=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",gI),_ce=new RegExp("^"+vce+yce+xce+wce+"$"),bce=["material","materials","bones","map"];class Ace{constructor(t,i,n){const r=n||pi.parseTrackName(i);this._targetGroup=t,this._bindings=t.subscribe_(i,r)}getValue(t,i){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(t,i)}setValue(t,i){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(t,i)}bind(){const t=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=t.length;i!==n;++i)t[i].bind()}unbind(){const t=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=t.length;i!==n;++i)t[i].unbind()}}class pi{constructor(t,i,n){this.path=i,this.parsedPath=n||pi.parseTrackName(i),this.node=pi.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,n){return t&&t.isAnimationObjectGroup?new pi.Composite(t,i,n):new pi(t,i,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(mce,"")}static parseTrackName(t){const i=_ce.exec(t);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);bce.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,i){if(i===void 0||i===""||i==="."||i===-1||i===t.name||i===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(i);if(n!==void 0)return n}if(t.children){const n=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===i||a.uuid===i)return a;const l=n(a.children);if(l)return l}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)t[i++]=n[r]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,n=i.objectName,r=i.propertyName;let s=i.propertyIndex;if(t||(t=pi.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let c=i.objectIndex;switch(n){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let h=0;h<t.length;h++)if(t[h].name===c){c=h;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[n]}if(c!==void 0){if(t[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[c]}}const o=t[r];if(o===void 0){const c=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",t);return}let a=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[s]!==void 0&&(s=t.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}pi.Composite=Ace;pi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};pi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};pi.prototype.GetterByBindingType=[pi.prototype._getValue_direct,pi.prototype._getValue_array,pi.prototype._getValue_arrayElement,pi.prototype._getValue_toArray];pi.prototype.SetterByBindingTypeAndVersioning=[[pi.prototype._setValue_direct,pi.prototype._setValue_direct_setNeedsUpdate,pi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[pi.prototype._setValue_array,pi.prototype._setValue_array_setNeedsUpdate,pi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[pi.prototype._setValue_arrayElement,pi.prototype._setValue_arrayElement_setNeedsUpdate,pi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[pi.prototype._setValue_fromArray,pi.prototype._setValue_fromArray_setNeedsUpdate,pi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Sce{constructor(){this.isAnimationObjectGroup=!0,this.uuid=vo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}add(){const t=this._objects,i=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=t.length,c=this.nCachedObjects_;for(let h=0,u=arguments.length;h!==u;++h){const d=arguments[h],f=d.uuid;let p=i[f];if(p===void 0){p=l++,i[f]=p,t.push(d);for(let g=0,m=o;g!==m;++g)s[g].push(new pi(d,n[g],r[g]))}else if(p<c){a=t[p];const g=--c,m=t[g];i[m.uuid]=p,t[p]=m,i[f]=g,t[g]=d;for(let v=0,x=o;v!==x;++v){const w=s[v],b=w[g];let M=w[p];w[p]=b,M===void 0&&(M=new pi(d,n[v],r[v])),w[g]=M}}else t[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const t=this._objects,i=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,h=i[c];if(h!==void 0&&h>=s){const u=s++,d=t[u];i[d.uuid]=h,t[h]=d,i[c]=u,t[u]=l;for(let f=0,p=r;f!==p;++f){const g=n[f],m=g[u],v=g[h];g[h]=m,g[u]=v}}}this.nCachedObjects_=s}uncache(){const t=this._objects,i=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=t.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],h=c.uuid,u=i[h];if(u!==void 0)if(delete i[h],u<s){const d=--s,f=t[d],p=--o,g=t[p];i[f.uuid]=u,t[u]=f,i[g.uuid]=d,t[d]=g,t.pop();for(let m=0,v=r;m!==v;++m){const x=n[m],w=x[d],b=x[p];x[u]=w,x[d]=b,x.pop()}}else{const d=--o,f=t[d];d>0&&(i[f.uuid]=u),t[u]=f,t.pop();for(let p=0,g=r;p!==g;++p){const m=n[p];m[u]=m[d],m.pop()}}}this.nCachedObjects_=s}subscribe_(t,i){const n=this._bindingsIndicesByPath;let r=n[t];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,h=this.nCachedObjects_,u=new Array(c);r=s.length,n[t]=r,o.push(t),a.push(i),s.push(u);for(let d=h,f=l.length;d!==f;++d){const p=l[d];u[d]=new pi(p,t,i)}return u}unsubscribe_(t){const i=this._bindingsIndicesByPath,n=i[t];if(n!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=t[a];i[c]=n,o[n]=l,o.pop(),s[n]=s[a],s.pop(),r[n]=r[a],r.pop()}}}class Mce{constructor(t,i,n=null,r=i.blendMode){this._mixer=t,this._clip=i,this._localRoot=n,this.blendMode=r;const s=i.tracks,o=s.length,a=new Array(o),l={endingStart:ef,endingEnd:ef};for(let c=0;c!==o;++c){const h=s[c].createInterpolant(null);a[c]=h,h.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=r7,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,i){return this.loop=t,this.repetitions=i,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,i,n){if(t.fadeOut(i),this.fadeIn(i),n){const r=this._clip.duration,s=t._clip.duration,o=s/r,a=r/s;t.warp(1,o,i),this.warp(a,1,i)}return this}crossFadeTo(t,i,n){return t.crossFadeFrom(this,i,n)}stopFading(){const t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,i,n){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+n,c[0]=t/o,c[1]=i/o,this}stopWarping(){const t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,i,n,r){if(!this.enabled){this._updateWeight(t);return}const s=this._startTime;if(s!==null){const l=(t-s)*n;l<0||n===0?i=0:(this._startTime=null,i=n*l)}i*=this._updateTimeScale(t);const o=this._updateTime(i),a=this._updateWeight(t);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case LR:for(let h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulateAdditive(a);break;case MM:default:for(let h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulate(r,a)}}}_updateWeight(t){let i=0;if(this.enabled){i=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(t)[0];i*=r,t>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(t){let i=0;if(!this.paused){i=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(t)[0];i*=r,t>n.parameterPositions[1]&&(this.stopWarping(),i===0?this.paused=!0:this.timeScale=i)}}return this._effectiveTimeScale=i,i}_updateTime(t){const i=this._clip.duration,n=this.loop;let r=this.time+t,s=this._loopCount;const o=n===s7;if(t===0)return s===-1?r:o&&(s&1)===1?i-r:r;if(n===n7){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=i)r=i;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(s===-1&&(t>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=i||r<0){const a=Math.floor(r/i);r-=i*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?i:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(l===1){const c=t<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return i-r}return r}_setEndings(t,i,n){const r=this._interpolantSettings;n?(r.endingStart=tf,r.endingEnd=tf):(t?r.endingStart=this.zeroSlopeAtStart?tf:ef:r.endingStart=rx,i?r.endingEnd=this.zeroSlopeAtEnd?tf:ef:r.endingEnd=rx)}_scheduleFading(t,i,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=i,a[1]=s+t,l[1]=n,this}}const Ece=new Float32Array(1);class Cce extends ec{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,i){const n=t._localRoot||this._root,r=t._clip.tracks,s=r.length,o=t._propertyBindings,a=t._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let h=c[l];h===void 0&&(h={},c[l]=h);for(let u=0;u!==s;++u){const d=r[u],f=d.name;let p=h[f];if(p!==void 0)++p.referenceCount,o[u]=p;else{if(p=o[u],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}const g=i&&i._propertyBindings[u].binding.parsedPath;p=new rX(pi.create(n,f,g),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[u]=p}a[u].resultBuffer=p.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){const n=(t._localRoot||this._root).uuid,r=t._clip.uuid,s=this._actionsByClip[r];this._bindAction(t,s&&s.knownActions[0]),this._addInactiveAction(t,r,n)}const i=t._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const s=i[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const i=t._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const s=i[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const i=t._cacheIndex;return i!==null&&i<this._nActiveActions}_addInactiveAction(t,i,n){const r=this._actions,s=this._actionsByClip;let o=s[i];if(o===void 0)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,s[i]=o;else{const a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t}_removeInactiveAction(t){const i=this._actions,n=i[i.length-1],r=t._cacheIndex;n._cacheIndex=r,i[r]=n,i.pop(),t._cacheIndex=null;const s=t._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],h=t._byClipCacheIndex;c._byClipCacheIndex=h,l[h]=c,l.pop(),t._byClipCacheIndex=null;const u=a.actionByRoot,d=(t._localRoot||this._root).uuid;delete u[d],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const i=t._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const s=i[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(t){const i=this._actions,n=t._cacheIndex,r=this._nActiveActions++,s=i[r];t._cacheIndex=r,i[r]=t,s._cacheIndex=n,i[n]=s}_takeBackAction(t){const i=this._actions,n=t._cacheIndex,r=--this._nActiveActions,s=i[r];t._cacheIndex=r,i[r]=t,s._cacheIndex=n,i[n]=s}_addInactiveBinding(t,i,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[i];o===void 0&&(o={},r[i]=o),o[n]=t,t._cacheIndex=s.length,s.push(t)}_removeInactiveBinding(t){const i=this._bindings,n=t.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[r],l=i[i.length-1],c=t._cacheIndex;l._cacheIndex=c,i[c]=l,i.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(t){const i=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,s=i[r];t._cacheIndex=r,i[r]=t,s._cacheIndex=n,i[n]=s}_takeBackBinding(t){const i=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,s=i[r];t._cacheIndex=r,i[r]=t,s._cacheIndex=n,i[n]=s}_lendControlInterpolant(){const t=this._controlInterpolants,i=this._nActiveControlInterpolants++;let n=t[i];return n===void 0&&(n=new oI(new Float32Array(2),new Float32Array(2),1,Ece),n.__cacheIndex=i,t[i]=n),n}_takeBackControlInterpolant(t){const i=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,s=i[r];t.__cacheIndex=r,i[r]=t,s.__cacheIndex=n,i[n]=s}clipAction(t,i,n){const r=i||this._root,s=r.uuid;let o=typeof t=="string"?Dg.findByName(r,t):t;const a=o!==null?o.uuid:t,l=this._actionsByClip[a];let c=null;if(n===void 0&&(o!==null?n=o.blendMode:n=MM),l!==void 0){const u=l.actionByRoot[s];if(u!==void 0&&u.blendMode===n)return u;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const h=new Mce(this,o,i,n);return this._bindAction(h,c),this._addInactiveAction(h,a,s),h}existingAction(t,i){const n=i||this._root,r=n.uuid,s=typeof t=="string"?Dg.findByName(n,t):t,o=s?s.uuid:t,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const t=this._actions,i=this._nActiveActions;for(let n=i-1;n>=0;--n)t[n].stop();return this}update(t){t*=this.timeScale;const i=this._actions,n=this._nActiveActions,r=this.time+=t,s=Math.sign(t),o=this._accuIndex^=1;for(let c=0;c!==n;++c)i[c]._update(r,t,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(t){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const i=this._actions,n=t.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const h=c._cacheIndex,u=i[i.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=h,i[h]=u,i.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}}uncacheRoot(t){const i=t.uuid,n=this._actionsByClip;for(const o in n){const a=n[o].actionByRoot,l=a[i];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[i];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(t,i){const n=this.existingAction(t,i);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class vI{constructor(t){this.value=t}clone(){return new vI(this.value.clone===void 0?this.value:this.value.clone())}}let Tce=0;class Pce extends ec{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Tce++}),this.name="",this.usage=sx,this.uniforms=[]}add(t){return this.uniforms.push(t),this}remove(t){const i=this.uniforms.indexOf(t);return i!==-1&&this.uniforms.splice(i,1),this}setName(t){return this.name=t,this}setUsage(t){return this.usage=t,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(t){this.name=t.name,this.usage=t.usage;const i=t.uniforms;this.uniforms.length=0;for(let n=0,r=i.length;n<r;n++)this.uniforms.push(i[n].clone());return this}clone(){return new this.constructor().copy(this)}}class Dce extends Jx{constructor(t,i,n=1){super(t,i),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const i=super.clone(t);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(t){const i=super.toJSON(t);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}class Bce{constructor(t,i,n,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=t,this.type=i,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(t){t===!0&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,i){return this.type=t,this.elementSize=i,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}class sX{constructor(t,i,n=0,r=1/0){this.ray=new Yx(t,i),this.near=n,this.far=r,this.camera=null,this.layers=new vf,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,i){this.ray.set(t,i)}setFromCamera(t,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}intersectObject(t,i=!0,n=[]){return S3(t,this,n,i),n.sort(IU),n}intersectObjects(t,i=!0,n=[]){for(let r=0,s=t.length;r<s;r++)S3(t[r],this,n,i);return n.sort(IU),n}}function IU(e,t){return e.distance-t.distance}function S3(e,t,i,n){if(e.layers.test(t.layers)&&e.raycast(t,i),n===!0){const r=e.children;for(let s=0,o=r.length;s<o;s++)S3(r[s],t,i,!0)}}class M3{constructor(t=1,i=0,n=0){return this.radius=t,this.phi=i,this.theta=n,this}set(t,i,n){return this.radius=t,this.phi=i,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,i,n){return this.radius=Math.sqrt(t*t+i*i+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(Tn(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Lce{constructor(t=1,i=0,n=0){return this.radius=t,this.theta=i,this.y=n,this}set(t,i,n){return this.radius=t,this.theta=i,this.y=n,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,i,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=i,this}clone(){return new this.constructor().copy(this)}}const OU=new Ve;class Rce{constructor(t=new Ve(1/0,1/0),i=new Ve(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=i}set(t,i){return this.min.copy(t),this.max.copy(i),this}setFromPoints(t){this.makeEmpty();for(let i=0,n=t.length;i<n;i++)this.expandByPoint(t[i]);return this}setFromCenterAndSize(t,i){const n=OU.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,i){return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,i){return i.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return OU.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const FU=new te,b_=new te;class Ice{constructor(t=new te,i=new te){this.start=t,this.end=i}set(t,i){return this.start.copy(t),this.end.copy(i),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,i){return this.delta(i).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,i){FU.subVectors(t,this.start),b_.subVectors(this.end,this.start);const n=b_.dot(b_);let s=b_.dot(FU)/n;return i&&(s=Tn(s,0,1)),s}closestPointToPoint(t,i,n){const r=this.closestPointToPointParameter(t,i);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const NU=new te;class Oce extends fi{constructor(t,i){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="SpotLightHelper";const n=new Qt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,h=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(h),Math.sin(h),1)}n.setAttribute("position",new wt(r,3));const s=new Zr({fog:!1,toneMapped:!1});this.cone=new el(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const t=this.light.distance?this.light.distance:1e3,i=t*Math.tan(this.light.angle);this.cone.scale.set(i,i,t),NU.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(NU),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Tu=new te,A_=new Nt,CT=new Nt;class Fce extends el{constructor(t){const i=oX(t),n=new Qt,r=[],s=[],o=new ct(0,0,1),a=new ct(0,1,0);for(let c=0;c<i.length;c++){const h=i[c];h.parent&&h.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new wt(r,3)),n.setAttribute("color",new wt(s,3));const l=new Zr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=t,this.bones=i,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const i=this.bones,n=this.geometry,r=n.getAttribute("position");CT.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<i.length;s++){const a=i[s];a.parent&&a.parent.isBone&&(A_.multiplyMatrices(CT,a.matrixWorld),Tu.setFromMatrixPosition(A_),r.setXYZ(o,Tu.x,Tu.y,Tu.z),A_.multiplyMatrices(CT,a.parent.matrixWorld),Tu.setFromMatrixPosition(A_),r.setXYZ(o+1,Tu.x,Tu.y,Tu.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}dispose(){this.geometry.dispose(),this.material.dispose()}}function oX(e){const t=[];e.isBone===!0&&t.push(e);for(let i=0;i<e.children.length;i++)t.push.apply(t,oX(e.children[i]));return t}class Nce extends $n{constructor(t,i,n){const r=new tv(i,4,2),s=new co({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=t,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const zce=new te,zU=new ct,kU=new ct;class kce extends fi{constructor(t,i,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new ev(i);r.rotateY(Math.PI*.5),this.material=new co({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new wi(o,3)),this.add(new $n(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=t.geometry.getAttribute("color");zU.copy(this.light.color),kU.copy(this.light.groundColor);for(let n=0,r=i.count;n<r;n++){const s=n<r/2?zU:kU;i.setXYZ(n,s.r,s.g,s.b)}i.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),t.lookAt(zce.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Uce extends el{constructor(t=10,i=10,n=4473924,r=8947848){n=new ct(n),r=new ct(r);const s=i/2,o=t/i,a=t/2,l=[],c=[];for(let d=0,f=0,p=-a;d<=i;d++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const g=d===s?n:r;g.toArray(c,f),f+=3,g.toArray(c,f),f+=3,g.toArray(c,f),f+=3,g.toArray(c,f),f+=3}const h=new Qt;h.setAttribute("position",new wt(l,3)),h.setAttribute("color",new wt(c,3));const u=new Zr({vertexColors:!0,toneMapped:!1});super(h,u),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Gce extends el{constructor(t=10,i=16,n=8,r=64,s=4473924,o=8947848){s=new ct(s),o=new ct(o);const a=[],l=[];if(i>1)for(let u=0;u<i;u++){const d=u/i*(Math.PI*2),f=Math.sin(d)*t,p=Math.cos(d)*t;a.push(0,0,0),a.push(f,0,p);const g=u&1?s:o;l.push(g.r,g.g,g.b),l.push(g.r,g.g,g.b)}for(let u=0;u<n;u++){const d=u&1?s:o,f=t-t/n*u;for(let p=0;p<r;p++){let g=p/r*(Math.PI*2),m=Math.sin(g)*f,v=Math.cos(g)*f;a.push(m,0,v),l.push(d.r,d.g,d.b),g=(p+1)/r*(Math.PI*2),m=Math.sin(g)*f,v=Math.cos(g)*f,a.push(m,0,v),l.push(d.r,d.g,d.b)}}const c=new Qt;c.setAttribute("position",new wt(a,3)),c.setAttribute("color",new wt(l,3));const h=new Zr({vertexColors:!0,toneMapped:!1});super(c,h),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const UU=new te,S_=new te,GU=new te;class Hce extends fi{constructor(t,i,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",i===void 0&&(i=1);let r=new Qt;r.setAttribute("position",new wt([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const s=new Zr({fog:!1,toneMapped:!1});this.lightPlane=new ou(r,s),this.add(this.lightPlane),r=new Qt,r.setAttribute("position",new wt([0,0,0,0,0,1],3)),this.targetLine=new ou(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),UU.setFromMatrixPosition(this.light.matrixWorld),S_.setFromMatrixPosition(this.light.target.matrixWorld),GU.subVectors(S_,UU),this.lightPlane.lookAt(S_),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(S_),this.targetLine.scale.z=GU.length()}}const M_=new te,fn=new qx;class Vce extends el{constructor(t){const i=new Qt,n=new Zr({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,g){l(p),l(g)}function l(p){r.push(0,0,0),s.push(0,0,0),o[p]===void 0&&(o[p]=[]),o[p].push(r.length/3-1)}i.setAttribute("position",new wt(r,3)),i.setAttribute("color",new wt(s,3)),super(i,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new ct(16755200),h=new ct(16711680),u=new ct(43775),d=new ct(16777215),f=new ct(3355443);this.setColors(c,h,u,d,f)}setColors(t,i,n,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,t.r,t.g,t.b),a.setXYZ(1,t.r,t.g,t.b),a.setXYZ(2,t.r,t.g,t.b),a.setXYZ(3,t.r,t.g,t.b),a.setXYZ(4,t.r,t.g,t.b),a.setXYZ(5,t.r,t.g,t.b),a.setXYZ(6,t.r,t.g,t.b),a.setXYZ(7,t.r,t.g,t.b),a.setXYZ(8,t.r,t.g,t.b),a.setXYZ(9,t.r,t.g,t.b),a.setXYZ(10,t.r,t.g,t.b),a.setXYZ(11,t.r,t.g,t.b),a.setXYZ(12,t.r,t.g,t.b),a.setXYZ(13,t.r,t.g,t.b),a.setXYZ(14,t.r,t.g,t.b),a.setXYZ(15,t.r,t.g,t.b),a.setXYZ(16,t.r,t.g,t.b),a.setXYZ(17,t.r,t.g,t.b),a.setXYZ(18,t.r,t.g,t.b),a.setXYZ(19,t.r,t.g,t.b),a.setXYZ(20,t.r,t.g,t.b),a.setXYZ(21,t.r,t.g,t.b),a.setXYZ(22,t.r,t.g,t.b),a.setXYZ(23,t.r,t.g,t.b),a.setXYZ(24,i.r,i.g,i.b),a.setXYZ(25,i.r,i.g,i.b),a.setXYZ(26,i.r,i.g,i.b),a.setXYZ(27,i.r,i.g,i.b),a.setXYZ(28,i.r,i.g,i.b),a.setXYZ(29,i.r,i.g,i.b),a.setXYZ(30,i.r,i.g,i.b),a.setXYZ(31,i.r,i.g,i.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const t=this.geometry,i=this.pointMap,n=1,r=1;fn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),bn("c",i,t,fn,0,0,-1),bn("t",i,t,fn,0,0,1),bn("n1",i,t,fn,-n,-r,-1),bn("n2",i,t,fn,n,-r,-1),bn("n3",i,t,fn,-n,r,-1),bn("n4",i,t,fn,n,r,-1),bn("f1",i,t,fn,-n,-r,1),bn("f2",i,t,fn,n,-r,1),bn("f3",i,t,fn,-n,r,1),bn("f4",i,t,fn,n,r,1),bn("u1",i,t,fn,n*.7,r*1.1,-1),bn("u2",i,t,fn,-n*.7,r*1.1,-1),bn("u3",i,t,fn,0,r*2,-1),bn("cf1",i,t,fn,-n,0,1),bn("cf2",i,t,fn,n,0,1),bn("cf3",i,t,fn,0,-r,1),bn("cf4",i,t,fn,0,r,1),bn("cn1",i,t,fn,-n,0,-1),bn("cn2",i,t,fn,n,0,-1),bn("cn3",i,t,fn,0,-r,-1),bn("cn4",i,t,fn,0,r,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function bn(e,t,i,n,r,s,o){M_.set(r,s,o).unproject(n);const a=t[e];if(a!==void 0){const l=i.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],M_.x,M_.y,M_.z)}}const E_=new Xh;class jce extends el{constructor(t,i=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new Qt;s.setIndex(new wi(n,1)),s.setAttribute("position",new wi(r,3)),super(s,new Zr({color:i,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(t!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&E_.setFromObject(this.object),E_.isEmpty())return;const i=E_.min,n=E_.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=i.x,s[4]=n.y,s[5]=n.z,s[6]=i.x,s[7]=i.y,s[8]=n.z,s[9]=n.x,s[10]=i.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=i.z,s[15]=i.x,s[16]=n.y,s[17]=i.z,s[18]=i.x,s[19]=i.y,s[20]=i.z,s[21]=n.x,s[22]=i.y,s[23]=i.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t,i){return super.copy(t,i),this.object=t.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Wce extends el{constructor(t,i=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Qt;s.setIndex(new wi(n,1)),s.setAttribute("position",new wt(r,3)),super(s,new Zr({color:i,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Xce extends ou{constructor(t,i=1,n=16776960){const r=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Qt;o.setAttribute("position",new wt(s,3)),o.computeBoundingSphere(),super(o,new Zr({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=i;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Qt;l.setAttribute("position",new wt(a,3)),l.computeBoundingSphere(),this.add(new $n(l,new co({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(t)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const HU=new te;let C_,TT;class Yce extends fi{constructor(t=new te(0,0,1),i=new te(0,0,0),n=1,r=16776960,s=n*.2,o=s*.2){super(),this.type="ArrowHelper",C_===void 0&&(C_=new Qt,C_.setAttribute("position",new wt([0,0,0,0,1,0],3)),TT=new Xf(0,.5,1,5,1),TT.translate(0,-.5,0)),this.position.copy(i),this.line=new ou(C_,new Zr({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new $n(TT,new co({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,s,o)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{HU.set(t.z,0,-t.x).normalize();const i=Math.acos(t.y);this.quaternion.setFromAxisAngle(HU,i)}}setLength(t,i=t*.2,n=i*.2){this.line.scale.set(1,Math.max(1e-4,t-i),1),this.line.updateMatrix(),this.cone.scale.set(n,i,n),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class qce extends el{constructor(t=1){const i=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Qt;r.setAttribute("position",new wt(i,3)),r.setAttribute("color",new wt(n,3));const s=new Zr({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(t,i,n){const r=new ct,s=this.geometry.attributes.color.array;return r.set(t),r.toArray(s,0),r.toArray(s,3),r.set(i),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Qce{constructor(){this.type="ShapePath",this.color=new ct,this.subPaths=[],this.currentPath=null}moveTo(t,i){return this.currentPath=new lx,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,i),this}lineTo(t,i){return this.currentPath.lineTo(t,i),this}quadraticCurveTo(t,i,n,r){return this.currentPath.quadraticCurveTo(t,i,n,r),this}bezierCurveTo(t,i,n,r,s,o){return this.currentPath.bezierCurveTo(t,i,n,r,s,o),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t){function i(v){const x=[];for(let w=0,b=v.length;w<b;w++){const M=v[w],A=new yf;A.curves=M.curves,x.push(A)}return x}function n(v,x){const w=x.length;let b=!1;for(let M=w-1,A=0;A<w;M=A++){let T=x[M],S=x[A],C=S.x-T.x,P=S.y-T.y;if(Math.abs(P)>Number.EPSILON){if(P<0&&(T=x[A],C=-C,S=x[M],P=-P),v.y<T.y||v.y>S.y)continue;if(v.y===T.y){if(v.x===T.x)return!0}else{const B=P*(v.x-T.x)-C*(v.y-T.y);if(B===0)return!0;if(B<0)continue;b=!b}}else{if(v.y!==T.y)continue;if(S.x<=v.x&&v.x<=T.x||T.x<=v.x&&v.x<=S.x)return!0}}return b}const r=Ul.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new yf,l.curves=a.curves,c.push(l),c;let h=!r(s[0].getPoints());h=t?!h:h;const u=[],d=[];let f=[],p=0,g;d[p]=void 0,f[p]=[];for(let v=0,x=s.length;v<x;v++)a=s[v],g=a.getPoints(),o=r(g),o=t?!o:o,o?(!h&&d[p]&&p++,d[p]={s:new yf,p:g},d[p].s.curves=a.curves,h&&p++,f[p]=[]):f[p].push({h:a,p:g[0]});if(!d[0])return i(s);if(d.length>1){let v=!1,x=0;for(let w=0,b=d.length;w<b;w++)u[w]=[];for(let w=0,b=d.length;w<b;w++){const M=f[w];for(let A=0;A<M.length;A++){const T=M[A];let S=!0;for(let C=0;C<d.length;C++)n(T.p,d[C].p)&&(w!==C&&x++,S?(S=!1,u[C].push(T)):v=!0);S&&u[w].push(T)}}x>0&&v===!1&&(f=u)}let m;for(let v=0,x=d.length;v<x;v++){l=d[v].s,c.push(l),m=f[v];for(let w=0,b=m.length;w<b;w++)l.holes.push(m[w].h)}return c}}const Fc=Jce();function Jce(){const e=new ArrayBuffer(4),t=new Float32Array(e),i=new Uint32Array(e),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(n[l]=1024>>-c-14,n[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(n[l]=c+15<<10,n[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(n[l]=31744,n[l|256]=64512,r[l]=24,r[l|256]=24):(n[l]=31744,n[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,h=0;for(;!(c&8388608);)c<<=1,h-=8388608;c&=-8388609,h+=947912704,s[l]=c|h}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:t,uint32View:i,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Kce(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=Tn(e,-65504,65504),Fc.floatView[0]=e;const t=Fc.uint32View[0],i=t>>23&511;return Fc.baseTable[i]+((t&8388607)>>Fc.shiftTable[i])}function Zce(e){const t=e>>10;return Fc.uint32View[0]=Fc.mantissaTable[Fc.offsetTable[t]+(e&1023)]+Fc.exponentTable[t],Fc.floatView[0]}var $ce=Object.freeze({__proto__:null,fromHalfFloat:Zce,toHalfFloat:Kce});class eue extends qh{constructor(t,i,n,r,s,o){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(t,i,n,r,s,o)}}class tue extends $x{constructor(t,i,n,r){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(t,i,n,r)}}class iue extends e1{constructor(t,i,n,r){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(t,i,n,r)}}class nue extends t1{constructor(t,i,n,r,s,o,a){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(t,i,n,r,s,o,a)}}class rue extends Xf{constructor(t,i,n,r,s,o,a,l){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(t,i,n,r,s,o,a,l)}}class sue extends i1{constructor(t,i){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(t,i)}}class oue extends n1{constructor(t,i){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(t,i)}}class aue extends r1{constructor(t,i){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(t,i)}}class lue extends $g{constructor(t,i,n,r){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(t,i,n,r)}}class cue extends ev{constructor(t,i){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(t,i)}}class uue extends Kg{constructor(t,i,n,r){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(t,i,n,r)}}class hue extends hu{constructor(t,i,n,r){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(t,i,n,r)}}class due extends s1{constructor(t,i,n,r,s,o){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(t,i,n,r,s,o)}}class fue extends o1{constructor(t,i){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(t,i)}}class pue extends tv{constructor(t,i,n,r,s,o,a){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(t,i,n,r,s,o,a)}}class mue extends a1{constructor(t,i){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(t,i)}}class gue extends l1{constructor(t,i,n,r,s){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(t,i,n,r,s)}}class vue extends c1{constructor(t,i,n,r,s,o){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(t,i,n,r,s,o)}}class yue extends u1{constructor(t,i,n,r,s){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(t,i,n,r,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Wx}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Wx);const xue=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:DR,AddEquation:Hd,AddOperation:N9,AdditiveAnimationBlendMode:LR,AdditiveBlending:HD,AlphaFormat:Y9,AlwaysDepth:D9,AlwaysStencilFunc:u7,AmbientLight:K7,AmbientLightProbe:lce,AnimationClip:Dg,AnimationLoader:Kle,AnimationMixer:Cce,AnimationObjectGroup:Sce,AnimationUtils:Yle,ArcCurve:T7,ArrayCamera:b7,ArrowHelper:Yce,Audio:nX,AudioAnalyser:pce,AudioContext:fI,AudioListener:hce,AudioLoader:oce,AxesHelper:qce,BackSide:Vs,BasicDepthPacking:a7,BasicShadowMap:g9,Bone:BM,BooleanKeyframeTrack:Yf,Box2:Rce,Box3:Xh,Box3Helper:Wce,BoxBufferGeometry:eue,BoxGeometry:qh,BoxHelper:jce,BufferAttribute:wi,BufferGeometry:Qt,BufferGeometryLoader:tX,ByteType:H9,Cache:Of,Camera:qx,CameraHelper:Vce,CanvasTexture:vle,CapsuleBufferGeometry:tue,CapsuleGeometry:$x,CatmullRomCurve3:P7,CineonToneMapping:U9,CircleBufferGeometry:iue,CircleGeometry:e1,ClampToEdgeWrapping:Mr,Clock:pI,Color:ct,ColorKeyframeTrack:aI,ColorManagement:Vr,CompressedArrayTexture:gle,CompressedTexture:KR,CompressedTextureLoader:Zle,ConeBufferGeometry:nue,ConeGeometry:t1,CubeCamera:UR,CubeReflectionMapping:Bh,CubeRefractionMapping:Lh,CubeTexture:Qx,CubeTextureLoader:$le,CubeUVReflectionMapping:Jg,CubicBezierCurve:$R,CubicBezierCurve3:D7,CubicInterpolant:Y7,CullFaceBack:GD,CullFaceFront:m9,CullFaceFrontBack:Aie,CullFaceNone:p9,Curve:tl,CurvePath:L7,CustomBlending:v9,CustomToneMapping:G9,CylinderBufferGeometry:rue,CylinderGeometry:Xf,Cylindrical:Lce,Data3DTexture:NR,DataArrayTexture:EM,DataTexture:Zm,DataTextureLoader:ece,DataUtils:$ce,DecrementStencilOp:Rie,DecrementWrapStencilOp:Oie,DefaultLoadingManager:Bm,DepthFormat:Sh,DepthStencilFormat:Lf,DepthTexture:A7,DirectionalLight:dI,DirectionalLightHelper:Hce,DiscreteInterpolant:q7,DodecahedronBufferGeometry:sue,DodecahedronGeometry:i1,DoubleSide:za,DstAlphaFactor:S9,DstColorFactor:E9,DynamicCopyUsage:Qie,DynamicDrawUsage:pf,DynamicReadUsage:Xie,EdgesGeometry:R7,EllipseCurve:LM,EqualDepth:L9,EqualStencilFunc:kie,EquirectangularReflectionMapping:tx,EquirectangularRefractionMapping:ix,Euler:Wf,EventDispatcher:ec,ExtrudeBufferGeometry:oue,ExtrudeGeometry:n1,FileLoader:wo,Float16BufferAttribute:Pne,Float32BufferAttribute:wt,Float64BufferAttribute:Dne,FloatType:Gc,Fog:DM,FogExp2:PM,FramebufferTexture:mle,FrontSide:Xl,Frustum:CM,GLBufferAttribute:Bce,GLSL1:Kie,GLSL3:g3,GreaterDepth:I9,GreaterEqualDepth:R9,GreaterEqualStencilFunc:Vie,GreaterStencilFunc:Gie,GridHelper:Uce,Group:Vc,HalfFloatType:Ag,HemisphereLight:J7,HemisphereLightHelper:kce,HemisphereLightProbe:ace,IcosahedronBufferGeometry:aue,IcosahedronGeometry:r1,ImageBitmapLoader:iX,ImageLoader:dx,ImageUtils:FR,IncrementStencilOp:Lie,IncrementWrapStencilOp:Iie,InstancedBufferAttribute:Cg,InstancedBufferGeometry:eX,InstancedInterleavedBuffer:Dce,InstancedMesh:qR,Int16BufferAttribute:Cne,Int32BufferAttribute:Tne,Int8BufferAttribute:Sne,IntType:j9,InterleavedBuffer:Jx,InterleavedBufferAttribute:Oh,Interpolant:iv,InterpolateDiscrete:Sg,InterpolateLinear:Rf,InterpolateSmooth:aA,InvertStencilOp:Fie,KeepStencilOp:lA,KeyframeTrack:il,LOD:C7,LatheBufferGeometry:lue,LatheGeometry:$g,Layers:vf,LessDepth:B9,LessEqualDepth:QA,LessEqualStencilFunc:Uie,LessStencilFunc:zie,Light:Qh,LightProbe:OM,Line:ou,Line3:Ice,LineBasicMaterial:Zr,LineCurve:RM,LineCurve3:B7,LineDashedMaterial:W7,LineLoop:QR,LineSegments:el,LinearEncoding:Ih,LinearFilter:rn,LinearInterpolant:oI,LinearMipMapLinearFilter:Tie,LinearMipMapNearestFilter:Cie,LinearMipmapLinearFilter:Yl,LinearMipmapNearestFilter:SM,LinearSRGBColorSpace:Mg,LinearToneMapping:z9,Loader:ws,LoaderUtils:Gl,LoadingManager:lI,LoopOnce:n7,LoopPingPong:s7,LoopRepeat:r7,LuminanceAlphaFormat:Q9,LuminanceFormat:q9,MOUSE:Rd,Material:Gn,MaterialLoader:FM,MathUtils:OR,Matrix3:hs,Matrix4:Nt,MaxEquation:XD,Mesh:$n,MeshBasicMaterial:co,MeshDepthMaterial:VR,MeshDistanceMaterial:jR,MeshLambertMaterial:V7,MeshMatcapMaterial:j7,MeshNormalMaterial:H7,MeshPhongMaterial:U7,MeshPhysicalMaterial:tc,MeshStandardMaterial:h1,MeshToonMaterial:G7,MinEquation:WD,MirroredRepeatWrapping:bg,MixOperation:F9,MultiplyBlending:jD,MultiplyOperation:Xx,NearestFilter:gn,NearestMipMapLinearFilter:Eie,NearestMipMapNearestFilter:Mie,NearestMipmapLinearFilter:Km,NearestMipmapNearestFilter:nx,NeverDepth:P9,NeverStencilFunc:Nie,NoBlending:Qc,NoColorSpace:Pie,NoToneMapping:Xa,NormalAnimationBlendMode:MM,NormalBlending:df,NotEqualDepth:O9,NotEqualStencilFunc:Hie,NumberKeyframeTrack:Tg,Object3D:fi,ObjectLoader:rce,ObjectSpaceNormalMap:c7,OctahedronBufferGeometry:cue,OctahedronGeometry:ev,OneFactor:_9,OneMinusDstAlphaFactor:M9,OneMinusDstColorFactor:C9,OneMinusSrcAlphaFactor:PR,OneMinusSrcColorFactor:A9,OrthographicCamera:Ya,PCFShadowMap:bM,PCFSoftShadowMap:fy,PMREMGenerator:y3,Path:lx,PerspectiveCamera:$i,Plane:Qu,PlaneBufferGeometry:uue,PlaneGeometry:Kg,PlaneHelper:Xce,PointLight:hI,PointLightHelper:Nce,Points:JR,PointsMaterial:Zx,PolarGridHelper:Gce,PolyhedronBufferGeometry:hue,PolyhedronGeometry:hu,PositionalAudio:fce,PropertyBinding:pi,PropertyMixer:rX,QuadraticBezierCurve:eI,QuadraticBezierCurve3:tI,Quaternion:yr,QuaternionKeyframeTrack:Fh,QuaternionLinearInterpolant:Q7,RED_GREEN_RGTC2_Format:p3,RED_RGTC1_Format:i7,REVISION:Wx,RGBADepthPacking:l7,RGBAFormat:Ls,RGBAIntegerFormat:e7,RGBA_ASTC_10x10_Format:u3,RGBA_ASTC_10x5_Format:a3,RGBA_ASTC_10x6_Format:l3,RGBA_ASTC_10x8_Format:c3,RGBA_ASTC_12x10_Format:h3,RGBA_ASTC_12x12_Format:d3,RGBA_ASTC_4x4_Format:$D,RGBA_ASTC_5x4_Format:e3,RGBA_ASTC_5x5_Format:t3,RGBA_ASTC_6x5_Format:i3,RGBA_ASTC_6x6_Format:n3,RGBA_ASTC_8x5_Format:r3,RGBA_ASTC_8x6_Format:s3,RGBA_ASTC_8x8_Format:o3,RGBA_BPTC_Format:oA,RGBA_ETC2_EAC_Format:ZD,RGBA_PVRTC_2BPPV1_Format:JD,RGBA_PVRTC_4BPPV1_Format:QD,RGBA_S3TC_DXT1_Format:nA,RGBA_S3TC_DXT3_Format:rA,RGBA_S3TC_DXT5_Format:sA,RGB_ETC1_Format:t7,RGB_ETC2_Format:KD,RGB_PVRTC_2BPPV1_Format:qD,RGB_PVRTC_4BPPV1_Format:YD,RGB_S3TC_DXT1_Format:iA,RGFormat:Z9,RGIntegerFormat:$9,RawShaderMaterial:k7,Ray:Yx,Raycaster:sX,RectAreaLight:Z7,RedFormat:J9,RedIntegerFormat:K9,ReinhardToneMapping:k9,RepeatWrapping:Rh,ReplaceStencilOp:Bie,ReverseSubtractEquation:x9,RingBufferGeometry:due,RingGeometry:s1,SIGNED_RED_GREEN_RGTC2_Format:m3,SIGNED_RED_RGTC1_Format:f3,SRGBColorSpace:Ia,Scene:$A,ShaderChunk:ii,ShaderLib:Fa,ShaderMaterial:ql,ShadowMaterial:z7,Shape:yf,ShapeBufferGeometry:fue,ShapeGeometry:o1,ShapePath:Qce,ShapeUtils:Ul,ShortType:V9,Skeleton:Kx,SkeletonHelper:Fce,SkinnedMesh:YR,Source:nf,Sphere:Yh,SphereBufferGeometry:pue,SphereGeometry:tv,Spherical:M3,SphericalHarmonics3:$7,SplineCurve:iI,SpotLight:uI,SpotLightHelper:Oce,Sprite:E7,SpriteMaterial:XR,SrcAlphaFactor:TR,SrcAlphaSaturateFactor:T9,SrcColorFactor:b9,StaticCopyUsage:qie,StaticDrawUsage:sx,StaticReadUsage:Wie,StereoCamera:cce,StreamCopyUsage:Jie,StreamDrawUsage:jie,StreamReadUsage:Yie,StringKeyframeTrack:qf,SubtractEquation:y9,SubtractiveBlending:VD,TOUCH:Id,TangentSpaceNormalMap:Wh,TetrahedronBufferGeometry:mue,TetrahedronGeometry:a1,Texture:en,TextureLoader:d1,TorusBufferGeometry:gue,TorusGeometry:l1,TorusKnotBufferGeometry:vue,TorusKnotGeometry:c1,Triangle:Ko,TriangleFanDrawMode:JA,TriangleStripDrawMode:RR,TrianglesDrawMode:o7,TubeBufferGeometry:yue,TubeGeometry:u1,TwoPassDoubleSide:Sie,UVMapping:AM,Uint16BufferAttribute:zR,Uint32BufferAttribute:kR,Uint8BufferAttribute:Mne,Uint8ClampedBufferAttribute:Ene,Uniform:vI,UniformsGroup:Pce,UniformsLib:rt,UniformsUtils:m7,UnsignedByteType:su,UnsignedInt248Type:ff,UnsignedIntType:lh,UnsignedShort4444Type:W9,UnsignedShort5551Type:X9,UnsignedShortType:BR,VSMShadowMap:$d,Vector2:Ve,Vector3:te,Vector4:Ci,VectorKeyframeTrack:Pg,VideoTexture:ple,WebGL1Renderer:S7,WebGL3DRenderTarget:pne,WebGLArrayRenderTarget:fne,WebGLCubeRenderTarget:GR,WebGLMultipleRenderTargets:mne,WebGLRenderTarget:Ja,WebGLRenderer:WR,WebGLUtils:_7,WireframeGeometry:N7,WrapAroundEnding:rx,ZeroCurvatureEnding:ef,ZeroFactor:w9,ZeroSlopeEnding:tf,ZeroStencilOp:Die,_SRGBAFormat:KA,sRGBEncoding:Gi},Symbol.toStringTag,{value:"Module"}));var aX={exports:{}},Qf={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Qf.ConcurrentRoot=1;Qf.ContinuousEventPriority=4;Qf.DefaultEventPriority=16;Qf.DiscreteEventPriority=1;Qf.IdleEventPriority=536870912;Qf.LegacyRoot=0;aX.exports=Qf;var Lm=aX.exports;function wue(e){let t;const i=new Set,n=(c,h)=>{const u=typeof c=="function"?c(t):c;if(u!==t){const d=t;t=h?u:Object.assign({},t,u),i.forEach(f=>f(t,d))}},r=()=>t,s=(c,h=r,u=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=h(t);function f(){const p=h(t);if(!u(d,p)){const g=d;c(d=p,g)}}return i.add(f),()=>i.delete(f)},l={setState:n,getState:r,subscribe:(c,h,u)=>h||u?s(c,h,u):(i.add(c),()=>i.delete(c)),destroy:()=>i.clear()};return t=e(n,r,l),l}const _ue=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),VU=_ue?ae.useEffect:ae.useLayoutEffect;function lX(e){const t=typeof e=="function"?wue(e):e,i=(n=t.getState,r=Object.is)=>{const[,s]=ae.useReducer(m=>m+1,0),o=t.getState(),a=ae.useRef(o),l=ae.useRef(n),c=ae.useRef(r),h=ae.useRef(!1),u=ae.useRef();u.current===void 0&&(u.current=n(o));let d,f=!1;(a.current!==o||l.current!==n||c.current!==r||h.current)&&(d=n(o),f=!r(u.current,d)),VU(()=>{f&&(u.current=d),a.current=o,l.current=n,c.current=r,h.current=!1});const p=ae.useRef(o);VU(()=>{const m=()=>{try{const x=t.getState(),w=l.current(x);c.current(u.current,w)||(a.current=x,u.current=w,s())}catch{h.current=!0,s()}},v=t.subscribe(m);return t.getState()!==p.current&&m(),v},[]);const g=f?d:u.current;return ae.useDebugValue(g),g};return Object.assign(i,t),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[i,t];return{next(){const r=n.length<=0;return{value:n.shift(),done:r}}}},i}var cX={exports:{}},uX={exports:{}},hX={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(U,X){var V=U.length;U.push(X);e:for(;0<V;){var q=V-1>>>1,H=U[q];if(0<r(H,X))U[q]=X,U[V]=H,V=q;else break e}}function i(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var X=U[0],V=U.pop();if(V!==X){U[0]=V;e:for(var q=0,H=U.length,Q=H>>>1;q<Q;){var J=2*(q+1)-1,le=U[J],j=J+1,ve=U[j];if(0>r(le,V))j<H&&0>r(ve,le)?(U[q]=ve,U[j]=V,q=j):(U[q]=le,U[J]=V,q=J);else if(j<H&&0>r(ve,V))U[q]=ve,U[j]=V,q=j;else break e}}return X}function r(U,X){var V=U.sortIndex-X.sortIndex;return V!==0?V:U.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(U){for(var X=i(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=U)n(c),X.sortIndex=X.expirationTime,t(l,X);else break;X=i(c)}}function b(U){if(g=!1,w(U),!p)if(i(l)!==null)p=!0,K(M);else{var X=i(c);X!==null&&Z(b,X.startTime-U)}}function M(U,X){p=!1,g&&(g=!1,v(S),S=-1),f=!0;var V=d;try{for(w(X),u=i(l);u!==null&&(!(u.expirationTime>X)||U&&!B());){var q=u.callback;if(typeof q=="function"){u.callback=null,d=u.priorityLevel;var H=q(u.expirationTime<=X);X=e.unstable_now(),typeof H=="function"?u.callback=H:u===i(l)&&n(l),w(X)}else n(l);u=i(l)}if(u!==null)var Q=!0;else{var J=i(c);J!==null&&Z(b,J.startTime-X),Q=!1}return Q}finally{u=null,d=V,f=!1}}var A=!1,T=null,S=-1,C=5,P=-1;function B(){return!(e.unstable_now()-P<C)}function k(){if(T!==null){var U=e.unstable_now();P=U;var X=!0;try{X=T(!0,U)}finally{X?z():(A=!1,T=null)}}else A=!1}var z;if(typeof x=="function")z=function(){x(k)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,W=F.port2;F.port1.onmessage=k,z=function(){W.postMessage(null)}}else z=function(){m(k,0)};function K(U){T=U,A||(A=!0,z())}function Z(U,X){S=m(function(){U(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,K(M))},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return i(l)},e.unstable_next=function(U){switch(d){case 1:case 2:case 3:var X=3;break;default:X=d}var V=d;d=X;try{return U()}finally{d=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(U,X){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var V=d;d=U;try{return X()}finally{d=V}},e.unstable_scheduleCallback=function(U,X,V){var q=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?q+V:q):V=q,U){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=V+H,U={id:h++,callback:X,priorityLevel:U,startTime:V,expirationTime:H,sortIndex:-1},V>q?(U.sortIndex=V,t(c,U),i(l)===null&&U===i(c)&&(g?(v(S),S=-1):g=!0,Z(b,V-q))):(U.sortIndex=H,t(l,U),p||f||(p=!0,K(M))),U},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(U){var X=d;return function(){var V=d;d=X;try{return U.apply(this,arguments)}finally{d=V}}}})(hX);uX.exports=hX;var E3=uX.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bue=function(t){var i={},n=ae,r=E3,s=Object.assign;function o(y){for(var _="https://reactjs.org/docs/error-decoder.html?invariant="+y,E=1;E<arguments.length;E++)_+="&args[]="+encodeURIComponent(arguments[E]);return"Minified React error #"+y+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),M=Symbol.iterator;function A(y){return y===null||typeof y!="object"?null:(y=M&&y[M]||y["@@iterator"],typeof y=="function"?y:null)}function T(y){if(y==null)return null;if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y;switch(y){case h:return"Fragment";case c:return"Portal";case d:return"Profiler";case u:return"StrictMode";case m:return"Suspense";case v:return"SuspenseList"}if(typeof y=="object")switch(y.$$typeof){case p:return(y.displayName||"Context")+".Consumer";case f:return(y._context.displayName||"Context")+".Provider";case g:var _=y.render;return y=y.displayName,y||(y=_.displayName||_.name||"",y=y!==""?"ForwardRef("+y+")":"ForwardRef"),y;case x:return _=y.displayName||null,_!==null?_:T(y.type)||"Memo";case w:_=y._payload,y=y._init;try{return T(y(_))}catch{}}return null}function S(y){var _=y.type;switch(y.tag){case 24:return"Cache";case 9:return(_.displayName||"Context")+".Consumer";case 10:return(_._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return y=_.render,y=y.displayName||y.name||"",_.displayName||(y!==""?"ForwardRef("+y+")":"ForwardRef");case 7:return"Fragment";case 5:return _;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return T(_);case 8:return _===u?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _}return null}function C(y){var _=y,E=y;if(y.alternate)for(;_.return;)_=_.return;else{y=_;do _=y,_.flags&4098&&(E=_.return),y=_.return;while(y)}return _.tag===3?E:null}function P(y){if(C(y)!==y)throw Error(o(188))}function B(y){var _=y.alternate;if(!_){if(_=C(y),_===null)throw Error(o(188));return _!==y?null:y}for(var E=y,D=_;;){var L=E.return;if(L===null)break;var G=L.alternate;if(G===null){if(D=L.return,D!==null){E=D;continue}break}if(L.child===G.child){for(G=L.child;G;){if(G===E)return P(L),y;if(G===D)return P(L),_;G=G.sibling}throw Error(o(188))}if(E.return!==D.return)E=L,D=G;else{for(var re=!1,_e=L.child;_e;){if(_e===E){re=!0,E=L,D=G;break}if(_e===D){re=!0,D=L,E=G;break}_e=_e.sibling}if(!re){for(_e=G.child;_e;){if(_e===E){re=!0,E=G,D=L;break}if(_e===D){re=!0,D=G,E=L;break}_e=_e.sibling}if(!re)throw Error(o(189))}}if(E.alternate!==D)throw Error(o(190))}if(E.tag!==3)throw Error(o(188));return E.stateNode.current===E?y:_}function k(y){return y=B(y),y!==null?z(y):null}function z(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){var _=z(y);if(_!==null)return _;y=y.sibling}return null}function F(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){if(y.tag!==4){var _=F(y);if(_!==null)return _}y=y.sibling}return null}var W=Array.isArray,K=t.getPublicInstance,Z=t.getRootHostContext,U=t.getChildHostContext,X=t.prepareForCommit,V=t.resetAfterCommit,q=t.createInstance,H=t.appendInitialChild,Q=t.finalizeInitialChildren,J=t.prepareUpdate,le=t.shouldSetTextContent,j=t.createTextInstance,ve=t.scheduleTimeout,pe=t.cancelTimeout,me=t.noTimeout,de=t.isPrimaryRenderer,Se=t.supportsMutation,ce=t.supportsPersistence,se=t.supportsHydration,be=t.getInstanceFromNode,Ee=t.preparePortalMount,Le=t.getCurrentEventPriority,ze=t.detachDeletedInstance,Oe=t.supportsMicrotasks,Ge=t.scheduleMicrotask,tt=t.supportsTestSelectors,ot=t.findFiberRoot,N=t.getBoundingRect,R=t.getTextContent,ie=t.isHiddenSubtree,xe=t.matchAccessibilityRole,Me=t.setFocusIfFocusable,Te=t.setupIntersectionObserver,qe=t.appendChild,De=t.appendChildToContainer,ue=t.commitTextUpdate,He=t.commitMount,ne=t.commitUpdate,we=t.insertBefore,Re=t.insertInContainerBefore,Ne=t.removeChild,$e=t.removeChildFromContainer,xt=t.resetTextContent,kt=t.hideInstance,Y=t.hideTextInstance,oe=t.unhideInstance,ye=t.unhideTextInstance,Fe=t.clearContainer,Xe=t.cloneInstance,pt=t.createContainerChildSet,ei=t.appendChildToContainerChildSet,ui=t.finalizeContainerChildren,ar=t.replaceContainerChildren,Dt=t.cloneHiddenInstance,un=t.cloneHiddenTextInstance,Oi=t.canHydrateInstance,td=t.canHydrateTextInstance,yv=t.canHydrateSuspenseInstance,np=t.isSuspenseInstancePending,id=t.isSuspenseInstanceFallback,O=t.registerSuspenseInstanceRetry,ee=t.getNextHydratableSibling,he=t.getFirstHydratableChild,$=t.getFirstHydratableChildWithinContainer,fe=t.getFirstHydratableChildWithinSuspenseInstance,We=t.hydrateInstance,Ke=t.hydrateTextInstance,nt=t.hydrateSuspenseInstance,st=t.getNextHydratableInstanceAfterSuspenseInstance,_t=t.commitHydratedContainer,mt=t.commitHydratedSuspenseInstance,ht=t.clearSuspenseBoundary,ni=t.clearSuspenseBoundaryFromContainer,Ai=t.shouldDeleteUnhydratedTailInstances,wn=t.didNotMatchHydratedContainerTextInstance,wr=t.didNotMatchHydratedTextInstance,Gt;function at(y){if(Gt===void 0)try{throw Error()}catch(E){var _=E.stack.trim().match(/\n( *(at )?)/);Gt=_&&_[1]||""}return`
`+Gt+y}var pa=!1;function ki(y,_){if(!y||pa)return"";pa=!0;var E=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(_)if(_=function(){throw Error()},Object.defineProperty(_.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_,[])}catch(Ze){var D=Ze}Reflect.construct(y,[],_)}else{try{_.call()}catch(Ze){D=Ze}y.call(_.prototype)}else{try{throw Error()}catch(Ze){D=Ze}y()}}catch(Ze){if(Ze&&D&&typeof Ze.stack=="string"){for(var L=Ze.stack.split(`
`),G=D.stack.split(`
`),re=L.length-1,_e=G.length-1;1<=re&&0<=_e&&L[re]!==G[_e];)_e--;for(;1<=re&&0<=_e;re--,_e--)if(L[re]!==G[_e]){if(re!==1||_e!==1)do if(re--,_e--,0>_e||L[re]!==G[_e]){var Ue=`
`+L[re].replace(" at new "," at ");return y.displayName&&Ue.includes("<anonymous>")&&(Ue=Ue.replace("<anonymous>",y.displayName)),Ue}while(1<=re&&0<=_e);break}}}finally{pa=!1,Error.prepareStackTrace=E}return(y=y?y.displayName||y.name:"")?at(y):""}var _r=Object.prototype.hasOwnProperty,rc=[],lr=-1;function Lr(y){return{current:y}}function bt(y){0>lr||(y.current=rc[lr],rc[lr]=null,lr--)}function Jt(y,_){lr++,rc[lr]=y.current,y.current=_}var Rr={},jt=Lr(Rr),hn=Lr(!1),ma=Rr;function So(y,_){var E=y.type.contextTypes;if(!E)return Rr;var D=y.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===_)return D.__reactInternalMemoizedMaskedChildContext;var L={},G;for(G in E)L[G]=_[G];return D&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=_,y.__reactInternalMemoizedMaskedChildContext=L),L}function As(y){return y=y.childContextTypes,y!=null}function L1(){bt(hn),bt(jt)}function EF(y,_,E){if(jt.current!==Rr)throw Error(o(168));Jt(jt,_),Jt(hn,E)}function CF(y,_,E){var D=y.stateNode;if(_=_.childContextTypes,typeof D.getChildContext!="function")return E;D=D.getChildContext();for(var L in D)if(!(L in _))throw Error(o(108,S(y)||"Unknown",L));return s({},E,D)}function R1(y){return y=(y=y.stateNode)&&y.__reactInternalMemoizedMergedChildContext||Rr,ma=jt.current,Jt(jt,y),Jt(hn,hn.current),!0}function TF(y,_,E){var D=y.stateNode;if(!D)throw Error(o(169));E?(y=CF(y,_,ma),D.__reactInternalMemoizedMergedChildContext=y,bt(hn),bt(jt),Jt(jt,y)):bt(hn),Jt(hn,E)}var ga=Math.clz32?Math.clz32:FZ,IZ=Math.log,OZ=Math.LN2;function FZ(y){return y>>>=0,y===0?32:31-(IZ(y)/OZ|0)|0}var I1=64,O1=4194304;function xv(y){switch(y&-y){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return y&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return y}}function F1(y,_){var E=y.pendingLanes;if(E===0)return 0;var D=0,L=y.suspendedLanes,G=y.pingedLanes,re=E&268435455;if(re!==0){var _e=re&~L;_e!==0?D=xv(_e):(G&=re,G!==0&&(D=xv(G)))}else re=E&~L,re!==0?D=xv(re):G!==0&&(D=xv(G));if(D===0)return 0;if(_!==0&&_!==D&&!(_&L)&&(L=D&-D,G=_&-_,L>=G||L===16&&(G&4194240)!==0))return _;if(D&4&&(D|=E&16),_=y.entangledLanes,_!==0)for(y=y.entanglements,_&=D;0<_;)E=31-ga(_),L=1<<E,D|=y[E],_&=~L;return D}function NZ(y,_){switch(y){case 1:case 2:case 4:return _+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zZ(y,_){for(var E=y.suspendedLanes,D=y.pingedLanes,L=y.expirationTimes,G=y.pendingLanes;0<G;){var re=31-ga(G),_e=1<<re,Ue=L[re];Ue===-1?(!(_e&E)||_e&D)&&(L[re]=NZ(_e,_)):Ue<=_&&(y.expiredLanes|=_e),G&=~_e}}function yE(y){return y=y.pendingLanes&-1073741825,y!==0?y:y&1073741824?1073741824:0}function xE(y){for(var _=[],E=0;31>E;E++)_.push(y);return _}function wv(y,_,E){y.pendingLanes|=_,_!==536870912&&(y.suspendedLanes=0,y.pingedLanes=0),y=y.eventTimes,_=31-ga(_),y[_]=E}function kZ(y,_){var E=y.pendingLanes&~_;y.pendingLanes=_,y.suspendedLanes=0,y.pingedLanes=0,y.expiredLanes&=_,y.mutableReadLanes&=_,y.entangledLanes&=_,_=y.entanglements;var D=y.eventTimes;for(y=y.expirationTimes;0<E;){var L=31-ga(E),G=1<<L;_[L]=0,D[L]=-1,y[L]=-1,E&=~G}}function wE(y,_){var E=y.entangledLanes|=_;for(y=y.entanglements;E;){var D=31-ga(E),L=1<<D;L&_|y[D]&_&&(y[D]|=_),E&=~L}}var gi=0;function PF(y){return y&=-y,1<y?4<y?y&268435455?16:536870912:4:1}var _E=r.unstable_scheduleCallback,DF=r.unstable_cancelCallback,UZ=r.unstable_shouldYield,GZ=r.unstable_requestPaint,cr=r.unstable_now,bE=r.unstable_ImmediatePriority,HZ=r.unstable_UserBlockingPriority,AE=r.unstable_NormalPriority,VZ=r.unstable_IdlePriority,N1=null,sl=null;function jZ(y){if(sl&&typeof sl.onCommitFiberRoot=="function")try{sl.onCommitFiberRoot(N1,y,void 0,(y.current.flags&128)===128)}catch{}}function WZ(y,_){return y===_&&(y!==0||1/y===1/_)||y!==y&&_!==_}var ol=typeof Object.is=="function"?Object.is:WZ,sc=null,z1=!1,SE=!1;function BF(y){sc===null?sc=[y]:sc.push(y)}function XZ(y){z1=!0,BF(y)}function al(){if(!SE&&sc!==null){SE=!0;var y=0,_=gi;try{var E=sc;for(gi=1;y<E.length;y++){var D=E[y];do D=D(!0);while(D!==null)}sc=null,z1=!1}catch(L){throw sc!==null&&(sc=sc.slice(y+1)),_E(bE,al),L}finally{gi=_,SE=!1}}return null}var YZ=a.ReactCurrentBatchConfig;function k1(y,_){if(ol(y,_))return!0;if(typeof y!="object"||y===null||typeof _!="object"||_===null)return!1;var E=Object.keys(y),D=Object.keys(_);if(E.length!==D.length)return!1;for(D=0;D<E.length;D++){var L=E[D];if(!_r.call(_,L)||!ol(y[L],_[L]))return!1}return!0}function qZ(y){switch(y.tag){case 5:return at(y.type);case 16:return at("Lazy");case 13:return at("Suspense");case 19:return at("SuspenseList");case 0:case 2:case 15:return y=ki(y.type,!1),y;case 11:return y=ki(y.type.render,!1),y;case 1:return y=ki(y.type,!0),y;default:return""}}function va(y,_){if(y&&y.defaultProps){_=s({},_),y=y.defaultProps;for(var E in y)_[E]===void 0&&(_[E]=y[E]);return _}return _}var U1=Lr(null),G1=null,rp=null,ME=null;function EE(){ME=rp=G1=null}function LF(y,_,E){de?(Jt(U1,_._currentValue),_._currentValue=E):(Jt(U1,_._currentValue2),_._currentValue2=E)}function CE(y){var _=U1.current;bt(U1),de?y._currentValue=_:y._currentValue2=_}function TE(y,_,E){for(;y!==null;){var D=y.alternate;if((y.childLanes&_)!==_?(y.childLanes|=_,D!==null&&(D.childLanes|=_)):D!==null&&(D.childLanes&_)!==_&&(D.childLanes|=_),y===E)break;y=y.return}}function sp(y,_){G1=y,ME=rp=null,y=y.dependencies,y!==null&&y.firstContext!==null&&(y.lanes&_&&(Ks=!0),y.firstContext=null)}function Mo(y){var _=de?y._currentValue:y._currentValue2;if(ME!==y)if(y={context:y,memoizedValue:_,next:null},rp===null){if(G1===null)throw Error(o(308));rp=y,G1.dependencies={lanes:0,firstContext:y}}else rp=rp.next=y;return _}var ll=null,mu=!1;function PE(y){y.updateQueue={baseState:y.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function RF(y,_){y=y.updateQueue,_.updateQueue===y&&(_.updateQueue={baseState:y.baseState,firstBaseUpdate:y.firstBaseUpdate,lastBaseUpdate:y.lastBaseUpdate,shared:y.shared,effects:y.effects})}function oc(y,_){return{eventTime:y,lane:_,tag:0,payload:null,callback:null,next:null}}function gu(y,_){var E=y.updateQueue;E!==null&&(E=E.shared,Ln!==null&&y.mode&1&&!(ri&2)?(y=E.interleaved,y===null?(_.next=_,ll===null?ll=[E]:ll.push(E)):(_.next=y.next,y.next=_),E.interleaved=_):(y=E.pending,y===null?_.next=_:(_.next=y.next,y.next=_),E.pending=_))}function H1(y,_,E){if(_=_.updateQueue,_!==null&&(_=_.shared,(E&4194240)!==0)){var D=_.lanes;D&=y.pendingLanes,E|=D,_.lanes=E,wE(y,E)}}function IF(y,_){var E=y.updateQueue,D=y.alternate;if(D!==null&&(D=D.updateQueue,E===D)){var L=null,G=null;if(E=E.firstBaseUpdate,E!==null){do{var re={eventTime:E.eventTime,lane:E.lane,tag:E.tag,payload:E.payload,callback:E.callback,next:null};G===null?L=G=re:G=G.next=re,E=E.next}while(E!==null);G===null?L=G=_:G=G.next=_}else L=G=_;E={baseState:D.baseState,firstBaseUpdate:L,lastBaseUpdate:G,shared:D.shared,effects:D.effects},y.updateQueue=E;return}y=E.lastBaseUpdate,y===null?E.firstBaseUpdate=_:y.next=_,E.lastBaseUpdate=_}function V1(y,_,E,D){var L=y.updateQueue;mu=!1;var G=L.firstBaseUpdate,re=L.lastBaseUpdate,_e=L.shared.pending;if(_e!==null){L.shared.pending=null;var Ue=_e,Ze=Ue.next;Ue.next=null,re===null?G=Ze:re.next=Ze,re=Ue;var yt=y.alternate;yt!==null&&(yt=yt.updateQueue,_e=yt.lastBaseUpdate,_e!==re&&(_e===null?yt.firstBaseUpdate=Ze:_e.next=Ze,yt.lastBaseUpdate=Ue))}if(G!==null){var Xt=L.baseState;re=0,yt=Ze=Ue=null,_e=G;do{var Bt=_e.lane,Fi=_e.eventTime;if((D&Bt)===Bt){yt!==null&&(yt=yt.next={eventTime:Fi,lane:0,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null});e:{var St=y,Nr=_e;switch(Bt=_,Fi=E,Nr.tag){case 1:if(St=Nr.payload,typeof St=="function"){Xt=St.call(Fi,Xt,Bt);break e}Xt=St;break e;case 3:St.flags=St.flags&-65537|128;case 0:if(St=Nr.payload,Bt=typeof St=="function"?St.call(Fi,Xt,Bt):St,Bt==null)break e;Xt=s({},Xt,Bt);break e;case 2:mu=!0}}_e.callback!==null&&_e.lane!==0&&(y.flags|=64,Bt=L.effects,Bt===null?L.effects=[_e]:Bt.push(_e))}else Fi={eventTime:Fi,lane:Bt,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null},yt===null?(Ze=yt=Fi,Ue=Xt):yt=yt.next=Fi,re|=Bt;if(_e=_e.next,_e===null){if(_e=L.shared.pending,_e===null)break;Bt=_e,_e=Bt.next,Bt.next=null,L.lastBaseUpdate=Bt,L.shared.pending=null}}while(1);if(yt===null&&(Ue=Xt),L.baseState=Ue,L.firstBaseUpdate=Ze,L.lastBaseUpdate=yt,_=L.shared.interleaved,_!==null){L=_;do re|=L.lane,L=L.next;while(L!==_)}else G===null&&(L.shared.lanes=0);pp|=re,y.lanes=re,y.memoizedState=Xt}}function OF(y,_,E){if(y=_.effects,_.effects=null,y!==null)for(_=0;_<y.length;_++){var D=y[_],L=D.callback;if(L!==null){if(D.callback=null,D=E,typeof L!="function")throw Error(o(191,L));L.call(D)}}}var FF=new n.Component().refs;function DE(y,_,E,D){_=y.memoizedState,E=E(D,_),E=E==null?_:s({},_,E),y.memoizedState=E,y.lanes===0&&(y.updateQueue.baseState=E)}var j1={isMounted:function(y){return(y=y._reactInternals)?C(y)===y:!1},enqueueSetState:function(y,_,E){y=y._reactInternals;var D=es(),L=xu(y),G=oc(D,L);G.payload=_,E!=null&&(G.callback=E),gu(y,G),_=Do(y,L,D),_!==null&&H1(_,y,L)},enqueueReplaceState:function(y,_,E){y=y._reactInternals;var D=es(),L=xu(y),G=oc(D,L);G.tag=1,G.payload=_,E!=null&&(G.callback=E),gu(y,G),_=Do(y,L,D),_!==null&&H1(_,y,L)},enqueueForceUpdate:function(y,_){y=y._reactInternals;var E=es(),D=xu(y),L=oc(E,D);L.tag=2,_!=null&&(L.callback=_),gu(y,L),_=Do(y,D,E),_!==null&&H1(_,y,D)}};function NF(y,_,E,D,L,G,re){return y=y.stateNode,typeof y.shouldComponentUpdate=="function"?y.shouldComponentUpdate(D,G,re):_.prototype&&_.prototype.isPureReactComponent?!k1(E,D)||!k1(L,G):!0}function zF(y,_,E){var D=!1,L=Rr,G=_.contextType;return typeof G=="object"&&G!==null?G=Mo(G):(L=As(_)?ma:jt.current,D=_.contextTypes,G=(D=D!=null)?So(y,L):Rr),_=new _(E,G),y.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=j1,y.stateNode=_,_._reactInternals=y,D&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=L,y.__reactInternalMemoizedMaskedChildContext=G),_}function kF(y,_,E,D){y=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(E,D),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(E,D),_.state!==y&&j1.enqueueReplaceState(_,_.state,null)}function BE(y,_,E,D){var L=y.stateNode;L.props=E,L.state=y.memoizedState,L.refs=FF,PE(y);var G=_.contextType;typeof G=="object"&&G!==null?L.context=Mo(G):(G=As(_)?ma:jt.current,L.context=So(y,G)),L.state=y.memoizedState,G=_.getDerivedStateFromProps,typeof G=="function"&&(DE(y,_,G,E),L.state=y.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(_=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),_!==L.state&&j1.enqueueReplaceState(L,L.state,null),V1(y,E,L,D),L.state=y.memoizedState),typeof L.componentDidMount=="function"&&(y.flags|=4194308)}var op=[],ap=0,W1=null,X1=0,Eo=[],Co=0,nd=null,ac=1,lc="";function rd(y,_){op[ap++]=X1,op[ap++]=W1,W1=y,X1=_}function UF(y,_,E){Eo[Co++]=ac,Eo[Co++]=lc,Eo[Co++]=nd,nd=y;var D=ac;y=lc;var L=32-ga(D)-1;D&=~(1<<L),E+=1;var G=32-ga(_)+L;if(30<G){var re=L-L%5;G=(D&(1<<re)-1).toString(32),D>>=re,L-=re,ac=1<<32-ga(_)+L|E<<L|D,lc=G+y}else ac=1<<G|E<<L|D,lc=y}function LE(y){y.return!==null&&(rd(y,1),UF(y,1,0))}function RE(y){for(;y===W1;)W1=op[--ap],op[ap]=null,X1=op[--ap],op[ap]=null;for(;y===nd;)nd=Eo[--Co],Eo[Co]=null,lc=Eo[--Co],Eo[Co]=null,ac=Eo[--Co],Eo[Co]=null}var Qs=null,Js=null,Qi=!1,_v=!1,ya=null;function GF(y,_){var E=Bo(5,null,null,0);E.elementType="DELETED",E.stateNode=_,E.return=y,_=y.deletions,_===null?(y.deletions=[E],y.flags|=16):_.push(E)}function HF(y,_){switch(y.tag){case 5:return _=Oi(_,y.type,y.pendingProps),_!==null?(y.stateNode=_,Qs=y,Js=he(_),!0):!1;case 6:return _=td(_,y.pendingProps),_!==null?(y.stateNode=_,Qs=y,Js=null,!0):!1;case 13:if(_=yv(_),_!==null){var E=nd!==null?{id:ac,overflow:lc}:null;return y.memoizedState={dehydrated:_,treeContext:E,retryLane:1073741824},E=Bo(18,null,null,0),E.stateNode=_,E.return=y,y.child=E,Qs=y,Js=null,!0}return!1;default:return!1}}function IE(y){return(y.mode&1)!==0&&(y.flags&128)===0}function OE(y){if(Qi){var _=Js;if(_){var E=_;if(!HF(y,_)){if(IE(y))throw Error(o(418));_=ee(E);var D=Qs;_&&HF(y,_)?GF(D,E):(y.flags=y.flags&-4097|2,Qi=!1,Qs=y)}}else{if(IE(y))throw Error(o(418));y.flags=y.flags&-4097|2,Qi=!1,Qs=y}}}function VF(y){for(y=y.return;y!==null&&y.tag!==5&&y.tag!==3&&y.tag!==13;)y=y.return;Qs=y}function bv(y){if(!se||y!==Qs)return!1;if(!Qi)return VF(y),Qi=!0,!1;if(y.tag!==3&&(y.tag!==5||Ai(y.type)&&!le(y.type,y.memoizedProps))){var _=Js;if(_){if(IE(y)){for(y=Js;y;)y=ee(y);throw Error(o(418))}for(;_;)GF(y,_),_=ee(_)}}if(VF(y),y.tag===13){if(!se)throw Error(o(316));if(y=y.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(o(317));Js=st(y)}else Js=Qs?ee(y.stateNode):null;return!0}function lp(){se&&(Js=Qs=null,_v=Qi=!1)}function FE(y){ya===null?ya=[y]:ya.push(y)}function Av(y,_,E){if(y=E.ref,y!==null&&typeof y!="function"&&typeof y!="object"){if(E._owner){if(E=E._owner,E){if(E.tag!==1)throw Error(o(309));var D=E.stateNode}if(!D)throw Error(o(147,y));var L=D,G=""+y;return _!==null&&_.ref!==null&&typeof _.ref=="function"&&_.ref._stringRef===G?_.ref:(_=function(re){var _e=L.refs;_e===FF&&(_e=L.refs={}),re===null?delete _e[G]:_e[G]=re},_._stringRef=G,_)}if(typeof y!="string")throw Error(o(284));if(!E._owner)throw Error(o(290,y))}return y}function Y1(y,_){throw y=Object.prototype.toString.call(_),Error(o(31,y==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":y))}function jF(y){var _=y._init;return _(y._payload)}function WF(y){function _(Pe,Ae){if(y){var ke=Pe.deletions;ke===null?(Pe.deletions=[Ae],Pe.flags|=16):ke.push(Ae)}}function E(Pe,Ae){if(!y)return null;for(;Ae!==null;)_(Pe,Ae),Ae=Ae.sibling;return null}function D(Pe,Ae){for(Pe=new Map;Ae!==null;)Ae.key!==null?Pe.set(Ae.key,Ae):Pe.set(Ae.index,Ae),Ae=Ae.sibling;return Pe}function L(Pe,Ae){return Pe=_u(Pe,Ae),Pe.index=0,Pe.sibling=null,Pe}function G(Pe,Ae,ke){return Pe.index=ke,y?(ke=Pe.alternate,ke!==null?(ke=ke.index,ke<Ae?(Pe.flags|=2,Ae):ke):(Pe.flags|=2,Ae)):(Pe.flags|=1048576,Ae)}function re(Pe){return y&&Pe.alternate===null&&(Pe.flags|=2),Pe}function _e(Pe,Ae,ke,ut){return Ae===null||Ae.tag!==6?(Ae=xC(ke,Pe.mode,ut),Ae.return=Pe,Ae):(Ae=L(Ae,ke),Ae.return=Pe,Ae)}function Ue(Pe,Ae,ke,ut){var At=ke.type;return At===h?yt(Pe,Ae,ke.props.children,ut,ke.key):Ae!==null&&(Ae.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===w&&jF(At)===Ae.type)?(ut=L(Ae,ke.props),ut.ref=Av(Pe,Ae,ke),ut.return=Pe,ut):(ut=Sw(ke.type,ke.key,ke.props,null,Pe.mode,ut),ut.ref=Av(Pe,Ae,ke),ut.return=Pe,ut)}function Ze(Pe,Ae,ke,ut){return Ae===null||Ae.tag!==4||Ae.stateNode.containerInfo!==ke.containerInfo||Ae.stateNode.implementation!==ke.implementation?(Ae=wC(ke,Pe.mode,ut),Ae.return=Pe,Ae):(Ae=L(Ae,ke.children||[]),Ae.return=Pe,Ae)}function yt(Pe,Ae,ke,ut,At){return Ae===null||Ae.tag!==7?(Ae=hd(ke,Pe.mode,ut,At),Ae.return=Pe,Ae):(Ae=L(Ae,ke),Ae.return=Pe,Ae)}function Xt(Pe,Ae,ke){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number")return Ae=xC(""+Ae,Pe.mode,ke),Ae.return=Pe,Ae;if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case l:return ke=Sw(Ae.type,Ae.key,Ae.props,null,Pe.mode,ke),ke.ref=Av(Pe,null,Ae),ke.return=Pe,ke;case c:return Ae=wC(Ae,Pe.mode,ke),Ae.return=Pe,Ae;case w:var ut=Ae._init;return Xt(Pe,ut(Ae._payload),ke)}if(W(Ae)||A(Ae))return Ae=hd(Ae,Pe.mode,ke,null),Ae.return=Pe,Ae;Y1(Pe,Ae)}return null}function Bt(Pe,Ae,ke,ut){var At=Ae!==null?Ae.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number")return At!==null?null:_e(Pe,Ae,""+ke,ut);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case l:return ke.key===At?Ue(Pe,Ae,ke,ut):null;case c:return ke.key===At?Ze(Pe,Ae,ke,ut):null;case w:return At=ke._init,Bt(Pe,Ae,At(ke._payload),ut)}if(W(ke)||A(ke))return At!==null?null:yt(Pe,Ae,ke,ut,null);Y1(Pe,ke)}return null}function Fi(Pe,Ae,ke,ut,At){if(typeof ut=="string"&&ut!==""||typeof ut=="number")return Pe=Pe.get(ke)||null,_e(Ae,Pe,""+ut,At);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case l:return Pe=Pe.get(ut.key===null?ke:ut.key)||null,Ue(Ae,Pe,ut,At);case c:return Pe=Pe.get(ut.key===null?ke:ut.key)||null,Ze(Ae,Pe,ut,At);case w:var ti=ut._init;return Fi(Pe,Ae,ke,ti(ut._payload),At)}if(W(ut)||A(ut))return Pe=Pe.get(ke)||null,yt(Ae,Pe,ut,At,null);Y1(Ae,ut)}return null}function St(Pe,Ae,ke,ut){for(var At=null,ti=null,Yt=Ae,vi=Ae=0,hr=null;Yt!==null&&vi<ke.length;vi++){Yt.index>vi?(hr=Yt,Yt=null):hr=Yt.sibling;var yi=Bt(Pe,Yt,ke[vi],ut);if(yi===null){Yt===null&&(Yt=hr);break}y&&Yt&&yi.alternate===null&&_(Pe,Yt),Ae=G(yi,Ae,vi),ti===null?At=yi:ti.sibling=yi,ti=yi,Yt=hr}if(vi===ke.length)return E(Pe,Yt),Qi&&rd(Pe,vi),At;if(Yt===null){for(;vi<ke.length;vi++)Yt=Xt(Pe,ke[vi],ut),Yt!==null&&(Ae=G(Yt,Ae,vi),ti===null?At=Yt:ti.sibling=Yt,ti=Yt);return Qi&&rd(Pe,vi),At}for(Yt=D(Pe,Yt);vi<ke.length;vi++)hr=Fi(Yt,Pe,vi,ke[vi],ut),hr!==null&&(y&&hr.alternate!==null&&Yt.delete(hr.key===null?vi:hr.key),Ae=G(hr,Ae,vi),ti===null?At=hr:ti.sibling=hr,ti=hr);return y&&Yt.forEach(function(bu){return _(Pe,bu)}),Qi&&rd(Pe,vi),At}function Nr(Pe,Ae,ke,ut){var At=A(ke);if(typeof At!="function")throw Error(o(150));if(ke=At.call(ke),ke==null)throw Error(o(151));for(var ti=At=null,Yt=Ae,vi=Ae=0,hr=null,yi=ke.next();Yt!==null&&!yi.done;vi++,yi=ke.next()){Yt.index>vi?(hr=Yt,Yt=null):hr=Yt.sibling;var bu=Bt(Pe,Yt,yi.value,ut);if(bu===null){Yt===null&&(Yt=hr);break}y&&Yt&&bu.alternate===null&&_(Pe,Yt),Ae=G(bu,Ae,vi),ti===null?At=bu:ti.sibling=bu,ti=bu,Yt=hr}if(yi.done)return E(Pe,Yt),Qi&&rd(Pe,vi),At;if(Yt===null){for(;!yi.done;vi++,yi=ke.next())yi=Xt(Pe,yi.value,ut),yi!==null&&(Ae=G(yi,Ae,vi),ti===null?At=yi:ti.sibling=yi,ti=yi);return Qi&&rd(Pe,vi),At}for(Yt=D(Pe,Yt);!yi.done;vi++,yi=ke.next())yi=Fi(Yt,Pe,vi,yi.value,ut),yi!==null&&(y&&yi.alternate!==null&&Yt.delete(yi.key===null?vi:yi.key),Ae=G(yi,Ae,vi),ti===null?At=yi:ti.sibling=yi,ti=yi);return y&&Yt.forEach(function(S$){return _(Pe,S$)}),Qi&&rd(Pe,vi),At}function Lo(Pe,Ae,ke,ut){if(typeof ke=="object"&&ke!==null&&ke.type===h&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case l:e:{for(var At=ke.key,ti=Ae;ti!==null;){if(ti.key===At){if(At=ke.type,At===h){if(ti.tag===7){E(Pe,ti.sibling),Ae=L(ti,ke.props.children),Ae.return=Pe,Pe=Ae;break e}}else if(ti.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===w&&jF(At)===ti.type){E(Pe,ti.sibling),Ae=L(ti,ke.props),Ae.ref=Av(Pe,ti,ke),Ae.return=Pe,Pe=Ae;break e}E(Pe,ti);break}else _(Pe,ti);ti=ti.sibling}ke.type===h?(Ae=hd(ke.props.children,Pe.mode,ut,ke.key),Ae.return=Pe,Pe=Ae):(ut=Sw(ke.type,ke.key,ke.props,null,Pe.mode,ut),ut.ref=Av(Pe,Ae,ke),ut.return=Pe,Pe=ut)}return re(Pe);case c:e:{for(ti=ke.key;Ae!==null;){if(Ae.key===ti)if(Ae.tag===4&&Ae.stateNode.containerInfo===ke.containerInfo&&Ae.stateNode.implementation===ke.implementation){E(Pe,Ae.sibling),Ae=L(Ae,ke.children||[]),Ae.return=Pe,Pe=Ae;break e}else{E(Pe,Ae);break}else _(Pe,Ae);Ae=Ae.sibling}Ae=wC(ke,Pe.mode,ut),Ae.return=Pe,Pe=Ae}return re(Pe);case w:return ti=ke._init,Lo(Pe,Ae,ti(ke._payload),ut)}if(W(ke))return St(Pe,Ae,ke,ut);if(A(ke))return Nr(Pe,Ae,ke,ut);Y1(Pe,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"?(ke=""+ke,Ae!==null&&Ae.tag===6?(E(Pe,Ae.sibling),Ae=L(Ae,ke),Ae.return=Pe,Pe=Ae):(E(Pe,Ae),Ae=xC(ke,Pe.mode,ut),Ae.return=Pe,Pe=Ae),re(Pe)):E(Pe,Ae)}return Lo}var cp=WF(!0),XF=WF(!1),Sv={},To=Lr(Sv),Mv=Lr(Sv),up=Lr(Sv);function cl(y){if(y===Sv)throw Error(o(174));return y}function NE(y,_){Jt(up,_),Jt(Mv,y),Jt(To,Sv),y=Z(_),bt(To),Jt(To,y)}function hp(){bt(To),bt(Mv),bt(up)}function YF(y){var _=cl(up.current),E=cl(To.current);_=U(E,y.type,_),E!==_&&(Jt(Mv,y),Jt(To,_))}function zE(y){Mv.current===y&&(bt(To),bt(Mv))}var tn=Lr(0);function q1(y){for(var _=y;_!==null;){if(_.tag===13){var E=_.memoizedState;if(E!==null&&(E=E.dehydrated,E===null||np(E)||id(E)))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if(_.flags&128)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===y)break;for(;_.sibling===null;){if(_.return===null||_.return===y)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}var kE=[];function UE(){for(var y=0;y<kE.length;y++){var _=kE[y];de?_._workInProgressVersionPrimary=null:_._workInProgressVersionSecondary=null}kE.length=0}var Q1=a.ReactCurrentDispatcher,Po=a.ReactCurrentBatchConfig,dp=0,dn=null,Ir=null,ur=null,J1=!1,Ev=!1,Cv=0,QZ=0;function Or(){throw Error(o(321))}function GE(y,_){if(_===null)return!1;for(var E=0;E<_.length&&E<y.length;E++)if(!ol(y[E],_[E]))return!1;return!0}function HE(y,_,E,D,L,G){if(dp=G,dn=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,Q1.current=y===null||y.memoizedState===null?$Z:e$,y=E(D,L),Ev){G=0;do{if(Ev=!1,Cv=0,25<=G)throw Error(o(301));G+=1,ur=Ir=null,_.updateQueue=null,Q1.current=t$,y=E(D,L)}while(Ev)}if(Q1.current=tw,_=Ir!==null&&Ir.next!==null,dp=0,ur=Ir=dn=null,J1=!1,_)throw Error(o(300));return y}function VE(){var y=Cv!==0;return Cv=0,y}function cc(){var y={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ur===null?dn.memoizedState=ur=y:ur=ur.next=y,ur}function ul(){if(Ir===null){var y=dn.alternate;y=y!==null?y.memoizedState:null}else y=Ir.next;var _=ur===null?dn.memoizedState:ur.next;if(_!==null)ur=_,Ir=y;else{if(y===null)throw Error(o(310));Ir=y,y={memoizedState:Ir.memoizedState,baseState:Ir.baseState,baseQueue:Ir.baseQueue,queue:Ir.queue,next:null},ur===null?dn.memoizedState=ur=y:ur=ur.next=y}return ur}function sd(y,_){return typeof _=="function"?_(y):_}function K1(y){var _=ul(),E=_.queue;if(E===null)throw Error(o(311));E.lastRenderedReducer=y;var D=Ir,L=D.baseQueue,G=E.pending;if(G!==null){if(L!==null){var re=L.next;L.next=G.next,G.next=re}D.baseQueue=L=G,E.pending=null}if(L!==null){G=L.next,D=D.baseState;var _e=re=null,Ue=null,Ze=G;do{var yt=Ze.lane;if((dp&yt)===yt)Ue!==null&&(Ue=Ue.next={lane:0,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null}),D=Ze.hasEagerState?Ze.eagerState:y(D,Ze.action);else{var Xt={lane:yt,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null};Ue===null?(_e=Ue=Xt,re=D):Ue=Ue.next=Xt,dn.lanes|=yt,pp|=yt}Ze=Ze.next}while(Ze!==null&&Ze!==G);Ue===null?re=D:Ue.next=_e,ol(D,_.memoizedState)||(Ks=!0),_.memoizedState=D,_.baseState=re,_.baseQueue=Ue,E.lastRenderedState=D}if(y=E.interleaved,y!==null){L=y;do G=L.lane,dn.lanes|=G,pp|=G,L=L.next;while(L!==y)}else L===null&&(E.lanes=0);return[_.memoizedState,E.dispatch]}function Z1(y){var _=ul(),E=_.queue;if(E===null)throw Error(o(311));E.lastRenderedReducer=y;var D=E.dispatch,L=E.pending,G=_.memoizedState;if(L!==null){E.pending=null;var re=L=L.next;do G=y(G,re.action),re=re.next;while(re!==L);ol(G,_.memoizedState)||(Ks=!0),_.memoizedState=G,_.baseQueue===null&&(_.baseState=G),E.lastRenderedState=G}return[G,D]}function qF(){}function QF(y,_){var E=dn,D=ul(),L=_(),G=!ol(D.memoizedState,L);if(G&&(D.memoizedState=L,Ks=!0),D=D.queue,Pv(ZF.bind(null,E,D,y),[y]),D.getSnapshot!==_||G||ur!==null&&ur.memoizedState.tag&1){if(E.flags|=2048,Tv(9,KF.bind(null,E,D,L,_),void 0,null),Ln===null)throw Error(o(349));dp&30||JF(E,_,L)}return L}function JF(y,_,E){y.flags|=16384,y={getSnapshot:_,value:E},_=dn.updateQueue,_===null?(_={lastEffect:null,stores:null},dn.updateQueue=_,_.stores=[y]):(E=_.stores,E===null?_.stores=[y]:E.push(y))}function KF(y,_,E,D){_.value=E,_.getSnapshot=D,$F(_)&&Do(y,1,-1)}function ZF(y,_,E){return E(function(){$F(_)&&Do(y,1,-1)})}function $F(y){var _=y.getSnapshot;y=y.value;try{var E=_();return!ol(y,E)}catch{return!0}}function jE(y){var _=cc();return typeof y=="function"&&(y=y()),_.memoizedState=_.baseState=y,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sd,lastRenderedState:y},_.queue=y,y=y.dispatch=ZZ.bind(null,dn,y),[_.memoizedState,y]}function Tv(y,_,E,D){return y={tag:y,create:_,destroy:E,deps:D,next:null},_=dn.updateQueue,_===null?(_={lastEffect:null,stores:null},dn.updateQueue=_,_.lastEffect=y.next=y):(E=_.lastEffect,E===null?_.lastEffect=y.next=y:(D=E.next,E.next=y,y.next=D,_.lastEffect=y)),y}function eN(){return ul().memoizedState}function $1(y,_,E,D){var L=cc();dn.flags|=y,L.memoizedState=Tv(1|_,E,void 0,D===void 0?null:D)}function ew(y,_,E,D){var L=ul();D=D===void 0?null:D;var G=void 0;if(Ir!==null){var re=Ir.memoizedState;if(G=re.destroy,D!==null&&GE(D,re.deps)){L.memoizedState=Tv(_,E,G,D);return}}dn.flags|=y,L.memoizedState=Tv(1|_,E,G,D)}function WE(y,_){return $1(8390656,8,y,_)}function Pv(y,_){return ew(2048,8,y,_)}function tN(y,_){return ew(4,2,y,_)}function iN(y,_){return ew(4,4,y,_)}function nN(y,_){if(typeof _=="function")return y=y(),_(y),function(){_(null)};if(_!=null)return y=y(),_.current=y,function(){_.current=null}}function rN(y,_,E){return E=E!=null?E.concat([y]):null,ew(4,4,nN.bind(null,_,y),E)}function XE(){}function sN(y,_){var E=ul();_=_===void 0?null:_;var D=E.memoizedState;return D!==null&&_!==null&&GE(_,D[1])?D[0]:(E.memoizedState=[y,_],y)}function oN(y,_){var E=ul();_=_===void 0?null:_;var D=E.memoizedState;return D!==null&&_!==null&&GE(_,D[1])?D[0]:(y=y(),E.memoizedState=[y,_],y)}function JZ(y,_){var E=gi;gi=E!==0&&4>E?E:4,y(!0);var D=Po.transition;Po.transition={};try{y(!1),_()}finally{gi=E,Po.transition=D}}function aN(){return ul().memoizedState}function KZ(y,_,E){var D=xu(y);E={lane:D,action:E,hasEagerState:!1,eagerState:null,next:null},lN(y)?cN(_,E):(uN(y,_,E),E=es(),y=Do(y,D,E),y!==null&&hN(y,_,D))}function ZZ(y,_,E){var D=xu(y),L={lane:D,action:E,hasEagerState:!1,eagerState:null,next:null};if(lN(y))cN(_,L);else{uN(y,_,L);var G=y.alternate;if(y.lanes===0&&(G===null||G.lanes===0)&&(G=_.lastRenderedReducer,G!==null))try{var re=_.lastRenderedState,_e=G(re,E);if(L.hasEagerState=!0,L.eagerState=_e,ol(_e,re))return}catch{}finally{}E=es(),y=Do(y,D,E),y!==null&&hN(y,_,D)}}function lN(y){var _=y.alternate;return y===dn||_!==null&&_===dn}function cN(y,_){Ev=J1=!0;var E=y.pending;E===null?_.next=_:(_.next=E.next,E.next=_),y.pending=_}function uN(y,_,E){Ln!==null&&y.mode&1&&!(ri&2)?(y=_.interleaved,y===null?(E.next=E,ll===null?ll=[_]:ll.push(_)):(E.next=y.next,y.next=E),_.interleaved=E):(y=_.pending,y===null?E.next=E:(E.next=y.next,y.next=E),_.pending=E)}function hN(y,_,E){if(E&4194240){var D=_.lanes;D&=y.pendingLanes,E|=D,_.lanes=E,wE(y,E)}}var tw={readContext:Mo,useCallback:Or,useContext:Or,useEffect:Or,useImperativeHandle:Or,useInsertionEffect:Or,useLayoutEffect:Or,useMemo:Or,useReducer:Or,useRef:Or,useState:Or,useDebugValue:Or,useDeferredValue:Or,useTransition:Or,useMutableSource:Or,useSyncExternalStore:Or,useId:Or,unstable_isNewReconciler:!1},$Z={readContext:Mo,useCallback:function(y,_){return cc().memoizedState=[y,_===void 0?null:_],y},useContext:Mo,useEffect:WE,useImperativeHandle:function(y,_,E){return E=E!=null?E.concat([y]):null,$1(4194308,4,nN.bind(null,_,y),E)},useLayoutEffect:function(y,_){return $1(4194308,4,y,_)},useInsertionEffect:function(y,_){return $1(4,2,y,_)},useMemo:function(y,_){var E=cc();return _=_===void 0?null:_,y=y(),E.memoizedState=[y,_],y},useReducer:function(y,_,E){var D=cc();return _=E!==void 0?E(_):_,D.memoizedState=D.baseState=_,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:y,lastRenderedState:_},D.queue=y,y=y.dispatch=KZ.bind(null,dn,y),[D.memoizedState,y]},useRef:function(y){var _=cc();return y={current:y},_.memoizedState=y},useState:jE,useDebugValue:XE,useDeferredValue:function(y){var _=jE(y),E=_[0],D=_[1];return WE(function(){var L=Po.transition;Po.transition={};try{D(y)}finally{Po.transition=L}},[y]),E},useTransition:function(){var y=jE(!1),_=y[0];return y=JZ.bind(null,y[1]),cc().memoizedState=y,[_,y]},useMutableSource:function(){},useSyncExternalStore:function(y,_,E){var D=dn,L=cc();if(Qi){if(E===void 0)throw Error(o(407));E=E()}else{if(E=_(),Ln===null)throw Error(o(349));dp&30||JF(D,_,E)}L.memoizedState=E;var G={value:E,getSnapshot:_};return L.queue=G,WE(ZF.bind(null,D,G,y),[y]),D.flags|=2048,Tv(9,KF.bind(null,D,G,E,_),void 0,null),E},useId:function(){var y=cc(),_=Ln.identifierPrefix;if(Qi){var E=lc,D=ac;E=(D&~(1<<32-ga(D)-1)).toString(32)+E,_=":"+_+"R"+E,E=Cv++,0<E&&(_+="H"+E.toString(32)),_+=":"}else E=QZ++,_=":"+_+"r"+E.toString(32)+":";return y.memoizedState=_},unstable_isNewReconciler:!1},e$={readContext:Mo,useCallback:sN,useContext:Mo,useEffect:Pv,useImperativeHandle:rN,useInsertionEffect:tN,useLayoutEffect:iN,useMemo:oN,useReducer:K1,useRef:eN,useState:function(){return K1(sd)},useDebugValue:XE,useDeferredValue:function(y){var _=K1(sd),E=_[0],D=_[1];return Pv(function(){var L=Po.transition;Po.transition={};try{D(y)}finally{Po.transition=L}},[y]),E},useTransition:function(){var y=K1(sd)[0],_=ul().memoizedState;return[y,_]},useMutableSource:qF,useSyncExternalStore:QF,useId:aN,unstable_isNewReconciler:!1},t$={readContext:Mo,useCallback:sN,useContext:Mo,useEffect:Pv,useImperativeHandle:rN,useInsertionEffect:tN,useLayoutEffect:iN,useMemo:oN,useReducer:Z1,useRef:eN,useState:function(){return Z1(sd)},useDebugValue:XE,useDeferredValue:function(y){var _=Z1(sd),E=_[0],D=_[1];return Pv(function(){var L=Po.transition;Po.transition={};try{D(y)}finally{Po.transition=L}},[y]),E},useTransition:function(){var y=Z1(sd)[0],_=ul().memoizedState;return[y,_]},useMutableSource:qF,useSyncExternalStore:QF,useId:aN,unstable_isNewReconciler:!1};function YE(y,_){try{var E="",D=_;do E+=qZ(D),D=D.return;while(D);var L=E}catch(G){L=`
Error generating stack: `+G.message+`
`+G.stack}return{value:y,source:_,stack:L}}function qE(y,_){try{console.error(_.value)}catch(E){setTimeout(function(){throw E})}}var i$=typeof WeakMap=="function"?WeakMap:Map;function dN(y,_,E){E=oc(-1,E),E.tag=3,E.payload={element:null};var D=_.value;return E.callback=function(){vw||(vw=!0,dC=D),qE(y,_)},E}function fN(y,_,E){E=oc(-1,E),E.tag=3;var D=y.type.getDerivedStateFromError;if(typeof D=="function"){var L=_.value;E.payload=function(){return D(L)},E.callback=function(){qE(y,_)}}var G=y.stateNode;return G!==null&&typeof G.componentDidCatch=="function"&&(E.callback=function(){qE(y,_),typeof D!="function"&&(vu===null?vu=new Set([this]):vu.add(this));var re=_.stack;this.componentDidCatch(_.value,{componentStack:re!==null?re:""})}),E}function pN(y,_,E){var D=y.pingCache;if(D===null){D=y.pingCache=new i$;var L=new Set;D.set(_,L)}else L=D.get(_),L===void 0&&(L=new Set,D.set(_,L));L.has(E)||(L.add(E),y=g$.bind(null,y,_,E),_.then(y,y))}function mN(y){do{var _;if((_=y.tag===13)&&(_=y.memoizedState,_=_!==null?_.dehydrated!==null:!0),_)return y;y=y.return}while(y!==null);return null}function gN(y,_,E,D,L){return y.mode&1?(y.flags|=65536,y.lanes=L,y):(y===_?y.flags|=65536:(y.flags|=128,E.flags|=131072,E.flags&=-52805,E.tag===1&&(E.alternate===null?E.tag=17:(_=oc(-1,1),_.tag=2,gu(E,_))),E.lanes|=1),y)}function hl(y){y.flags|=4}function vN(y,_){if(y!==null&&y.child===_.child)return!0;if(_.flags&16)return!1;for(y=_.child;y!==null;){if(y.flags&12854||y.subtreeFlags&12854)return!1;y=y.sibling}return!0}var Dv,Bv,iw,nw;if(Se)Dv=function(y,_){for(var E=_.child;E!==null;){if(E.tag===5||E.tag===6)H(y,E.stateNode);else if(E.tag!==4&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===_)break;for(;E.sibling===null;){if(E.return===null||E.return===_)return;E=E.return}E.sibling.return=E.return,E=E.sibling}},Bv=function(){},iw=function(y,_,E,D,L){if(y=y.memoizedProps,y!==D){var G=_.stateNode,re=cl(To.current);E=J(G,E,y,D,L,re),(_.updateQueue=E)&&hl(_)}},nw=function(y,_,E,D){E!==D&&hl(_)};else if(ce){Dv=function(y,_,E,D){for(var L=_.child;L!==null;){if(L.tag===5){var G=L.stateNode;E&&D&&(G=Dt(G,L.type,L.memoizedProps,L)),H(y,G)}else if(L.tag===6)G=L.stateNode,E&&D&&(G=un(G,L.memoizedProps,L)),H(y,G);else if(L.tag!==4){if(L.tag===22&&L.memoizedState!==null)G=L.child,G!==null&&(G.return=L),Dv(y,L,!0,!0);else if(L.child!==null){L.child.return=L,L=L.child;continue}}if(L===_)break;for(;L.sibling===null;){if(L.return===null||L.return===_)return;L=L.return}L.sibling.return=L.return,L=L.sibling}};var yN=function(y,_,E,D){for(var L=_.child;L!==null;){if(L.tag===5){var G=L.stateNode;E&&D&&(G=Dt(G,L.type,L.memoizedProps,L)),ei(y,G)}else if(L.tag===6)G=L.stateNode,E&&D&&(G=un(G,L.memoizedProps,L)),ei(y,G);else if(L.tag!==4){if(L.tag===22&&L.memoizedState!==null)G=L.child,G!==null&&(G.return=L),yN(y,L,!0,!0);else if(L.child!==null){L.child.return=L,L=L.child;continue}}if(L===_)break;for(;L.sibling===null;){if(L.return===null||L.return===_)return;L=L.return}L.sibling.return=L.return,L=L.sibling}};Bv=function(y,_){var E=_.stateNode;if(!vN(y,_)){y=E.containerInfo;var D=pt(y);yN(D,_,!1,!1),E.pendingChildren=D,hl(_),ui(y,D)}},iw=function(y,_,E,D,L){var G=y.stateNode,re=y.memoizedProps;if((y=vN(y,_))&&re===D)_.stateNode=G;else{var _e=_.stateNode,Ue=cl(To.current),Ze=null;re!==D&&(Ze=J(_e,E,re,D,L,Ue)),y&&Ze===null?_.stateNode=G:(G=Xe(G,Ze,E,re,D,_,y,_e),Q(G,E,D,L,Ue)&&hl(_),_.stateNode=G,y?hl(_):Dv(G,_,!1,!1))}},nw=function(y,_,E,D){E!==D?(y=cl(up.current),E=cl(To.current),_.stateNode=j(D,y,E,_),hl(_)):_.stateNode=y.stateNode}}else Bv=function(){},iw=function(){},nw=function(){};function Lv(y,_){if(!Qi)switch(y.tailMode){case"hidden":_=y.tail;for(var E=null;_!==null;)_.alternate!==null&&(E=_),_=_.sibling;E===null?y.tail=null:E.sibling=null;break;case"collapsed":E=y.tail;for(var D=null;E!==null;)E.alternate!==null&&(D=E),E=E.sibling;D===null?_||y.tail===null?y.tail=null:y.tail.sibling=null:D.sibling=null}}function Fr(y){var _=y.alternate!==null&&y.alternate.child===y.child,E=0,D=0;if(_)for(var L=y.child;L!==null;)E|=L.lanes|L.childLanes,D|=L.subtreeFlags&14680064,D|=L.flags&14680064,L.return=y,L=L.sibling;else for(L=y.child;L!==null;)E|=L.lanes|L.childLanes,D|=L.subtreeFlags,D|=L.flags,L.return=y,L=L.sibling;return y.subtreeFlags|=D,y.childLanes=E,_}function n$(y,_,E){var D=_.pendingProps;switch(RE(_),_.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fr(_),null;case 1:return As(_.type)&&L1(),Fr(_),null;case 3:return D=_.stateNode,hp(),bt(hn),bt(jt),UE(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(y===null||y.child===null)&&(bv(_)?hl(_):y===null||y.memoizedState.isDehydrated&&!(_.flags&256)||(_.flags|=1024,ya!==null&&(mC(ya),ya=null))),Bv(y,_),Fr(_),null;case 5:zE(_),E=cl(up.current);var L=_.type;if(y!==null&&_.stateNode!=null)iw(y,_,L,D,E),y.ref!==_.ref&&(_.flags|=512,_.flags|=2097152);else{if(!D){if(_.stateNode===null)throw Error(o(166));return Fr(_),null}if(y=cl(To.current),bv(_)){if(!se)throw Error(o(175));y=We(_.stateNode,_.type,_.memoizedProps,E,y,_,!_v),_.updateQueue=y,y!==null&&hl(_)}else{var G=q(L,D,E,y,_);Dv(G,_,!1,!1),_.stateNode=G,Q(G,L,D,E,y)&&hl(_)}_.ref!==null&&(_.flags|=512,_.flags|=2097152)}return Fr(_),null;case 6:if(y&&_.stateNode!=null)nw(y,_,y.memoizedProps,D);else{if(typeof D!="string"&&_.stateNode===null)throw Error(o(166));if(y=cl(up.current),E=cl(To.current),bv(_)){if(!se)throw Error(o(176));if(y=_.stateNode,D=_.memoizedProps,(E=Ke(y,D,_,!_v))&&(L=Qs,L!==null))switch(G=(L.mode&1)!==0,L.tag){case 3:wn(L.stateNode.containerInfo,y,D,G);break;case 5:wr(L.type,L.memoizedProps,L.stateNode,y,D,G)}E&&hl(_)}else _.stateNode=j(D,y,E,_)}return Fr(_),null;case 13:if(bt(tn),D=_.memoizedState,Qi&&Js!==null&&_.mode&1&&!(_.flags&128)){for(y=Js;y;)y=ee(y);return lp(),_.flags|=98560,_}if(D!==null&&D.dehydrated!==null){if(D=bv(_),y===null){if(!D)throw Error(o(318));if(!se)throw Error(o(344));if(y=_.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(o(317));nt(y,_)}else lp(),!(_.flags&128)&&(_.memoizedState=null),_.flags|=4;return Fr(_),null}return ya!==null&&(mC(ya),ya=null),_.flags&128?(_.lanes=E,_):(D=D!==null,E=!1,y===null?bv(_):E=y.memoizedState!==null,D&&!E&&(_.child.flags|=8192,_.mode&1&&(y===null||tn.current&1?jn===0&&(jn=3):vC())),_.updateQueue!==null&&(_.flags|=4),Fr(_),null);case 4:return hp(),Bv(y,_),y===null&&Ee(_.stateNode.containerInfo),Fr(_),null;case 10:return CE(_.type._context),Fr(_),null;case 17:return As(_.type)&&L1(),Fr(_),null;case 19:if(bt(tn),L=_.memoizedState,L===null)return Fr(_),null;if(D=(_.flags&128)!==0,G=L.rendering,G===null)if(D)Lv(L,!1);else{if(jn!==0||y!==null&&y.flags&128)for(y=_.child;y!==null;){if(G=q1(y),G!==null){for(_.flags|=128,Lv(L,!1),y=G.updateQueue,y!==null&&(_.updateQueue=y,_.flags|=4),_.subtreeFlags=0,y=E,D=_.child;D!==null;)E=D,L=y,E.flags&=14680066,G=E.alternate,G===null?(E.childLanes=0,E.lanes=L,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=G.childLanes,E.lanes=G.lanes,E.child=G.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=G.memoizedProps,E.memoizedState=G.memoizedState,E.updateQueue=G.updateQueue,E.type=G.type,L=G.dependencies,E.dependencies=L===null?null:{lanes:L.lanes,firstContext:L.firstContext}),D=D.sibling;return Jt(tn,tn.current&1|2),_.child}y=y.sibling}L.tail!==null&&cr()>hC&&(_.flags|=128,D=!0,Lv(L,!1),_.lanes=4194304)}else{if(!D)if(y=q1(G),y!==null){if(_.flags|=128,D=!0,y=y.updateQueue,y!==null&&(_.updateQueue=y,_.flags|=4),Lv(L,!0),L.tail===null&&L.tailMode==="hidden"&&!G.alternate&&!Qi)return Fr(_),null}else 2*cr()-L.renderingStartTime>hC&&E!==1073741824&&(_.flags|=128,D=!0,Lv(L,!1),_.lanes=4194304);L.isBackwards?(G.sibling=_.child,_.child=G):(y=L.last,y!==null?y.sibling=G:_.child=G,L.last=G)}return L.tail!==null?(_=L.tail,L.rendering=_,L.tail=_.sibling,L.renderingStartTime=cr(),_.sibling=null,y=tn.current,Jt(tn,D?y&1|2:y&1),_):(Fr(_),null);case 22:case 23:return gC(),D=_.memoizedState!==null,y!==null&&y.memoizedState!==null!==D&&(_.flags|=8192),D&&_.mode&1?Zs&1073741824&&(Fr(_),Se&&_.subtreeFlags&6&&(_.flags|=8192)):Fr(_),null;case 24:return null;case 25:return null}throw Error(o(156,_.tag))}var r$=a.ReactCurrentOwner,Ks=!1;function $r(y,_,E,D){_.child=y===null?XF(_,null,E,D):cp(_,y.child,E,D)}function xN(y,_,E,D,L){E=E.render;var G=_.ref;return sp(_,L),D=HE(y,_,E,D,G,L),E=VE(),y!==null&&!Ks?(_.updateQueue=y.updateQueue,_.flags&=-2053,y.lanes&=~L,uc(y,_,L)):(Qi&&E&&LE(_),_.flags|=1,$r(y,_,D,L),_.child)}function wN(y,_,E,D,L){if(y===null){var G=E.type;return typeof G=="function"&&!yC(G)&&G.defaultProps===void 0&&E.compare===null&&E.defaultProps===void 0?(_.tag=15,_.type=G,_N(y,_,G,D,L)):(y=Sw(E.type,null,D,_,_.mode,L),y.ref=_.ref,y.return=_,_.child=y)}if(G=y.child,!(y.lanes&L)){var re=G.memoizedProps;if(E=E.compare,E=E!==null?E:k1,E(re,D)&&y.ref===_.ref)return uc(y,_,L)}return _.flags|=1,y=_u(G,D),y.ref=_.ref,y.return=_,_.child=y}function _N(y,_,E,D,L){if(y!==null&&k1(y.memoizedProps,D)&&y.ref===_.ref)if(Ks=!1,(y.lanes&L)!==0)y.flags&131072&&(Ks=!0);else return _.lanes=y.lanes,uc(y,_,L);return QE(y,_,E,D,L)}function bN(y,_,E){var D=_.pendingProps,L=D.children,G=y!==null?y.memoizedState:null;if(D.mode==="hidden")if(!(_.mode&1))_.memoizedState={baseLanes:0,cachePool:null},Jt(fp,Zs),Zs|=E;else if(E&1073741824)_.memoizedState={baseLanes:0,cachePool:null},D=G!==null?G.baseLanes:E,Jt(fp,Zs),Zs|=D;else return y=G!==null?G.baseLanes|E:E,_.lanes=_.childLanes=1073741824,_.memoizedState={baseLanes:y,cachePool:null},_.updateQueue=null,Jt(fp,Zs),Zs|=y,null;else G!==null?(D=G.baseLanes|E,_.memoizedState=null):D=E,Jt(fp,Zs),Zs|=D;return $r(y,_,L,E),_.child}function AN(y,_){var E=_.ref;(y===null&&E!==null||y!==null&&y.ref!==E)&&(_.flags|=512,_.flags|=2097152)}function QE(y,_,E,D,L){var G=As(E)?ma:jt.current;return G=So(_,G),sp(_,L),E=HE(y,_,E,D,G,L),D=VE(),y!==null&&!Ks?(_.updateQueue=y.updateQueue,_.flags&=-2053,y.lanes&=~L,uc(y,_,L)):(Qi&&D&&LE(_),_.flags|=1,$r(y,_,E,L),_.child)}function SN(y,_,E,D,L){if(As(E)){var G=!0;R1(_)}else G=!1;if(sp(_,L),_.stateNode===null)y!==null&&(y.alternate=null,_.alternate=null,_.flags|=2),zF(_,E,D),BE(_,E,D,L),D=!0;else if(y===null){var re=_.stateNode,_e=_.memoizedProps;re.props=_e;var Ue=re.context,Ze=E.contextType;typeof Ze=="object"&&Ze!==null?Ze=Mo(Ze):(Ze=As(E)?ma:jt.current,Ze=So(_,Ze));var yt=E.getDerivedStateFromProps,Xt=typeof yt=="function"||typeof re.getSnapshotBeforeUpdate=="function";Xt||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(_e!==D||Ue!==Ze)&&kF(_,re,D,Ze),mu=!1;var Bt=_.memoizedState;re.state=Bt,V1(_,D,re,L),Ue=_.memoizedState,_e!==D||Bt!==Ue||hn.current||mu?(typeof yt=="function"&&(DE(_,E,yt,D),Ue=_.memoizedState),(_e=mu||NF(_,E,_e,D,Bt,Ue,Ze))?(Xt||typeof re.UNSAFE_componentWillMount!="function"&&typeof re.componentWillMount!="function"||(typeof re.componentWillMount=="function"&&re.componentWillMount(),typeof re.UNSAFE_componentWillMount=="function"&&re.UNSAFE_componentWillMount()),typeof re.componentDidMount=="function"&&(_.flags|=4194308)):(typeof re.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=D,_.memoizedState=Ue),re.props=D,re.state=Ue,re.context=Ze,D=_e):(typeof re.componentDidMount=="function"&&(_.flags|=4194308),D=!1)}else{re=_.stateNode,RF(y,_),_e=_.memoizedProps,Ze=_.type===_.elementType?_e:va(_.type,_e),re.props=Ze,Xt=_.pendingProps,Bt=re.context,Ue=E.contextType,typeof Ue=="object"&&Ue!==null?Ue=Mo(Ue):(Ue=As(E)?ma:jt.current,Ue=So(_,Ue));var Fi=E.getDerivedStateFromProps;(yt=typeof Fi=="function"||typeof re.getSnapshotBeforeUpdate=="function")||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(_e!==Xt||Bt!==Ue)&&kF(_,re,D,Ue),mu=!1,Bt=_.memoizedState,re.state=Bt,V1(_,D,re,L);var St=_.memoizedState;_e!==Xt||Bt!==St||hn.current||mu?(typeof Fi=="function"&&(DE(_,E,Fi,D),St=_.memoizedState),(Ze=mu||NF(_,E,Ze,D,Bt,St,Ue)||!1)?(yt||typeof re.UNSAFE_componentWillUpdate!="function"&&typeof re.componentWillUpdate!="function"||(typeof re.componentWillUpdate=="function"&&re.componentWillUpdate(D,St,Ue),typeof re.UNSAFE_componentWillUpdate=="function"&&re.UNSAFE_componentWillUpdate(D,St,Ue)),typeof re.componentDidUpdate=="function"&&(_.flags|=4),typeof re.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof re.componentDidUpdate!="function"||_e===y.memoizedProps&&Bt===y.memoizedState||(_.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||_e===y.memoizedProps&&Bt===y.memoizedState||(_.flags|=1024),_.memoizedProps=D,_.memoizedState=St),re.props=D,re.state=St,re.context=Ue,D=Ze):(typeof re.componentDidUpdate!="function"||_e===y.memoizedProps&&Bt===y.memoizedState||(_.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||_e===y.memoizedProps&&Bt===y.memoizedState||(_.flags|=1024),D=!1)}return JE(y,_,E,D,G,L)}function JE(y,_,E,D,L,G){AN(y,_);var re=(_.flags&128)!==0;if(!D&&!re)return L&&TF(_,E,!1),uc(y,_,G);D=_.stateNode,r$.current=_;var _e=re&&typeof E.getDerivedStateFromError!="function"?null:D.render();return _.flags|=1,y!==null&&re?(_.child=cp(_,y.child,null,G),_.child=cp(_,null,_e,G)):$r(y,_,_e,G),_.memoizedState=D.state,L&&TF(_,E,!0),_.child}function MN(y){var _=y.stateNode;_.pendingContext?EF(y,_.pendingContext,_.pendingContext!==_.context):_.context&&EF(y,_.context,!1),NE(y,_.containerInfo)}function EN(y,_,E,D,L){return lp(),FE(L),_.flags|=256,$r(y,_,E,D),_.child}var rw={dehydrated:null,treeContext:null,retryLane:0};function sw(y){return{baseLanes:y,cachePool:null}}function CN(y,_,E){var D=_.pendingProps,L=tn.current,G=!1,re=(_.flags&128)!==0,_e;if((_e=re)||(_e=y!==null&&y.memoizedState===null?!1:(L&2)!==0),_e?(G=!0,_.flags&=-129):(y===null||y.memoizedState!==null)&&(L|=1),Jt(tn,L&1),y===null)return OE(_),y=_.memoizedState,y!==null&&(y=y.dehydrated,y!==null)?(_.mode&1?id(y)?_.lanes=8:_.lanes=1073741824:_.lanes=1,null):(L=D.children,y=D.fallback,G?(D=_.mode,G=_.child,L={mode:"hidden",children:L},!(D&1)&&G!==null?(G.childLanes=0,G.pendingProps=L):G=Mw(L,D,0,null),y=hd(y,D,E,null),G.return=_,y.return=_,G.sibling=y,_.child=G,_.child.memoizedState=sw(E),_.memoizedState=rw,y):KE(_,L));if(L=y.memoizedState,L!==null){if(_e=L.dehydrated,_e!==null){if(re)return _.flags&256?(_.flags&=-257,ow(y,_,E,Error(o(422)))):_.memoizedState!==null?(_.child=y.child,_.flags|=128,null):(G=D.fallback,L=_.mode,D=Mw({mode:"visible",children:D.children},L,0,null),G=hd(G,L,E,null),G.flags|=2,D.return=_,G.return=_,D.sibling=G,_.child=D,_.mode&1&&cp(_,y.child,null,E),_.child.memoizedState=sw(E),_.memoizedState=rw,G);if(!(_.mode&1))_=ow(y,_,E,null);else if(id(_e))_=ow(y,_,E,Error(o(419)));else if(D=(E&y.childLanes)!==0,Ks||D){if(D=Ln,D!==null){switch(E&-E){case 4:G=2;break;case 16:G=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:G=32;break;case 536870912:G=268435456;break;default:G=0}D=G&(D.suspendedLanes|E)?0:G,D!==0&&D!==L.retryLane&&(L.retryLane=D,Do(y,D,-1))}vC(),_=ow(y,_,E,Error(o(421)))}else np(_e)?(_.flags|=128,_.child=y.child,_=v$.bind(null,y),O(_e,_),_=null):(E=L.treeContext,se&&(Js=fe(_e),Qs=_,Qi=!0,ya=null,_v=!1,E!==null&&(Eo[Co++]=ac,Eo[Co++]=lc,Eo[Co++]=nd,ac=E.id,lc=E.overflow,nd=_)),_=KE(_,_.pendingProps.children),_.flags|=4096);return _}return G?(D=PN(y,_,D.children,D.fallback,E),G=_.child,L=y.child.memoizedState,G.memoizedState=L===null?sw(E):{baseLanes:L.baseLanes|E,cachePool:null},G.childLanes=y.childLanes&~E,_.memoizedState=rw,D):(E=TN(y,_,D.children,E),_.memoizedState=null,E)}return G?(D=PN(y,_,D.children,D.fallback,E),G=_.child,L=y.child.memoizedState,G.memoizedState=L===null?sw(E):{baseLanes:L.baseLanes|E,cachePool:null},G.childLanes=y.childLanes&~E,_.memoizedState=rw,D):(E=TN(y,_,D.children,E),_.memoizedState=null,E)}function KE(y,_){return _=Mw({mode:"visible",children:_},y.mode,0,null),_.return=y,y.child=_}function TN(y,_,E,D){var L=y.child;return y=L.sibling,E=_u(L,{mode:"visible",children:E}),!(_.mode&1)&&(E.lanes=D),E.return=_,E.sibling=null,y!==null&&(D=_.deletions,D===null?(_.deletions=[y],_.flags|=16):D.push(y)),_.child=E}function PN(y,_,E,D,L){var G=_.mode;y=y.child;var re=y.sibling,_e={mode:"hidden",children:E};return!(G&1)&&_.child!==y?(E=_.child,E.childLanes=0,E.pendingProps=_e,_.deletions=null):(E=_u(y,_e),E.subtreeFlags=y.subtreeFlags&14680064),re!==null?D=_u(re,D):(D=hd(D,G,L,null),D.flags|=2),D.return=_,E.return=_,E.sibling=D,_.child=E,D}function ow(y,_,E,D){return D!==null&&FE(D),cp(_,y.child,null,E),y=KE(_,_.pendingProps.children),y.flags|=2,_.memoizedState=null,y}function DN(y,_,E){y.lanes|=_;var D=y.alternate;D!==null&&(D.lanes|=_),TE(y.return,_,E)}function ZE(y,_,E,D,L){var G=y.memoizedState;G===null?y.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:D,tail:E,tailMode:L}:(G.isBackwards=_,G.rendering=null,G.renderingStartTime=0,G.last=D,G.tail=E,G.tailMode=L)}function BN(y,_,E){var D=_.pendingProps,L=D.revealOrder,G=D.tail;if($r(y,_,D.children,E),D=tn.current,D&2)D=D&1|2,_.flags|=128;else{if(y!==null&&y.flags&128)e:for(y=_.child;y!==null;){if(y.tag===13)y.memoizedState!==null&&DN(y,E,_);else if(y.tag===19)DN(y,E,_);else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===_)break e;for(;y.sibling===null;){if(y.return===null||y.return===_)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}D&=1}if(Jt(tn,D),!(_.mode&1))_.memoizedState=null;else switch(L){case"forwards":for(E=_.child,L=null;E!==null;)y=E.alternate,y!==null&&q1(y)===null&&(L=E),E=E.sibling;E=L,E===null?(L=_.child,_.child=null):(L=E.sibling,E.sibling=null),ZE(_,!1,L,E,G);break;case"backwards":for(E=null,L=_.child,_.child=null;L!==null;){if(y=L.alternate,y!==null&&q1(y)===null){_.child=L;break}y=L.sibling,L.sibling=E,E=L,L=y}ZE(_,!0,E,null,G);break;case"together":ZE(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function uc(y,_,E){if(y!==null&&(_.dependencies=y.dependencies),pp|=_.lanes,!(E&_.childLanes))return null;if(y!==null&&_.child!==y.child)throw Error(o(153));if(_.child!==null){for(y=_.child,E=_u(y,y.pendingProps),_.child=E,E.return=_;y.sibling!==null;)y=y.sibling,E=E.sibling=_u(y,y.pendingProps),E.return=_;E.sibling=null}return _.child}function s$(y,_,E){switch(_.tag){case 3:MN(_),lp();break;case 5:YF(_);break;case 1:As(_.type)&&R1(_);break;case 4:NE(_,_.stateNode.containerInfo);break;case 10:LF(_,_.type._context,_.memoizedProps.value);break;case 13:var D=_.memoizedState;if(D!==null)return D.dehydrated!==null?(Jt(tn,tn.current&1),_.flags|=128,null):E&_.child.childLanes?CN(y,_,E):(Jt(tn,tn.current&1),y=uc(y,_,E),y!==null?y.sibling:null);Jt(tn,tn.current&1);break;case 19:if(D=(E&_.childLanes)!==0,y.flags&128){if(D)return BN(y,_,E);_.flags|=128}var L=_.memoizedState;if(L!==null&&(L.rendering=null,L.tail=null,L.lastEffect=null),Jt(tn,tn.current),D)break;return null;case 22:case 23:return _.lanes=0,bN(y,_,E)}return uc(y,_,E)}function o$(y,_){switch(RE(_),_.tag){case 1:return As(_.type)&&L1(),y=_.flags,y&65536?(_.flags=y&-65537|128,_):null;case 3:return hp(),bt(hn),bt(jt),UE(),y=_.flags,y&65536&&!(y&128)?(_.flags=y&-65537|128,_):null;case 5:return zE(_),null;case 13:if(bt(tn),y=_.memoizedState,y!==null&&y.dehydrated!==null){if(_.alternate===null)throw Error(o(340));lp()}return y=_.flags,y&65536?(_.flags=y&-65537|128,_):null;case 19:return bt(tn),null;case 4:return hp(),null;case 10:return CE(_.type._context),null;case 22:case 23:return gC(),null;case 24:return null;default:return null}}var aw=!1,od=!1,a$=typeof WeakSet=="function"?WeakSet:Set,lt=null;function lw(y,_){var E=y.ref;if(E!==null)if(typeof E=="function")try{E(null)}catch(D){Es(y,_,D)}else E.current=null}function $E(y,_,E){try{E()}catch(D){Es(y,_,D)}}var LN=!1;function l$(y,_){for(X(y.containerInfo),lt=_;lt!==null;)if(y=lt,_=y.child,(y.subtreeFlags&1028)!==0&&_!==null)_.return=y,lt=_;else for(;lt!==null;){y=lt;try{var E=y.alternate;if(y.flags&1024)switch(y.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var D=E.memoizedProps,L=E.memoizedState,G=y.stateNode,re=G.getSnapshotBeforeUpdate(y.elementType===y.type?D:va(y.type,D),L);G.__reactInternalSnapshotBeforeUpdate=re}break;case 3:Se&&Fe(y.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(_e){Es(y,y.return,_e)}if(_=y.sibling,_!==null){_.return=y.return,lt=_;break}lt=y.return}return E=LN,LN=!1,E}function ad(y,_,E){var D=_.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var L=D=D.next;do{if((L.tag&y)===y){var G=L.destroy;L.destroy=void 0,G!==void 0&&$E(_,E,G)}L=L.next}while(L!==D)}}function Rv(y,_){if(_=_.updateQueue,_=_!==null?_.lastEffect:null,_!==null){var E=_=_.next;do{if((E.tag&y)===y){var D=E.create;E.destroy=D()}E=E.next}while(E!==_)}}function eC(y){var _=y.ref;if(_!==null){var E=y.stateNode;switch(y.tag){case 5:y=K(E);break;default:y=E}typeof _=="function"?_(y):_.current=y}}function RN(y,_,E){if(sl&&typeof sl.onCommitFiberUnmount=="function")try{sl.onCommitFiberUnmount(N1,_)}catch{}switch(_.tag){case 0:case 11:case 14:case 15:if(y=_.updateQueue,y!==null&&(y=y.lastEffect,y!==null)){var D=y=y.next;do{var L=D,G=L.destroy;L=L.tag,G!==void 0&&(L&2||L&4)&&$E(_,E,G),D=D.next}while(D!==y)}break;case 1:if(lw(_,E),y=_.stateNode,typeof y.componentWillUnmount=="function")try{y.props=_.memoizedProps,y.state=_.memoizedState,y.componentWillUnmount()}catch(re){Es(_,E,re)}break;case 5:lw(_,E);break;case 4:Se?kN(y,_,E):ce&&ce&&(_=_.stateNode.containerInfo,E=pt(_),ar(_,E))}}function IN(y,_,E){for(var D=_;;)if(RN(y,D,E),D.child===null||Se&&D.tag===4){if(D===_)break;for(;D.sibling===null;){if(D.return===null||D.return===_)return;D=D.return}D.sibling.return=D.return,D=D.sibling}else D.child.return=D,D=D.child}function ON(y){var _=y.alternate;_!==null&&(y.alternate=null,ON(_)),y.child=null,y.deletions=null,y.sibling=null,y.tag===5&&(_=y.stateNode,_!==null&&ze(_)),y.stateNode=null,y.return=null,y.dependencies=null,y.memoizedProps=null,y.memoizedState=null,y.pendingProps=null,y.stateNode=null,y.updateQueue=null}function FN(y){return y.tag===5||y.tag===3||y.tag===4}function NN(y){e:for(;;){for(;y.sibling===null;){if(y.return===null||FN(y.return))return null;y=y.return}for(y.sibling.return=y.return,y=y.sibling;y.tag!==5&&y.tag!==6&&y.tag!==18;){if(y.flags&2||y.child===null||y.tag===4)continue e;y.child.return=y,y=y.child}if(!(y.flags&2))return y.stateNode}}function zN(y){if(Se){e:{for(var _=y.return;_!==null;){if(FN(_))break e;_=_.return}throw Error(o(160))}var E=_;switch(E.tag){case 5:_=E.stateNode,E.flags&32&&(xt(_),E.flags&=-33),E=NN(y),iC(y,E,_);break;case 3:case 4:_=E.stateNode.containerInfo,E=NN(y),tC(y,E,_);break;default:throw Error(o(161))}}}function tC(y,_,E){var D=y.tag;if(D===5||D===6)y=y.stateNode,_?Re(E,y,_):De(E,y);else if(D!==4&&(y=y.child,y!==null))for(tC(y,_,E),y=y.sibling;y!==null;)tC(y,_,E),y=y.sibling}function iC(y,_,E){var D=y.tag;if(D===5||D===6)y=y.stateNode,_?we(E,y,_):qe(E,y);else if(D!==4&&(y=y.child,y!==null))for(iC(y,_,E),y=y.sibling;y!==null;)iC(y,_,E),y=y.sibling}function kN(y,_,E){for(var D=_,L=!1,G,re;;){if(!L){L=D.return;e:for(;;){if(L===null)throw Error(o(160));switch(G=L.stateNode,L.tag){case 5:re=!1;break e;case 3:G=G.containerInfo,re=!0;break e;case 4:G=G.containerInfo,re=!0;break e}L=L.return}L=!0}if(D.tag===5||D.tag===6)IN(y,D,E),re?$e(G,D.stateNode):Ne(G,D.stateNode);else if(D.tag===18)re?ni(G,D.stateNode):ht(G,D.stateNode);else if(D.tag===4){if(D.child!==null){G=D.stateNode.containerInfo,re=!0,D.child.return=D,D=D.child;continue}}else if(RN(y,D,E),D.child!==null){D.child.return=D,D=D.child;continue}if(D===_)break;for(;D.sibling===null;){if(D.return===null||D.return===_)return;D=D.return,D.tag===4&&(L=!1)}D.sibling.return=D.return,D=D.sibling}}function nC(y,_){if(Se){switch(_.tag){case 0:case 11:case 14:case 15:ad(3,_,_.return),Rv(3,_),ad(5,_,_.return);return;case 1:return;case 5:var E=_.stateNode;if(E!=null){var D=_.memoizedProps;y=y!==null?y.memoizedProps:D;var L=_.type,G=_.updateQueue;_.updateQueue=null,G!==null&&ne(E,G,L,y,D,_)}return;case 6:if(_.stateNode===null)throw Error(o(162));E=_.memoizedProps,ue(_.stateNode,y!==null?y.memoizedProps:E,E);return;case 3:se&&y!==null&&y.memoizedState.isDehydrated&&_t(_.stateNode.containerInfo);return;case 12:return;case 13:cw(_);return;case 19:cw(_);return;case 17:return}throw Error(o(163))}switch(_.tag){case 0:case 11:case 14:case 15:ad(3,_,_.return),Rv(3,_),ad(5,_,_.return);return;case 12:return;case 13:cw(_);return;case 19:cw(_);return;case 3:se&&y!==null&&y.memoizedState.isDehydrated&&_t(_.stateNode.containerInfo);break;case 22:case 23:return}e:if(ce){switch(_.tag){case 1:case 5:case 6:break e;case 3:case 4:_=_.stateNode,ar(_.containerInfo,_.pendingChildren);break e}throw Error(o(163))}}function cw(y){var _=y.updateQueue;if(_!==null){y.updateQueue=null;var E=y.stateNode;E===null&&(E=y.stateNode=new a$),_.forEach(function(D){var L=y$.bind(null,y,D);E.has(D)||(E.add(D),D.then(L,L))})}}function c$(y,_){for(lt=_;lt!==null;){_=lt;var E=_.deletions;if(E!==null)for(var D=0;D<E.length;D++){var L=E[D];try{var G=y;Se?kN(G,L,_):IN(G,L,_);var re=L.alternate;re!==null&&(re.return=null),L.return=null}catch(At){Es(L,_,At)}}if(E=_.child,_.subtreeFlags&12854&&E!==null)E.return=_,lt=E;else for(;lt!==null;){_=lt;try{var _e=_.flags;if(_e&32&&Se&&xt(_.stateNode),_e&512){var Ue=_.alternate;if(Ue!==null){var Ze=Ue.ref;Ze!==null&&(typeof Ze=="function"?Ze(null):Ze.current=null)}}if(_e&8192)switch(_.tag){case 13:if(_.memoizedState!==null){var yt=_.alternate;(yt===null||yt.memoizedState===null)&&(uC=cr())}break;case 22:var Xt=_.memoizedState!==null,Bt=_.alternate,Fi=Bt!==null&&Bt.memoizedState!==null;if(E=_,Se){e:if(D=E,L=Xt,G=null,Se)for(var St=D;;){if(St.tag===5){if(G===null){G=St;var Nr=St.stateNode;L?kt(Nr):oe(St.stateNode,St.memoizedProps)}}else if(St.tag===6){if(G===null){var Lo=St.stateNode;L?Y(Lo):ye(Lo,St.memoizedProps)}}else if((St.tag!==22&&St.tag!==23||St.memoizedState===null||St===D)&&St.child!==null){St.child.return=St,St=St.child;continue}if(St===D)break;for(;St.sibling===null;){if(St.return===null||St.return===D)break e;G===St&&(G=null),St=St.return}G===St&&(G=null),St.sibling.return=St.return,St=St.sibling}}if(Xt&&!Fi&&E.mode&1){lt=E;for(var Pe=E.child;Pe!==null;){for(E=lt=Pe;lt!==null;){D=lt;var Ae=D.child;switch(D.tag){case 0:case 11:case 14:case 15:ad(4,D,D.return);break;case 1:lw(D,D.return);var ke=D.stateNode;if(typeof ke.componentWillUnmount=="function"){var ut=D.return;try{ke.props=D.memoizedProps,ke.state=D.memoizedState,ke.componentWillUnmount()}catch(At){Es(D,ut,At)}}break;case 5:lw(D,D.return);break;case 22:if(D.memoizedState!==null){HN(E);continue}}Ae!==null?(Ae.return=D,lt=Ae):HN(E)}Pe=Pe.sibling}}}switch(_e&4102){case 2:zN(_),_.flags&=-3;break;case 6:zN(_),_.flags&=-3,nC(_.alternate,_);break;case 4096:_.flags&=-4097;break;case 4100:_.flags&=-4097,nC(_.alternate,_);break;case 4:nC(_.alternate,_)}}catch(At){Es(_,_.return,At)}if(E=_.sibling,E!==null){E.return=_.return,lt=E;break}lt=_.return}}}function u$(y,_,E){lt=y,UN(y)}function UN(y,_,E){for(var D=(y.mode&1)!==0;lt!==null;){var L=lt,G=L.child;if(L.tag===22&&D){var re=L.memoizedState!==null||aw;if(!re){var _e=L.alternate,Ue=_e!==null&&_e.memoizedState!==null||od;_e=aw;var Ze=od;if(aw=re,(od=Ue)&&!Ze)for(lt=L;lt!==null;)re=lt,Ue=re.child,re.tag===22&&re.memoizedState!==null?VN(L):Ue!==null?(Ue.return=re,lt=Ue):VN(L);for(;G!==null;)lt=G,UN(G),G=G.sibling;lt=L,aw=_e,od=Ze}GN(y)}else L.subtreeFlags&8772&&G!==null?(G.return=L,lt=G):GN(y)}}function GN(y){for(;lt!==null;){var _=lt;if(_.flags&8772){var E=_.alternate;try{if(_.flags&8772)switch(_.tag){case 0:case 11:case 15:od||Rv(5,_);break;case 1:var D=_.stateNode;if(_.flags&4&&!od)if(E===null)D.componentDidMount();else{var L=_.elementType===_.type?E.memoizedProps:va(_.type,E.memoizedProps);D.componentDidUpdate(L,E.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var G=_.updateQueue;G!==null&&OF(_,G,D);break;case 3:var re=_.updateQueue;if(re!==null){if(E=null,_.child!==null)switch(_.child.tag){case 5:E=K(_.child.stateNode);break;case 1:E=_.child.stateNode}OF(_,re,E)}break;case 5:var _e=_.stateNode;E===null&&_.flags&4&&He(_e,_.type,_.memoizedProps,_);break;case 6:break;case 4:break;case 12:break;case 13:if(se&&_.memoizedState===null){var Ue=_.alternate;if(Ue!==null){var Ze=Ue.memoizedState;if(Ze!==null){var yt=Ze.dehydrated;yt!==null&&mt(yt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}od||_.flags&512&&eC(_)}catch(Xt){Es(_,_.return,Xt)}}if(_===y){lt=null;break}if(E=_.sibling,E!==null){E.return=_.return,lt=E;break}lt=_.return}}function HN(y){for(;lt!==null;){var _=lt;if(_===y){lt=null;break}var E=_.sibling;if(E!==null){E.return=_.return,lt=E;break}lt=_.return}}function VN(y){for(;lt!==null;){var _=lt;try{switch(_.tag){case 0:case 11:case 15:var E=_.return;try{Rv(4,_)}catch(Ue){Es(_,E,Ue)}break;case 1:var D=_.stateNode;if(typeof D.componentDidMount=="function"){var L=_.return;try{D.componentDidMount()}catch(Ue){Es(_,L,Ue)}}var G=_.return;try{eC(_)}catch(Ue){Es(_,G,Ue)}break;case 5:var re=_.return;try{eC(_)}catch(Ue){Es(_,re,Ue)}}}catch(Ue){Es(_,_.return,Ue)}if(_===y){lt=null;break}var _e=_.sibling;if(_e!==null){_e.return=_.return,lt=_e;break}lt=_.return}}var uw=0,hw=1,dw=2,fw=3,pw=4;if(typeof Symbol=="function"&&Symbol.for){var Iv=Symbol.for;uw=Iv("selector.component"),hw=Iv("selector.has_pseudo_class"),dw=Iv("selector.role"),fw=Iv("selector.test_id"),pw=Iv("selector.text")}function rC(y){var _=be(y);if(_!=null){if(typeof _.memoizedProps["data-testname"]!="string")throw Error(o(364));return _}if(y=ot(y),y===null)throw Error(o(362));return y.stateNode.current}function sC(y,_){switch(_.$$typeof){case uw:if(y.type===_.value)return!0;break;case hw:e:{_=_.value,y=[y,0];for(var E=0;E<y.length;){var D=y[E++],L=y[E++],G=_[L];if(D.tag!==5||!ie(D)){for(;G!=null&&sC(D,G);)L++,G=_[L];if(L===_.length){_=!0;break e}else for(D=D.child;D!==null;)y.push(D,L),D=D.sibling}}_=!1}return _;case dw:if(y.tag===5&&xe(y.stateNode,_.value))return!0;break;case pw:if((y.tag===5||y.tag===6)&&(y=R(y),y!==null&&0<=y.indexOf(_.value)))return!0;break;case fw:if(y.tag===5&&(y=y.memoizedProps["data-testname"],typeof y=="string"&&y.toLowerCase()===_.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function oC(y){switch(y.$$typeof){case uw:return"<"+(T(y.value)||"Unknown")+">";case hw:return":has("+(oC(y)||"")+")";case dw:return'[role="'+y.value+'"]';case pw:return'"'+y.value+'"';case fw:return'[data-testname="'+y.value+'"]';default:throw Error(o(365))}}function jN(y,_){var E=[];y=[y,0];for(var D=0;D<y.length;){var L=y[D++],G=y[D++],re=_[G];if(L.tag!==5||!ie(L)){for(;re!=null&&sC(L,re);)G++,re=_[G];if(G===_.length)E.push(L);else for(L=L.child;L!==null;)y.push(L,G),L=L.sibling}}return E}function aC(y,_){if(!tt)throw Error(o(363));y=rC(y),y=jN(y,_),_=[],y=Array.from(y);for(var E=0;E<y.length;){var D=y[E++];if(D.tag===5)ie(D)||_.push(D.stateNode);else for(D=D.child;D!==null;)y.push(D),D=D.sibling}return _}var h$=Math.ceil,mw=a.ReactCurrentDispatcher,lC=a.ReactCurrentOwner,_n=a.ReactCurrentBatchConfig,ri=0,Ln=null,Rn=null,br=0,Zs=0,fp=Lr(0),jn=0,Ov=null,pp=0,gw=0,cC=0,Fv=null,Ss=null,uC=0,hC=1/0;function mp(){hC=cr()+500}var vw=!1,dC=null,vu=null,yw=!1,yu=null,xw=0,Nv=0,fC=null,ww=-1,_w=0;function es(){return ri&6?cr():ww!==-1?ww:ww=cr()}function xu(y){return y.mode&1?ri&2&&br!==0?br&-br:YZ.transition!==null?(_w===0&&(y=I1,I1<<=1,!(I1&4194240)&&(I1=64),_w=y),_w):(y=gi,y!==0?y:Le()):1}function Do(y,_,E){if(50<Nv)throw Nv=0,fC=null,Error(o(185));var D=bw(y,_);return D===null?null:(wv(D,_,E),(!(ri&2)||D!==Ln)&&(D===Ln&&(!(ri&2)&&(gw|=_),jn===4&&wu(D,br)),Ms(D,E),_===1&&ri===0&&!(y.mode&1)&&(mp(),z1&&al())),D)}function bw(y,_){y.lanes|=_;var E=y.alternate;for(E!==null&&(E.lanes|=_),E=y,y=y.return;y!==null;)y.childLanes|=_,E=y.alternate,E!==null&&(E.childLanes|=_),E=y,y=y.return;return E.tag===3?E.stateNode:null}function Ms(y,_){var E=y.callbackNode;zZ(y,_);var D=F1(y,y===Ln?br:0);if(D===0)E!==null&&DF(E),y.callbackNode=null,y.callbackPriority=0;else if(_=D&-D,y.callbackPriority!==_){if(E!=null&&DF(E),_===1)y.tag===0?XZ(XN.bind(null,y)):BF(XN.bind(null,y)),Oe?Ge(function(){ri===0&&al()}):_E(bE,al),E=null;else{switch(PF(D)){case 1:E=bE;break;case 4:E=HZ;break;case 16:E=AE;break;case 536870912:E=VZ;break;default:E=AE}E=tz(E,WN.bind(null,y))}y.callbackPriority=_,y.callbackNode=E}}function WN(y,_){if(ww=-1,_w=0,ri&6)throw Error(o(327));var E=y.callbackNode;if(ud()&&y.callbackNode!==E)return null;var D=F1(y,y===Ln?br:0);if(D===0)return null;if(D&30||D&y.expiredLanes||_)_=Aw(y,D);else{_=D;var L=ri;ri|=2;var G=QN();(Ln!==y||br!==_)&&(mp(),ld(y,_));do try{p$();break}catch(_e){qN(y,_e)}while(1);EE(),mw.current=G,ri=L,Rn!==null?_=0:(Ln=null,br=0,_=jn)}if(_!==0){if(_===2&&(L=yE(y),L!==0&&(D=L,_=pC(y,L))),_===1)throw E=Ov,ld(y,0),wu(y,D),Ms(y,cr()),E;if(_===6)wu(y,D);else{if(L=y.current.alternate,!(D&30)&&!d$(L)&&(_=Aw(y,D),_===2&&(G=yE(y),G!==0&&(D=G,_=pC(y,G))),_===1))throw E=Ov,ld(y,0),wu(y,D),Ms(y,cr()),E;switch(y.finishedWork=L,y.finishedLanes=D,_){case 0:case 1:throw Error(o(345));case 2:cd(y,Ss);break;case 3:if(wu(y,D),(D&130023424)===D&&(_=uC+500-cr(),10<_)){if(F1(y,0)!==0)break;if(L=y.suspendedLanes,(L&D)!==D){es(),y.pingedLanes|=y.suspendedLanes&L;break}y.timeoutHandle=ve(cd.bind(null,y,Ss),_);break}cd(y,Ss);break;case 4:if(wu(y,D),(D&4194240)===D)break;for(_=y.eventTimes,L=-1;0<D;){var re=31-ga(D);G=1<<re,re=_[re],re>L&&(L=re),D&=~G}if(D=L,D=cr()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*h$(D/1960))-D,10<D){y.timeoutHandle=ve(cd.bind(null,y,Ss),D);break}cd(y,Ss);break;case 5:cd(y,Ss);break;default:throw Error(o(329))}}}return Ms(y,cr()),y.callbackNode===E?WN.bind(null,y):null}function pC(y,_){var E=Fv;return y.current.memoizedState.isDehydrated&&(ld(y,_).flags|=256),y=Aw(y,_),y!==2&&(_=Ss,Ss=E,_!==null&&mC(_)),y}function mC(y){Ss===null?Ss=y:Ss.push.apply(Ss,y)}function d$(y){for(var _=y;;){if(_.flags&16384){var E=_.updateQueue;if(E!==null&&(E=E.stores,E!==null))for(var D=0;D<E.length;D++){var L=E[D],G=L.getSnapshot;L=L.value;try{if(!ol(G(),L))return!1}catch{return!1}}}if(E=_.child,_.subtreeFlags&16384&&E!==null)E.return=_,_=E;else{if(_===y)break;for(;_.sibling===null;){if(_.return===null||_.return===y)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function wu(y,_){for(_&=~cC,_&=~gw,y.suspendedLanes|=_,y.pingedLanes&=~_,y=y.expirationTimes;0<_;){var E=31-ga(_),D=1<<E;y[E]=-1,_&=~D}}function XN(y){if(ri&6)throw Error(o(327));ud();var _=F1(y,0);if(!(_&1))return Ms(y,cr()),null;var E=Aw(y,_);if(y.tag!==0&&E===2){var D=yE(y);D!==0&&(_=D,E=pC(y,D))}if(E===1)throw E=Ov,ld(y,0),wu(y,_),Ms(y,cr()),E;if(E===6)throw Error(o(345));return y.finishedWork=y.current.alternate,y.finishedLanes=_,cd(y,Ss),Ms(y,cr()),null}function YN(y){yu!==null&&yu.tag===0&&!(ri&6)&&ud();var _=ri;ri|=1;var E=_n.transition,D=gi;try{if(_n.transition=null,gi=1,y)return y()}finally{gi=D,_n.transition=E,ri=_,!(ri&6)&&al()}}function gC(){Zs=fp.current,bt(fp)}function ld(y,_){y.finishedWork=null,y.finishedLanes=0;var E=y.timeoutHandle;if(E!==me&&(y.timeoutHandle=me,pe(E)),Rn!==null)for(E=Rn.return;E!==null;){var D=E;switch(RE(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&L1();break;case 3:hp(),bt(hn),bt(jt),UE();break;case 5:zE(D);break;case 4:hp();break;case 13:bt(tn);break;case 19:bt(tn);break;case 10:CE(D.type._context);break;case 22:case 23:gC()}E=E.return}if(Ln=y,Rn=y=_u(y.current,null),br=Zs=_,jn=0,Ov=null,cC=gw=pp=0,Ss=Fv=null,ll!==null){for(_=0;_<ll.length;_++)if(E=ll[_],D=E.interleaved,D!==null){E.interleaved=null;var L=D.next,G=E.pending;if(G!==null){var re=G.next;G.next=L,D.next=re}E.pending=D}ll=null}return y}function qN(y,_){do{var E=Rn;try{if(EE(),Q1.current=tw,J1){for(var D=dn.memoizedState;D!==null;){var L=D.queue;L!==null&&(L.pending=null),D=D.next}J1=!1}if(dp=0,ur=Ir=dn=null,Ev=!1,Cv=0,lC.current=null,E===null||E.return===null){jn=1,Ov=_,Rn=null;break}e:{var G=y,re=E.return,_e=E,Ue=_;if(_=br,_e.flags|=32768,Ue!==null&&typeof Ue=="object"&&typeof Ue.then=="function"){var Ze=Ue,yt=_e,Xt=yt.tag;if(!(yt.mode&1)&&(Xt===0||Xt===11||Xt===15)){var Bt=yt.alternate;Bt?(yt.updateQueue=Bt.updateQueue,yt.memoizedState=Bt.memoizedState,yt.lanes=Bt.lanes):(yt.updateQueue=null,yt.memoizedState=null)}var Fi=mN(re);if(Fi!==null){Fi.flags&=-257,gN(Fi,re,_e,G,_),Fi.mode&1&&pN(G,Ze,_),_=Fi,Ue=Ze;var St=_.updateQueue;if(St===null){var Nr=new Set;Nr.add(Ue),_.updateQueue=Nr}else St.add(Ue);break e}else{if(!(_&1)){pN(G,Ze,_),vC();break e}Ue=Error(o(426))}}else if(Qi&&_e.mode&1){var Lo=mN(re);if(Lo!==null){!(Lo.flags&65536)&&(Lo.flags|=256),gN(Lo,re,_e,G,_),FE(Ue);break e}}G=Ue,jn!==4&&(jn=2),Fv===null?Fv=[G]:Fv.push(G),Ue=YE(Ue,_e),_e=re;do{switch(_e.tag){case 3:_e.flags|=65536,_&=-_,_e.lanes|=_;var Pe=dN(_e,Ue,_);IF(_e,Pe);break e;case 1:G=Ue;var Ae=_e.type,ke=_e.stateNode;if(!(_e.flags&128)&&(typeof Ae.getDerivedStateFromError=="function"||ke!==null&&typeof ke.componentDidCatch=="function"&&(vu===null||!vu.has(ke)))){_e.flags|=65536,_&=-_,_e.lanes|=_;var ut=fN(_e,G,_);IF(_e,ut);break e}}_e=_e.return}while(_e!==null)}KN(E)}catch(At){_=At,Rn===E&&E!==null&&(Rn=E=E.return);continue}break}while(1)}function QN(){var y=mw.current;return mw.current=tw,y===null?tw:y}function vC(){(jn===0||jn===3||jn===2)&&(jn=4),Ln===null||!(pp&268435455)&&!(gw&268435455)||wu(Ln,br)}function Aw(y,_){var E=ri;ri|=2;var D=QN();Ln===y&&br===_||ld(y,_);do try{f$();break}catch(L){qN(y,L)}while(1);if(EE(),ri=E,mw.current=D,Rn!==null)throw Error(o(261));return Ln=null,br=0,jn}function f$(){for(;Rn!==null;)JN(Rn)}function p$(){for(;Rn!==null&&!UZ();)JN(Rn)}function JN(y){var _=ez(y.alternate,y,Zs);y.memoizedProps=y.pendingProps,_===null?KN(y):Rn=_,lC.current=null}function KN(y){var _=y;do{var E=_.alternate;if(y=_.return,_.flags&32768){if(E=o$(E,_),E!==null){E.flags&=32767,Rn=E;return}if(y!==null)y.flags|=32768,y.subtreeFlags=0,y.deletions=null;else{jn=6,Rn=null;return}}else if(E=n$(E,_,Zs),E!==null){Rn=E;return}if(_=_.sibling,_!==null){Rn=_;return}Rn=_=y}while(_!==null);jn===0&&(jn=5)}function cd(y,_){var E=gi,D=_n.transition;try{_n.transition=null,gi=1,m$(y,_,E)}finally{_n.transition=D,gi=E}return null}function m$(y,_,E){do ud();while(yu!==null);if(ri&6)throw Error(o(327));var D=y.finishedWork,L=y.finishedLanes;if(D===null)return null;if(y.finishedWork=null,y.finishedLanes=0,D===y.current)throw Error(o(177));y.callbackNode=null,y.callbackPriority=0;var G=D.lanes|D.childLanes;if(kZ(y,G),y===Ln&&(Rn=Ln=null,br=0),!(D.subtreeFlags&2064)&&!(D.flags&2064)||yw||(yw=!0,tz(AE,function(){return ud(),null})),G=(D.flags&15990)!==0,D.subtreeFlags&15990||G){G=_n.transition,_n.transition=null;var re=gi;gi=1;var _e=ri;ri|=4,lC.current=null,l$(y,D),c$(y,D),V(y.containerInfo),y.current=D,u$(D),GZ(),ri=_e,gi=re,_n.transition=G}else y.current=D;if(yw&&(yw=!1,yu=y,xw=L),G=y.pendingLanes,G===0&&(vu=null),jZ(D.stateNode),Ms(y,cr()),_!==null)for(E=y.onRecoverableError,D=0;D<_.length;D++)E(_[D]);if(vw)throw vw=!1,y=dC,dC=null,y;return xw&1&&y.tag!==0&&ud(),G=y.pendingLanes,G&1?y===fC?Nv++:(Nv=0,fC=y):Nv=0,al(),null}function ud(){if(yu!==null){var y=PF(xw),_=_n.transition,E=gi;try{if(_n.transition=null,gi=16>y?16:y,yu===null)var D=!1;else{if(y=yu,yu=null,xw=0,ri&6)throw Error(o(331));var L=ri;for(ri|=4,lt=y.current;lt!==null;){var G=lt,re=G.child;if(lt.flags&16){var _e=G.deletions;if(_e!==null){for(var Ue=0;Ue<_e.length;Ue++){var Ze=_e[Ue];for(lt=Ze;lt!==null;){var yt=lt;switch(yt.tag){case 0:case 11:case 15:ad(8,yt,G)}var Xt=yt.child;if(Xt!==null)Xt.return=yt,lt=Xt;else for(;lt!==null;){yt=lt;var Bt=yt.sibling,Fi=yt.return;if(ON(yt),yt===Ze){lt=null;break}if(Bt!==null){Bt.return=Fi,lt=Bt;break}lt=Fi}}}var St=G.alternate;if(St!==null){var Nr=St.child;if(Nr!==null){St.child=null;do{var Lo=Nr.sibling;Nr.sibling=null,Nr=Lo}while(Nr!==null)}}lt=G}}if(G.subtreeFlags&2064&&re!==null)re.return=G,lt=re;else e:for(;lt!==null;){if(G=lt,G.flags&2048)switch(G.tag){case 0:case 11:case 15:ad(9,G,G.return)}var Pe=G.sibling;if(Pe!==null){Pe.return=G.return,lt=Pe;break e}lt=G.return}}var Ae=y.current;for(lt=Ae;lt!==null;){re=lt;var ke=re.child;if(re.subtreeFlags&2064&&ke!==null)ke.return=re,lt=ke;else e:for(re=Ae;lt!==null;){if(_e=lt,_e.flags&2048)try{switch(_e.tag){case 0:case 11:case 15:Rv(9,_e)}}catch(At){Es(_e,_e.return,At)}if(_e===re){lt=null;break e}var ut=_e.sibling;if(ut!==null){ut.return=_e.return,lt=ut;break e}lt=_e.return}}if(ri=L,al(),sl&&typeof sl.onPostCommitFiberRoot=="function")try{sl.onPostCommitFiberRoot(N1,y)}catch{}D=!0}return D}finally{gi=E,_n.transition=_}}return!1}function ZN(y,_,E){_=YE(E,_),_=dN(y,_,1),gu(y,_),_=es(),y=bw(y,1),y!==null&&(wv(y,1,_),Ms(y,_))}function Es(y,_,E){if(y.tag===3)ZN(y,y,E);else for(;_!==null;){if(_.tag===3){ZN(_,y,E);break}else if(_.tag===1){var D=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(vu===null||!vu.has(D))){y=YE(E,y),y=fN(_,y,1),gu(_,y),y=es(),_=bw(_,1),_!==null&&(wv(_,1,y),Ms(_,y));break}}_=_.return}}function g$(y,_,E){var D=y.pingCache;D!==null&&D.delete(_),_=es(),y.pingedLanes|=y.suspendedLanes&E,Ln===y&&(br&E)===E&&(jn===4||jn===3&&(br&130023424)===br&&500>cr()-uC?ld(y,0):cC|=E),Ms(y,_)}function $N(y,_){_===0&&(y.mode&1?(_=O1,O1<<=1,!(O1&130023424)&&(O1=4194304)):_=1);var E=es();y=bw(y,_),y!==null&&(wv(y,_,E),Ms(y,E))}function v$(y){var _=y.memoizedState,E=0;_!==null&&(E=_.retryLane),$N(y,E)}function y$(y,_){var E=0;switch(y.tag){case 13:var D=y.stateNode,L=y.memoizedState;L!==null&&(E=L.retryLane);break;case 19:D=y.stateNode;break;default:throw Error(o(314))}D!==null&&D.delete(_),$N(y,E)}var ez;ez=function(y,_,E){if(y!==null)if(y.memoizedProps!==_.pendingProps||hn.current)Ks=!0;else{if(!(y.lanes&E)&&!(_.flags&128))return Ks=!1,s$(y,_,E);Ks=!!(y.flags&131072)}else Ks=!1,Qi&&_.flags&1048576&&UF(_,X1,_.index);switch(_.lanes=0,_.tag){case 2:var D=_.type;y!==null&&(y.alternate=null,_.alternate=null,_.flags|=2),y=_.pendingProps;var L=So(_,jt.current);sp(_,E),L=HE(null,_,D,y,L,E);var G=VE();return _.flags|=1,typeof L=="object"&&L!==null&&typeof L.render=="function"&&L.$$typeof===void 0?(_.tag=1,_.memoizedState=null,_.updateQueue=null,As(D)?(G=!0,R1(_)):G=!1,_.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,PE(_),L.updater=j1,_.stateNode=L,L._reactInternals=_,BE(_,D,y,E),_=JE(null,_,D,!0,G,E)):(_.tag=0,Qi&&G&&LE(_),$r(null,_,L,E),_=_.child),_;case 16:D=_.elementType;e:{switch(y!==null&&(y.alternate=null,_.alternate=null,_.flags|=2),y=_.pendingProps,L=D._init,D=L(D._payload),_.type=D,L=_.tag=w$(D),y=va(D,y),L){case 0:_=QE(null,_,D,y,E);break e;case 1:_=SN(null,_,D,y,E);break e;case 11:_=xN(null,_,D,y,E);break e;case 14:_=wN(null,_,D,va(D.type,y),E);break e}throw Error(o(306,D,""))}return _;case 0:return D=_.type,L=_.pendingProps,L=_.elementType===D?L:va(D,L),QE(y,_,D,L,E);case 1:return D=_.type,L=_.pendingProps,L=_.elementType===D?L:va(D,L),SN(y,_,D,L,E);case 3:e:{if(MN(_),y===null)throw Error(o(387));D=_.pendingProps,G=_.memoizedState,L=G.element,RF(y,_),V1(_,D,null,E);var re=_.memoizedState;if(D=re.element,se&&G.isDehydrated)if(G={element:D,isDehydrated:!1,cache:re.cache,transitions:re.transitions},_.updateQueue.baseState=G,_.memoizedState=G,_.flags&256){L=Error(o(423)),_=EN(y,_,D,E,L);break e}else if(D!==L){L=Error(o(424)),_=EN(y,_,D,E,L);break e}else for(se&&(Js=$(_.stateNode.containerInfo),Qs=_,Qi=!0,ya=null,_v=!1),E=XF(_,null,D,E),_.child=E;E;)E.flags=E.flags&-3|4096,E=E.sibling;else{if(lp(),D===L){_=uc(y,_,E);break e}$r(y,_,D,E)}_=_.child}return _;case 5:return YF(_),y===null&&OE(_),D=_.type,L=_.pendingProps,G=y!==null?y.memoizedProps:null,re=L.children,le(D,L)?re=null:G!==null&&le(D,G)&&(_.flags|=32),AN(y,_),$r(y,_,re,E),_.child;case 6:return y===null&&OE(_),null;case 13:return CN(y,_,E);case 4:return NE(_,_.stateNode.containerInfo),D=_.pendingProps,y===null?_.child=cp(_,null,D,E):$r(y,_,D,E),_.child;case 11:return D=_.type,L=_.pendingProps,L=_.elementType===D?L:va(D,L),xN(y,_,D,L,E);case 7:return $r(y,_,_.pendingProps,E),_.child;case 8:return $r(y,_,_.pendingProps.children,E),_.child;case 12:return $r(y,_,_.pendingProps.children,E),_.child;case 10:e:{if(D=_.type._context,L=_.pendingProps,G=_.memoizedProps,re=L.value,LF(_,D,re),G!==null)if(ol(G.value,re)){if(G.children===L.children&&!hn.current){_=uc(y,_,E);break e}}else for(G=_.child,G!==null&&(G.return=_);G!==null;){var _e=G.dependencies;if(_e!==null){re=G.child;for(var Ue=_e.firstContext;Ue!==null;){if(Ue.context===D){if(G.tag===1){Ue=oc(-1,E&-E),Ue.tag=2;var Ze=G.updateQueue;if(Ze!==null){Ze=Ze.shared;var yt=Ze.pending;yt===null?Ue.next=Ue:(Ue.next=yt.next,yt.next=Ue),Ze.pending=Ue}}G.lanes|=E,Ue=G.alternate,Ue!==null&&(Ue.lanes|=E),TE(G.return,E,_),_e.lanes|=E;break}Ue=Ue.next}}else if(G.tag===10)re=G.type===_.type?null:G.child;else if(G.tag===18){if(re=G.return,re===null)throw Error(o(341));re.lanes|=E,_e=re.alternate,_e!==null&&(_e.lanes|=E),TE(re,E,_),re=G.sibling}else re=G.child;if(re!==null)re.return=G;else for(re=G;re!==null;){if(re===_){re=null;break}if(G=re.sibling,G!==null){G.return=re.return,re=G;break}re=re.return}G=re}$r(y,_,L.children,E),_=_.child}return _;case 9:return L=_.type,D=_.pendingProps.children,sp(_,E),L=Mo(L),D=D(L),_.flags|=1,$r(y,_,D,E),_.child;case 14:return D=_.type,L=va(D,_.pendingProps),L=va(D.type,L),wN(y,_,D,L,E);case 15:return _N(y,_,_.type,_.pendingProps,E);case 17:return D=_.type,L=_.pendingProps,L=_.elementType===D?L:va(D,L),y!==null&&(y.alternate=null,_.alternate=null,_.flags|=2),_.tag=1,As(D)?(y=!0,R1(_)):y=!1,sp(_,E),zF(_,D,L),BE(_,D,L,E),JE(null,_,D,!0,y,E);case 19:return BN(y,_,E);case 22:return bN(y,_,E)}throw Error(o(156,_.tag))};function tz(y,_){return _E(y,_)}function x$(y,_,E,D){this.tag=y,this.key=E,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bo(y,_,E,D){return new x$(y,_,E,D)}function yC(y){return y=y.prototype,!(!y||!y.isReactComponent)}function w$(y){if(typeof y=="function")return yC(y)?1:0;if(y!=null){if(y=y.$$typeof,y===g)return 11;if(y===x)return 14}return 2}function _u(y,_){var E=y.alternate;return E===null?(E=Bo(y.tag,_,y.key,y.mode),E.elementType=y.elementType,E.type=y.type,E.stateNode=y.stateNode,E.alternate=y,y.alternate=E):(E.pendingProps=_,E.type=y.type,E.flags=0,E.subtreeFlags=0,E.deletions=null),E.flags=y.flags&14680064,E.childLanes=y.childLanes,E.lanes=y.lanes,E.child=y.child,E.memoizedProps=y.memoizedProps,E.memoizedState=y.memoizedState,E.updateQueue=y.updateQueue,_=y.dependencies,E.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},E.sibling=y.sibling,E.index=y.index,E.ref=y.ref,E}function Sw(y,_,E,D,L,G){var re=2;if(D=y,typeof y=="function")yC(y)&&(re=1);else if(typeof y=="string")re=5;else e:switch(y){case h:return hd(E.children,L,G,_);case u:re=8,L|=8;break;case d:return y=Bo(12,E,_,L|2),y.elementType=d,y.lanes=G,y;case m:return y=Bo(13,E,_,L),y.elementType=m,y.lanes=G,y;case v:return y=Bo(19,E,_,L),y.elementType=v,y.lanes=G,y;case b:return Mw(E,L,G,_);default:if(typeof y=="object"&&y!==null)switch(y.$$typeof){case f:re=10;break e;case p:re=9;break e;case g:re=11;break e;case x:re=14;break e;case w:re=16,D=null;break e}throw Error(o(130,y==null?y:typeof y,""))}return _=Bo(re,E,_,L),_.elementType=y,_.type=D,_.lanes=G,_}function hd(y,_,E,D){return y=Bo(7,y,D,_),y.lanes=E,y}function Mw(y,_,E,D){return y=Bo(22,y,D,_),y.elementType=b,y.lanes=E,y.stateNode={},y}function xC(y,_,E){return y=Bo(6,y,null,_),y.lanes=E,y}function wC(y,_,E){return _=Bo(4,y.children!==null?y.children:[],y.key,_),_.lanes=E,_.stateNode={containerInfo:y.containerInfo,pendingChildren:null,implementation:y.implementation},_}function _$(y,_,E,D,L){this.tag=_,this.containerInfo=y,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=me,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xE(0),this.expirationTimes=xE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xE(0),this.identifierPrefix=D,this.onRecoverableError=L,se&&(this.mutableSourceEagerHydrationData=null)}function iz(y,_,E,D,L,G,re,_e,Ue){return y=new _$(y,_,E,_e,Ue),_===1?(_=1,G===!0&&(_|=8)):_=0,G=Bo(3,null,null,_),y.current=G,G.stateNode=y,G.memoizedState={element:D,isDehydrated:E,cache:null,transitions:null},PE(G),y}function nz(y){if(!y)return Rr;y=y._reactInternals;e:{if(C(y)!==y||y.tag!==1)throw Error(o(170));var _=y;do{switch(_.tag){case 3:_=_.stateNode.context;break e;case 1:if(As(_.type)){_=_.stateNode.__reactInternalMemoizedMergedChildContext;break e}}_=_.return}while(_!==null);throw Error(o(171))}if(y.tag===1){var E=y.type;if(As(E))return CF(y,E,_)}return _}function rz(y){var _=y._reactInternals;if(_===void 0)throw typeof y.render=="function"?Error(o(188)):(y=Object.keys(y).join(","),Error(o(268,y)));return y=k(_),y===null?null:y.stateNode}function sz(y,_){if(y=y.memoizedState,y!==null&&y.dehydrated!==null){var E=y.retryLane;y.retryLane=E!==0&&E<_?E:_}}function _C(y,_){sz(y,_),(y=y.alternate)&&sz(y,_)}function b$(y){return y=k(y),y===null?null:y.stateNode}function A$(){return null}return i.attemptContinuousHydration=function(y){if(y.tag===13){var _=es();Do(y,134217728,_),_C(y,134217728)}},i.attemptHydrationAtCurrentPriority=function(y){if(y.tag===13){var _=es(),E=xu(y);Do(y,E,_),_C(y,E)}},i.attemptSynchronousHydration=function(y){switch(y.tag){case 3:var _=y.stateNode;if(_.current.memoizedState.isDehydrated){var E=xv(_.pendingLanes);E!==0&&(wE(_,E|1),Ms(_,cr()),!(ri&6)&&(mp(),al()))}break;case 13:var D=es();YN(function(){return Do(y,1,D)}),_C(y,1)}},i.batchedUpdates=function(y,_){var E=ri;ri|=1;try{return y(_)}finally{ri=E,ri===0&&(mp(),z1&&al())}},i.createComponentSelector=function(y){return{$$typeof:uw,value:y}},i.createContainer=function(y,_,E,D,L,G,re){return iz(y,_,!1,null,E,D,L,G,re)},i.createHasPseudoClassSelector=function(y){return{$$typeof:hw,value:y}},i.createHydrationContainer=function(y,_,E,D,L,G,re,_e,Ue){return y=iz(E,D,!0,y,L,G,re,_e,Ue),y.context=nz(null),E=y.current,D=es(),L=xu(E),G=oc(D,L),G.callback=_??null,gu(E,G),y.current.lanes=L,wv(y,L,D),Ms(y,D),y},i.createPortal=function(y,_,E){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:D==null?null:""+D,children:y,containerInfo:_,implementation:E}},i.createRoleSelector=function(y){return{$$typeof:dw,value:y}},i.createTestNameSelector=function(y){return{$$typeof:fw,value:y}},i.createTextSelector=function(y){return{$$typeof:pw,value:y}},i.deferredUpdates=function(y){var _=gi,E=_n.transition;try{return _n.transition=null,gi=16,y()}finally{gi=_,_n.transition=E}},i.discreteUpdates=function(y,_,E,D,L){var G=gi,re=_n.transition;try{return _n.transition=null,gi=1,y(_,E,D,L)}finally{gi=G,_n.transition=re,ri===0&&mp()}},i.findAllNodes=aC,i.findBoundingRects=function(y,_){if(!tt)throw Error(o(363));_=aC(y,_),y=[];for(var E=0;E<_.length;E++)y.push(N(_[E]));for(_=y.length-1;0<_;_--){E=y[_];for(var D=E.x,L=D+E.width,G=E.y,re=G+E.height,_e=_-1;0<=_e;_e--)if(_!==_e){var Ue=y[_e],Ze=Ue.x,yt=Ze+Ue.width,Xt=Ue.y,Bt=Xt+Ue.height;if(D>=Ze&&G>=Xt&&L<=yt&&re<=Bt){y.splice(_,1);break}else if(D!==Ze||E.width!==Ue.width||Bt<G||Xt>re){if(!(G!==Xt||E.height!==Ue.height||yt<D||Ze>L)){Ze>D&&(Ue.width+=Ze-D,Ue.x=D),yt<L&&(Ue.width=L-Ze),y.splice(_,1);break}}else{Xt>G&&(Ue.height+=Xt-G,Ue.y=G),Bt<re&&(Ue.height=re-Xt),y.splice(_,1);break}}}return y},i.findHostInstance=rz,i.findHostInstanceWithNoPortals=function(y){return y=B(y),y=y!==null?F(y):null,y===null?null:y.stateNode},i.findHostInstanceWithWarning=function(y){return rz(y)},i.flushControlled=function(y){var _=ri;ri|=1;var E=_n.transition,D=gi;try{_n.transition=null,gi=1,y()}finally{gi=D,_n.transition=E,ri=_,ri===0&&(mp(),al())}},i.flushPassiveEffects=ud,i.flushSync=YN,i.focusWithin=function(y,_){if(!tt)throw Error(o(363));for(y=rC(y),_=jN(y,_),_=Array.from(_),y=0;y<_.length;){var E=_[y++];if(!ie(E)){if(E.tag===5&&Me(E.stateNode))return!0;for(E=E.child;E!==null;)_.push(E),E=E.sibling}}return!1},i.getCurrentUpdatePriority=function(){return gi},i.getFindAllNodesFailureDescription=function(y,_){if(!tt)throw Error(o(363));var E=0,D=[];y=[rC(y),0];for(var L=0;L<y.length;){var G=y[L++],re=y[L++],_e=_[re];if((G.tag!==5||!ie(G))&&(sC(G,_e)&&(D.push(oC(_e)),re++,re>E&&(E=re)),re<_.length))for(G=G.child;G!==null;)y.push(G,re),G=G.sibling}if(E<_.length){for(y=[];E<_.length;E++)y.push(oC(_[E]));return`findAllNodes was able to match part of the selector:
  `+(D.join(" > ")+`

No matching component was found for:
  `)+y.join(" > ")}return null},i.getPublicRootInstance=function(y){if(y=y.current,!y.child)return null;switch(y.child.tag){case 5:return K(y.child.stateNode);default:return y.child.stateNode}},i.injectIntoDevTools=function(y){if(y={bundleType:y.bundleType,version:y.version,rendererPackageName:y.rendererPackageName,rendererConfig:y.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:b$,findFiberByHostInstance:y.findFiberByHostInstance||A$,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")y=!1;else{var _=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(_.isDisabled||!_.supportsFiber)y=!0;else{try{N1=_.inject(y),sl=_}catch{}y=!!_.checkDCE}}return y},i.isAlreadyRendering=function(){return!1},i.observeVisibleRects=function(y,_,E,D){if(!tt)throw Error(o(363));y=aC(y,_);var L=Te(y,E,D).disconnect;return{disconnect:function(){L()}}},i.registerMutableSourceForHydration=function(y,_){var E=_._getVersion;E=E(_._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[_,E]:y.mutableSourceEagerHydrationData.push(_,E)},i.runWithPriority=function(y,_){var E=gi;try{return gi=y,_()}finally{gi=E}},i.shouldError=function(){return null},i.shouldSuspend=function(){return!1},i.updateContainer=function(y,_,E,D){var L=_.current,G=es(),re=xu(L);return E=nz(E),_.context===null?_.context=E:_.pendingContext=E,_=oc(G,re),_.payload={element:y},D=D===void 0?null:D,D!==null&&(_.callback=D),gu(L,_),y=Do(L,re,G),y!==null&&H1(y,L,re),re},i};cX.exports=bue;var Aue=cX.exports;const Sue=DL(Aue);function dX(e,t,i=(n,r)=>n===r){if(e===t)return!0;if(!e||!t)return!1;const n=e.length;if(t.length!==n)return!1;for(let r=0;r<n;r++)if(!i(e[r],t[r]))return!1;return!0}const Nc=[];function fX(e,t,i=!1,n={}){for(const s of Nc)if(dX(t,s.keys,s.equal)){if(i)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return s.response;if(!i)throw s.promise}const r={keys:t,equal:n.equal,promise:e(...t).then(s=>r.response=s).then(()=>{n.lifespan&&n.lifespan>0&&setTimeout(()=>{const s=Nc.indexOf(r);s!==-1&&Nc.splice(s,1)},n.lifespan)}).catch(s=>r.error=s)};if(Nc.push(r),!i)throw r.promise}const Mue=(e,t,i)=>fX(e,t,!1,i),Eue=(e,t,i)=>void fX(e,t,!0,i),Cue=e=>{if(e===void 0||e.length===0)Nc.splice(0,Nc.length);else{const t=Nc.find(i=>dX(e,i.keys,i.equal));if(t){const i=Nc.indexOf(t);i!==-1&&Nc.splice(i,1)}}},yI={},Tue=e=>void Object.assign(yI,e);function Pue(e,t){function i(h,{args:u=[],attach:d,...f},p){let g=`${h[0].toUpperCase()}${h.slice(1)}`,m;if(h==="primitive"){if(f.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const v=f.object;m=cm(v,{type:h,root:p,attach:d,primitive:!0})}else{const v=yI[g];if(!v)throw new Error(`R3F: ${g} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(u))throw new Error("R3F: The args prop must be an array!");m=cm(new v(...u),{type:h,root:p,attach:d,memoizedProps:{args:u}})}return m.__r3f.attach===void 0&&(m instanceof Qt?m.__r3f.attach="geometry":m instanceof Gn&&(m.__r3f.attach="material")),g!=="inject"&&BT(m,f),m}function n(h,u){let d=!1;if(u){var f,p;(f=u.__r3f)!=null&&f.attach?DT(h,u,u.__r3f.attach):u.isObject3D&&h.isObject3D&&(h.add(u),d=!0),d||(p=h.__r3f)==null||p.objects.push(u),u.__r3f||cm(u,{}),u.__r3f.parent=h,T3(u),um(u)}}function r(h,u,d){let f=!1;if(u){var p,g;if((p=u.__r3f)!=null&&p.attach)DT(h,u,u.__r3f.attach);else if(u.isObject3D&&h.isObject3D){u.parent=h,u.dispatchEvent({type:"added"});const m=h.children.filter(x=>x!==u),v=m.indexOf(d);h.children=[...m.slice(0,v),u,...m.slice(v)],f=!0}f||(g=h.__r3f)==null||g.objects.push(u),u.__r3f||cm(u,{}),u.__r3f.parent=h,T3(u),um(u)}}function s(h,u,d=!1){h&&[...h].forEach(f=>o(u,f,d))}function o(h,u,d){if(u){var f,p,g;if(u.__r3f&&(u.__r3f.parent=null),(f=h.__r3f)!=null&&f.objects&&(h.__r3f.objects=h.__r3f.objects.filter(b=>b!==u)),(p=u.__r3f)!=null&&p.attach)qU(h,u,u.__r3f.attach);else if(u.isObject3D&&h.isObject3D){var m;h.remove(u),(m=u.__r3f)!=null&&m.root&&Nue(u.__r3f.root,u)}const x=(g=u.__r3f)==null?void 0:g.primitive,w=d===void 0?u.dispose!==null&&!x:d;if(!x){var v;s((v=u.__r3f)==null?void 0:v.objects,u,w),s(u.children,u,w)}delete u.__r3f,w&&u.dispose&&u.type!=="Scene"&&E3.unstable_scheduleCallback(E3.unstable_IdlePriority,()=>{try{u.dispose()}catch{}}),um(h)}}function a(h,u,d,f){var p;const g=(p=h.__r3f)==null?void 0:p.parent;if(!g)return;const m=i(u,d,h.__r3f.root);if(h.children){for(const v of h.children)v.__r3f&&n(m,v);h.children=h.children.filter(v=>!v.__r3f)}h.__r3f.objects.forEach(v=>n(m,v)),h.__r3f.objects=[],h.__r3f.autoRemovedBeforeAppend||o(g,h),m.parent&&(m.__r3f.autoRemovedBeforeAppend=!0),n(g,m),m.raycast&&m.__r3f.eventCount&&m.__r3f.root.getState().internal.interaction.push(m),[f,f.alternate].forEach(v=>{v!==null&&(v.stateNode=m,v.ref&&(typeof v.ref=="function"?v.ref(m):v.ref.current=m))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Sue({createInstance:i,removeChild:o,appendChild:n,appendInitialChild:n,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(h,u)=>{if(!u)return;const d=h.getState().scene;d.__r3f&&(d.__r3f.root=h,n(d,u))},removeChildFromContainer:(h,u)=>{u&&o(h.getState().scene,u)},insertInContainerBefore:(h,u,d)=>{if(!u||!d)return;const f=h.getState().scene;f.__r3f&&r(f,u,d)},getRootHostContext:()=>null,getChildHostContext:h=>h,finalizeInitialChildren(h){var u;return!!((u=h==null?void 0:h.__r3f)!=null?u:{}).handlers},prepareUpdate(h,u,d,f){if(h.__r3f.primitive&&f.object&&f.object!==h)return[!0];{const{args:p=[],children:g,...m}=f,{args:v=[],children:x,...w}=d;if(!Array.isArray(p))throw new Error("R3F: the args prop must be an array!");if(p.some((M,A)=>M!==v[A]))return[!0];const b=wX(h,m,w,!0);return b.changes.length?[!1,b]:null}},commitUpdate(h,[u,d],f,p,g,m){u?a(h,f,g,m):BT(h,d)},commitMount(h,u,d,f){var p;const g=(p=h.__r3f)!=null?p:{};h.raycast&&g.handlers&&g.eventCount&&h.__r3f.root.getState().internal.interaction.push(h)},getPublicInstance:h=>h,prepareForCommit:()=>null,preparePortalMount:h=>cm(h.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(h){var u;const{attach:d,parent:f}=(u=h.__r3f)!=null?u:{};d&&f&&qU(f,h,d),h.isObject3D&&(h.visible=!1),um(h)},unhideInstance(h,u){var d;const{attach:f,parent:p}=(d=h.__r3f)!=null?d:{};f&&p&&DT(p,h,f),(h.isObject3D&&u.visible==null||u.visible)&&(h.visible=!0),um(h)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>t?t():Lm.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Yi.fun(performance.now)?performance.now:Yi.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Yi.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Yi.fun(clearTimeout)?clearTimeout:void 0}),applyProps:BT}}var jU,WU;const PT=e=>"colorSpace"in e||"outputColorSpace"in e,pX=()=>{var e;return(e=yI.ColorManagement)!=null?e:null},mX=e=>e&&e.isOrthographicCamera,Due=e=>e&&e.hasOwnProperty("current"),f1=typeof window<"u"&&((jU=window.document)!=null&&jU.createElement||((WU=window.navigator)==null?void 0:WU.product)==="ReactNative")?ae.useLayoutEffect:ae.useEffect;function gX(e){const t=ae.useRef(e);return f1(()=>void(t.current=e),[e]),t}function Bue({set:e}){return f1(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class vX extends ae.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}vX.getDerivedStateFromError=()=>({error:!0});const yX="__default",XU=new Map,Lue=e=>e&&!!e.memoized&&!!e.changes;function xX(e){var t;const i=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],i),e[1]):e}const r0=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()},Yi={obj:e=>e===Object(e)&&!Yi.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:i="shallow",objects:n="reference",strict:r=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(Yi.str(e)||Yi.num(e))return e===t;const s=Yi.obj(e);if(s&&n==="reference")return e===t;const o=Yi.arr(e);if(o&&i==="reference")return e===t;if((o||s)&&e===t)return!0;let a;for(a in e)if(!(a in t))return!1;if(s&&i==="shallow"&&n==="shallow"){for(a in r?t:e)if(!Yi.equ(e[a],t[a],{strict:r,objects:"reference"}))return!1}else for(a in r?t:e)if(e[a]!==t[a])return!1;if(Yi.und(a)){if(o&&e.length===0&&t.length===0||s&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function Rue(e){const t={nodes:{},materials:{}};return e&&e.traverse(i=>{i.name&&(t.nodes[i.name]=i),i.material&&!t.materials[i.material.name]&&(t.materials[i.material.name]=i.material)}),t}function Iue(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function cm(e,t){const i=e;return(t!=null&&t.primitive||!i.__r3f)&&(i.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t}),e}function C3(e,t){let i=e;if(t.includes("-")){const n=t.split("-"),r=n.pop();return i=n.reduce((s,o)=>s[o],e),{target:i,key:r}}else return{target:i,key:t}}const YU=/-\d+$/;function DT(e,t,i){if(Yi.str(i)){if(YU.test(i)){const s=i.replace(YU,""),{target:o,key:a}=C3(e,s);Array.isArray(o[a])||(o[a]=[])}const{target:n,key:r}=C3(e,i);t.__r3f.previousAttach=n[r],n[r]=t}else t.__r3f.previousAttach=i(e,t)}function qU(e,t,i){var n,r;if(Yi.str(i)){const{target:s,key:o}=C3(e,i),a=t.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(n=t.__r3f)==null||n.previousAttach==null||n.previousAttach(e,t);(r=t.__r3f)==null||delete r.previousAttach}function wX(e,{children:t,key:i,ref:n,...r},{children:s,key:o,ref:a,...l}={},c=!1){var h;const u=(h=e==null?void 0:e.__r3f)!=null?h:{},d=Object.entries(r),f=[];if(c){const g=Object.keys(l);for(let m=0;m<g.length;m++)r.hasOwnProperty(g[m])||d.unshift([g[m],yX+"remove"])}d.forEach(([g,m])=>{var v;if((v=e.__r3f)!=null&&v.primitive&&g==="object"||Yi.equ(m,l[g]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(g))return f.push([g,m,!0,[]]);let x=[];g.includes("-")&&(x=g.split("-")),f.push([g,m,!1,x]);for(const w in r){const b=r[w];w.startsWith(`${g}-`)&&f.push([w,b,!1,w.split("-")])}});const p={...r};return u.memoizedProps&&u.memoizedProps.args&&(p.args=u.memoizedProps.args),u.memoizedProps&&u.memoizedProps.attach&&(p.attach=u.memoizedProps.attach),{memoized:p,changes:f}}function BT(e,t){var i,n,r;const s=(i=e.__r3f)!=null?i:{},o=s.root,a=(n=o==null||o.getState==null?void 0:o.getState())!=null?n:{},{memoized:l,changes:c}=Lue(t)?t:wX(e,t),h=s.eventCount;e.__r3f&&(e.__r3f.memoizedProps=l);for(let d=0;d<c.length;d++){let[f,p,g,m]=c[d];if(PT(e)){const b="srgb",M="srgb-linear";f==="encoding"?(f="colorSpace",p=p===3001?b:M):f==="outputEncoding"&&(f="outputColorSpace",p=p===3001?b:M)}let v=e,x=v[f];if(m.length&&(x=m.reduce((w,b)=>w[b],e),!(x&&x.set))){const[w,...b]=m.reverse();v=b.reverse().reduce((M,A)=>M[A],e),f=w}if(p===yX+"remove")if(v.constructor){let w=XU.get(v.constructor);w||(w=new v.constructor,XU.set(v.constructor,w)),p=w[f]}else p=0;if(g)p?s.handlers[f]=p:delete s.handlers[f],s.eventCount=Object.keys(s.handlers).length;else if(x&&x.set&&(x.copy||x instanceof vf)){if(Array.isArray(p))x.fromArray?x.fromArray(p):x.set(...p);else if(x.copy&&p&&p.constructor&&x.constructor===p.constructor)x.copy(p);else if(p!==void 0){const w=x instanceof ct;!w&&x.setScalar?x.setScalar(p):x instanceof vf&&p instanceof vf?x.mask=p.mask:x.set(p),!pX()&&!a.linear&&w&&x.convertSRGBToLinear()}}else if(v[f]=p,v[f]instanceof en&&v[f].format===Ls&&v[f].type===su){const w=v[f];PT(w)&&PT(a.gl)?w.colorSpace=a.gl.outputColorSpace:w.encoding=a.gl.outputEncoding}um(e)}if(s.parent&&a.internal&&e.raycast&&h!==s.eventCount){const d=a.internal.interaction.indexOf(e);d>-1&&a.internal.interaction.splice(d,1),s.eventCount&&a.internal.interaction.push(e)}return!(c.length===1&&c[0][0]==="onUpdate")&&c.length&&(r=e.__r3f)!=null&&r.parent&&T3(e),e}function um(e){var t,i;const n=(t=e.__r3f)==null||(i=t.root)==null||i.getState==null?void 0:i.getState();n&&n.internal.frames===0&&n.invalidate()}function T3(e){e.onUpdate==null||e.onUpdate(e)}function Oue(e,t){e.manual||(mX(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function T_(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Fue(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return Lm.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Lm.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Lm.ContinuousEventPriority;default:return Lm.DefaultEventPriority}}function _X(e,t,i,n){const r=i.get(t);r&&(i.delete(t),i.size===0&&(e.delete(n),r.target.releasePointerCapture(n)))}function Nue(e,t){const{internal:i}=e.getState();i.interaction=i.interaction.filter(n=>n!==t),i.initialHits=i.initialHits.filter(n=>n!==t),i.hovered.forEach((n,r)=>{(n.eventObject===t||n.object===t)&&i.hovered.delete(r)}),i.capturedMap.forEach((n,r)=>{_X(i.capturedMap,t,n,r)})}function zue(e){function t(l){const{internal:c}=e.getState(),h=l.offsetX-c.initialClick[0],u=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(h*h+u*u))}function i(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(h=>{var u;return(u=c.__r3f)==null?void 0:u.handlers["onPointer"+h]}))}function n(l,c){const h=e.getState(),u=new Set,d=[],f=c?c(h.internal.interaction):h.internal.interaction;for(let v=0;v<f.length;v++){const x=r0(f[v]);x&&(x.raycaster.camera=void 0)}h.previousRoot||h.events.compute==null||h.events.compute(l,h);function p(v){const x=r0(v);if(!x||!x.events.enabled||x.raycaster.camera===null)return[];if(x.raycaster.camera===void 0){var w;x.events.compute==null||x.events.compute(l,x,(w=x.previousRoot)==null?void 0:w.getState()),x.raycaster.camera===void 0&&(x.raycaster.camera=null)}return x.raycaster.camera?x.raycaster.intersectObject(v,!0):[]}let g=f.flatMap(p).sort((v,x)=>{const w=r0(v.object),b=r0(x.object);return!w||!b?v.distance-x.distance:b.events.priority-w.events.priority||v.distance-x.distance}).filter(v=>{const x=T_(v);return u.has(x)?!1:(u.add(x),!0)});h.events.filter&&(g=h.events.filter(g,h));for(const v of g){let x=v.object;for(;x;){var m;(m=x.__r3f)!=null&&m.eventCount&&d.push({...v,eventObject:x}),x=x.parent}}if("pointerId"in l&&h.internal.capturedMap.has(l.pointerId))for(let v of h.internal.capturedMap.get(l.pointerId).values())u.has(T_(v.intersection))||d.push(v.intersection);return d}function r(l,c,h,u){const d=e.getState();if(l.length){const f={stopped:!1};for(const p of l){const g=r0(p.object)||d,{raycaster:m,pointer:v,camera:x,internal:w}=g,b=new te(v.x,v.y,0).unproject(x),M=P=>{var B,k;return(B=(k=w.capturedMap.get(P))==null?void 0:k.has(p.eventObject))!=null?B:!1},A=P=>{const B={intersection:p,target:c.target};w.capturedMap.has(P)?w.capturedMap.get(P).set(p.eventObject,B):w.capturedMap.set(P,new Map([[p.eventObject,B]])),c.target.setPointerCapture(P)},T=P=>{const B=w.capturedMap.get(P);B&&_X(w.capturedMap,p.eventObject,B,P)};let S={};for(let P in c){let B=c[P];typeof B!="function"&&(S[P]=B)}let C={...p,...S,pointer:v,intersections:l,stopped:f.stopped,delta:h,unprojectedPoint:b,ray:m.ray,camera:x,stopPropagation(){const P="pointerId"in c&&w.capturedMap.get(c.pointerId);if((!P||P.has(p.eventObject))&&(C.stopped=f.stopped=!0,w.hovered.size&&Array.from(w.hovered.values()).find(B=>B.eventObject===p.eventObject))){const B=l.slice(0,l.indexOf(p));s([...B,p])}},target:{hasPointerCapture:M,setPointerCapture:A,releasePointerCapture:T},currentTarget:{hasPointerCapture:M,setPointerCapture:A,releasePointerCapture:T},nativeEvent:c};if(u(C),f.stopped===!0)break}}return l}function s(l){const{internal:c}=e.getState();for(const h of c.hovered.values())if(!l.length||!l.find(u=>u.object===h.object&&u.index===h.index&&u.instanceId===h.instanceId)){const d=h.eventObject.__r3f,f=d==null?void 0:d.handlers;if(c.hovered.delete(T_(h)),d!=null&&d.eventCount){const p={...h,intersections:l};f.onPointerOut==null||f.onPointerOut(p),f.onPointerLeave==null||f.onPointerLeave(p)}}}function o(l,c){for(let h=0;h<c.length;h++){const u=c[h].__r3f;u==null||u.handlers.onPointerMissed==null||u.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:h}=e.getState();"pointerId"in c&&h.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{h.capturedMap.has(c.pointerId)&&(h.capturedMap.delete(c.pointerId),s([]))})}}return function(h){const{onPointerMissed:u,internal:d}=e.getState();d.lastEvent.current=h;const f=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",m=n(h,f?i:void 0),v=p?t(h):0;l==="onPointerDown"&&(d.initialClick=[h.offsetX,h.offsetY],d.initialHits=m.map(w=>w.eventObject)),p&&!m.length&&v<=2&&(o(h,d.interaction),u&&u(h)),f&&s(m);function x(w){const b=w.eventObject,M=b.__r3f,A=M==null?void 0:M.handlers;if(M!=null&&M.eventCount)if(f){if(A.onPointerOver||A.onPointerEnter||A.onPointerOut||A.onPointerLeave){const T=T_(w),S=d.hovered.get(T);S?S.stopped&&w.stopPropagation():(d.hovered.set(T,w),A.onPointerOver==null||A.onPointerOver(w),A.onPointerEnter==null||A.onPointerEnter(w))}A.onPointerMove==null||A.onPointerMove(w)}else{const T=A[l];T?(!p||d.initialHits.includes(b))&&(o(h,d.interaction.filter(S=>!d.initialHits.includes(S))),T(w)):p&&d.initialHits.includes(b)&&o(h,d.interaction.filter(S=>!d.initialHits.includes(S)))}}r(m,h,v,x)}}return{handlePointer:a}}const bX=e=>!!(e!=null&&e.render),AX=ae.createContext(null),kue=(e,t)=>{const i=lX((a,l)=>{const c=new te,h=new te,u=new te;function d(v=l().camera,x=h,w=l().size){const{width:b,height:M,top:A,left:T}=w,S=b/M;x instanceof te?u.copy(x):u.set(...x);const C=v.getWorldPosition(c).distanceTo(u);if(mX(v))return{width:b/v.zoom,height:M/v.zoom,top:A,left:T,factor:1,distance:C,aspect:S};{const P=v.fov*Math.PI/180,B=2*Math.tan(P/2)*C,k=B*(b/M);return{width:k,height:B,top:A,left:T,factor:b/k,distance:C,aspect:S}}}let f;const p=v=>a(x=>({performance:{...x.performance,current:v}})),g=new Ve;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(v=1)=>e(l(),v),advance:(v,x)=>t(v,x,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new pI,pointer:g,mouse:g,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=l();f&&clearTimeout(f),v.performance.current!==v.performance.min&&p(v.performance.min),f=setTimeout(()=>p(l().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:v=>a(x=>({...x,events:{...x.events,...v}})),setSize:(v,x,w,b,M)=>{const A=l().camera,T={width:v,height:x,top:b||0,left:M||0,updateStyle:w};a(S=>({size:T,viewport:{...S.viewport,...d(A,h,T)}}))},setDpr:v=>a(x=>{const w=xX(v);return{viewport:{...x.viewport,dpr:w,initialDpr:x.viewport.initialDpr||w}}}),setFrameloop:(v="always")=>{const x=l().clock;x.stop(),x.elapsedTime=0,v!=="never"&&(x.start(),x.elapsedTime=0),a(()=>({frameloop:v}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:ae.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(v,x,w)=>{const b=l().internal;return b.priority=b.priority+(x>0?1:0),b.subscribers.push({ref:v,priority:x,store:w}),b.subscribers=b.subscribers.sort((M,A)=>M.priority-A.priority),()=>{const M=l().internal;M!=null&&M.subscribers&&(M.priority=M.priority-(x>0?1:0),M.subscribers=M.subscribers.filter(A=>A.ref!==v))}}}}}),n=i.getState();let r=n.size,s=n.viewport.dpr,o=n.camera;return i.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:h,set:u}=i.getState();if(l!==r||c.dpr!==s){var d;r=l,s=c.dpr,Oue(a,l),h.setPixelRatio(c.dpr);const f=(d=l.updateStyle)!=null?d:typeof HTMLCanvasElement<"u"&&h.domElement instanceof HTMLCanvasElement;h.setSize(l.width,l.height,f)}a!==o&&(o=a,u(f=>({viewport:{...f.viewport,...f.viewport.getCurrentViewport(a)}})))}),i.subscribe(a=>e(a)),i};let P_,Uue=new Set,Gue=new Set,Hue=new Set;function LT(e,t){if(e.size)for(const{callback:i}of e.values())i(t)}function s0(e,t){switch(e){case"before":return LT(Uue,t);case"after":return LT(Gue,t);case"tail":return LT(Hue,t)}}let RT,IT;function OT(e,t,i){let n=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(n=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),RT=t.internal.subscribers,P_=0;P_<RT.length;P_++)IT=RT[P_],IT.ref.current(IT.store.getState(),n,i);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function Vue(e){let t=!1,i,n,r;function s(l){n=requestAnimationFrame(s),t=!0,i=0,s0("before",l);for(const h of e.values()){var c;r=h.store.getState(),r.internal.active&&(r.frameloop==="always"||r.internal.frames>0)&&!((c=r.gl.xr)!=null&&c.isPresenting)&&(i+=OT(l,r))}if(s0("after",l),i===0)return s0("tail",l),t=!1,cancelAnimationFrame(n)}function o(l,c=1){var h;if(!l)return e.forEach(u=>o(u.store.getState()),c);(h=l.gl.xr)!=null&&h.isPresenting||!l.internal.active||l.frameloop==="never"||(l.internal.frames=Math.min(60,l.internal.frames+c),t||(t=!0,requestAnimationFrame(s)))}function a(l,c=!0,h,u){if(c&&s0("before",l),h)OT(l,h,u);else for(const d of e.values())OT(l,d.store.getState());c&&s0("after",l)}return{loop:s,invalidate:o,advance:a}}function SX(){const e=ae.useContext(AX);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function ro(e=i=>i,t){return SX()(e,t)}function nv(e,t=0){const i=SX(),n=i.getState().internal.subscribe,r=gX(e);return f1(()=>n(r,t,i),[t,n,i]),null}function MX(e,t){return function(i,...n){const r=new i;return e&&e(r),Promise.all(n.map(s=>new Promise((o,a)=>r.load(s,l=>{l.scene&&Object.assign(l,Rue(l.scene)),o(l)},t,l=>a(new Error(`Could not load ${s}: ${l.message})`))))))}}function Jh(e,t,i,n){const r=Array.isArray(t)?t:[t],s=Mue(MX(i,n),[e,...r],{equal:Yi.equ});return Array.isArray(t)?s:s[0]}Jh.preload=function(e,t,i){const n=Array.isArray(t)?t:[t];return Eue(MX(i),[e,...n])};Jh.clear=function(e,t){const i=Array.isArray(t)?t:[t];return Cue([e,...i])};const Bg=new Map,{invalidate:QU,advance:JU}=Vue(Bg),{reconciler:eS,applyProps:Tl}=Pue(Bg,Fue),Op={objects:"shallow",strict:!1},jue=(e,t)=>{const i=typeof e=="function"?e(t):e;return bX(i)?i:new WR({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function Wue(e,t){if(t)return t;if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:i,height:n,top:r,left:s}=e.parentElement.getBoundingClientRect();return{width:i,height:n,top:r,left:s}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function Xue(e){const t=Bg.get(e),i=t==null?void 0:t.fiber,n=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=n||kue(QU,JU),o=i||eS.createContainer(s,Lm.ConcurrentRoot,null,!1,null,"",r,null);t||Bg.set(e,{fiber:o,store:s});let a,l=!1,c;return{configure(h={}){let{gl:u,size:d,scene:f,events:p,onCreated:g,shadows:m=!1,linear:v=!1,flat:x=!1,legacy:w=!1,orthographic:b=!1,frameloop:M="always",dpr:A=[1,2],performance:T,raycaster:S,camera:C,onPointerMissed:P}=h,B=s.getState(),k=B.gl;B.gl||B.set({gl:k=jue(u,e)});let z=B.raycaster;z||B.set({raycaster:z=new sX});const{params:F,...W}=S||{};if(Yi.equ(W,z,Op)||Tl(z,{...W}),Yi.equ(F,z.params,Op)||Tl(z,{params:{...z.params,...F}}),!B.camera||B.camera===c&&!Yi.equ(c,C,Op)){c=C;const q=C instanceof qx,H=q?C:b?new Ya(0,0,0,0,.1,1e3):new $i(75,0,.1,1e3);q||(H.position.z=5,C&&Tl(H,C),!B.camera&&!(C!=null&&C.rotation)&&H.lookAt(0,0,0)),B.set({camera:H})}if(!B.scene){let q;f instanceof $A?q=f:(q=new $A,f&&Tl(q,f)),B.set({scene:cm(q)})}if(!B.xr){const q=(J,le)=>{const j=s.getState();j.frameloop!=="never"&&JU(J,!0,j,le)},H=()=>{const J=s.getState();J.gl.xr.enabled=J.gl.xr.isPresenting,J.gl.xr.setAnimationLoop(J.gl.xr.isPresenting?q:null),J.gl.xr.isPresenting||QU(J)},Q={connect(){const J=s.getState().gl;J.xr.addEventListener("sessionstart",H),J.xr.addEventListener("sessionend",H)},disconnect(){const J=s.getState().gl;J.xr.removeEventListener("sessionstart",H),J.xr.removeEventListener("sessionend",H)}};k.xr&&Q.connect(),B.set({xr:Q})}if(k.shadowMap){const q=k.shadowMap.enabled,H=k.shadowMap.type;if(k.shadowMap.enabled=!!m,Yi.boo(m))k.shadowMap.type=fy;else if(Yi.str(m)){var K;const Q={basic:g9,percentage:bM,soft:fy,variance:$d};k.shadowMap.type=(K=Q[m])!=null?K:fy}else Yi.obj(m)&&Object.assign(k.shadowMap,m);(q!==k.shadowMap.enabled||H!==k.shadowMap.type)&&(k.shadowMap.needsUpdate=!0)}const Z=pX();Z&&("enabled"in Z?Z.enabled=!w:"legacyMode"in Z&&(Z.legacyMode=w)),Tl(k,{outputEncoding:v?3e3:3001,toneMapping:x?Xa:DR}),B.legacy!==w&&B.set(()=>({legacy:w})),B.linear!==v&&B.set(()=>({linear:v})),B.flat!==x&&B.set(()=>({flat:x})),u&&!Yi.fun(u)&&!bX(u)&&!Yi.equ(u,k,Op)&&Tl(k,u),p&&!B.events.handlers&&B.set({events:p(s)});const V=Wue(e,d);return Yi.equ(V,B.size,Op)||B.setSize(V.width,V.height,V.updateStyle,V.top,V.left),A&&B.viewport.dpr!==xX(A)&&B.setDpr(A),B.frameloop!==M&&B.setFrameloop(M),B.onPointerMissed||B.set({onPointerMissed:P}),T&&!Yi.equ(T,B.performance,Op)&&B.set(q=>({performance:{...q.performance,...T}})),a=g,l=!0,this},render(h){return l||this.configure(),eS.updateContainer(ae.createElement(Yue,{store:s,children:h,onCreated:a,rootElement:e}),o,null,()=>{}),s},unmount(){EX(e)}}}function Yue({store:e,children:t,onCreated:i,rootElement:n}){return f1(()=>{const r=e.getState();r.set(s=>({internal:{...s.internal,active:!0}})),i&&i(r),e.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),ae.createElement(AX.Provider,{value:e},t)}function EX(e,t){const i=Bg.get(e),n=i==null?void 0:i.fiber;if(n){const r=i==null?void 0:i.store.getState();r&&(r.internal.active=!1),eS.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),Iue(r),Bg.delete(e),t&&t(e)}catch{}},500)})}}eS.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ae.version});function ca(){return ca=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},ca.apply(this,arguments)}function P3(e,t,i){var n,r,s,o,a;t==null&&(t=100);function l(){var h=Date.now()-o;h<t&&h>=0?n=setTimeout(l,t-h):(n=null,i||(a=e.apply(s,r),s=r=null))}var c=function(){s=this,r=arguments,o=Date.now();var h=i&&!n;return n||(n=setTimeout(l,t)),h&&(a=e.apply(s,r),s=r=null),a};return c.clear=function(){n&&(clearTimeout(n),n=null)},c.flush=function(){n&&(a=e.apply(s,r),s=r=null,clearTimeout(n),n=null)},c}P3.debounce=P3;var que=P3;const KU=DL(que);function Que(e){let{debounce:t,scroll:i,polyfill:n,offsetSize:r}=e===void 0?{debounce:0,scroll:!1,offsetSize:!1}:e;const s=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=ae.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=ae.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),c=t?typeof t=="number"?t:t.scroll:null,h=t?typeof t=="number"?t:t.resize:null,u=ae.useRef(!1);ae.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[d,f,p]=ae.useMemo(()=>{const x=()=>{if(!l.current.element)return;const{left:w,top:b,width:M,height:A,bottom:T,right:S,x:C,y:P}=l.current.element.getBoundingClientRect(),B={left:w,top:b,width:M,height:A,bottom:T,right:S,x:C,y:P};l.current.element instanceof HTMLElement&&r&&(B.height=l.current.element.offsetHeight,B.width=l.current.element.offsetWidth),Object.freeze(B),u.current&&!$ue(l.current.lastBounds,B)&&a(l.current.lastBounds=B)};return[x,h?KU(x,h):x,c?KU(x,c):x]},[a,r,c,h]);function g(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(x=>x.removeEventListener("scroll",p,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function m(){l.current.element&&(l.current.resizeObserver=new s(p),l.current.resizeObserver.observe(l.current.element),i&&l.current.scrollContainers&&l.current.scrollContainers.forEach(x=>x.addEventListener("scroll",p,{capture:!0,passive:!0})))}const v=x=>{!x||x===l.current.element||(g(),l.current.element=x,l.current.scrollContainers=CX(x),m())};return Kue(p,!!i),Jue(f),ae.useEffect(()=>{g(),m()},[i,p,f]),ae.useEffect(()=>g,[]),[v,o,d]}function Jue(e){ae.useEffect(()=>{const t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function Kue(e,t){ae.useEffect(()=>{if(t){const i=e;return window.addEventListener("scroll",i,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",i,!0)}},[e,t])}function CX(e){const t=[];if(!e||e===document.body)return t;const{overflow:i,overflowX:n,overflowY:r}=window.getComputedStyle(e);return[i,n,r].some(s=>s==="auto"||s==="scroll")&&t.push(e),[...t,...CX(e.parentElement)]}const Zue=["x","y","top","bottom","left","right","width","height"],$ue=(e,t)=>Zue.every(i=>e[i]===t[i]);var ehe=Object.defineProperty,the=Object.defineProperties,ihe=Object.getOwnPropertyDescriptors,ZU=Object.getOwnPropertySymbols,nhe=Object.prototype.hasOwnProperty,rhe=Object.prototype.propertyIsEnumerable,$U=(e,t,i)=>t in e?ehe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,e4=(e,t)=>{for(var i in t||(t={}))nhe.call(t,i)&&$U(e,i,t[i]);if(ZU)for(var i of ZU(t))rhe.call(t,i)&&$U(e,i,t[i]);return e},she=(e,t)=>the(e,ihe(t));function TX(e,t,i){if(!e)return;if(i(e)===!0)return e;let n=t?e.return:e.child;for(;n;){const r=TX(n,t,i);if(r)return r;n=t?null:n.sibling}}function PX(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const xI=PX(ae.createContext(null));class DX extends ae.Component{render(){return ae.createElement(xI.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:t4,ReactCurrentDispatcher:i4}=ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function ohe(){const e=ae.useContext(xI);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=ae.useId();return ae.useMemo(()=>{for(const n of[t4==null?void 0:t4.current,e,e==null?void 0:e.alternate]){if(!n)continue;const r=TX(n,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===t)return!0;o=o.next}});if(r)return r}},[e,t])}function ahe(){var e,t;const i=ohe(),[n]=ae.useState(()=>new Map);n.clear();let r=i;for(;r;){const s=(e=r.type)==null?void 0:e._context;s&&s!==xI&&!n.has(s)&&n.set(s,(t=i4==null?void 0:i4.current)==null?void 0:t.readContext(PX(s))),r=r.return}return n}function lhe(){const e=ahe();return ae.useMemo(()=>Array.from(e.keys()).reduce((t,i)=>n=>ae.createElement(t,null,ae.createElement(i.Provider,she(e4({},n),{value:e.get(i)}))),t=>ae.createElement(DX,e4({},t))),[e])}const FT={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function che(e){const{handlePointer:t}=zue(e);return{priority:1,enabled:!0,compute(i,n,r){n.pointer.set(i.offsetX/n.size.width*2-1,-(i.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(FT).reduce((i,n)=>({...i,[n]:t(n)}),{}),update:()=>{var i;const{events:n,internal:r}=e.getState();(i=r.lastEvent)!=null&&i.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:i=>{var n;const{set:r,events:s}=e.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:i}})),Object.entries((n=s.handlers)!=null?n:[]).forEach(([o,a])=>{const[l,c]=FT[o];i.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:i,events:n}=e.getState();if(n.connected){var r;Object.entries((r=n.handlers)!=null?r:[]).forEach(([s,o])=>{if(n&&n.connected instanceof HTMLElement){const[a]=FT[s];n.connected.removeEventListener(a,o)}}),i(s=>({events:{...s.events,connected:void 0}}))}}}}const uhe=ae.forwardRef(function({children:t,fallback:i,resize:n,style:r,gl:s,events:o=che,eventSource:a,eventPrefix:l,shadows:c,linear:h,flat:u,legacy:d,orthographic:f,frameloop:p,dpr:g,performance:m,raycaster:v,camera:x,onPointerMissed:w,onCreated:b,...M},A){ae.useMemo(()=>Tue(xue),[]);const T=lhe(),[S,C]=Que({scroll:!0,debounce:{scroll:50,resize:0},...n}),P=ae.useRef(null),B=ae.useRef(null);ae.useImperativeHandle(A,()=>P.current);const k=gX(w),[z,F]=ae.useState(!1),[W,K]=ae.useState(!1);if(z)throw z;if(W)throw W;const Z=ae.useRef(null);f1(()=>{const X=P.current;C.width>0&&C.height>0&&X&&(Z.current||(Z.current=Xue(X)),Z.current.configure({gl:s,events:o,shadows:c,linear:h,flat:u,legacy:d,orthographic:f,frameloop:p,dpr:g,performance:m,raycaster:v,camera:x,size:C,onPointerMissed:(...V)=>k.current==null?void 0:k.current(...V),onCreated:V=>{V.events.connect==null||V.events.connect(a?Due(a)?a.current:a:B.current),l&&V.setEvents({compute:(q,H)=>{const Q=q[l+"X"],J=q[l+"Y"];H.pointer.set(Q/H.size.width*2-1,-(J/H.size.height)*2+1),H.raycaster.setFromCamera(H.pointer,H.camera)}}),b==null||b(V)}}),Z.current.render(ae.createElement(T,null,ae.createElement(vX,{set:K},ae.createElement(ae.Suspense,{fallback:ae.createElement(Bue,{set:F})},t)))))}),ae.useEffect(()=>{const X=P.current;if(X)return()=>EX(X)},[]);const U=a?"none":"auto";return ae.createElement("div",ca({ref:B,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:U,...r}},M),ae.createElement("div",{ref:S,style:{width:"100%",height:"100%"}},ae.createElement("canvas",{ref:P,style:{display:"block"}},i)))}),wI=ae.forwardRef(function(t,i){return ae.createElement(DX,null,ae.createElement(uhe,ca({},t,{ref:i})))}),p1=new te,_I=new te,hhe=new te;function dhe(e,t,i){const n=p1.setFromMatrixPosition(e.matrixWorld);n.project(t);const r=i.width/2,s=i.height/2;return[n.x*r+r,-(n.y*s)+s]}function fhe(e,t){const i=p1.setFromMatrixPosition(e.matrixWorld),n=_I.setFromMatrixPosition(t.matrixWorld),r=i.sub(n),s=t.getWorldDirection(hhe);return r.angleTo(s)>Math.PI/2}function phe(e,t,i,n){const r=p1.setFromMatrixPosition(e.matrixWorld),s=r.clone();s.project(t),i.setFromCamera(s,t);const o=i.intersectObjects(n,!0);if(o.length){const a=o[0].distance;return r.distanceTo(i.ray.origin)<a}return!0}function mhe(e,t){if(t instanceof Ya)return t.zoom;if(t instanceof $i){const i=p1.setFromMatrixPosition(e.matrixWorld),n=_I.setFromMatrixPosition(t.matrixWorld),r=t.fov*Math.PI/180,s=i.distanceTo(n);return 1/(2*Math.tan(r/2)*s)}else return 1}function ghe(e,t,i){if(t instanceof $i||t instanceof Ya){const n=p1.setFromMatrixPosition(e.matrixWorld),r=_I.setFromMatrixPosition(t.matrixWorld),s=n.distanceTo(r),o=(i[1]-i[0])/(t.far-t.near),a=i[1]-o*t.far;return Math.round(o*s+a)}}const D3=e=>Math.abs(e)<1e-10?0:e;function BX(e,t,i=""){let n="matrix3d(";for(let r=0;r!==16;r++)n+=D3(t[r]*e.elements[r])+(r!==15?",":")");return i+n}const vhe=(e=>t=>BX(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),yhe=(e=>(t,i)=>BX(t,e(i),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function xhe(e){return e&&typeof e=="object"&&"current"in e}const whe=ae.forwardRef(({children:e,eps:t=.001,style:i,className:n,prepend:r,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:c=!1,transform:h=!1,occlude:u,onOcclude:d,castShadow:f,receiveShadow:p,material:g,geometry:m,zIndexRange:v=[16777271,0],calculatePosition:x=dhe,as:w="div",wrapperClass:b,pointerEvents:M="auto",...A},T)=>{const{gl:S,camera:C,scene:P,size:B,raycaster:k,events:z,viewport:F}=ro(),[W]=ae.useState(()=>document.createElement(w)),K=ae.useRef(),Z=ae.useRef(null),U=ae.useRef(0),X=ae.useRef([0,0]),V=ae.useRef(null),q=ae.useRef(null),H=(a==null?void 0:a.current)||z.connected||S.domElement.parentNode,Q=ae.useRef(null),J=ae.useRef(!1),le=ae.useMemo(()=>u&&u!=="blending"||Array.isArray(u)&&u.length&&xhe(u[0]),[u]);ae.useLayoutEffect(()=>{const de=S.domElement;u&&u==="blending"?(de.style.zIndex=`${Math.floor(v[0]/2)}`,de.style.position="absolute",de.style.pointerEvents="none"):(de.style.zIndex=null,de.style.position=null,de.style.pointerEvents=null)},[u]),ae.useLayoutEffect(()=>{if(Z.current){const de=K.current=s9(W);if(P.updateMatrixWorld(),h)W.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Se=x(Z.current,C,B);W.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Se[0]}px,${Se[1]}px,0);transform-origin:0 0;`}return H&&(r?H.prepend(W):H.appendChild(W)),()=>{H&&H.removeChild(W),de.unmount()}}},[H,h]),ae.useLayoutEffect(()=>{b&&(W.className=b)},[b]);const j=ae.useMemo(()=>h?{position:"absolute",top:0,left:0,width:B.width,height:B.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-B.height/2,left:-B.width/2,width:B.width,height:B.height},...i},[i,s,o,B,h]),ve=ae.useMemo(()=>({position:"absolute",pointerEvents:M}),[M]);ae.useLayoutEffect(()=>{if(J.current=!1,h){var de;(de=K.current)==null||de.render(ae.createElement("div",{ref:V,style:j},ae.createElement("div",{ref:q,style:ve},ae.createElement("div",{ref:T,className:n,style:i,children:e}))))}else{var Se;(Se=K.current)==null||Se.render(ae.createElement("div",{ref:T,style:j,className:n,children:e}))}});const pe=ae.useRef(!0);nv(de=>{if(Z.current){C.updateMatrixWorld(),Z.current.updateWorldMatrix(!0,!1);const Se=h?X.current:x(Z.current,C,B);if(h||Math.abs(U.current-C.zoom)>t||Math.abs(X.current[0]-Se[0])>t||Math.abs(X.current[1]-Se[1])>t){const ce=fhe(Z.current,C);let se=!1;le&&(u!=="blending"?se=[P]:Array.isArray(u)&&(se=u.map(ze=>ze.current)));const be=pe.current;if(se){const ze=phe(Z.current,C,k,se);pe.current=ze&&!ce}else pe.current=!ce;be!==pe.current&&(d?d(!pe.current):W.style.display=pe.current?"block":"none");const Ee=Math.floor(v[0]/2),Le=u?le?[v[0],Ee]:[Ee-1,0]:v;if(W.style.zIndex=`${ghe(Z.current,C,Le)}`,h){const[ze,Oe]=[B.width/2,B.height/2],Ge=C.projectionMatrix.elements[5]*Oe,{isOrthographicCamera:tt,top:ot,left:N,bottom:R,right:ie}=C,xe=vhe(C.matrixWorldInverse),Me=tt?`scale(${Ge})translate(${D3(-(ie+N)/2)}px,${D3((ot+R)/2)}px)`:`translateZ(${Ge}px)`;let Te=Z.current.matrixWorld;c&&(Te=C.matrixWorldInverse.clone().transpose().copyPosition(Te).scale(Z.current.scale),Te.elements[3]=Te.elements[7]=Te.elements[11]=0,Te.elements[15]=1),W.style.width=B.width+"px",W.style.height=B.height+"px",W.style.perspective=tt?"":`${Ge}px`,V.current&&q.current&&(V.current.style.transform=`${Me}${xe}translate(${ze}px,${Oe}px)`,q.current.style.transform=yhe(Te,1/((l||10)/400)))}else{const ze=l===void 0?1:mhe(Z.current,C)*l;W.style.transform=`translate3d(${Se[0]}px,${Se[1]}px,0) scale(${ze})`}X.current=Se,U.current=C.zoom}}if(!le&&Q.current&&!J.current)if(h){if(V.current){const Se=V.current.children[0];if(Se!=null&&Se.clientWidth&&Se!=null&&Se.clientHeight){const{isOrthographicCamera:ce}=C;if(ce||m)A.scale&&(Array.isArray(A.scale)?A.scale instanceof te?Q.current.scale.copy(A.scale.clone().divideScalar(1)):Q.current.scale.set(1/A.scale[0],1/A.scale[1],1/A.scale[2]):Q.current.scale.setScalar(1/A.scale));else{const se=(l||10)/400,be=Se.clientWidth*se,Ee=Se.clientHeight*se;Q.current.scale.set(be,Ee,1)}J.current=!0}}}else{const Se=W.children[0];if(Se!=null&&Se.clientWidth&&Se!=null&&Se.clientHeight){const ce=1/F.factor,se=Se.clientWidth*ce,be=Se.clientHeight*ce;Q.current.scale.set(se,be,1),J.current=!0}Q.current.lookAt(de.camera.position)}});const me=ae.useMemo(()=>({vertexShader:h?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[h]);return ae.createElement("group",ca({},A,{ref:Z}),u&&!le&&ae.createElement("mesh",{castShadow:f,receiveShadow:p,ref:Q},m||ae.createElement("planeGeometry",null),g||ae.createElement("shaderMaterial",{side:za,vertexShader:me.vertexShader,fragmentShader:me.fragmentShader})))});let o0=0;const _he=lX(e=>(Bm.onStart=(t,i,n)=>{e({active:!0,item:t,loaded:i,total:n,progress:(i-o0)/(n-o0)*100})},Bm.onLoad=()=>{e({active:!1})},Bm.onError=t=>e(i=>({errors:[...i.errors,t]})),Bm.onProgress=(t,i,n)=>{i===n&&(o0=n),e({active:!0,item:t,loaded:i,total:n,progress:(i-o0)/(n-o0)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}));function bI(e){return function(t){e.forEach(function(i){typeof i=="function"?i(t):i!=null&&(i.current=t)})}}function $m(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n4(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),i.push.apply(i,n)}return i}function r4(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?n4(Object(i),!0).forEach(function(n){$m(e,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n4(Object(i)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))})}return e}new Ve;new Ve;function LX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Io=function e(t,i,n){var r=this;LX(this,e),$m(this,"dot2",function(s,o){return r.x*s+r.y*o}),$m(this,"dot3",function(s,o,a){return r.x*s+r.y*o+r.z*a}),this.x=t,this.y=i,this.z=n},bhe=[new Io(1,1,0),new Io(-1,1,0),new Io(1,-1,0),new Io(-1,-1,0),new Io(1,0,1),new Io(-1,0,1),new Io(1,0,-1),new Io(-1,0,-1),new Io(0,1,1),new Io(0,-1,1),new Io(0,1,-1),new Io(0,-1,-1)],s4=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],o4=new Array(512),a4=new Array(512),Ahe=function(t){t>0&&t<1&&(t*=65536),t=Math.floor(t),t<256&&(t|=t<<8);for(var i=0;i<256;i++){var n;i&1?n=s4[i]^t&255:n=s4[i]^t>>8&255,o4[i]=o4[i+256]=n,a4[i]=a4[i+256]=bhe[n%12]}};Ahe(0);function She(e){if(typeof e=="number")e=Math.abs(e);else if(typeof e=="string"){var t=e;e=0;for(var i=0;i<t.length;i++)e=(e+(i+1)*(t.charCodeAt(i)%96))%2147483647}return e===0&&(e=311),e}function l4(e){var t=She(e);return function(){var i=t*48271%2147483647;return t=i,i/2147483647}}var Mhe=function e(t){var i=this;LX(this,e),$m(this,"seed",0),$m(this,"init",function(n){i.seed=n,i.value=l4(n)}),$m(this,"value",l4(this.seed)),this.init(t)},Ehe=new Mhe(Math.random()),Che={radius:1,center:[0,0,0]};function The(e,t){for(var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ehe,n=r4(r4({},Che),t),r=n.radius,s=n.center,o=0;o<e.length;o+=3){var a=Math.pow(i.value(),.3333333333333333),l=i.value()*2-1,c=i.value()*2-1,h=i.value()*2-1,u=Math.sqrt(l*l+c*c+h*h);l=a*l/u,c=a*c/u,h=a*h/u,e[o]=l*r+s[0],e[o+1]=c*r+s[1],e[o+2]=h*r+s[2]}return e}function c4(e,t){if(t===o7)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===JA||t===RR){let i=e.getIndex();if(i===null){const o=[],a=e.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);e.setIndex(o),i=e.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e}const n=i.count-2,r=[];if(i)if(t===JA)for(let o=1;o<=n;o++)r.push(i.getX(0)),r.push(i.getX(o)),r.push(i.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(i.getX(o)),r.push(i.getX(o+1)),r.push(i.getX(o+2))):(r.push(i.getX(o+2)),r.push(i.getX(o+1)),r.push(i.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=e.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}var Phe=Object.defineProperty,Dhe=(e,t,i)=>t in e?Phe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,qt=(e,t,i)=>(Dhe(e,typeof t!="symbol"?t+"":t,i),i);const u4=(e,t)=>(e%t+t)%t;let Bhe=class extends ec{constructor(t,i){super(),qt(this,"object"),qt(this,"domElement"),qt(this,"enabled",!0),qt(this,"target",new te),qt(this,"minDistance",0),qt(this,"maxDistance",1/0),qt(this,"minZoom",0),qt(this,"maxZoom",1/0),qt(this,"minPolarAngle",0),qt(this,"maxPolarAngle",Math.PI),qt(this,"minAzimuthAngle",-1/0),qt(this,"maxAzimuthAngle",1/0),qt(this,"enableDamping",!1),qt(this,"dampingFactor",.05),qt(this,"enableZoom",!0),qt(this,"zoomSpeed",1),qt(this,"enableRotate",!0),qt(this,"rotateSpeed",1),qt(this,"enablePan",!0),qt(this,"panSpeed",1),qt(this,"screenSpacePanning",!0),qt(this,"keyPanSpeed",7),qt(this,"autoRotate",!1),qt(this,"autoRotateSpeed",2),qt(this,"reverseOrbit",!1),qt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),qt(this,"mouseButtons",{LEFT:Rd.ROTATE,MIDDLE:Rd.DOLLY,RIGHT:Rd.PAN}),qt(this,"touches",{ONE:Id.ROTATE,TWO:Id.DOLLY_PAN}),qt(this,"target0"),qt(this,"position0"),qt(this,"zoom0"),qt(this,"_domElementKeyEvents",null),qt(this,"getPolarAngle"),qt(this,"getAzimuthalAngle"),qt(this,"setPolarAngle"),qt(this,"setAzimuthalAngle"),qt(this,"getDistance"),qt(this,"listenToKeyEvents"),qt(this,"saveState"),qt(this,"reset"),qt(this,"update"),qt(this,"connect"),qt(this,"dispose"),this.object=t,this.domElement=i,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=ne=>{let we=u4(ne,2*Math.PI),Re=h.phi;Re<0&&(Re+=2*Math.PI),we<0&&(we+=2*Math.PI);let Ne=Math.abs(we-Re);2*Math.PI-Ne<Ne&&(we<Re?we+=2*Math.PI:Re+=2*Math.PI),u.phi=we-Re,n.update()},this.setAzimuthalAngle=ne=>{let we=u4(ne,2*Math.PI),Re=h.theta;Re<0&&(Re+=2*Math.PI),we<0&&(we+=2*Math.PI);let Ne=Math.abs(we-Re);2*Math.PI-Ne<Ne&&(we<Re?we+=2*Math.PI:Re+=2*Math.PI),u.theta=we-Re,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ne=>{ne.addEventListener("keydown",ie),this._domElementKeyEvents=ne},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),l=a.NONE},this.update=(()=>{const ne=new te,we=new yr().setFromUnitVectors(t.up,new te(0,1,0)),Re=we.clone().invert(),Ne=new te,$e=new yr,xt=2*Math.PI;return function(){const Y=n.object.position;ne.copy(Y).sub(n.target),ne.applyQuaternion(we),h.setFromVector3(ne),n.autoRotate&&l===a.NONE&&k(P()),n.enableDamping?(h.theta+=u.theta*n.dampingFactor,h.phi+=u.phi*n.dampingFactor):(h.theta+=u.theta,h.phi+=u.phi);let oe=n.minAzimuthAngle,ye=n.maxAzimuthAngle;return isFinite(oe)&&isFinite(ye)&&(oe<-Math.PI?oe+=xt:oe>Math.PI&&(oe-=xt),ye<-Math.PI?ye+=xt:ye>Math.PI&&(ye-=xt),oe<=ye?h.theta=Math.max(oe,Math.min(ye,h.theta)):h.theta=h.theta>(oe+ye)/2?Math.max(oe,h.theta):Math.min(ye,h.theta)),h.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=d,h.radius=Math.max(n.minDistance,Math.min(n.maxDistance,h.radius)),n.enableDamping===!0?n.target.addScaledVector(f,n.dampingFactor):n.target.add(f),ne.setFromSpherical(h),ne.applyQuaternion(Re),Y.copy(n.target).add(ne),n.object.lookAt(n.target),n.enableDamping===!0?(u.theta*=1-n.dampingFactor,u.phi*=1-n.dampingFactor,f.multiplyScalar(1-n.dampingFactor)):(u.set(0,0,0),f.set(0,0,0)),d=1,p||Ne.distanceToSquared(n.object.position)>c||8*(1-$e.dot(n.object.quaternion))>c?(n.dispatchEvent(r),Ne.copy(n.object.position),$e.copy(n.object.quaternion),p=!1,!0):!1}})(),this.connect=ne=>{ne===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),n.domElement=ne,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Te),n.domElement.addEventListener("pointerdown",ze),n.domElement.addEventListener("pointercancel",tt),n.domElement.addEventListener("wheel",R)},this.dispose=()=>{var ne,we,Re,Ne,$e,xt;(ne=n.domElement)==null||ne.removeEventListener("contextmenu",Te),(we=n.domElement)==null||we.removeEventListener("pointerdown",ze),(Re=n.domElement)==null||Re.removeEventListener("pointercancel",tt),(Ne=n.domElement)==null||Ne.removeEventListener("wheel",R),($e=n.domElement)==null||$e.ownerDocument.removeEventListener("pointermove",Oe),(xt=n.domElement)==null||xt.ownerDocument.removeEventListener("pointerup",Ge),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",ie)};const n=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,h=new M3,u=new M3;let d=1;const f=new te;let p=!1;const g=new Ve,m=new Ve,v=new Ve,x=new Ve,w=new Ve,b=new Ve,M=new Ve,A=new Ve,T=new Ve,S=[],C={};function P(){return 2*Math.PI/60/60*n.autoRotateSpeed}function B(){return Math.pow(.95,n.zoomSpeed)}function k(ne){n.reverseOrbit?u.theta+=ne:u.theta-=ne}function z(ne){n.reverseOrbit?u.phi+=ne:u.phi-=ne}const F=(()=>{const ne=new te;return function(Re,Ne){ne.setFromMatrixColumn(Ne,0),ne.multiplyScalar(-Re),f.add(ne)}})(),W=(()=>{const ne=new te;return function(Re,Ne){n.screenSpacePanning===!0?ne.setFromMatrixColumn(Ne,1):(ne.setFromMatrixColumn(Ne,0),ne.crossVectors(n.object.up,ne)),ne.multiplyScalar(Re),f.add(ne)}})(),K=(()=>{const ne=new te;return function(Re,Ne){const $e=n.domElement;if($e&&n.object instanceof $i&&n.object.isPerspectiveCamera){const xt=n.object.position;ne.copy(xt).sub(n.target);let kt=ne.length();kt*=Math.tan(n.object.fov/2*Math.PI/180),F(2*Re*kt/$e.clientHeight,n.object.matrix),W(2*Ne*kt/$e.clientHeight,n.object.matrix)}else $e&&n.object instanceof Ya&&n.object.isOrthographicCamera?(F(Re*(n.object.right-n.object.left)/n.object.zoom/$e.clientWidth,n.object.matrix),W(Ne*(n.object.top-n.object.bottom)/n.object.zoom/$e.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function Z(ne){n.object instanceof $i&&n.object.isPerspectiveCamera?d/=ne:n.object instanceof Ya&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*ne)),n.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function U(ne){n.object instanceof $i&&n.object.isPerspectiveCamera?d*=ne:n.object instanceof Ya&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/ne)),n.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function X(ne){g.set(ne.clientX,ne.clientY)}function V(ne){M.set(ne.clientX,ne.clientY)}function q(ne){x.set(ne.clientX,ne.clientY)}function H(ne){m.set(ne.clientX,ne.clientY),v.subVectors(m,g).multiplyScalar(n.rotateSpeed);const we=n.domElement;we&&(k(2*Math.PI*v.x/we.clientHeight),z(2*Math.PI*v.y/we.clientHeight)),g.copy(m),n.update()}function Q(ne){A.set(ne.clientX,ne.clientY),T.subVectors(A,M),T.y>0?Z(B()):T.y<0&&U(B()),M.copy(A),n.update()}function J(ne){w.set(ne.clientX,ne.clientY),b.subVectors(w,x).multiplyScalar(n.panSpeed),K(b.x,b.y),x.copy(w),n.update()}function le(ne){ne.deltaY<0?U(B()):ne.deltaY>0&&Z(B()),n.update()}function j(ne){let we=!1;switch(ne.code){case n.keys.UP:K(0,n.keyPanSpeed),we=!0;break;case n.keys.BOTTOM:K(0,-n.keyPanSpeed),we=!0;break;case n.keys.LEFT:K(n.keyPanSpeed,0),we=!0;break;case n.keys.RIGHT:K(-n.keyPanSpeed,0),we=!0;break}we&&(ne.preventDefault(),n.update())}function ve(){if(S.length==1)g.set(S[0].pageX,S[0].pageY);else{const ne=.5*(S[0].pageX+S[1].pageX),we=.5*(S[0].pageY+S[1].pageY);g.set(ne,we)}}function pe(){if(S.length==1)x.set(S[0].pageX,S[0].pageY);else{const ne=.5*(S[0].pageX+S[1].pageX),we=.5*(S[0].pageY+S[1].pageY);x.set(ne,we)}}function me(){const ne=S[0].pageX-S[1].pageX,we=S[0].pageY-S[1].pageY,Re=Math.sqrt(ne*ne+we*we);M.set(0,Re)}function de(){n.enableZoom&&me(),n.enablePan&&pe()}function Se(){n.enableZoom&&me(),n.enableRotate&&ve()}function ce(ne){if(S.length==1)m.set(ne.pageX,ne.pageY);else{const Re=He(ne),Ne=.5*(ne.pageX+Re.x),$e=.5*(ne.pageY+Re.y);m.set(Ne,$e)}v.subVectors(m,g).multiplyScalar(n.rotateSpeed);const we=n.domElement;we&&(k(2*Math.PI*v.x/we.clientHeight),z(2*Math.PI*v.y/we.clientHeight)),g.copy(m)}function se(ne){if(S.length==1)w.set(ne.pageX,ne.pageY);else{const we=He(ne),Re=.5*(ne.pageX+we.x),Ne=.5*(ne.pageY+we.y);w.set(Re,Ne)}b.subVectors(w,x).multiplyScalar(n.panSpeed),K(b.x,b.y),x.copy(w)}function be(ne){const we=He(ne),Re=ne.pageX-we.x,Ne=ne.pageY-we.y,$e=Math.sqrt(Re*Re+Ne*Ne);A.set(0,$e),T.set(0,Math.pow(A.y/M.y,n.zoomSpeed)),Z(T.y),M.copy(A)}function Ee(ne){n.enableZoom&&be(ne),n.enablePan&&se(ne)}function Le(ne){n.enableZoom&&be(ne),n.enableRotate&&ce(ne)}function ze(ne){var we,Re;n.enabled!==!1&&(S.length===0&&((we=n.domElement)==null||we.ownerDocument.addEventListener("pointermove",Oe),(Re=n.domElement)==null||Re.ownerDocument.addEventListener("pointerup",Ge)),qe(ne),ne.pointerType==="touch"?xe(ne):ot(ne))}function Oe(ne){n.enabled!==!1&&(ne.pointerType==="touch"?Me(ne):N(ne))}function Ge(ne){var we,Re,Ne;De(ne),S.length===0&&((we=n.domElement)==null||we.releasePointerCapture(ne.pointerId),(Re=n.domElement)==null||Re.ownerDocument.removeEventListener("pointermove",Oe),(Ne=n.domElement)==null||Ne.ownerDocument.removeEventListener("pointerup",Ge)),n.dispatchEvent(o),l=a.NONE}function tt(ne){De(ne)}function ot(ne){let we;switch(ne.button){case 0:we=n.mouseButtons.LEFT;break;case 1:we=n.mouseButtons.MIDDLE;break;case 2:we=n.mouseButtons.RIGHT;break;default:we=-1}switch(we){case Rd.DOLLY:if(n.enableZoom===!1)return;V(ne),l=a.DOLLY;break;case Rd.ROTATE:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(n.enablePan===!1)return;q(ne),l=a.PAN}else{if(n.enableRotate===!1)return;X(ne),l=a.ROTATE}break;case Rd.PAN:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(n.enableRotate===!1)return;X(ne),l=a.ROTATE}else{if(n.enablePan===!1)return;q(ne),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(s)}function N(ne){if(n.enabled!==!1)switch(l){case a.ROTATE:if(n.enableRotate===!1)return;H(ne);break;case a.DOLLY:if(n.enableZoom===!1)return;Q(ne);break;case a.PAN:if(n.enablePan===!1)return;J(ne);break}}function R(ne){n.enabled===!1||n.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(ne.preventDefault(),n.dispatchEvent(s),le(ne),n.dispatchEvent(o))}function ie(ne){n.enabled===!1||n.enablePan===!1||j(ne)}function xe(ne){switch(ue(ne),S.length){case 1:switch(n.touches.ONE){case Id.ROTATE:if(n.enableRotate===!1)return;ve(),l=a.TOUCH_ROTATE;break;case Id.PAN:if(n.enablePan===!1)return;pe(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(n.touches.TWO){case Id.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;de(),l=a.TOUCH_DOLLY_PAN;break;case Id.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Se(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(s)}function Me(ne){switch(ue(ne),l){case a.TOUCH_ROTATE:if(n.enableRotate===!1)return;ce(ne),n.update();break;case a.TOUCH_PAN:if(n.enablePan===!1)return;se(ne),n.update();break;case a.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Ee(ne),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Le(ne),n.update();break;default:l=a.NONE}}function Te(ne){n.enabled!==!1&&ne.preventDefault()}function qe(ne){S.push(ne)}function De(ne){delete C[ne.pointerId];for(let we=0;we<S.length;we++)if(S[we].pointerId==ne.pointerId){S.splice(we,1);return}}function ue(ne){let we=C[ne.pointerId];we===void 0&&(we=new Ve,C[ne.pointerId]=we),we.set(ne.pageX,ne.pageY)}function He(ne){const we=ne.pointerId===S[0].pointerId?S[1]:S[0];return C[we.pointerId]}i!==void 0&&this.connect(i),this.update()}};class AI extends ws{constructor(t){super(t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(i){return new Fhe(i)}),this.register(function(i){return new jhe(i)}),this.register(function(i){return new Whe(i)}),this.register(function(i){return new Xhe(i)}),this.register(function(i){return new zhe(i)}),this.register(function(i){return new khe(i)}),this.register(function(i){return new Uhe(i)}),this.register(function(i){return new Ghe(i)}),this.register(function(i){return new Ohe(i)}),this.register(function(i){return new Hhe(i)}),this.register(function(i){return new Nhe(i)}),this.register(function(i){return new Vhe(i)}),this.register(function(i){return new Rhe(i)}),this.register(function(i){return new Yhe(i)}),this.register(function(i){return new qhe(i)})}load(t,i,n,r){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=Gl.extractUrlBase(t),this.manager.itemStart(t);const a=function(c){r?r(c):console.error(c),s.manager.itemError(t),s.manager.itemEnd(t)},l=new wo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(t,function(c){try{s.parse(c,o,function(h){i(h),s.manager.itemEnd(t)},a)}catch(h){a(h)}},n,a)}setDRACOLoader(t){return this.dracoLoader=t,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(t){return this.ktx2Loader=t,this}setMeshoptDecoder(t){return this.meshoptDecoder=t,this}register(t){return this.pluginCallbacks.indexOf(t)===-1&&this.pluginCallbacks.push(t),this}unregister(t){return this.pluginCallbacks.indexOf(t)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}parse(t,i,n,r){let s;const o={},a={};if(typeof t=="string")s=JSON.parse(t);else if(t instanceof ArrayBuffer)if(Gl.decodeText(new Uint8Array(t.slice(0,4)))===RX){try{o[di.KHR_BINARY_GLTF]=new Qhe(t)}catch(h){r&&r(h);return}s=JSON.parse(o[di.KHR_BINARY_GLTF].content)}else s=JSON.parse(Gl.decodeText(new Uint8Array(t)));else s=t;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new lde(s,{path:i||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const h=this.pluginCallbacks[c](l);a[h.name]=h,o[h.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const h=s.extensionsUsed[c],u=s.extensionsRequired||[];switch(h){case di.KHR_MATERIALS_UNLIT:o[h]=new Ihe;break;case di.KHR_DRACO_MESH_COMPRESSION:o[h]=new Jhe(s,this.dracoLoader);break;case di.KHR_TEXTURE_TRANSFORM:o[h]=new Khe;break;case di.KHR_MESH_QUANTIZATION:o[h]=new Zhe;break;default:u.indexOf(h)>=0&&a[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(n,r)}parseAsync(t,i){const n=this;return new Promise(function(r,s){n.parse(t,i,r,s)})}}function Lhe(){let e={};return{get:function(t){return e[t]},add:function(t,i){e[t]=i},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const di={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Rhe{constructor(t){this.parser=t,this.name=di.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const t=this.parser,i=this.parser.json.nodes||[];for(let n=0,r=i.length;n<r;n++){const s=i[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&t._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(t){const i=this.parser,n="light:"+t;let r=i.cache.get(n);if(r)return r;const s=i.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[t];let c;const h=new ct(16777215);l.color!==void 0&&h.fromArray(l.color);const u=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new dI(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new hI(h),c.distance=u;break;case"spot":c=new uI(h),c.distance=u,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Ju(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=i.createUniqueName(l.name||"light_"+t),r=Promise.resolve(c),i.cache.add(n,r),r}getDependency(t,i){if(t==="light")return this._loadLight(i)}createNodeAttachment(t){const i=this,n=this.parser,s=n.json.nodes[t],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return n._getNodeRef(i.cache,a,l)})}}class Ihe{constructor(){this.name=di.KHR_MATERIALS_UNLIT}getMaterialType(){return co}extendParams(t,i,n){const r=[];t.color=new ct(1,1,1),t.opacity=1;const s=i.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;t.color.fromArray(o),t.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(n.assignTexture(t,"map",s.baseColorTexture,3001))}return Promise.all(r)}}class Ohe{constructor(t){this.parser=t,this.name=di.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(t,i){const r=this.parser.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(i.emissiveIntensity=s),Promise.resolve()}}class Fhe{constructor(t){this.parser=t,this.name=di.KHR_MATERIALS_CLEARCOAT}getMaterialType(t){const n=this.parser.json.materials[t];return!n.extensions||!n.extensions[this.name]?null:tc}extendMaterialParams(t,i){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(i.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(i,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(i.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(i,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(i,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;i.clearcoatNormalScale=new Ve(a,a)}return Promise.all(s)}}class Nhe{constructor(t){this.parser=t,this.name=di.KHR_MATERIALS_IRIDESCENCE}getMaterialType(t){const n=this.parser.json.materials[t];return!n.extensions||!n.extensions[this.name]?null:tc}extendMaterialParams(t,i){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(i.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(n.assignTexture(i,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(i.iridescenceIOR=o.iridescenceIor),i.iridescenceThicknessRange===void 0&&(i.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(i.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(i.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(i,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class zhe{constructor(t){this.parser=t,this.name=di.KHR_MATERIALS_SHEEN}getMaterialType(t){const n=this.parser.json.materials[t];return!n.extensions||!n.extensions[this.name]?null:tc}extendMaterialParams(t,i){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];i.sheenColor=new ct(0,0,0),i.sheenRoughness=0,i.sheen=1;const o=r.extensions[this.name];return o.sheenColorFactor!==void 0&&i.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(i.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(i,"sheenColorMap",o.sheenColorTexture,3001)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(i,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class khe{constructor(t){this.parser=t,this.name=di.KHR_MATERIALS_TRANSMISSION}getMaterialType(t){const n=this.parser.json.materials[t];return!n.extensions||!n.extensions[this.name]?null:tc}extendMaterialParams(t,i){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(i.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(i,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Uhe{constructor(t){this.parser=t,this.name=di.KHR_MATERIALS_VOLUME}getMaterialType(t){const n=this.parser.json.materials[t];return!n.extensions||!n.extensions[this.name]?null:tc}extendMaterialParams(t,i){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];i.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(i,"thicknessMap",o.thicknessTexture)),i.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return i.attenuationColor=new ct(a[0],a[1],a[2]),Promise.all(s)}}class Ghe{constructor(t){this.parser=t,this.name=di.KHR_MATERIALS_IOR}getMaterialType(t){const n=this.parser.json.materials[t];return!n.extensions||!n.extensions[this.name]?null:tc}extendMaterialParams(t,i){const r=this.parser.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return i.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class Hhe{constructor(t){this.parser=t,this.name=di.KHR_MATERIALS_SPECULAR}getMaterialType(t){const n=this.parser.json.materials[t];return!n.extensions||!n.extensions[this.name]?null:tc}extendMaterialParams(t,i){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];i.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(i,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return i.specularColor=new ct(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(n.assignTexture(i,"specularColorMap",o.specularColorTexture,3001)),Promise.all(s)}}class Vhe{constructor(t){this.parser=t,this.name=di.KHR_MATERIALS_ANISOTROPY}getMaterialType(t){const n=this.parser.json.materials[t];return!n.extensions||!n.extensions[this.name]?null:tc}extendMaterialParams(t,i){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(i.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(i.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(n.assignTexture(i,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class jhe{constructor(t){this.parser=t,this.name=di.KHR_TEXTURE_BASISU}loadTexture(t){const i=this.parser,n=i.json,r=n.textures[t];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=i.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return i.loadTextureImage(t,s.source,o)}}class Whe{constructor(t){this.parser=t,this.name=di.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(t){const i=this.name,n=this.parser,r=n.json,s=r.textures[t];if(!s.extensions||!s.extensions[i])return null;const o=s.extensions[i],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(t,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(t)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(t){const i=new Image;i.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",i.onload=i.onerror=function(){t(i.height===1)}})),this.isSupported}}class Xhe{constructor(t){this.parser=t,this.name=di.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(t){const i=this.name,n=this.parser,r=n.json,s=r.textures[t];if(!s.extensions||!s.extensions[i])return null;const o=s.extensions[i],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(t,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(t)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(t){const i=new Image;i.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",i.onload=i.onerror=function(){t(i.height===1)}})),this.isSupported}}class Yhe{constructor(t){this.name=di.EXT_MESHOPT_COMPRESSION,this.parser=t}loadBufferView(t){const i=this.parser.json,n=i.bufferViews[t];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,h=r.count,u=r.byteStride,d=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(h,u,d,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(h*u);return o.decodeGltfBuffer(new Uint8Array(f),h,u,d,r.mode,r.filter),f})})}else return null}}class qhe{constructor(t){this.name=di.EXT_MESH_GPU_INSTANCING,this.parser=t}createNodeMesh(t){const i=this.parser.json,n=i.nodes[t];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const r=i.meshes[n.mesh];for(const c of r.primitives)if(c.mode!==Ho.TRIANGLES&&c.mode!==Ho.TRIANGLE_STRIP&&c.mode!==Ho.TRIANGLE_FAN&&c.mode!==void 0)return null;const o=n.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(h=>(l[c]=h,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(t)),Promise.all(a).then(c=>{const h=c.pop(),u=h.isGroup?h.children:[h],d=c[0].count,f=[];for(const p of u){const g=new Nt,m=new te,v=new yr,x=new te(1,1,1),w=new qR(p.geometry,p.material,d);for(let b=0;b<d;b++)l.TRANSLATION&&m.fromBufferAttribute(l.TRANSLATION,b),l.ROTATION&&v.fromBufferAttribute(l.ROTATION,b),l.SCALE&&x.fromBufferAttribute(l.SCALE,b),w.setMatrixAt(b,g.compose(m,v,x));for(const b in l)b!=="TRANSLATION"&&b!=="ROTATION"&&b!=="SCALE"&&p.geometry.setAttribute(b,l[b]);fi.prototype.copy.call(w,p),this.parser.assignFinalMaterial(w),f.push(w)}return h.isGroup?(h.clear(),h.add(...f),h):f[0]}))}}const RX="glTF",a0=12,h4={JSON:1313821514,BIN:5130562};class Qhe{constructor(t){this.name=di.KHR_BINARY_GLTF,this.content=null,this.body=null;const i=new DataView(t,0,a0);if(this.header={magic:Gl.decodeText(new Uint8Array(t.slice(0,4))),version:i.getUint32(4,!0),length:i.getUint32(8,!0)},this.header.magic!==RX)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-a0,r=new DataView(t,a0);let s=0;for(;s<n;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,a===h4.JSON){const l=new Uint8Array(t,a0+s,o);this.content=Gl.decodeText(l)}else if(a===h4.BIN){const l=a0+s;this.body=t.slice(l,l+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Jhe{constructor(t,i){if(!i)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=di.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=i,this.dracoLoader.preload()}decodePrimitive(t,i){const n=this.json,r=this.dracoLoader,s=t.extensions[this.name].bufferView,o=t.extensions[this.name].attributes,a={},l={},c={};for(const h in o){const u=B3[h]||h.toLowerCase();a[u]=o[h]}for(const h in t.attributes){const u=B3[h]||h.toLowerCase();if(o[h]!==void 0){const d=n.accessors[t.attributes[h]],f=eg[d.componentType];c[u]=f.name,l[u]=d.normalized===!0}}return i.getDependency("bufferView",s).then(function(h){return new Promise(function(u){r.decodeDracoFile(h,function(d){for(const f in d.attributes){const p=d.attributes[f],g=l[f];g!==void 0&&(p.normalized=g)}u(d)},a,c)})})}}class Khe{constructor(){this.name=di.KHR_TEXTURE_TRANSFORM}extendTexture(t,i){return(i.texCoord===void 0||i.texCoord===t.channel)&&i.offset===void 0&&i.rotation===void 0&&i.scale===void 0||(t=t.clone(),i.texCoord!==void 0&&(t.channel=i.texCoord),i.offset!==void 0&&t.offset.fromArray(i.offset),i.rotation!==void 0&&(t.rotation=i.rotation),i.scale!==void 0&&t.repeat.fromArray(i.scale),t.needsUpdate=!0),t}}class Zhe{constructor(){this.name=di.KHR_MESH_QUANTIZATION}}class IX extends iv{constructor(t,i,n,r){super(t,i,n,r)}copySampleValue_(t){const i=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=t*r*3+r;for(let o=0;o!==r;o++)i[o]=n[s+o];return i}interpolate_(t,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,h=r-i,u=(n-i)/h,d=u*u,f=d*u,p=t*c,g=p-c,m=-2*f+3*d,v=f-d,x=1-m,w=v-d+u;for(let b=0;b!==a;b++){const M=o[g+b+a],A=o[g+b+l]*h,T=o[p+b+a],S=o[p+b]*h;s[b]=x*M+w*A+m*T+v*S}return s}}const $he=new yr;class ede extends IX{interpolate_(t,i,n,r){const s=super.interpolate_(t,i,n,r);return $he.fromArray(s).normalize().toArray(s),s}}const Ho={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},eg={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},d4={9728:gn,9729:rn,9984:nx,9985:SM,9986:Km,9987:Yl},f4={33071:Mr,33648:bg,10497:Rh},NT={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},B3={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...Wx.replace(/\D+/g,"")>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Pu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},tde={CUBICSPLINE:void 0,LINEAR:Rf,STEP:Sg},zT={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function ide(e){return e.DefaultMaterial===void 0&&(e.DefaultMaterial=new h1({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Xl})),e.DefaultMaterial}function wd(e,t,i){for(const n in i.extensions)e[n]===void 0&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=i.extensions[n])}function Ju(e,t){t.extras!==void 0&&(typeof t.extras=="object"?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function nde(e,t,i){let n=!1,r=!1,s=!1;for(let c=0,h=t.length;c<h;c++){const u=t[c];if(u.POSITION!==void 0&&(n=!0),u.NORMAL!==void 0&&(r=!0),u.COLOR_0!==void 0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(e);const o=[],a=[],l=[];for(let c=0,h=t.length;c<h;c++){const u=t[c];if(n){const d=u.POSITION!==void 0?i.getDependency("accessor",u.POSITION):e.attributes.position;o.push(d)}if(r){const d=u.NORMAL!==void 0?i.getDependency("accessor",u.NORMAL):e.attributes.normal;a.push(d)}if(s){const d=u.COLOR_0!==void 0?i.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[0],u=c[1],d=c[2];return n&&(e.morphAttributes.position=h),r&&(e.morphAttributes.normal=u),s&&(e.morphAttributes.color=d),e.morphTargetsRelative=!0,e})}function rde(e,t){if(e.updateMorphTargets(),t.weights!==void 0)for(let i=0,n=t.weights.length;i<n;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){const i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(let n=0,r=i.length;n<r;n++)e.morphTargetDictionary[i[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function sde(e){let t;const i=e.extensions&&e.extensions[di.KHR_DRACO_MESH_COMPRESSION];if(i?t="draco:"+i.bufferView+":"+i.indices+":"+kT(i.attributes):t=e.indices+":"+kT(e.attributes)+":"+e.mode,e.targets!==void 0)for(let n=0,r=e.targets.length;n<r;n++)t+=":"+kT(e.targets[n]);return t}function kT(e){let t="";const i=Object.keys(e).sort();for(let n=0,r=i.length;n<r;n++)t+=i[n]+":"+e[i[n]]+";";return t}function L3(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function ode(e){return e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0?"image/jpeg":e.search(/\.webp($|\?)/i)>0||e.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const ade=new Nt;class lde{constructor(t={},i={}){this.json=t,this.extensions={},this.plugins={},this.options=i,this.cache=new Lhe,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,s=-1;typeof navigator<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||r&&s<98?this.textureLoader=new d1(this.options.manager):this.textureLoader=new iX(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new wo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(t){this.extensions=t}setPlugins(t){this.plugins=t}parse(t,i){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};wd(s,a,r),Ju(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){t(a)})}).catch(i)}_markDefs(){const t=this.json.nodes||[],i=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=i.length;r<s;r++){const o=i[r].joints;for(let a=0,l=o.length;a<l;a++)t[o[a]].isBone=!0}for(let r=0,s=t.length;r<s;r++){const o=t[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(t,i){i!==void 0&&(t.refs[i]===void 0&&(t.refs[i]=t.uses[i]=0),t.refs[i]++)}_getNodeRef(t,i,n){if(t.refs[i]<=1)return n;const r=n.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,h]of o.children.entries())s(h,a.children[c])};return s(n,r),r.name+="_instance_"+t.uses[i]++,r}_invokeOne(t){const i=Object.values(this.plugins);i.push(this);for(let n=0;n<i.length;n++){const r=t(i[n]);if(r)return r}return null}_invokeAll(t){const i=Object.values(this.plugins);i.unshift(this);const n=[];for(let r=0;r<i.length;r++){const s=t(i[r]);s&&n.push(s)}return n}getDependency(t,i){const n=t+":"+i;let r=this.cache.get(n);if(!r){switch(t){case"scene":r=this.loadScene(i);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(i)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(i)});break;case"accessor":r=this.loadAccessor(i);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(i)});break;case"buffer":r=this.loadBuffer(i);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(i)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(i)});break;case"skin":r=this.loadSkin(i);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(i)});break;case"camera":r=this.loadCamera(i);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(t,i)}),!r)throw new Error("Unknown type: "+t);break}this.cache.add(n,r)}return r}getDependencies(t){let i=this.cache.get(t);if(!i){const n=this,r=this.json[t+(t==="mesh"?"es":"s")]||[];i=Promise.all(r.map(function(s,o){return n.getDependency(t,o)})),this.cache.add(t,i)}return i}loadBuffer(t){const i=this.json.buffers[t],n=this.fileLoader;if(i.type&&i.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+i.type+" buffer type is not supported.");if(i.uri===void 0&&t===0)return Promise.resolve(this.extensions[di.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(Gl.resolveURL(i.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+i.uri+'".'))})})}loadBufferView(t){const i=this.json.bufferViews[t];return this.getDependency("buffer",i.buffer).then(function(n){const r=i.byteLength||0,s=i.byteOffset||0;return n.slice(s,s+r)})}loadAccessor(t){const i=this,n=this.json,r=this.json.accessors[t];if(r.bufferView===void 0&&r.sparse===void 0){const o=NT[r.type],a=eg[r.componentType],l=r.normalized===!0,c=new a(r.count*o);return Promise.resolve(new wi(c,o,l))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=NT[r.type],c=eg[r.componentType],h=c.BYTES_PER_ELEMENT,u=h*l,d=r.byteOffset||0,f=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,p=r.normalized===!0;let g,m;if(f&&f!==u){const v=Math.floor(d/f),x="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+v+":"+r.count;let w=i.cache.get(x);w||(g=new c(a,v*f,r.count*f/h),w=new Jx(g,f/h),i.cache.add(x,w)),m=new Oh(w,l,d%f/h,p)}else a===null?g=new c(r.count*l):g=new c(a,d,r.count*l),m=new wi(g,l,p);if(r.sparse!==void 0){const v=NT.SCALAR,x=eg[r.sparse.indices.componentType],w=r.sparse.indices.byteOffset||0,b=r.sparse.values.byteOffset||0,M=new x(o[1],w,r.sparse.count*v),A=new c(o[2],b,r.sparse.count*l);a!==null&&(m=new wi(m.array.slice(),m.itemSize,m.normalized));for(let T=0,S=M.length;T<S;T++){const C=M[T];if(m.setX(C,A[T*l]),l>=2&&m.setY(C,A[T*l+1]),l>=3&&m.setZ(C,A[T*l+2]),l>=4&&m.setW(C,A[T*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return m})}loadTexture(t){const i=this.json,n=this.options,s=i.textures[t].source,o=i.images[s];let a=this.textureLoader;if(o.uri){const l=n.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(t,s,a)}loadTextureImage(t,i,n){const r=this,s=this.json,o=s.textures[t],a=s.images[i],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(i,n).then(function(h){h.flipY=!1,h.name=o.name||a.name||"",h.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(h.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return h.magFilter=d4[d.magFilter]||rn,h.minFilter=d4[d.minFilter]||Yl,h.wrapS=f4[d.wrapS]||Rh,h.wrapT=f4[d.wrapT]||Rh,r.associations.set(h,{textures:t}),h}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(t,i){const n=this,r=this.json,s=this.options;if(this.sourceCache[t]!==void 0)return this.sourceCache[t].then(u=>u.clone());const o=r.images[t],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=n.getDependency("bufferView",o.bufferView).then(function(u){c=!0;const d=new Blob([u],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(u){return new Promise(function(d,f){let p=d;i.isImageBitmapLoader===!0&&(p=function(g){const m=new en(g);m.needsUpdate=!0,d(m)}),i.load(Gl.resolveURL(u,s.path),p,void 0,f)})}).then(function(u){return c===!0&&a.revokeObjectURL(l),u.userData.mimeType=o.mimeType||ode(o.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),u});return this.sourceCache[t]=h,h}assignTexture(t,i,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),s.extensions[di.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[di.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[di.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&("colorSpace"in o?o.colorSpace=r===3001?"srgb":"srgb-linear":o.encoding=r),t[i]=o,o})}assignFinalMaterial(t){const i=t.geometry;let n=t.material;const r=i.attributes.tangent===void 0,s=i.attributes.color!==void 0,o=i.attributes.normal===void 0;if(t.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new Zx,Gn.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(t.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new Zr,Gn.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}t.material=n}getMaterialType(){return h1}loadMaterial(t){const i=this,n=this.json,r=this.extensions,s=n.materials[t];let o;const a={},l=s.extensions||{},c=[];if(l[di.KHR_MATERIALS_UNLIT]){const u=r[di.KHR_MATERIALS_UNLIT];o=u.getMaterialType(),c.push(u.extendParams(a,s,i))}else{const u=s.pbrMetallicRoughness||{};if(a.color=new ct(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){const d=u.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}u.baseColorTexture!==void 0&&c.push(i.assignTexture(a,"map",u.baseColorTexture,3001)),a.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,a.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(c.push(i.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),c.push(i.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(t)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(t,a)})))}s.doubleSided===!0&&(a.side=za);const h=s.alphaMode||zT.OPAQUE;if(h===zT.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===zT.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==co&&(c.push(i.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ve(1,1),s.normalTexture.scale!==void 0)){const u=s.normalTexture.scale;a.normalScale.set(u,u)}return s.occlusionTexture!==void 0&&o!==co&&(c.push(i.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==co&&(a.emissive=new ct().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==co&&c.push(i.assignTexture(a,"emissiveMap",s.emissiveTexture,3001)),Promise.all(c).then(function(){const u=new o(a);return s.name&&(u.name=s.name),Ju(u,s),i.associations.set(u,{materials:t}),s.extensions&&wd(r,u,s),u})}createUniqueName(t){const i=pi.sanitizeNodeName(t||"");return i in this.nodeNamesUsed?i+"_"+ ++this.nodeNamesUsed[i]:(this.nodeNamesUsed[i]=0,i)}loadGeometries(t){const i=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[di.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,i).then(function(l){return p4(l,a,i)})}const o=[];for(let a=0,l=t.length;a<l;a++){const c=t[a],h=sde(c),u=r[h];if(u)o.push(u.promise);else{let d;c.extensions&&c.extensions[di.KHR_DRACO_MESH_COMPRESSION]?d=s(c):d=p4(new Qt,c,i),r[h]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(t){const i=this,n=this.json,r=this.extensions,s=n.meshes[t],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const h=o[l].material===void 0?ide(this.cache):this.getDependency("material",o[l].material);a.push(h)}return a.push(i.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),h=l[l.length-1],u=[];for(let f=0,p=h.length;f<p;f++){const g=h[f],m=o[f];let v;const x=c[f];if(m.mode===Ho.TRIANGLES||m.mode===Ho.TRIANGLE_STRIP||m.mode===Ho.TRIANGLE_FAN||m.mode===void 0)v=s.isSkinnedMesh===!0?new YR(g,x):new $n(g,x),v.isSkinnedMesh===!0&&v.normalizeSkinWeights(),m.mode===Ho.TRIANGLE_STRIP?v.geometry=c4(v.geometry,RR):m.mode===Ho.TRIANGLE_FAN&&(v.geometry=c4(v.geometry,JA));else if(m.mode===Ho.LINES)v=new el(g,x);else if(m.mode===Ho.LINE_STRIP)v=new ou(g,x);else if(m.mode===Ho.LINE_LOOP)v=new QR(g,x);else if(m.mode===Ho.POINTS)v=new JR(g,x);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);Object.keys(v.geometry.morphAttributes).length>0&&rde(v,s),v.name=i.createUniqueName(s.name||"mesh_"+t),Ju(v,s),m.extensions&&wd(r,v,m),i.assignFinalMaterial(v),u.push(v)}for(let f=0,p=u.length;f<p;f++)i.associations.set(u[f],{meshes:t,primitives:f});if(u.length===1)return s.extensions&&wd(r,u[0],s),u[0];const d=new Vc;s.extensions&&wd(r,d,s),i.associations.set(d,{meshes:t});for(let f=0,p=u.length;f<p;f++)d.add(u[f]);return d})}loadCamera(t){let i;const n=this.json.cameras[t],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?i=new $i(OR.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(i=new Ya(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(i.name=this.createUniqueName(n.name)),Ju(i,n),Promise.resolve(i)}loadSkin(t){const i=this.json.skins[t],n=[];for(let r=0,s=i.joints.length;r<s;r++)n.push(this._loadNodeShallow(i.joints[r]));return i.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",i.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,h=o.length;c<h;c++){const u=o[c];if(u){a.push(u);const d=new Nt;s!==null&&d.fromArray(s.array,c*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',i.joints[c])}return new Kx(a,l)})}loadAnimation(t){const n=this.json.animations[t],r=n.name?n.name:"animation_"+t,s=[],o=[],a=[],l=[],c=[];for(let h=0,u=n.channels.length;h<u;h++){const d=n.channels[h],f=n.samplers[d.sampler],p=d.target,g=p.node,m=n.parameters!==void 0?n.parameters[f.input]:f.input,v=n.parameters!==void 0?n.parameters[f.output]:f.output;p.node!==void 0&&(s.push(this.getDependency("node",g)),o.push(this.getDependency("accessor",m)),a.push(this.getDependency("accessor",v)),l.push(f),c.push(p))}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c)]).then(function(h){const u=h[0],d=h[1],f=h[2],p=h[3],g=h[4],m=[];for(let v=0,x=u.length;v<x;v++){const w=u[v],b=d[v],M=f[v],A=p[v],T=g[v];if(w===void 0)continue;w.updateMatrix();let S;switch(Pu[T.path]){case Pu.weights:S=Tg;break;case Pu.rotation:S=Fh;break;case Pu.position:case Pu.scale:default:S=Pg;break}const C=w.name?w.name:w.uuid,P=A.interpolation!==void 0?tde[A.interpolation]:Rf,B=[];Pu[T.path]===Pu.weights?w.traverse(function(z){z.morphTargetInfluences&&B.push(z.name?z.name:z.uuid)}):B.push(C);let k=M.array;if(M.normalized){const z=L3(k.constructor),F=new Float32Array(k.length);for(let W=0,K=k.length;W<K;W++)F[W]=k[W]*z;k=F}for(let z=0,F=B.length;z<F;z++){const W=new S(B[z]+"."+Pu[T.path],b.array,k,P);A.interpolation==="CUBICSPLINE"&&(W.createInterpolant=function(Z){const U=this instanceof Fh?ede:IX;return new U(this.times,this.values,this.getValueSize()/3,Z)},W.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),m.push(W)}}return new Dg(r,void 0,m)})}createNodeMesh(t){const i=this.json,n=this,r=i.nodes[t];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(t){const i=this.json,n=this,r=i.nodes[t],s=n._loadNodeShallow(t),o=[],a=r.children||[];for(let c=0,h=a.length;c<h;c++)o.push(n.getDependency("node",a[c]));const l=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const h=c[0],u=c[1],d=c[2];d!==null&&h.traverse(function(f){f.isSkinnedMesh&&f.bind(d,ade)});for(let f=0,p=u.length;f<p;f++)h.add(u[f]);return h})}_loadNodeShallow(t){const i=this.json,n=this.extensions,r=this;if(this.nodeCache[t]!==void 0)return this.nodeCache[t];const s=i.nodes[t],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(t)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(t)}).forEach(function(c){a.push(c)}),this.nodeCache[t]=Promise.all(a).then(function(c){let h;if(s.isBone===!0?h=new BM:c.length>1?h=new Vc:c.length===1?h=c[0]:h=new fi,h!==c[0])for(let u=0,d=c.length;u<d;u++)h.add(c[u]);if(s.name&&(h.userData.name=s.name,h.name=o),Ju(h,s),s.extensions&&wd(n,h,s),s.matrix!==void 0){const u=new Nt;u.fromArray(s.matrix),h.applyMatrix4(u)}else s.translation!==void 0&&h.position.fromArray(s.translation),s.rotation!==void 0&&h.quaternion.fromArray(s.rotation),s.scale!==void 0&&h.scale.fromArray(s.scale);return r.associations.has(h)||r.associations.set(h,{}),r.associations.get(h).nodes=t,h}),this.nodeCache[t]}loadScene(t){const i=this.extensions,n=this.json.scenes[t],r=this,s=new Vc;n.name&&(s.name=r.createUniqueName(n.name)),Ju(s,n),n.extensions&&wd(i,s,n);const o=n.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let h=0,u=l.length;h<u;h++)s.add(l[h]);const c=h=>{const u=new Map;for(const[d,f]of r.associations)(d instanceof Gn||d instanceof en)&&u.set(d,f);return h.traverse(d=>{const f=r.associations.get(d);f!=null&&u.set(d,f)}),u};return r.associations=c(s),s})}}function cde(e,t,i){const n=t.attributes,r=new Xh;if(n.POSITION!==void 0){const a=i.json.accessors[n.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(r.set(new te(l[0],l[1],l[2]),new te(c[0],c[1],c[2])),a.normalized){const h=L3(eg[a.componentType]);r.min.multiplyScalar(h),r.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=t.targets;if(s!==void 0){const a=new te,l=new te;for(let c=0,h=s.length;c<h;c++){const u=s[c];if(u.POSITION!==void 0){const d=i.json.accessors[u.POSITION],f=d.min,p=d.max;if(f!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const g=L3(eg[d.componentType]);l.multiplyScalar(g)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}e.boundingBox=r;const o=new Yh;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,e.boundingSphere=o}function p4(e,t,i){const n=t.attributes,r=[];function s(o,a){return i.getDependency("accessor",o).then(function(l){e.setAttribute(a,l)})}for(const o in n){const a=B3[o]||o.toLowerCase();a in e.attributes||r.push(s(n[o],a))}if(t.indices!==void 0&&!e.index){const o=i.getDependency("accessor",t.indices).then(function(a){e.setIndex(a)});r.push(o)}return Ju(e,t),cde(e,t,i),Promise.all(r).then(function(){return t.targets!==void 0?nde(e,t.targets,i):e})}class ude extends Qt{constructor(t,i,n,r){super();const s=[],o=[],a=[],l=new te,c=new Nt;c.makeRotationFromEuler(n),c.setPosition(i);const h=new Nt;h.copy(c).invert(),u(),this.setAttribute("position",new wt(s,3)),this.setAttribute("normal",new wt(o,3)),this.setAttribute("uv",new wt(a,2));function u(){let g,m=[];const v=new te,x=new te;if(t.geometry.isGeometry===!0){console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");return}const w=t.geometry,b=w.attributes.position,M=w.attributes.normal;if(w.index!==null){const A=w.index;for(g=0;g<A.count;g++)v.fromBufferAttribute(b,A.getX(g)),x.fromBufferAttribute(M,A.getX(g)),d(m,v,x)}else for(g=0;g<b.count;g++)v.fromBufferAttribute(b,g),x.fromBufferAttribute(M,g),d(m,v,x);for(m=f(m,l.set(1,0,0)),m=f(m,l.set(-1,0,0)),m=f(m,l.set(0,1,0)),m=f(m,l.set(0,-1,0)),m=f(m,l.set(0,0,1)),m=f(m,l.set(0,0,-1)),g=0;g<m.length;g++){const A=m[g];a.push(.5+A.position.x/r.x,.5+A.position.y/r.y),A.position.applyMatrix4(c),s.push(A.position.x,A.position.y,A.position.z),o.push(A.normal.x,A.normal.y,A.normal.z)}}function d(g,m,v){m.applyMatrix4(t.matrixWorld),m.applyMatrix4(h),v.transformDirection(t.matrixWorld),g.push(new m4(m.clone(),v.clone()))}function f(g,m){const v=[],x=.5*Math.abs(r.dot(m));for(let w=0;w<g.length;w+=3){let b,M,A,T=0,S,C,P,B;const k=g[w+0].position.dot(m)-x,z=g[w+1].position.dot(m)-x,F=g[w+2].position.dot(m)-x;switch(b=k>0,M=z>0,A=F>0,T=(b?1:0)+(M?1:0)+(A?1:0),T){case 0:{v.push(g[w]),v.push(g[w+1]),v.push(g[w+2]);break}case 1:{if(b&&(S=g[w+1],C=g[w+2],P=p(g[w],S,m,x),B=p(g[w],C,m,x)),M){S=g[w],C=g[w+2],P=p(g[w+1],S,m,x),B=p(g[w+1],C,m,x),v.push(P),v.push(C.clone()),v.push(S.clone()),v.push(C.clone()),v.push(P.clone()),v.push(B);break}A&&(S=g[w],C=g[w+1],P=p(g[w+2],S,m,x),B=p(g[w+2],C,m,x)),v.push(S.clone()),v.push(C.clone()),v.push(P),v.push(B),v.push(P.clone()),v.push(C.clone());break}case 2:{b||(S=g[w].clone(),C=p(S,g[w+1],m,x),P=p(S,g[w+2],m,x),v.push(S),v.push(C),v.push(P)),M||(S=g[w+1].clone(),C=p(S,g[w+2],m,x),P=p(S,g[w],m,x),v.push(S),v.push(C),v.push(P)),A||(S=g[w+2].clone(),C=p(S,g[w],m,x),P=p(S,g[w+1],m,x),v.push(S),v.push(C),v.push(P));break}}}return v}function p(g,m,v,x){const w=g.position.dot(v)-x,b=m.position.dot(v)-x,M=w/(w-b);return new m4(new te(g.position.x+M*(m.position.x-g.position.x),g.position.y+M*(m.position.y-g.position.y),g.position.z+M*(m.position.z-g.position.z)),new te(g.normal.x+M*(m.normal.x-g.normal.x),g.normal.y+M*(m.normal.y-g.normal.y),g.normal.z+M*(m.normal.z-g.normal.z)))}}}class m4{constructor(t,i){this.position=t,this.normal=i}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}const UT=new WeakMap;class hde extends ws{constructor(t){super(t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(t){return this.decoderPath=t,this}setDecoderConfig(t){return this.decoderConfig=t,this}setWorkerLimit(t){return this.workerLimit=t,this}load(t,i,n,r){const s=new wo(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(i).catch(r)},n,r)}decodeDracoFile(t,i,n,r){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(t,s).then(i)}decodeGeometry(t,i){for(const l in i.attributeTypes){const c=i.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(i.attributeTypes[l]=c.name)}const n=JSON.stringify(i);if(UT.has(t)){const l=UT.get(t);if(l.key===n)return l.promise;if(t.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=t.byteLength,a=this._getWorker(s,o).then(l=>(r=l,new Promise((c,h)=>{r._callbacks[s]={resolve:c,reject:h},r.postMessage({type:"decode",id:s,taskConfig:i,buffer:t},[t])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),UT.set(t,{key:n,promise:a}),a}_createGeometry(t){const i=new Qt;t.index&&i.setIndex(new wi(t.index.array,1));for(let n=0;n<t.attributes.length;n++){const r=t.attributes[n],s=r.name,o=r.array,a=r.itemSize;i.setAttribute(s,new wi(o,a))}return i}_loadLibrary(t,i){const n=new wo(this.manager);return n.setPath(this.decoderPath),n.setResponseType(i),n.setWithCredentials(this.withCredentials),new Promise((r,s)=>{n.load(t,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const t=typeof WebAssembly!="object"||this.decoderConfig.type==="js",i=[];return t?i.push(this._loadLibrary("draco_decoder.js","text")):(i.push(this._loadLibrary("draco_wasm_wrapper.js","text")),i.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(i).then(n=>{const r=n[0];t||(this.decoderConfig.wasmBinary=n[1]);const s=dde.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(t,i){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[t]=i,n._taskLoad+=i,n})}_releaseTask(t,i){t._taskLoad-=t._taskCosts[i],delete t._callbacks[i],delete t._taskCosts[i]}debug(){console.log("Task load: ",this.workerPool.map(t=>t._taskLoad))}dispose(){for(let t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this}}function dde(){let e,t;onmessage=function(o){const a=o.data;switch(a.type){case"init":e=a.decoderConfig,t=new Promise(function(h){e.onModuleLoaded=function(u){h({draco:u})},DracoDecoderModule(e)});break;case"decode":const l=a.buffer,c=a.taskConfig;t.then(h=>{const u=h.draco,d=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{const p=i(u,d,f,c),g=p.attributes.map(m=>m.array.buffer);p.index&&g.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},g)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{u.destroy(f),u.destroy(d)}});break}};function i(o,a,l,c){const h=c.attributeIDs,u=c.attributeTypes;let d,f;const p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeBufferToMesh(l,d);else if(p===o.POINT_CLOUD)d=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const g={index:null,attributes:[]};for(const m in h){const v=self[u[m]];let x,w;if(c.useUniqueIDs)w=h[m],x=a.GetAttributeByUniqueId(d,w);else{if(w=a.GetAttributeId(d,o[h[m]]),w===-1)continue;x=a.GetAttribute(d,w)}g.attributes.push(r(o,a,d,m,v,x))}return p===o.TRIANGULAR_MESH&&(g.index=n(o,a,d)),o.destroy(d),g}function n(o,a,l){const h=l.num_faces()*3,u=h*4,d=o._malloc(u);a.GetTrianglesUInt32Array(l,u,d);const f=new Uint32Array(o.HEAPF32.buffer,d,h).slice();return o._free(d),{array:f,itemSize:1}}function r(o,a,l,c,h,u){const d=u.num_components(),p=l.num_points()*d,g=p*h.BYTES_PER_ELEMENT,m=s(o,h),v=o._malloc(g);a.GetAttributeDataArrayForAllPoints(l,u,m,g,v);const x=new h(o.HEAPF32.buffer,v,p).slice();return o._free(v),{name:c,array:x,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let D_;const GT=()=>{if(D_)return D_;const e="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",t="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",i=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let r=e;WebAssembly.validate(i)&&(r=t);let s;const o=WebAssembly.instantiate(a(r),{}).then(u=>{s=u.instance,s.exports.__wasm_call_ctors()});function a(u){const d=new Uint8Array(u.length);for(let p=0;p<u.length;++p){const g=u.charCodeAt(p);d[p]=g>96?g-71:g>64?g-65:g>47?g+4:g>46?63:62}let f=0;for(let p=0;p<u.length;++p)d[f++]=d[p]<60?n[d[p]]:(d[p]-60)*64+d[++p];return d.buffer.slice(0,f)}function l(u,d,f,p,g,m){const v=s.exports.sbrk,x=f+3&-4,w=v(x*p),b=v(g.length),M=new Uint8Array(s.exports.memory.buffer);M.set(g,b);const A=u(w,f,p,b,g.length);if(A===0&&m&&m(w,x,p),d.set(M.subarray(w,w+f*p)),v(w-v(0)),A!==0)throw new Error(`Malformed buffer data: ${A}`)}const c={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return D_={ready:o,supported:!0,decodeVertexBuffer(u,d,f,p,g){l(s.exports.meshopt_decodeVertexBuffer,u,d,f,p,s.exports[c[g]])},decodeIndexBuffer(u,d,f,p){l(s.exports.meshopt_decodeIndexBuffer,u,d,f,p)},decodeIndexSequence(u,d,f,p){l(s.exports.meshopt_decodeIndexSequence,u,d,f,p)},decodeGltfBuffer(u,d,f,p,g,m){l(s.exports[h[g]],u,d,f,p,s.exports[c[m]])}},D_},g4=e=>e===Object(e)&&!Array.isArray(e)&&typeof e!="function";function SI(e,t){const i=ro(r=>r.gl),n=Jh(d1,g4(e)?Object.values(e):e);if(ae.useLayoutEffect(()=>{t==null||t(n)},[t]),ae.useEffect(()=>{(Array.isArray(n)?n:[n]).forEach(i.initTexture)},[i,n]),g4(e)){const r=Object.keys(e),s={};return r.forEach(o=>Object.assign(s,{[o]:n[r.indexOf(o)]})),s}else return n}SI.preload=e=>Jh.preload(d1,e);SI.clear=e=>Jh.clear(d1,e);function fde(e){return Array.isArray(e)}function HT(e=[0,0,0]){return fde(e)?e:e instanceof te||e instanceof Wf?[e.x,e.y,e.z]:[e,e,e]}const pde=ae.forwardRef(function({debug:t,mesh:i,children:n,position:r,rotation:s,scale:o,...a},l){const c=ae.useRef(null);ae.useImperativeHandle(l,()=>c.current);const h=ae.useRef(null);return ae.useLayoutEffect(()=>{const u=(i==null?void 0:i.current)||c.current.parent,d=c.current;if(!(u instanceof $n))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');const f={position:new te,rotation:new Wf,scale:new te(1,1,1)};if(u){Tl(f,{position:r,scale:o});const p=u.matrixWorld.clone();if(u.matrixWorld.identity(),!s||typeof s=="number"){const g=new fi;g.position.copy(f.position),g.lookAt(u.position),typeof s=="number"&&g.rotateZ(s),Tl(f,{rotation:g.rotation})}else Tl(f,{rotation:s});return d.geometry=new ude(u,f.position,f.rotation,f.scale),h.current&&Tl(h.current,f),u.matrixWorld=p,()=>{d.geometry.dispose()}}},[i,...HT(r),...HT(o),...HT(s)]),ae.createElement("mesh",{ref:c},n||ae.createElement("meshStandardMaterial",ca({transparent:!0,polygonOffset:!0,polygonOffsetFactor:-10},a)),t&&ae.createElement("mesh",{ref:h},ae.createElement("boxGeometry",null),ae.createElement("meshNormalMaterial",{wireframe:!0}),ae.createElement("axesHelper",null)))});let B_=null;function OX(e,t,i){return n=>{i&&i(n),e&&(B_||(B_=new hde),B_.setDecoderPath(typeof e=="string"?e:"https://www.gstatic.com/draco/versioned/decoders/1.5.5/"),n.setDRACOLoader(B_)),t&&n.setMeshoptDecoder(typeof GT=="function"?GT():GT)}}function MI(e,t=!0,i=!0,n){return Jh(AI,e,OX(t,i,n))}MI.preload=(e,t=!0,i=!0,n)=>Jh.preload(AI,e,OX(t,i,n));MI.clear=e=>Jh.clear(AI,e);const FX=ae.forwardRef(({makeDefault:e,camera:t,regress:i,domElement:n,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...c},h)=>{const u=ro(A=>A.invalidate),d=ro(A=>A.camera),f=ro(A=>A.gl),p=ro(A=>A.events),g=ro(A=>A.setEvents),m=ro(A=>A.set),v=ro(A=>A.get),x=ro(A=>A.performance),w=t||d,b=n||p.connected||f.domElement,M=ae.useMemo(()=>new Bhe(w),[w]);return nv(()=>{M.enabled&&M.update()},-1),ae.useEffect(()=>(s&&M.connect(s===!0?b:s),M.connect(b),()=>void M.dispose()),[s,b,i,M,u]),ae.useEffect(()=>{const A=C=>{u(),i&&x.regress(),o&&o(C)},T=C=>{a&&a(C)},S=C=>{l&&l(C)};return M.addEventListener("change",A),M.addEventListener("start",T),M.addEventListener("end",S),()=>{M.removeEventListener("start",T),M.removeEventListener("end",S),M.removeEventListener("change",A)}},[o,a,l,M,u,g]),ae.useEffect(()=>{if(e){const A=v().controls;return m({controls:M}),()=>m({controls:A})}},[e,M]),ae.createElement("primitive",ca({ref:h,object:M,enableDamping:r},c))});class mde extends Zx{constructor(t){super(t),this.onBeforeCompile=(i,n)=>{const{isWebGL2:r}=n.capabilities;i.fragmentShader=i.fragmentShader.replace("#include <output_fragment>",`
        ${r?"#include <output_fragment>":`#extension GL_OES_standard_derivatives : enable
#include <output_fragment>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <encodings_fragment>
      `)}}}const gde=ae.forwardRef((e,t)=>{const[i]=ae.useState(()=>new mde(null));return ae.createElement("primitive",ca({},e,{object:i,ref:t,attach:"material"}))}),vde=ae.forwardRef(({children:e,enabled:t=!0,speed:i=1,rotationIntensity:n=1,floatIntensity:r=1,floatingRange:s=[-.1,.1],...o},a)=>{const l=ae.useRef(null),c=ae.useRef(Math.random()*1e4);return nv(h=>{var u,d;if(!t||i===0)return;const f=c.current+h.clock.getElapsedTime();l.current.rotation.x=Math.cos(f/4*i)/8*n,l.current.rotation.y=Math.sin(f/4*i)/8*n,l.current.rotation.z=Math.sin(f/4*i)/20*n;let p=Math.sin(f/4*i)/10;p=OR.mapLinear(p,-.1,.1,(u=s==null?void 0:s[0])!==null&&u!==void 0?u:-.1,(d=s==null?void 0:s[1])!==null&&d!==void 0?d:.1),l.current.position.y=p*r,l.current.updateMatrix()}),ae.createElement("group",o,ae.createElement("group",{ref:bI([l,a]),matrixAutoUpdate:!1},e))});let _d,l0;const yde=ae.createContext(null),v4=new Nt,y4=new te,xde=ae.forwardRef(({children:e,range:t,limit:i=1e3,...n},r)=>{const s=ae.useRef(null),[o,a]=ae.useState([]),[[l,c,h]]=ae.useState(()=>[new Float32Array(i*3),Float32Array.from({length:i*3},()=>1),Float32Array.from({length:i},()=>1)]);ae.useEffect(()=>{s.current.geometry.attributes.position.needsUpdate=!0}),nv(()=>{for(s.current.updateMatrix(),s.current.updateMatrixWorld(),v4.copy(s.current.matrixWorld).invert(),s.current.geometry.drawRange.count=Math.min(i,t!==void 0?t:i,o.length),_d=0;_d<o.length;_d++)l0=o[_d].current,l0.getWorldPosition(y4).applyMatrix4(v4),y4.toArray(l,_d*3),s.current.geometry.attributes.position.needsUpdate=!0,l0.matrixWorldNeedsUpdate=!0,l0.color.toArray(c,_d*3),s.current.geometry.attributes.color.needsUpdate=!0,h.set([l0.size],_d),s.current.geometry.attributes.size.needsUpdate=!0});const u=ae.useMemo(()=>({getParent:()=>s,subscribe:d=>(a(f=>[...f,d]),()=>a(f=>f.filter(p=>p.current!==d.current)))}),[]);return ae.createElement("points",ca({userData:{instances:o},matrixAutoUpdate:!1,ref:bI([r,s]),raycast:()=>null},n),ae.createElement("bufferGeometry",null,ae.createElement("bufferAttribute",{attach:"attributes-position",count:l.length/3,array:l,itemSize:3,usage:pf}),ae.createElement("bufferAttribute",{attach:"attributes-color",count:c.length/3,array:c,itemSize:3,usage:pf}),ae.createElement("bufferAttribute",{attach:"attributes-size",count:h.length,array:h,itemSize:1,usage:pf})),ae.createElement(yde.Provider,{value:u},e))}),wde=ae.forwardRef(({children:e,positions:t,colors:i,sizes:n,stride:r=3,...s},o)=>{const a=ae.useRef(null);return nv(()=>{const l=a.current.geometry.attributes;l.position.needsUpdate=!0,i&&(l.color.needsUpdate=!0),n&&(l.size.needsUpdate=!0)}),ae.createElement("points",ca({ref:bI([o,a])},s),ae.createElement("bufferGeometry",null,ae.createElement("bufferAttribute",{attach:"attributes-position",count:t.length/r,array:t,itemSize:r,usage:pf}),i&&ae.createElement("bufferAttribute",{attach:"attributes-color",count:i.length/r,array:i,itemSize:3,usage:pf}),n&&ae.createElement("bufferAttribute",{attach:"attributes-size",count:n.length/r,array:n,itemSize:1,usage:pf})),e)}),_de=ae.forwardRef((e,t)=>e.positions instanceof Float32Array?ae.createElement(wde,ca({},e,{ref:t})):ae.createElement(xde,ca({},e,{ref:t})));var NX={exports:{}},bde="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ade=bde,Sde=Ade;function zX(){}function kX(){}kX.resetWarningCache=zX;var Mde=function(){function e(n,r,s,o,a,l){if(l!==Sde){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var i={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:kX,resetWarningCache:zX};return i.PropTypes=i,i};NX.exports=Mde();var UX=NX.exports;function EI({all:e,scene:t,camera:i}){const n=ro(({gl:o})=>o),r=ro(({camera:o})=>o),s=ro(({scene:o})=>o);return ae.useLayoutEffect(()=>{const o=[];e&&(t||s).traverse(c=>{c.visible===!1&&(o.push(c),c.visible=!0)}),n.compile(t||s,i||r);const a=new GR(128);new UR(.01,1e5,a).update(n,t||s),a.dispose(),o.forEach(c=>c.visible=!1)},[]),null}const GX=()=>{const{progress:e}=_he();return Be(whe,{children:Be("span",{className:"canvas-load",children:Be("p",{style:{fontSize:14,color:"#f1f1f1",fontWeight:800,marginTop:40},children:e.toFixed(2)})})})},Ede=()=>{const e=MI("./planet/scene.gltf");return Be("primitive",{object:e.scene,scale:2.5,"position-y":0,"rotation-y":0})},Cde=()=>Be(wI,{shadows:!0,frameloop:"demand",dpr:[1,2],gl:{preserveDrawingBuffer:!0},camera:{fov:45,near:.1,far:200,position:[-4,3,6]},children:Et(ae.Suspense,{fallback:Be(GX,{}),children:[Be(FX,{autoRotate:!0,enableZoom:!1,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/2}),Be(Ede,{}),Be(EI,{all:!0})]})}),Tde=e=>{const[t]=SI([e.imgUrl]);return Et(vde,{speed:1.75,rotationIntensity:1,floatIntensity:2,children:[Be("ambientLight",{intensity:.25}),Be("directionalLight",{position:[0,0,.05]}),Et("mesh",{castShadow:!0,receiveShadow:!0,scale:2.75,children:[Be("icosahedronGeometry",{args:[1,1]}),Be("meshStandardMaterial",{color:"#fff8eb",polygonOffset:!0,polygonOffsetFactor:-5,flatShading:!0}),Be(pde,{position:[0,0,1],rotation:[2*Math.PI,0,6.25],scale:1,map:t,flatShading:!0})]})]})},Pde=({icon:e})=>Et(wI,{frameloop:"demand",dpr:[1,2],gl:{preserveDrawingBuffer:!0},children:[Et(ae.Suspense,{fallback:Be(GX,{}),children:[Be(FX,{enableZoom:!1}),Be(Tde,{imgUrl:e})]}),Be(EI,{all:!0})]}),Dde=e=>{const t=ae.useRef(),[i]=ae.useState(()=>The(new Float32Array(5001),{radius:1.2}));return nv((n,r)=>{t.current.rotation.x-=r/10,t.current.rotation.y-=r/15}),Be("group",{rotation:[0,0,Math.PI/4],children:Be(_de,{ref:t,positions:i,stride:3,frustumCulled:!0,...e,children:Be(gde,{transparent:!0,color:"#f272c8",size:.002,sizeAttenuation:!0,depthWrite:!1})})})},Bde=()=>Be("div",{className:"w-full h-auto absolute inset-0 z-[-1]",children:Et(wI,{camera:{position:[0,0,1]},children:[Be(ae.Suspense,{fallback:null,children:Be(Dde,{})}),Be(EI,{all:!0})]})}),HX=ae.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),NM=ae.createContext({});function Lde(){return ae.useContext(NM).visualElement}const CI=ae.createContext(null),zM=typeof document<"u",x4=zM?ae.useLayoutEffect:ae.useEffect,VX=ae.createContext({strict:!1});function Rde(e,t,i,n){const r=Lde(),s=ae.useContext(VX),o=ae.useContext(CI),a=ae.useContext(HX).reducedMotion,l=ae.useRef();n=n||s.renderer,!l.current&&n&&(l.current=n(e,{visualState:t,parent:r,props:i,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const c=l.current;return ae.useInsertionEffect(()=>{c&&c.update(i,o)}),x4(()=>{c&&c.render()}),ae.useEffect(()=>{c&&c.updateFeatures()}),(window.HandoffAppearAnimations?x4:ae.useEffect)(()=>{c&&c.animationState&&c.animationState.animateChanges()}),c}function Rm(e){return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Ide(e,t,i){return ae.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),i&&(typeof i=="function"?i(n):Rm(i)&&(i.current=n))},[t])}function fx(e){return typeof e=="string"||Array.isArray(e)}function kM(e){return typeof e=="object"&&typeof e.start=="function"}const TI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],PI=["initial",...TI];function UM(e){return kM(e.animate)||PI.some(t=>fx(e[t]))}function jX(e){return!!(UM(e)||e.variants)}function Ode(e,t){if(UM(e)){const{initial:i,animate:n}=e;return{initial:i===!1||fx(i)?i:void 0,animate:fx(n)?n:void 0}}return e.inherit!==!1?t:{}}function Fde(e){const{initial:t,animate:i}=Ode(e,ae.useContext(NM));return ae.useMemo(()=>({initial:t,animate:i}),[w4(t),w4(i)])}function w4(e){return Array.isArray(e)?e.join(" "):e}const _4={animation:["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag","whileInView"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},px={};for(const e in _4)px[e]={isEnabled:t=>_4[e].some(i=>!!t[i])};function Nde(e){for(const t in e)px[t]={...px[t],...e[t]}}function WX(e){const t=ae.useRef(null);return t.current===null&&(t.current=e()),t.current}const vy={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let zde=1;function kde(){return WX(()=>{if(vy.hasEverUpdated)return zde++})}const XX=ae.createContext({}),YX=ae.createContext({}),Ude=Symbol.for("motionComponentSymbol");function Gde({preloadedFeatures:e,createVisualElement:t,useRender:i,useVisualState:n,Component:r}){e&&Nde(e);function s(a,l){let c;const h={...ae.useContext(HX),...a,layoutId:Hde(a)},{isStatic:u}=h,d=Fde(a),f=u?void 0:kde(),p=n(a,u);if(!u&&zM){d.visualElement=Rde(r,p,h,t);const g=ae.useContext(YX),m=ae.useContext(VX).strict;d.visualElement&&(c=d.visualElement.loadFeatures(h,m,e,f,g))}return ae.createElement(NM.Provider,{value:d},c&&d.visualElement?ae.createElement(c,{visualElement:d.visualElement,...h}):null,i(r,a,f,Ide(p,d.visualElement,l),p,u,d.visualElement))}const o=ae.forwardRef(s);return o[Ude]=r,o}function Hde({layoutId:e}){const t=ae.useContext(XX).id;return t&&e!==void 0?t+"-"+e:e}function Vde(e){function t(n,r={}){return Gde(e(n,r))}if(typeof Proxy>"u")return t;const i=new Map;return new Proxy(t,{get:(n,r)=>(i.has(r)||i.set(r,t(r)),i.get(r))})}const jde=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function DI(e){return typeof e!="string"||e.includes("-")?!1:!!(jde.indexOf(e)>-1||/[A-Z]/.test(e))}const tS={};function Wde(e){Object.assign(tS,e)}const GM=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Jf=new Set(GM);function qX(e,{layout:t,layoutId:i}){return Jf.has(e)||e.startsWith("origin")||(t||i!==void 0)&&(!!tS[e]||e==="opacity")}const Xs=e=>!!(e&&e.getVelocity),Xde={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Yde=GM.length;function qde(e,{enableHardwareAcceleration:t=!0,allowTransformNone:i=!0},n,r){let s="";for(let o=0;o<Yde;o++){const a=GM[o];if(e[a]!==void 0){const l=Xde[a]||a;s+=`${l}(${e[a]}) `}}return t&&!e.z&&(s+="translateZ(0)"),s=s.trim(),r?s=r(e,n?"":s):i&&n&&(s="none"),s}const QX=e=>t=>typeof t=="string"&&t.startsWith(e),JX=QX("--"),R3=QX("var(--"),Qde=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Lg=(e,t,i)=>Math.min(Math.max(i,e),t),Kf={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},yy={...Kf,transform:e=>Lg(0,1,e)},L_={...Kf,default:1},xy=e=>Math.round(e*1e5)/1e5,mx=/(-)?([\d]*\.?[\d])+/g,I3=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Jde=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function m1(e){return typeof e=="string"}const g1=e=>({test:t=>m1(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Xu=g1("deg"),Hl=g1("%"),Ft=g1("px"),Kde=g1("vh"),Zde=g1("vw"),b4={...Hl,parse:e=>Hl.parse(e)/100,transform:e=>Hl.transform(e*100)},A4={...Kf,transform:Math.round},KX={borderWidth:Ft,borderTopWidth:Ft,borderRightWidth:Ft,borderBottomWidth:Ft,borderLeftWidth:Ft,borderRadius:Ft,radius:Ft,borderTopLeftRadius:Ft,borderTopRightRadius:Ft,borderBottomRightRadius:Ft,borderBottomLeftRadius:Ft,width:Ft,maxWidth:Ft,height:Ft,maxHeight:Ft,size:Ft,top:Ft,right:Ft,bottom:Ft,left:Ft,padding:Ft,paddingTop:Ft,paddingRight:Ft,paddingBottom:Ft,paddingLeft:Ft,margin:Ft,marginTop:Ft,marginRight:Ft,marginBottom:Ft,marginLeft:Ft,rotate:Xu,rotateX:Xu,rotateY:Xu,rotateZ:Xu,scale:L_,scaleX:L_,scaleY:L_,scaleZ:L_,skew:Xu,skewX:Xu,skewY:Xu,distance:Ft,translateX:Ft,translateY:Ft,translateZ:Ft,x:Ft,y:Ft,z:Ft,perspective:Ft,transformPerspective:Ft,opacity:yy,originX:b4,originY:b4,originZ:Ft,zIndex:A4,fillOpacity:yy,strokeOpacity:yy,numOctaves:A4};function BI(e,t,i,n){const{style:r,vars:s,transform:o,transformOrigin:a}=e;let l=!1,c=!1,h=!0;for(const u in t){const d=t[u];if(JX(u)){s[u]=d;continue}const f=KX[u],p=Qde(d,f);if(Jf.has(u)){if(l=!0,o[u]=p,!h)continue;d!==(f.default||0)&&(h=!1)}else u.startsWith("origin")?(c=!0,a[u]=p):r[u]=p}if(t.transform||(l||n?r.transform=qde(e.transform,i,h,n):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:f=0}=a;r.transformOrigin=`${u} ${d} ${f}`}}const LI=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function ZX(e,t,i){for(const n in t)!Xs(t[n])&&!qX(n,i)&&(e[n]=t[n])}function $de({transformTemplate:e},t,i){return ae.useMemo(()=>{const n=LI();return BI(n,t,{enableHardwareAcceleration:!i},e),Object.assign({},n.vars,n.style)},[t])}function efe(e,t,i){const n=e.style||{},r={};return ZX(r,n,e),Object.assign(r,$de(e,t,i)),e.transformValues?e.transformValues(r):r}function tfe(e,t,i){const n={},r=efe(e,t,i);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const ife=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function iS(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||ife.has(e)}let $X=e=>!iS(e);function nfe(e){e&&($X=t=>t.startsWith("on")?!iS(t):e(t))}try{nfe(require("@emotion/is-prop-valid").default)}catch{}function rfe(e,t,i){const n={};for(const r in e)r==="values"&&typeof e.values=="object"||($X(r)||i===!0&&iS(r)||!t&&!iS(r)||e.draggable&&r.startsWith("onDrag"))&&(n[r]=e[r]);return n}function S4(e,t,i){return typeof e=="string"?e:Ft.transform(t+i*e)}function sfe(e,t,i){const n=S4(t,e.x,e.width),r=S4(i,e.y,e.height);return`${n} ${r}`}const ofe={offset:"stroke-dashoffset",array:"stroke-dasharray"},afe={offset:"strokeDashoffset",array:"strokeDasharray"};function lfe(e,t,i=1,n=0,r=!0){e.pathLength=1;const s=r?ofe:afe;e[s.offset]=Ft.transform(-n);const o=Ft.transform(t),a=Ft.transform(i);e[s.array]=`${o} ${a}`}function RI(e,{attrX:t,attrY:i,originX:n,originY:r,pathLength:s,pathSpacing:o=1,pathOffset:a=0,...l},c,h,u){if(BI(e,l,c,u),h){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:f,dimensions:p}=e;d.transform&&(p&&(f.transform=d.transform),delete d.transform),p&&(n!==void 0||r!==void 0||f.transform)&&(f.transformOrigin=sfe(p,n!==void 0?n:.5,r!==void 0?r:.5)),t!==void 0&&(d.x=t),i!==void 0&&(d.y=i),s!==void 0&&lfe(d,s,o,a,!1)}const eY=()=>({...LI(),attrs:{}}),II=e=>typeof e=="string"&&e.toLowerCase()==="svg";function cfe(e,t,i,n){const r=ae.useMemo(()=>{const s=eY();return RI(s,t,{enableHardwareAcceleration:!1},II(n),e.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};ZX(s,e.style,e),r.style={...s,...r.style}}return r}function ufe(e=!1){return(i,n,r,s,{latestValues:o},a)=>{const c=(DI(i)?cfe:tfe)(n,o,a,i),u={...rfe(n,typeof i=="string",e),...c,ref:s},{children:d}=n,f=ae.useMemo(()=>Xs(d)?d.get():d,[d]);return r&&(u["data-projection-id"]=r),ae.createElement(i,{...u,children:f})}}const OI=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function tY(e,{style:t,vars:i},n,r){Object.assign(e.style,t,r&&r.getProjectionStyles(n));for(const s in i)e.style.setProperty(s,i[s])}const iY=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function nY(e,t,i,n){tY(e,t,void 0,n);for(const r in t.attrs)e.setAttribute(iY.has(r)?r:OI(r),t.attrs[r])}function FI(e,t){const{style:i}=e,n={};for(const r in i)(Xs(i[r])||t.style&&Xs(t.style[r])||qX(r,e))&&(n[r]=i[r]);return n}function rY(e,t){const i=FI(e,t);for(const n in e)if(Xs(e[n])||Xs(t[n])){const r=n==="x"||n==="y"?"attr"+n.toUpperCase():n;i[r]=e[n]}return i}function NI(e,t,i,n={},r={}){return typeof t=="function"&&(t=t(i!==void 0?i:e.custom,n,r)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(i!==void 0?i:e.custom,n,r)),t}const nS=e=>Array.isArray(e),hfe=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),dfe=e=>nS(e)?e[e.length-1]||0:e;function hA(e){const t=Xs(e)?e.get():e;return hfe(t)?t.toValue():t}function ffe({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:i},n,r,s){const o={latestValues:pfe(n,r,s,e),renderState:t()};return i&&(o.mount=a=>i(n,a,o)),o}const sY=e=>(t,i)=>{const n=ae.useContext(NM),r=ae.useContext(CI),s=()=>ffe(e,t,n,r);return i?s():WX(s)};function pfe(e,t,i,n){const r={},s=n(e,{});for(const d in s)r[d]=hA(s[d]);let{initial:o,animate:a}=e;const l=UM(e),c=jX(e);t&&c&&!l&&e.inherit!==!1&&(o===void 0&&(o=t.initial),a===void 0&&(a=t.animate));let h=i?i.initial===!1:!1;h=h||o===!1;const u=h?a:o;return u&&typeof u!="boolean"&&!kM(u)&&(Array.isArray(u)?u:[u]).forEach(f=>{const p=NI(e,f);if(!p)return;const{transitionEnd:g,transition:m,...v}=p;for(const x in v){let w=v[x];if(Array.isArray(w)){const b=h?w.length-1:0;w=w[b]}w!==null&&(r[x]=w)}for(const x in g)r[x]=g[x]}),r}const mfe={useVisualState:sY({scrapeMotionValuesFromProps:rY,createRenderState:eY,onMount:(e,t,{renderState:i,latestValues:n})=>{try{i.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{i.dimensions={x:0,y:0,width:0,height:0}}RI(i,n,{enableHardwareAcceleration:!1},II(t.tagName),e.transformTemplate),nY(t,i)}})},gfe={useVisualState:sY({scrapeMotionValuesFromProps:FI,createRenderState:LI})};function vfe(e,{forwardMotionProps:t=!1},i,n){return{...DI(e)?mfe:gfe,preloadedFeatures:i,useRender:ufe(t),createVisualElement:n,Component:e}}function jc(e,t,i,n={passive:!0}){return e.addEventListener(t,i,n),()=>e.removeEventListener(t,i)}const oY=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function HM(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const yfe=e=>t=>oY(t)&&e(t,HM(t));function Jc(e,t,i,n){return jc(e,t,yfe(i),n)}const xfe=(e,t)=>i=>t(e(i)),Mh=(...e)=>e.reduce(xfe);function aY(e){let t=null;return()=>{const i=()=>{t=null};return t===null?(t=e,i):!1}}const M4=aY("dragHorizontal"),E4=aY("dragVertical");function lY(e){let t=!1;if(e==="y")t=E4();else if(e==="x")t=M4();else{const i=M4(),n=E4();i&&n?t=()=>{i(),n()}:(i&&i(),n&&n())}return t}function cY(){const e=lY(!0);return e?(e(),!1):!0}class Kh{constructor(t){this.isMounted=!1,this.node=t}update(){}}function C4(e,t){const i="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),r=(s,o)=>{if(s.type==="touch"||cY())return;const a=e.getProps();e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",t),a[n]&&a[n](s,o)};return Jc(e.current,i,r,{passive:!e.getProps()[n]})}class wfe extends Kh{mount(){this.unmount=Mh(C4(this.node,!0),C4(this.node,!1))}unmount(){}}class _fe extends Kh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Mh(jc(this.node.current,"focus",()=>this.onFocus()),jc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const uY=(e,t)=>t?e===t?!0:uY(e,t.parentElement):!1,ia=e=>e;function VT(e,t){if(!t)return;const i=new PointerEvent("pointer"+e);t(i,HM(i))}class bfe extends Kh{constructor(){super(...arguments),this.removeStartListeners=ia,this.removeEndListeners=ia,this.removeAccessibleListeners=ia,this.startPointerPress=(t,i)=>{if(this.removeEndListeners(),this.isPressing)return;const n=this.node.getProps(),s=Jc(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:h}=this.node.getProps();uY(this.node.current,a.target)?c&&c(a,l):h&&h(a,l)},{passive:!(n.onTap||n.onPointerUp)}),o=Jc(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Mh(s,o),this.startPress(t,i)},this.startAccessiblePress=()=>{const t=s=>{if(s.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||VT("up",this.node.getProps().onTap)};this.removeEndListeners(),this.removeEndListeners=jc(this.node.current,"keyup",o),VT("down",(a,l)=>{this.startPress(a,l)})},i=jc(this.node.current,"keydown",t),n=()=>{this.isPressing&&VT("cancel",(s,o)=>this.cancelPress(s,o))},r=jc(this.node.current,"blur",n);this.removeAccessibleListeners=Mh(i,r)}}startPress(t,i){this.isPressing=!0;const{onTapStart:n,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&n(t,i)}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!cY()}cancelPress(t,i){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&n(t,i)}mount(){const t=this.node.getProps(),i=Jc(this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=jc(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Mh(i,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const O3=new WeakMap,jT=new WeakMap,Afe=e=>{const t=O3.get(e.target);t&&t(e)},Sfe=e=>{e.forEach(Afe)};function Mfe({root:e,...t}){const i=e||document;jT.has(i)||jT.set(i,{});const n=jT.get(i),r=JSON.stringify(t);return n[r]||(n[r]=new IntersectionObserver(Sfe,{root:e,...t})),n[r]}function Efe(e,t,i){const n=Mfe(t);return O3.set(e,i),n.observe(e),()=>{O3.delete(e),n.unobserve(e)}}const Cfe={some:0,all:1};class Tfe extends Kh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}viewportFallback(){requestAnimationFrame(()=>{this.hasEnteredView=!0;const{onViewportEnter:t}=this.node.getProps();t&&t(null),this.node.animationState&&this.node.animationState.setActive("whileInView",!0)})}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:i,margin:n,amount:r="some",once:s,fallback:o=!0}=t;if(typeof IntersectionObserver>"u"){o&&this.viewportFallback();return}const a={root:i?i.current:void 0,rootMargin:n,threshold:typeof r=="number"?r:Cfe[r]},l=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),f=h?u:d;f&&f(c)};return Efe(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:i}=this.node;["amount","margin","root"].some(Pfe(t,i))&&this.startObserver()}unmount(){}}function Pfe({viewport:e={}},{viewport:t={}}={}){return i=>e[i]!==t[i]}const Dfe={inView:{Feature:Tfe},tap:{Feature:bfe},focus:{Feature:_fe},hover:{Feature:wfe}};function hY(e,t){if(!Array.isArray(t))return!1;const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}const Bfe=e=>/^\-?\d*\.?\d+$/.test(e),Lfe=e=>/^0[^.\s]+$/.test(e),Kc={delta:0,timestamp:0},dY=1/60*1e3,Rfe=typeof performance<"u"?()=>performance.now():()=>Date.now(),fY=typeof window<"u"?e=>window.requestAnimationFrame(e):e=>setTimeout(()=>e(Rfe()),dY);function Ife(e){let t=[],i=[],n=0,r=!1,s=!1;const o=new WeakSet,a={schedule:(l,c=!1,h=!1)=>{const u=h&&r,d=u?t:i;return c&&o.add(l),d.indexOf(l)===-1&&(d.push(l),u&&r&&(n=t.length)),l},cancel:l=>{const c=i.indexOf(l);c!==-1&&i.splice(c,1),o.delete(l)},process:l=>{if(r){s=!0;return}if(r=!0,[t,i]=[i,t],i.length=0,n=t.length,n)for(let c=0;c<n;c++){const h=t[c];h(l),o.has(h)&&(a.schedule(h),e())}r=!1,s&&(s=!1,a.process(l))}};return a}const Ofe=40;let F3=!0,gx=!1,N3=!1;const v1=["read","update","preRender","render","postRender"],VM=v1.reduce((e,t)=>(e[t]=Ife(()=>gx=!0),e),{}),ms=v1.reduce((e,t)=>{const i=VM[t];return e[t]=(n,r=!1,s=!1)=>(gx||Nfe(),i.schedule(n,r,s)),e},{}),Nh=v1.reduce((e,t)=>(e[t]=VM[t].cancel,e),{}),WT=v1.reduce((e,t)=>(e[t]=()=>VM[t].process(Kc),e),{}),Ffe=e=>VM[e].process(Kc),pY=e=>{gx=!1,Kc.delta=F3?dY:Math.max(Math.min(e-Kc.timestamp,Ofe),1),Kc.timestamp=e,N3=!0,v1.forEach(Ffe),N3=!1,gx&&(F3=!1,fY(pY))},Nfe=()=>{gx=!0,F3=!0,N3||fY(pY)};function zI(e,t){e.indexOf(t)===-1&&e.push(t)}function kI(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}class UI{constructor(){this.subscriptions=[]}add(t){return zI(this.subscriptions,t),()=>kI(this.subscriptions,t)}notify(t,i,n){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](t,i,n);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(t,i,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function GI(e,t){return t?e*(1e3/t):0}const zfe=e=>!isNaN(parseFloat(e));class kfe{constructor(t,i={}){this.version="9.1.7",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,r=!0)=>{this.prev=this.current,this.current=n;const{delta:s,timestamp:o}=Kc;this.lastUpdated!==o&&(this.timeDelta=s,this.lastUpdated=o,ms.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>ms.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=zfe(this.current),this.owner=i.owner}onChange(t){return this.on("change",t)}on(t,i){this.events[t]||(this.events[t]=new UI);const n=this.events[t].add(i);return t==="change"?()=>{n(),ms.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,i){this.passiveEffect=t,this.stopPassiveEffect=i}set(t,i=!0){!i||!this.passiveEffect?this.updateAndNotify(t,i):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,i,n){this.set(i),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?GI(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=t(i)||null,this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){this.animation=null}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Rg(e,t){return new kfe(e,t)}const HI=(e,t)=>i=>!!(m1(i)&&Jde.test(i)&&i.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(i,t)),mY=(e,t,i)=>n=>{if(!m1(n))return n;const[r,s,o,a]=n.match(mx);return{[e]:parseFloat(r),[t]:parseFloat(s),[i]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Ufe=e=>Lg(0,255,e),XT={...Kf,transform:e=>Math.round(Ufe(e))},sf={test:HI("rgb","red"),parse:mY("red","green","blue"),transform:({red:e,green:t,blue:i,alpha:n=1})=>"rgba("+XT.transform(e)+", "+XT.transform(t)+", "+XT.transform(i)+", "+xy(yy.transform(n))+")"};function Gfe(e){let t="",i="",n="",r="";return e.length>5?(t=e.substring(1,3),i=e.substring(3,5),n=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),i=e.substring(2,3),n=e.substring(3,4),r=e.substring(4,5),t+=t,i+=i,n+=n,r+=r),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(n,16),alpha:r?parseInt(r,16)/255:1}}const z3={test:HI("#"),parse:Gfe,transform:sf.transform},Im={test:HI("hsl","hue"),parse:mY("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:i,alpha:n=1})=>"hsla("+Math.round(e)+", "+Hl.transform(xy(t))+", "+Hl.transform(xy(i))+", "+xy(yy.transform(n))+")"},as={test:e=>sf.test(e)||z3.test(e)||Im.test(e),parse:e=>sf.test(e)?sf.parse(e):Im.test(e)?Im.parse(e):z3.parse(e),transform:e=>m1(e)?e:e.hasOwnProperty("red")?sf.transform(e):Im.transform(e)},gY="${c}",vY="${n}";function Hfe(e){var t,i;return isNaN(e)&&m1(e)&&(((t=e.match(mx))===null||t===void 0?void 0:t.length)||0)+(((i=e.match(I3))===null||i===void 0?void 0:i.length)||0)>0}function rS(e){typeof e=="number"&&(e=`${e}`);const t=[];let i=0,n=0;const r=e.match(I3);r&&(i=r.length,e=e.replace(I3,gY),t.push(...r.map(as.parse)));const s=e.match(mx);return s&&(n=s.length,e=e.replace(mx,vY),t.push(...s.map(Kf.parse))),{values:t,numColors:i,numNumbers:n,tokenised:e}}function yY(e){return rS(e).values}function xY(e){const{values:t,numColors:i,tokenised:n}=rS(e),r=t.length;return s=>{let o=n;for(let a=0;a<r;a++)o=o.replace(a<i?gY:vY,a<i?as.transform(s[a]):xy(s[a]));return o}}const Vfe=e=>typeof e=="number"?0:e;function jfe(e){const t=yY(e);return xY(e)(t.map(Vfe))}const zh={test:Hfe,parse:yY,createTransformer:xY,getAnimatableNone:jfe},Wfe=new Set(["brightness","contrast","saturate","opacity"]);function Xfe(e){const[t,i]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=i.match(mx)||[];if(!n)return e;const r=i.replace(n,"");let s=Wfe.has(t)?1:0;return n!==i&&(s*=100),t+"("+s+r+")"}const Yfe=/([a-z-]*)\(.*?\)/g,k3={...zh,getAnimatableNone:e=>{const t=e.match(Yfe);return t?t.map(Xfe).join(" "):e}},qfe={...KX,color:as,backgroundColor:as,outlineColor:as,fill:as,stroke:as,borderColor:as,borderTopColor:as,borderRightColor:as,borderBottomColor:as,borderLeftColor:as,filter:k3,WebkitFilter:k3},VI=e=>qfe[e];function jI(e,t){let i=VI(e);return i!==k3&&(i=zh),i.getAnimatableNone?i.getAnimatableNone(t):void 0}const wY=e=>t=>t.test(e),Qfe={test:e=>e==="auto",parse:e=>e},_Y=[Kf,Ft,Hl,Xu,Zde,Kde,Qfe],c0=e=>_Y.find(wY(e)),Jfe=[..._Y,as,zh],Kfe=e=>Jfe.find(wY(e));function Zfe(e){const t={};return e.values.forEach((i,n)=>t[n]=i.get()),t}function $fe(e){const t={};return e.values.forEach((i,n)=>t[n]=i.getVelocity()),t}function jM(e,t,i){const n=e.getProps();return NI(n,t,i!==void 0?i:n.custom,Zfe(e),$fe(e))}function epe(e,t,i){e.hasValue(t)?e.getValue(t).set(i):e.addValue(t,Rg(i))}function tpe(e,t){const i=jM(e,t);let{transitionEnd:n={},transition:r={},...s}=i?e.makeTargetAnimatable(i,!1):{};s={...s,...n};for(const o in s){const a=dfe(s[o]);epe(e,o,a)}}function ipe(e,t,i){var n,r;const s=Object.keys(t).filter(a=>!e.hasValue(a)),o=s.length;if(o)for(let a=0;a<o;a++){const l=s[a],c=t[l];let h=null;Array.isArray(c)&&(h=c[0]),h===null&&(h=(r=(n=i[l])!==null&&n!==void 0?n:e.readValue(l))!==null&&r!==void 0?r:t[l]),h!=null&&(typeof h=="string"&&(Bfe(h)||Lfe(h))?h=parseFloat(h):!Kfe(h)&&zh.test(c)&&(h=jI(l,c)),e.addValue(l,Rg(h,{owner:e})),i[l]===void 0&&(i[l]=h),h!==null&&e.setBaseTarget(l,h))}}function npe(e,t){return t?(t[e]||t.default||t).from:void 0}function rpe(e,t,i){const n={};for(const r in e){const s=npe(r,t);if(s!==void 0)n[r]=s;else{const o=i.getValue(r);o&&(n[r]=o.get())}}return n}function sS(e){return!!(Xs(e)&&e.add)}const spe="framerAppearId",ope="data-"+OI(spe);let ape=ia,oS=ia;const dA=e=>e*1e3,lpe={current:!1},WI=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,XI=e=>t=>1-e(1-t),YI=e=>e*e,cpe=XI(YI),qI=WI(YI),on=(e,t,i)=>-i*e+i*t+e;function YT(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function upe({hue:e,saturation:t,lightness:i,alpha:n}){e/=360,t/=100,i/=100;let r=0,s=0,o=0;if(!t)r=s=o=i;else{const a=i<.5?i*(1+t):i+t-i*t,l=2*i-a;r=YT(l,a,e+1/3),s=YT(l,a,e),o=YT(l,a,e-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:n}}const qT=(e,t,i)=>{const n=e*e;return Math.sqrt(Math.max(0,i*(t*t-n)+n))},hpe=[z3,sf,Im],dpe=e=>hpe.find(t=>t.test(e));function T4(e){const t=dpe(e);let i=t.parse(e);return t===Im&&(i=upe(i)),i}const bY=(e,t)=>{const i=T4(e),n=T4(t),r={...i};return s=>(r.red=qT(i.red,n.red,s),r.green=qT(i.green,n.green,s),r.blue=qT(i.blue,n.blue,s),r.alpha=on(i.alpha,n.alpha,s),sf.transform(r))};function AY(e,t){return typeof e=="number"?i=>on(e,t,i):as.test(e)?bY(e,t):MY(e,t)}const SY=(e,t)=>{const i=[...e],n=i.length,r=e.map((s,o)=>AY(s,t[o]));return s=>{for(let o=0;o<n;o++)i[o]=r[o](s);return i}},fpe=(e,t)=>{const i={...e,...t},n={};for(const r in i)e[r]!==void 0&&t[r]!==void 0&&(n[r]=AY(e[r],t[r]));return r=>{for(const s in n)i[s]=n[s](r);return i}},MY=(e,t)=>{const i=zh.createTransformer(t),n=rS(e),r=rS(t);return n.numColors===r.numColors&&n.numNumbers>=r.numNumbers?Mh(SY(n.values,r.values),i):o=>`${o>0?t:e}`},vx=(e,t,i)=>{const n=t-e;return n===0?1:(i-e)/n},P4=(e,t)=>i=>on(e,t,i);function ppe(e){return typeof e=="number"?P4:typeof e=="string"?as.test(e)?bY:MY:Array.isArray(e)?SY:typeof e=="object"?fpe:P4}function mpe(e,t,i){const n=[],r=i||ppe(e[0]),s=e.length-1;for(let o=0;o<s;o++){let a=r(e[o],e[o+1]);if(t){const l=Array.isArray(t)?t[o]:t;a=Mh(l,a)}n.push(a)}return n}function EY(e,t,{clamp:i=!0,ease:n,mixer:r}={}){const s=e.length;oS(s===t.length),oS(!n||!Array.isArray(n)||n.length===s-1),e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=mpe(t,n,r),a=o.length,l=c=>{let h=0;if(a>1)for(;h<e.length-2&&!(c<e[h+1]);h++);const u=vx(e[h],e[h+1],c);return o[h](u)};return i?c=>l(Lg(e[0],e[s-1],c)):l}function gpe(e,t){const i=e[e.length-1];for(let n=1;n<=t;n++){const r=vx(0,t,n);e.push(on(i,1,r))}}function vpe(e){const t=[0];return gpe(t,e.length-1),t}function ype(e,t){return e.map(i=>i*t)}const CY=(e,t,i)=>(((1-3*i+3*t)*e+(3*i-6*t))*e+3*t)*e,xpe=1e-7,wpe=12;function _pe(e,t,i,n,r){let s,o,a=0;do o=t+(i-t)/2,s=CY(o,n,r)-e,s>0?i=o:t=o;while(Math.abs(s)>xpe&&++a<wpe);return o}function TY(e,t,i,n){if(e===t&&i===n)return ia;const r=s=>_pe(s,0,1,e,i);return s=>s===0||s===1?s:CY(r(s),t,n)}const PY=e=>1-Math.sin(Math.acos(e)),QI=XI(PY),bpe=WI(QI),DY=TY(.33,1.53,.69,.99),JI=XI(DY),Ape=WI(JI),Spe=e=>(e*=2)<1?.5*JI(e):.5*(2-Math.pow(2,-10*(e-1))),Mpe={linear:ia,easeIn:YI,easeInOut:qI,easeOut:cpe,circIn:PY,circInOut:bpe,circOut:QI,backIn:JI,backInOut:Ape,backOut:DY,anticipate:Spe},D4=e=>{if(Array.isArray(e)){oS(e.length===4);const[t,i,n,r]=e;return TY(t,i,n,r)}else if(typeof e=="string")return Mpe[e];return e},Epe=e=>Array.isArray(e)&&typeof e[0]!="number";function Cpe(e,t){return e.map(()=>t||qI).splice(0,e.length-1)}function U3({keyframes:e,ease:t=qI,times:i,duration:n=300}){e=[...e];const r=Epe(t)?t.map(D4):D4(t),s={done:!1,value:e[0]},o=ype(i&&i.length===e.length?i:vpe(e),n);function a(){return EY(o,e,{ease:Array.isArray(r)?r:Cpe(e,r)})}let l=a();return{next:c=>(s.value=l(c),s.done=c>=n,s),flipTarget:()=>{e.reverse(),l=a()}}}const QT=.001,Tpe=.01,B4=10,Ppe=.05,Dpe=1;function Bpe({duration:e=800,bounce:t=.25,velocity:i=0,mass:n=1}){let r,s;ape(e<=B4*1e3);let o=1-t;o=Lg(Ppe,Dpe,o),e=Lg(Tpe,B4,e/1e3),o<1?(r=c=>{const h=c*o,u=h*e,d=h-i,f=G3(c,o),p=Math.exp(-u);return QT-d/f*p},s=c=>{const u=c*o*e,d=u*i+i,f=Math.pow(o,2)*Math.pow(c,2)*e,p=Math.exp(-u),g=G3(Math.pow(c,2),o);return(-r(c)+QT>0?-1:1)*((d-f)*p)/g}):(r=c=>{const h=Math.exp(-c*e),u=(c-i)*e+1;return-QT+h*u},s=c=>{const h=Math.exp(-c*e),u=(i-c)*(e*e);return h*u});const a=5/e,l=Rpe(r,s,a);if(e=e*1e3,isNaN(l))return{stiffness:100,damping:10,duration:e};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:o*2*Math.sqrt(n*c),duration:e}}}const Lpe=12;function Rpe(e,t,i){let n=i;for(let r=1;r<Lpe;r++)n=n-e(n)/t(n);return n}function G3(e,t){return e*Math.sqrt(1-t*t)}const Ipe=["duration","bounce"],Ope=["stiffness","damping","mass"];function L4(e,t){return t.some(i=>e[i]!==void 0)}function Fpe(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!L4(e,Ope)&&L4(e,Ipe)){const i=Bpe(e);t={...t,...i,velocity:0,mass:1},t.isResolvedFromDuration=!0}return t}const Npe=5;function BY({keyframes:e,restDelta:t,restSpeed:i,...n}){let r=e[0],s=e[e.length-1];const o={done:!1,value:r},{stiffness:a,damping:l,mass:c,velocity:h,duration:u,isResolvedFromDuration:d}=Fpe(n);let f=zpe,p=h?-(h/1e3):0;const g=l/(2*Math.sqrt(a*c));function m(){const v=s-r,x=Math.sqrt(a/c)/1e3,w=Math.abs(v)<5;if(i||(i=w?.01:2),t||(t=w?.005:.5),g<1){const b=G3(x,g);f=M=>{const A=Math.exp(-g*x*M);return s-A*((p+g*x*v)/b*Math.sin(b*M)+v*Math.cos(b*M))}}else if(g===1)f=b=>s-Math.exp(-x*b)*(v+(p+x*v)*b);else{const b=x*Math.sqrt(g*g-1);f=M=>{const A=Math.exp(-g*x*M),T=Math.min(b*M,300);return s-A*((p+g*x*v)*Math.sinh(T)+b*v*Math.cosh(T))/b}}}return m(),{next:v=>{const x=f(v);if(d)o.done=v>=u;else{let w=p;if(v!==0)if(g<1){const A=Math.max(0,v-Npe);w=GI(x-f(A),v-A)}else w=0;const b=Math.abs(w)<=i,M=Math.abs(s-x)<=t;o.done=b&&M}return o.value=o.done?s:x,o},flipTarget:()=>{p=-p,[r,s]=[s,r],m()}}}BY.needsInterpolation=(e,t)=>typeof e=="string"||typeof t=="string";const zpe=e=>0;function kpe({keyframes:e=[0],velocity:t=0,power:i=.8,timeConstant:n=350,restDelta:r=.5,modifyTarget:s}){const o=e[0],a={done:!1,value:o};let l=i*t;const c=o+l,h=s===void 0?c:s(c);return h!==c&&(l=h-o),{next:u=>{const d=-l*Math.exp(-u/n);return a.done=!(d>r||d<-r),a.value=a.done?h:h+d,a},flipTarget:()=>{}}}const Upe={decay:kpe,keyframes:U3,tween:U3,spring:BY};function LY(e,t,i=0){return e-t-i}function Gpe(e,t=0,i=0,n=!0){return n?LY(t+-e,t,i):t-(e-t)+i}function Hpe(e,t,i,n){return n?e>=t+i:e<=-i}const Vpe=e=>{const t=({delta:i})=>e(i);return{start:()=>ms.update(t,!0),stop:()=>Nh.update(t)}};function aS({duration:e,driver:t=Vpe,elapsed:i=0,repeat:n=0,repeatType:r="loop",repeatDelay:s=0,keyframes:o,autoplay:a=!0,onPlay:l,onStop:c,onComplete:h,onRepeat:u,onUpdate:d,type:f="keyframes",...p}){const g=i;let m,v=0,x=e,w=!1,b=!0,M;const A=Upe[o.length>2?"keyframes":f]||U3,T=o[0],S=o[o.length-1];let C={done:!1,value:T};const{needsInterpolation:P}=A;P&&P(T,S)&&(M=EY([0,100],[T,S],{clamp:!1}),o=[0,100]);const B=A({...p,duration:e,keyframes:o});function k(){v++,r==="reverse"?(b=v%2===0,i=Gpe(i,x,s,b)):(i=LY(i,x,s),r==="mirror"&&B.flipTarget()),w=!1,u&&u()}function z(){m&&m.stop(),h&&h()}function F(K){b||(K=-K),i+=K,w||(C=B.next(Math.max(0,i)),M&&(C.value=M(C.value)),w=b?C.done:i<=0),d&&d(C.value),w&&(v===0&&(x=x!==void 0?x:i),v<n?Hpe(i,x,s,b)&&k():z())}function W(){l&&l(),m=t(F),m.start()}return a&&W(),{stop:()=>{c&&c(),m&&m.stop()},set currentTime(K){i=g,F(K)},sample:K=>{i=g;const Z=e&&typeof e=="number"?Math.max(e*.5,50):50;let U=0;for(F(0);U<=K;){const X=K-U;F(Math.min(X,Z)),U+=Z}return C}}}function jpe(e){return!e||Array.isArray(e)||typeof e=="string"&&RY[e]}const q0=([e,t,i,n])=>`cubic-bezier(${e}, ${t}, ${i}, ${n})`,RY={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:q0([0,.65,.55,1]),circOut:q0([.55,0,1,.45]),backIn:q0([.31,.01,.66,-.59]),backOut:q0([.33,1.53,.69,.99])};function Wpe(e){if(e)return Array.isArray(e)?q0(e):RY[e]}function Xpe(e,t,i,{delay:n=0,duration:r,repeat:s=0,repeatType:o="loop",ease:a,times:l}={}){return e.animate({[t]:i,offset:l},{delay:n,duration:r,easing:Wpe(a),fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const R4={waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate")},JT={},IY={};for(const e in R4)IY[e]=()=>(JT[e]===void 0&&(JT[e]=R4[e]()),JT[e]);function Ype(e,{repeat:t,repeatType:i="loop"}){const n=t&&i!=="loop"&&t%2===1?0:e.length-1;return e[n]}const qpe=new Set(["opacity","clipPath","filter","transform"]),R_=10;function Qpe(e,t,{onUpdate:i,onComplete:n,...r}){if(!(IY.waapi()&&qpe.has(t)&&!r.repeatDelay&&r.repeatType!=="mirror"&&r.damping!==0))return!1;let{keyframes:o,duration:a=300,elapsed:l=0,ease:c}=r;if(r.type==="spring"||!jpe(r.ease)){if(r.repeat===1/0)return;const u=aS({...r,elapsed:0});let d={done:!1,value:o[0]};const f=[];let p=0;for(;!d.done&&p<2e4;)d=u.sample(p),f.push(d.value),p+=R_;o=f,a=p-R_,c="linear"}const h=Xpe(e.owner.current,t,o,{...r,delay:-l,duration:a,ease:c});return h.onfinish=()=>{e.set(Ype(o,r)),ms.update(()=>h.cancel()),n&&n()},{get currentTime(){return h.currentTime||0},set currentTime(u){h.currentTime=u},stop:()=>{const{currentTime:u}=h;if(u){const d=aS({...r,autoplay:!1});e.setWithVelocity(d.sample(u-R_).value,d.sample(u).value,R_)}ms.update(()=>h.cancel())}}}function OY(e,t){const i=performance.now(),n=({timestamp:r})=>{const s=r-i;s>=t&&(Nh.read(n),e(s-t))};return ms.read(n,!0),()=>Nh.read(n)}function Jpe({keyframes:e,elapsed:t,onUpdate:i,onComplete:n}){const r=()=>{i&&i(e[e.length-1]),n&&n()};return t?{stop:OY(r,-t)}:r()}function Kpe({keyframes:e,velocity:t=0,min:i,max:n,power:r=.8,timeConstant:s=750,bounceStiffness:o=500,bounceDamping:a=10,restDelta:l=1,modifyTarget:c,driver:h,onUpdate:u,onComplete:d,onStop:f}){const p=e[0];let g;function m(b){return i!==void 0&&b<i||n!==void 0&&b>n}function v(b){return i===void 0?n:n===void 0||Math.abs(i-b)<Math.abs(n-b)?i:n}function x(b){g&&g.stop(),g=aS({keyframes:[0,1],velocity:0,...b,driver:h,onUpdate:M=>{u&&u(M),b.onUpdate&&b.onUpdate(M)},onComplete:d,onStop:f})}function w(b){x({type:"spring",stiffness:o,damping:a,restDelta:l,...b})}if(m(p))w({velocity:t,keyframes:[p,v(p)]});else{let b=r*t+p;typeof c<"u"&&(b=c(b));const M=v(b),A=M===i?-1:1;let T,S;const C=P=>{T=S,S=P,t=GI(P-T,Kc.delta),(A===1&&P>M||A===-1&&P<M)&&w({keyframes:[P,M],velocity:t})};x({type:"decay",keyframes:[p,0],velocity:t,timeConstant:s,power:r,restDelta:l,modifyTarget:c,onUpdate:m(b)?C:void 0})}return{stop:()=>g&&g.stop()}}const Zpe={type:"spring",stiffness:500,damping:25,restSpeed:10},$pe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),eme={type:"keyframes",duration:.8},tme={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ime=(e,{keyframes:t})=>t.length>2?eme:Jf.has(e)?e.startsWith("scale")?$pe(t[1]):Zpe:tme,H3=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&zh.test(t)&&!t.startsWith("url("));function nme({when:e,delay:t,delayChildren:i,staggerChildren:n,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:c,...h}){return!!Object.keys(h).length}function I4(e){return e===0||typeof e=="string"&&parseFloat(e)===0&&e.indexOf(" ")===-1}function O4(e){return typeof e=="number"?0:jI("",e)}function FY(e,t){return e[t]||e.default||e}function rme(e,t,i,n){const r=H3(t,i);let s=n.from!==void 0?n.from:e.get();return s==="none"&&r&&typeof i=="string"?s=jI(t,i):I4(s)&&typeof i=="string"?s=O4(i):!Array.isArray(i)&&I4(i)&&typeof s=="string"&&(i=O4(s)),Array.isArray(i)?(i[0]===null&&(i[0]=s),i):[s,i]}const KI=(e,t,i,n={})=>r=>{const s=FY(n,e)||{},o=s.delay||n.delay||0;let{elapsed:a=0}=n;a=a-dA(o);const l=rme(t,e,i,s),c=l[0],h=l[l.length-1],u=H3(e,c),d=H3(e,h);let f={keyframes:l,velocity:t.getVelocity(),...s,elapsed:a,onUpdate:p=>{t.set(p),s.onUpdate&&s.onUpdate(p)},onComplete:()=>{r(),s.onComplete&&s.onComplete()}};if(!u||!d||lpe.current||s.type===!1)return Jpe(f);if(s.type==="inertia")return Kpe(f);if(nme(s)||(f={...f,...ime(e,f)}),f.duration&&(f.duration=dA(f.duration)),f.repeatDelay&&(f.repeatDelay=dA(f.repeatDelay)),t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const p=Qpe(t,e,f);if(p)return p}return aS(f)};function sme(e,t,i={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const r=t.map(s=>V3(e,s,i));n=Promise.all(r)}else if(typeof t=="string")n=V3(e,t,i);else{const r=typeof t=="function"?jM(e,t,i.custom):t;n=NY(e,r,i)}return n.then(()=>e.notify("AnimationComplete",t))}function V3(e,t,i={}){const n=jM(e,t,i.custom);let{transition:r=e.getDefaultTransition()||{}}=n||{};i.transitionOverride&&(r=i.transitionOverride);const s=n?()=>NY(e,n,i):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:h,staggerDirection:u}=r;return ome(e,t,c+l,h,u,i)}:()=>Promise.resolve(),{when:a}=r;if(a){const[l,c]=a==="beforeChildren"?[s,o]:[o,s];return l().then(c)}else return Promise.all([s(),o(i.delay)])}function NY(e,t,{delay:i=0,transitionOverride:n,type:r}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:o,...a}=e.makeTargetAnimatable(t);const l=e.getValue("willChange");n&&(s=n);const c=[],h=r&&e.animationState&&e.animationState.getState()[r];for(const u in a){const d=e.getValue(u),f=a[u];if(!d||f===void 0||h&&lme(h,u))continue;const p={delay:i,elapsed:0,...s};if(window.HandoffAppearAnimations&&!d.hasAnimated){const m=e.getProps()[ope];m&&(p.elapsed=window.HandoffAppearAnimations(m,u,d,ms))}let g=d.start(KI(u,d,f,e.shouldReduceMotion&&Jf.has(u)?{type:!1}:p));sS(l)&&(l.add(u),g=g.then(()=>l.remove(u))),c.push(g)}return Promise.all(c).then(()=>{o&&tpe(e,o)})}function ome(e,t,i=0,n=0,r=1,s){const o=[],a=(e.variantChildren.size-1)*n,l=r===1?(c=0)=>c*n:(c=0)=>a-c*n;return Array.from(e.variantChildren).sort(ame).forEach((c,h)=>{c.notify("AnimationStart",t),o.push(V3(c,t,{...s,delay:i+l(h)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(o)}function ame(e,t){return e.sortNodePosition(t)}function lme({protectedKeys:e,needsAnimating:t},i){const n=e.hasOwnProperty(i)&&t[i]!==!0;return t[i]=!1,n}const cme=[...TI].reverse(),ume=TI.length;function hme(e){return t=>Promise.all(t.map(({animation:i,options:n})=>sme(e,i,n)))}function dme(e){let t=hme(e);const i=pme();let n=!0;const r=(l,c)=>{const h=jM(e,c);if(h){const{transition:u,transitionEnd:d,...f}=h;l={...l,...f,...d}}return l};function s(l){t=l(e)}function o(l,c){const h=e.getProps(),u=e.getVariantContext(!0)||{},d=[],f=new Set;let p={},g=1/0;for(let v=0;v<ume;v++){const x=cme[v],w=i[x],b=h[x]!==void 0?h[x]:u[x],M=fx(b),A=x===c?w.isActive:null;A===!1&&(g=v);let T=b===u[x]&&b!==h[x]&&M;if(T&&n&&e.manuallyAnimateOnMount&&(T=!1),w.protectedKeys={...p},!w.isActive&&A===null||!b&&!w.prevProp||kM(b)||typeof b=="boolean")continue;const S=fme(w.prevProp,b);let C=S||x===c&&w.isActive&&!T&&M||v>g&&M;const P=Array.isArray(b)?b:[b];let B=P.reduce(r,{});A===!1&&(B={});const{prevResolvedValues:k={}}=w,z={...k,...B},F=W=>{C=!0,f.delete(W),w.needsAnimating[W]=!0};for(const W in z){const K=B[W],Z=k[W];p.hasOwnProperty(W)||(K!==Z?nS(K)&&nS(Z)?!hY(K,Z)||S?F(W):w.protectedKeys[W]=!0:K!==void 0?F(W):f.add(W):K!==void 0&&f.has(W)?F(W):w.protectedKeys[W]=!0)}w.prevProp=b,w.prevResolvedValues=B,w.isActive&&(p={...p,...B}),n&&e.blockInitialAnimation&&(C=!1),C&&!T&&d.push(...P.map(W=>({animation:W,options:{type:x,...l}})))}if(f.size){const v={};f.forEach(x=>{const w=e.getBaseTarget(x);w!==void 0&&(v[x]=w)}),d.push({animation:v})}let m=!!d.length;return n&&h.initial===!1&&!e.manuallyAnimateOnMount&&(m=!1),n=!1,m?t(d):Promise.resolve()}function a(l,c,h){var u;if(i[l].isActive===c)return Promise.resolve();(u=e.variantChildren)===null||u===void 0||u.forEach(f=>{var p;return(p=f.animationState)===null||p===void 0?void 0:p.setActive(l,c)}),i[l].isActive=c;const d=o(h,l);for(const f in i)i[f].protectedKeys={};return d}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>i}}function fme(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!hY(t,e):!1}function bd(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function pme(){return{animate:bd(!0),whileInView:bd(),whileHover:bd(),whileTap:bd(),whileDrag:bd(),whileFocus:bd(),exit:bd()}}class mme extends Kh{constructor(t){super(t),t.animationState||(t.animationState=dme(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),kM(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:i}=this.node.prevProps||{};t!==i&&this.updateAnimationControlsSubscription()}unmount(){}}let gme=0;class vme extends Kh{constructor(){super(...arguments),this.id=gme++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:i,custom:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});i&&!t&&s.then(()=>i(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const yme={animation:{Feature:mme},exit:{Feature:vme}},F4=(e,t)=>Math.abs(e-t);function xme(e,t){const i=F4(e.x,t.x),n=F4(e.y,t.y);return Math.sqrt(i**2+n**2)}class zY{constructor(t,i,{transformPagePoint:n}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=ZT(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,u=xme(c.offset,{x:0,y:0})>=3;if(!h&&!u)return;const{point:d}=c,{timestamp:f}=Kc;this.history.push({...d,timestamp:f});const{onStart:p,onMove:g}=this.handlers;h||(p&&p(this.lastMoveEvent,c),this.startEvent=this.lastMoveEvent),g&&g(this.lastMoveEvent,c)},this.handlePointerMove=(c,h)=>{this.lastMoveEvent=c,this.lastMoveEventInfo=KT(h,this.transformPagePoint),ms.update(this.updatePoint,!0)},this.handlePointerUp=(c,h)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const{onEnd:u,onSessionEnd:d}=this.handlers,f=ZT(c.type==="pointercancel"?this.lastMoveEventInfo:KT(h,this.transformPagePoint),this.history);this.startEvent&&u&&u(c,f),d&&d(c,f)},!oY(t))return;this.handlers=i,this.transformPagePoint=n;const r=HM(t),s=KT(r,this.transformPagePoint),{point:o}=s,{timestamp:a}=Kc;this.history=[{...o,timestamp:a}];const{onSessionStart:l}=i;l&&l(t,ZT(s,this.history)),this.removeListeners=Mh(Jc(window,"pointermove",this.handlePointerMove),Jc(window,"pointerup",this.handlePointerUp),Jc(window,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Nh.update(this.updatePoint)}}function KT(e,t){return t?{point:t(e.point)}:e}function N4(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ZT({point:e},t){return{point:e,delta:N4(e,kY(t)),offset:N4(e,wme(t)),velocity:_me(t,.1)}}function wme(e){return e[0]}function kY(e){return e[e.length-1]}function _me(e,t){if(e.length<2)return{x:0,y:0};let i=e.length-1,n=null;const r=kY(e);for(;i>=0&&(n=e[i],!(r.timestamp-n.timestamp>dA(t)));)i--;if(!n)return{x:0,y:0};const s=(r.timestamp-n.timestamp)/1e3;if(s===0)return{x:0,y:0};const o={x:(r.x-n.x)/s,y:(r.y-n.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function _o(e){return e.max-e.min}function j3(e,t=0,i=.01){return Math.abs(e-t)<=i}function z4(e,t,i,n=.5){e.origin=n,e.originPoint=on(t.min,t.max,e.origin),e.scale=_o(i)/_o(t),(j3(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=on(i.min,i.max,e.origin)-e.originPoint,(j3(e.translate)||isNaN(e.translate))&&(e.translate=0)}function wy(e,t,i,n){z4(e.x,t.x,i.x,n?n.originX:void 0),z4(e.y,t.y,i.y,n?n.originY:void 0)}function k4(e,t,i){e.min=i.min+t.min,e.max=e.min+_o(t)}function bme(e,t,i){k4(e.x,t.x,i.x),k4(e.y,t.y,i.y)}function U4(e,t,i){e.min=t.min-i.min,e.max=e.min+_o(t)}function _y(e,t,i){U4(e.x,t.x,i.x),U4(e.y,t.y,i.y)}function Ame(e,{min:t,max:i},n){return t!==void 0&&e<t?e=n?on(t,e,n.min):Math.max(e,t):i!==void 0&&e>i&&(e=n?on(i,e,n.max):Math.min(e,i)),e}function G4(e,t,i){return{min:t!==void 0?e.min+t:void 0,max:i!==void 0?e.max+i-(e.max-e.min):void 0}}function Sme(e,{top:t,left:i,bottom:n,right:r}){return{x:G4(e.x,i,r),y:G4(e.y,t,n)}}function H4(e,t){let i=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([i,n]=[n,i]),{min:i,max:n}}function Mme(e,t){return{x:H4(e.x,t.x),y:H4(e.y,t.y)}}function Eme(e,t){let i=.5;const n=_o(e),r=_o(t);return r>n?i=vx(t.min,t.max-n,e.min):n>r&&(i=vx(e.min,e.max-r,t.min)),Lg(0,1,i)}function Cme(e,t){const i={};return t.min!==void 0&&(i.min=t.min-e.min),t.max!==void 0&&(i.max=t.max-e.min),i}const W3=.35;function Tme(e=W3){return e===!1?e=0:e===!0&&(e=W3),{x:V4(e,"left","right"),y:V4(e,"top","bottom")}}function V4(e,t,i){return{min:j4(e,t),max:j4(e,i)}}function j4(e,t){return typeof e=="number"?e:e[t]||0}const W4=()=>({translate:0,scale:1,origin:0,originPoint:0}),by=()=>({x:W4(),y:W4()}),X4=()=>({min:0,max:0}),Nn=()=>({x:X4(),y:X4()});function El(e){return[e("x"),e("y")]}function UY({top:e,left:t,right:i,bottom:n}){return{x:{min:t,max:i},y:{min:e,max:n}}}function Pme({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Dme(e,t){if(!t)return e;const i=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:i.y,left:i.x,bottom:n.y,right:n.x}}function $T(e){return e===void 0||e===1}function X3({scale:e,scaleX:t,scaleY:i}){return!$T(e)||!$T(t)||!$T(i)}function Fd(e){return X3(e)||GY(e)||e.z||e.rotate||e.rotateX||e.rotateY}function GY(e){return Y4(e.x)||Y4(e.y)}function Y4(e){return e&&e!=="0%"}function lS(e,t,i){const n=e-i,r=t*n;return i+r}function q4(e,t,i,n,r){return r!==void 0&&(e=lS(e,r,n)),lS(e,i,n)+t}function Y3(e,t=0,i=1,n,r){e.min=q4(e.min,t,i,n,r),e.max=q4(e.max,t,i,n,r)}function HY(e,{x:t,y:i}){Y3(e.x,t.translate,t.scale,t.originPoint),Y3(e.y,i.translate,i.scale,i.originPoint)}function Bme(e,t,i,n=!1){const r=i.length;if(!r)return;t.x=t.y=1;let s,o;for(let a=0;a<r;a++){s=i[a],o=s.projectionDelta;const l=s.instance;l&&l.style&&l.style.display==="contents"||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Om(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,HY(e,o)),n&&Fd(s.latestValues)&&Om(e,s.latestValues))}t.x=Q4(t.x),t.y=Q4(t.y)}function Q4(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Ku(e,t){e.min=e.min+t,e.max=e.max+t}function J4(e,t,[i,n,r]){const s=t[r]!==void 0?t[r]:.5,o=on(e.min,e.max,s);Y3(e,t[i],t[n],o,t.scale)}const Lme=["x","scaleX","originX"],Rme=["y","scaleY","originY"];function Om(e,t){J4(e.x,t,Lme),J4(e.y,t,Rme)}function VY(e,t){return UY(Dme(e.getBoundingClientRect(),t))}function Ime(e,t,i){const n=VY(e,i),{scroll:r}=t;return r&&(Ku(n.x,r.offset.x),Ku(n.y,r.offset.y)),n}const Ome=new WeakMap;class Fme{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Nn(),this.visualElement=t}start(t,{snapToCursor:i=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const r=l=>{this.stopAnimation(),i&&this.snapToCursor(HM(l,"page").point)},s=(l,c)=>{const{drag:h,dragPropagation:u,onDragStart:d}=this.getProps();if(h&&!u&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=lY(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),El(p=>{let g=this.getAxisMotionValue(p).get()||0;if(Hl.test(g)){const{projection:m}=this.visualElement;if(m&&m.layout){const v=m.layout.layoutBox[p];v&&(g=_o(v)*(parseFloat(g)/100))}}this.originPoint[p]=g}),d&&d(l,c);const{animationState:f}=this.visualElement;f&&f.setActive("whileDrag",!0)},o=(l,c)=>{const{dragPropagation:h,dragDirectionLock:u,onDirectionLock:d,onDrag:f}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:p}=c;if(u&&this.currentDirection===null){this.currentDirection=Nme(p),this.currentDirection!==null&&d&&d(this.currentDirection);return}this.updateAxis("x",c.point,p),this.updateAxis("y",c.point,p),this.visualElement.render(),f&&f(l,c)},a=(l,c)=>this.stop(l,c);this.panSession=new zY(t,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(t,i){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:r}=i;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&s(t,i)}cancel(){this.isDragging=!1;const{projection:t,animationState:i}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(t,i,n){const{drag:r}=this.getProps();if(!n||!I_(t,r,this.currentDirection))return;const s=this.getAxisMotionValue(t);let o=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(o=Ame(o,this.constraints[t],this.elastic[t])),s.set(o)}resolveConstraints(){const{dragConstraints:t,dragElastic:i}=this.getProps(),{layout:n}=this.visualElement.projection||{},r=this.constraints;t&&Rm(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=Sme(n.layoutBox,t):this.constraints=!1,this.elastic=Tme(i),r!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&El(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=Cme(n.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:i}=this.getProps();if(!t||!Rm(t))return!1;const n=t.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=Ime(n,r.root,this.visualElement.getTransformPagePoint());let o=Mme(r.layout.layoutBox,s);if(i){const a=i(Pme(o));this.hasMutatedConstraints=!!a,a&&(o=UY(a))}return o}startAnimation(t){const{drag:i,dragMomentum:n,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=El(h=>{if(!I_(h,i,this.currentDirection))return;let u=l&&l[h]||{};o&&(u={min:0,max:0});const d=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:n?t[h]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...s,...u};return this.startAxisValueAnimation(h,p)});return Promise.all(c).then(a)}startAxisValueAnimation(t,i){const n=this.getAxisMotionValue(t);return n.start(KI(t,n,0,i))}stopAnimation(){El(t=>this.getAxisMotionValue(t).stop())}getAxisMotionValue(t){const i="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),r=n[i];return r||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){El(i=>{const{drag:n}=this.getProps();if(!I_(i,n,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(i);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[i];s.set(t[i]-on(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:i}=this.getProps(),{projection:n}=this.visualElement;if(!Rm(i)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};El(o=>{const a=this.getAxisMotionValue(o);if(a){const l=a.get();r[o]=Eme({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),El(o=>{if(!I_(o,t,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(on(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;Ome.set(this.visualElement,this);const t=this.visualElement.current,i=Jc(t,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();Rm(l)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",n);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),n();const o=jc(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(El(h=>{const u=this.getAxisMotionValue(h);u&&(this.originPoint[h]+=l[h].translate,u.set(u.get()+l[h].translate))}),this.visualElement.render())});return()=>{o(),i(),s(),a&&a()}}getProps(){const t=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=W3,dragMomentum:a=!0}=t;return{...t,drag:i,dragDirectionLock:n,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function I_(e,t,i){return(t===!0||t===e)&&(i===null||i===e)}function Nme(e,t=10){let i=null;return Math.abs(e.y)>t?i="y":Math.abs(e.x)>t&&(i="x"),i}class zme extends Kh{constructor(t){super(t),this.removeGroupControls=ia,this.removeListeners=ia,this.controls=new Fme(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ia}unmount(){this.removeGroupControls(),this.removeListeners()}}class kme extends Kh{constructor(){super(...arguments),this.removePointerDownListener=ia}onPointerDown(t){this.session=new zY(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:i,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:t,onStart:i,onMove:n,onEnd:(s,o)=>{delete this.session,r&&r(s,o)}}}mount(){this.removePointerDownListener=Jc(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Ume(){const e=ae.useContext(CI);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:n}=e,r=ae.useId();return ae.useEffect(()=>n(r),[]),!t&&i?[!1,()=>i&&i(r)]:[!0]}function K4(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const u0={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Ft.test(e))e=parseFloat(e);else return e;const i=K4(e,t.target.x),n=K4(e,t.target.y);return`${i}% ${n}%`}},jY=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Gme(e){const t=jY.exec(e);if(!t)return[,];const[,i,n]=t;return[i,n]}function q3(e,t,i=1){const[n,r]=Gme(e);if(!n)return;const s=window.getComputedStyle(t).getPropertyValue(n);return s?s.trim():R3(r)?q3(r,t,i+1):r}function Hme(e,{...t},i){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:i};i&&(i={...i}),e.values.forEach(r=>{const s=r.get();if(!R3(s))return;const o=q3(s,n);o&&r.set(o)});for(const r in t){const s=t[r];if(!R3(s))continue;const o=q3(s,n);o&&(t[r]=o,i&&i[r]===void 0&&(i[r]=s))}return{target:t,transitionEnd:i}}const Z4="_$css",Vme={correct:(e,{treeScale:t,projectionDelta:i})=>{const n=e,r=e.includes("var("),s=[];r&&(e=e.replace(jY,f=>(s.push(f),Z4)));const o=zh.parse(e);if(o.length>5)return n;const a=zh.createTransformer(e),l=typeof o[0]!="number"?1:0,c=i.x.scale*t.x,h=i.y.scale*t.y;o[0+l]/=c,o[1+l]/=h;const u=on(c,h,.5);typeof o[2+l]=="number"&&(o[2+l]/=u),typeof o[3+l]=="number"&&(o[3+l]/=u);let d=a(o);if(r){let f=0;d=d.replace(Z4,()=>{const p=s[f];return f++,p})}return d}};class jme extends kx.Component{componentDidMount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:n,layoutId:r}=this.props,{projection:s}=t;Wde(Wme),s&&(i.group&&i.group.add(s),n&&n.register&&r&&n.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),vy.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:i,visualElement:n,drag:r,isPresent:s}=this.props,o=n.projection;return o&&(o.isPresent=s,r||t.layoutDependency!==i||i===void 0?o.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?o.promote():o.relegate()||ms.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),!t.currentAnimation&&t.isLead()&&this.safeToRemove())}componentWillUnmount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:n}=this.props,{projection:r}=t;r&&(r.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function WY(e){const[t,i]=Ume(),n=ae.useContext(XX);return kx.createElement(jme,{...e,layoutGroup:n,switchLayoutGroup:ae.useContext(YX),isPresent:t,safeToRemove:i})}const Wme={borderRadius:{...u0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:u0,borderTopRightRadius:u0,borderBottomLeftRadius:u0,borderBottomRightRadius:u0,boxShadow:Vme};function Xme(e,t,i={}){const n=Xs(e)?e:Rg(e);return n.start(KI("",n,t,i)),{stop:()=>n.stop(),isAnimating:()=>n.isAnimating()}}const XY=["TopLeft","TopRight","BottomLeft","BottomRight"],Yme=XY.length,$4=e=>typeof e=="string"?parseFloat(e):e,e5=e=>typeof e=="number"||Ft.test(e);function qme(e,t,i,n,r,s){r?(e.opacity=on(0,i.opacity!==void 0?i.opacity:1,Qme(n)),e.opacityExit=on(t.opacity!==void 0?t.opacity:1,0,Jme(n))):s&&(e.opacity=on(t.opacity!==void 0?t.opacity:1,i.opacity!==void 0?i.opacity:1,n));for(let o=0;o<Yme;o++){const a=`border${XY[o]}Radius`;let l=t5(t,a),c=t5(i,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||e5(l)===e5(c)?(e[a]=Math.max(on($4(l),$4(c),n),0),(Hl.test(c)||Hl.test(l))&&(e[a]+="%")):e[a]=c}(t.rotate||i.rotate)&&(e.rotate=on(t.rotate||0,i.rotate||0,n))}function t5(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Qme=YY(0,.5,QI),Jme=YY(.5,.95,ia);function YY(e,t,i){return n=>n<e?0:n>t?1:i(vx(e,t,n))}function i5(e,t){e.min=t.min,e.max=t.max}function Oo(e,t){i5(e.x,t.x),i5(e.y,t.y)}function n5(e,t,i,n,r){return e-=t,e=lS(e,1/i,n),r!==void 0&&(e=lS(e,1/r,n)),e}function Kme(e,t=0,i=1,n=.5,r,s=e,o=e){if(Hl.test(t)&&(t=parseFloat(t),t=on(o.min,o.max,t/100)-o.min),typeof t!="number")return;let a=on(s.min,s.max,n);e===s&&(a-=t),e.min=n5(e.min,t,i,a,r),e.max=n5(e.max,t,i,a,r)}function r5(e,t,[i,n,r],s,o){Kme(e,t[i],t[n],t[r],t.scale,s,o)}const Zme=["x","scaleX","originX"],$me=["y","scaleY","originY"];function s5(e,t,i,n){r5(e.x,t,Zme,i?i.x:void 0,n?n.x:void 0),r5(e.y,t,$me,i?i.y:void 0,n?n.y:void 0)}function o5(e){return e.translate===0&&e.scale===1}function qY(e){return o5(e.x)&&o5(e.y)}function Q3(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function a5(e){return _o(e.x)/_o(e.y)}class ege{constructor(){this.members=[]}add(t){zI(this.members,t),t.scheduleRender()}remove(t){if(kI(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(t){const i=this.members.findIndex(r=>t===r);if(i===0)return!1;let n;for(let r=i;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){n=s;break}}return n?(this.promote(n),!0):!1}promote(t,i){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,i&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:r}=t.options;r===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:i,resumingFrom:n}=t;i.onExitComplete&&i.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function l5(e,t,i){let n="";const r=e.x.translate/t.x,s=e.y.translate/t.y;if((r||s)&&(n=`translate3d(${r}px, ${s}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),i){const{rotate:l,rotateX:c,rotateY:h}=i;l&&(n+=`rotate(${l}deg) `),c&&(n+=`rotateX(${c}deg) `),h&&(n+=`rotateY(${h}deg) `)}const o=e.x.scale*t.x,a=e.y.scale*t.y;return(o!==1||a!==1)&&(n+=`scale(${o}, ${a})`),n||"none"}const tge=(e,t)=>e.depth-t.depth;class ige{constructor(){this.children=[],this.isDirty=!1}add(t){zI(this.children,t),this.isDirty=!0}remove(t){kI(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(tge),this.isDirty=!1,this.children.forEach(t)}}function nge(e){window.MotionDebug&&window.MotionDebug.record(e)}const c5=["","X","Y","Z"],u5=1e3;let rge=0;const Nd={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function QY({attachResizeListener:e,defaultParent:t,measureScroll:i,checkIsScrollRoot:n,resetTransform:r}){return class{constructor(o,a={},l=t==null?void 0:t()){this.id=rge++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.potentialNodes=new Map,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{Nd.totalNodes=Nd.resolvedTargetDeltas=Nd.recalculatedProjection=0,this.nodes.forEach(age),this.nodes.forEach(hge),this.nodes.forEach(dge),this.nodes.forEach(lge),nge(Nd)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.elementId=o,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0,o&&this.root.registerPotentialNode(o,this);for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new ige)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new UI),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}registerPotentialNode(o,a){this.potentialNodes.set(o,a)}mount(o,a=!1){if(this.instance)return;this.isSVG=o instanceof SVGElement&&o.tagName!=="svg",this.instance=o;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.elementId&&this.root.potentialNodes.delete(this.elementId),a&&(c||l)&&(this.isLayoutDirty=!0),e){let u;const d=()=>this.root.updateBlockedByResize=!1;e(o,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=OY(d,250),vy.hasAnimatedSinceResize&&(vy.hasAnimatedSinceResize=!1,this.nodes.forEach(d5))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||h.getDefaultTransition()||vge,{onLayoutAnimationStart:m,onLayoutAnimationComplete:v}=h.getProps(),x=!this.targetLayout||!Q3(this.targetLayout,p)||f,w=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||d&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,w);const b={...FY(g,"layout"),onPlay:m,onComplete:v};(h.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else!d&&this.animationProgress===0&&d5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Nh.preRender(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(fge),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const u=this.path[h];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}didUpdate(){if(this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(h5);return}this.isUpdating&&(this.isUpdating=!1,this.potentialNodes.size&&(this.potentialNodes.forEach(yge),this.potentialNodes.clear()),this.nodes.forEach(uge),this.nodes.forEach(sge),this.nodes.forEach(oge),this.clearAllSnapshots(),WT.update(),WT.preRender(),WT.render())}clearAllSnapshots(){this.nodes.forEach(cge),this.sharedNodes.forEach(pge)}scheduleUpdateProjection(){ms.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){ms.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Nn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:n(this.instance),offset:i(this.instance)})}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!qY(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;o&&(a||Fd(this.latestValues)||h)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),xge(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Nn();const a=o.measureViewportBox(),{scroll:l}=this.root;return l&&(Ku(a.x,l.offset.x),Ku(a.y,l.offset.y)),a}removeElementScroll(o){const a=Nn();Oo(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:h,options:u}=c;if(c!==this.root&&h&&u.layoutScroll){if(h.isRoot){Oo(a,o);const{scroll:d}=this.root;d&&(Ku(a.x,-d.offset.x),Ku(a.y,-d.offset.y))}Ku(a.x,h.offset.x),Ku(a.y,h.offset.y)}}return a}applyTransform(o,a=!1){const l=Nn();Oo(l,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Om(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Fd(h.latestValues)&&Om(l,h.latestValues)}return Fd(this.latestValues)&&Om(l,this.latestValues),l}removeTransform(o){const a=Nn();Oo(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Fd(c.latestValues))continue;X3(c.latestValues)&&c.updateSnapshot();const h=Nn(),u=c.measurePageBox();Oo(h,u),s5(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return Fd(this.latestValues)&&s5(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}resolveTargetDelta(){var o;const a=this.getLead();if(this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty),!((!!this.resumingFrom||this!==a)&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:u}=this.options;if(!(!this.layout||!(h||u))){if(!this.targetDelta&&!this.relativeTarget){const d=this.getClosestProjectingParent();d&&d.layout?(this.relativeParent=d,this.relativeTarget=Nn(),this.relativeTargetOrigin=Nn(),_y(this.relativeTargetOrigin,this.layout.layoutBox,d.layout.layoutBox),Oo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Nn(),this.targetWithTransforms=Nn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?bme(this.target,this.relativeTarget,this.relativeParent.target):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Oo(this.target,this.layout.layoutBox),HY(this.target,this.targetDelta)):Oo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const d=this.getClosestProjectingParent();d&&!!d.resumingFrom==!!this.resumingFrom&&!d.options.layoutScroll&&d.target?(this.relativeParent=d,this.relativeTarget=Nn(),this.relativeTargetOrigin=Nn(),_y(this.relativeTargetOrigin,this.target,d.target),Oo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Nd.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||X3(this.parent.latestValues)||GY(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),c)return;const{layout:h,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||u))return;Oo(this.layoutCorrected,this.layout.layoutBox),Bme(this.layoutCorrected,this.treeScale,this.path,l);const{target:d}=a;if(!d)return;this.projectionDelta||(this.projectionDelta=by(),this.projectionDeltaWithTransform=by());const f=this.treeScale.x,p=this.treeScale.y,g=this.projectionTransform;wy(this.projectionDelta,this.layoutCorrected,d,this.latestValues),this.projectionTransform=l5(this.projectionDelta,this.treeScale),(this.projectionTransform!==g||this.treeScale.x!==f||this.treeScale.y!==p)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",d)),Nd.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},u=by();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=Nn(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,g=f!==p,m=this.getStack(),v=!m||m.members.length<=1,x=!!(g&&!v&&this.options.crossfade===!0&&!this.path.some(gge));this.animationProgress=0;let w;this.mixTargetDelta=b=>{const M=b/1e3;f5(u.x,o.x,M),f5(u.y,o.y,M),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(_y(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mge(this.relativeTarget,this.relativeTargetOrigin,d,M),w&&Q3(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=Nn()),Oo(w,this.relativeTarget)),g&&(this.animationValues=h,qme(h,c,this.latestValues,M,x,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=M},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Nh.update(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ms.update(()=>{vy.hasAnimatedSinceResize=!0,this.currentAnimation=Xme(0,u5,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(u5),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:h}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&JY(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Nn();const u=_o(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+u;const d=_o(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}Oo(a,l),Om(a,h),wy(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new ege),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(a=!0),!a)return;const c={};for(let h=0;h<c5.length;h++){const u="rotate"+c5[h];l[u]&&(c[u]=l[u],o.setStaticValue(u,0))}o.render();for(const h in c)o.setStaticValue(h,c[h]);o.scheduleRender()}getProjectionStyles(o={}){var a,l;const c={};if(!this.instance||this.isSVG)return c;if(this.isVisible)c.visibility="";else return{visibility:"hidden"};const h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=hA(o.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=hA(o.pointerEvents)||""),this.hasProjected&&!Fd(this.latestValues)&&(g.transform=h?h({},""):"none",this.hasProjected=!1),g}const d=u.animationValues||u.latestValues;this.applyTransformsToTarget(),c.transform=l5(this.projectionDeltaWithTransform,this.treeScale,d),h&&(c.transform=h(d,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,u.animationValues?c.opacity=u===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const g in tS){if(d[g]===void 0)continue;const{correct:m,applyTo:v}=tS[g],x=c.transform==="none"?d[g]:m(d[g],u);if(v){const w=v.length;for(let b=0;b<w;b++)c[v[b]]=x}else c[g]=x}return this.options.layoutId&&(c.pointerEvents=u===this?hA(o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(h5),this.root.sharedNodes.clear()}}}function sge(e){e.updateLayout()}function oge(e){var t;const i=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&i&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=e.layout,{animationType:s}=e.options,o=i.source!==e.layout.source;s==="size"?El(u=>{const d=o?i.measuredBox[u]:i.layoutBox[u],f=_o(d);d.min=n[u].min,d.max=d.min+f}):JY(s,i.layoutBox,n)&&El(u=>{const d=o?i.measuredBox[u]:i.layoutBox[u],f=_o(n[u]);d.max=d.min+f});const a=by();wy(a,n,i.layoutBox);const l=by();o?wy(l,e.applyTransform(r,!0),i.measuredBox):wy(l,n,i.layoutBox);const c=!qY(a);let h=!1;if(!e.resumeFrom){const u=e.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:d,layout:f}=u;if(d&&f){const p=Nn();_y(p,i.layoutBox,d.layoutBox);const g=Nn();_y(g,n,f.layoutBox),Q3(p,g)||(h=!0),u.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=p,e.relativeParent=u)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:i,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function age(e){Nd.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function lge(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function cge(e){e.clearSnapshot()}function h5(e){e.clearMeasurements()}function uge(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function d5(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0}function hge(e){e.resolveTargetDelta()}function dge(e){e.calcProjection()}function fge(e){e.resetRotation()}function pge(e){e.removeLeadSnapshot()}function f5(e,t,i){e.translate=on(t.translate,0,i),e.scale=on(t.scale,1,i),e.origin=t.origin,e.originPoint=t.originPoint}function p5(e,t,i,n){e.min=on(t.min,i.min,n),e.max=on(t.max,i.max,n)}function mge(e,t,i,n){p5(e.x,t.x,i.x,n),p5(e.y,t.y,i.y,n)}function gge(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const vge={duration:.45,ease:[.4,0,.1,1]};function yge(e,t){let i=e.root;for(let s=e.path.length-1;s>=0;s--)if(e.path[s].instance){i=e.path[s];break}const r=(i&&i!==e.root?i.instance:document).querySelector(`[data-projection-id="${t}"]`);r&&e.mount(r,!0)}function m5(e){e.min=Math.round(e.min),e.max=Math.round(e.max)}function xge(e){m5(e.x),m5(e.y)}function JY(e,t,i){return e==="position"||e==="preserve-aspect"&&!j3(a5(t),a5(i),.2)}const wge=QY({attachResizeListener:(e,t)=>jc(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),e2={current:void 0},KY=QY({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!e2.current){const e=new wge(0,{});e.mount(window),e.setOptions({layoutScroll:!0}),e2.current=e}return e2.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),_ge={pan:{Feature:kme},drag:{Feature:zme,ProjectionNode:KY,MeasureLayout:WY}},bge=new Set(["width","height","top","left","right","bottom","x","y"]),ZY=e=>bge.has(e),Age=e=>Object.keys(e).some(ZY),g5=e=>e===Kf||e===Ft,v5=(e,t)=>parseFloat(e.split(", ")[t]),y5=(e,t)=>(i,{transform:n})=>{if(n==="none"||!n)return 0;const r=n.match(/^matrix3d\((.+)\)$/);if(r)return v5(r[1],t);{const s=n.match(/^matrix\((.+)\)$/);return s?v5(s[1],e):0}},Sge=new Set(["x","y","z"]),Mge=GM.filter(e=>!Sge.has(e));function Ege(e){const t=[];return Mge.forEach(i=>{const n=e.getValue(i);n!==void 0&&(t.push([i,n.get()]),n.set(i.startsWith("scale")?1:0))}),t.length&&e.render(),t}const x5={width:({x:e},{paddingLeft:t="0",paddingRight:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),height:({y:e},{paddingTop:t="0",paddingBottom:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:y5(4,13),y:y5(5,14)},Cge=(e,t,i)=>{const n=t.measureViewportBox(),r=t.current,s=getComputedStyle(r),{display:o}=s,a={};o==="none"&&t.setStaticValue("display",e.display||"block"),i.forEach(c=>{a[c]=x5[c](n,s)}),t.render();const l=t.measureViewportBox();return i.forEach(c=>{const h=t.getValue(c);h&&h.jump(a[c]),e[c]=x5[c](l,s)}),e},Tge=(e,t,i={},n={})=>{t={...t},n={...n};const r=Object.keys(t).filter(ZY);let s=[],o=!1;const a=[];if(r.forEach(l=>{const c=e.getValue(l);if(!e.hasValue(l))return;let h=i[l],u=c0(h);const d=t[l];let f;if(nS(d)){const p=d.length,g=d[0]===null?1:0;h=d[g],u=c0(h);for(let m=g;m<p;m++)f?oS(c0(d[m])===f):f=c0(d[m])}else f=c0(d);if(u!==f)if(g5(u)&&g5(f)){const p=c.get();typeof p=="string"&&c.set(parseFloat(p)),typeof d=="string"?t[l]=parseFloat(d):Array.isArray(d)&&f===Ft&&(t[l]=d.map(parseFloat))}else u!=null&&u.transform&&(f!=null&&f.transform)&&(h===0||d===0)?h===0?c.set(f.transform(h)):t[l]=u.transform(d):(o||(s=Ege(e),o=!0),a.push(l),n[l]=n[l]!==void 0?n[l]:t[l],c.jump(d))}),a.length){const l=a.indexOf("height")>=0?window.pageYOffset:null,c=Cge(t,e,a);return s.length&&s.forEach(([h,u])=>{e.getValue(h).set(u)}),e.render(),zM&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:n}}else return{target:t,transitionEnd:n}};function Pge(e,t,i,n){return Age(t)?Tge(e,t,i,n):{target:t,transitionEnd:n}}const Dge=(e,t,i,n)=>{const r=Hme(e,t,n);return t=r.target,n=r.transitionEnd,Pge(e,t,i,n)},J3={current:null},$Y={current:!1};function Bge(){if($Y.current=!0,!!zM)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>J3.current=e.matches;e.addListener(t),t()}else J3.current=!1}function Lge(e,t,i){const{willChange:n}=t;for(const r in t){const s=t[r],o=i[r];if(Xs(s))e.addValue(r,s),sS(n)&&n.add(r);else if(Xs(o))e.addValue(r,Rg(s,{owner:e})),sS(n)&&n.remove(r);else if(o!==s)if(e.hasValue(r)){const a=e.getValue(r);!a.hasAnimated&&a.set(s)}else{const a=e.getStaticValue(r);e.addValue(r,Rg(a!==void 0?a:s,{owner:e}))}}for(const r in i)t[r]===void 0&&e.removeValue(r);return t}const eq=Object.keys(px),Rge=eq.length,w5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Ige=PI.length;class Oge{constructor({parent:t,props:i,presenceContext:n,reducedMotionConfig:r,visualState:s},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>ms.render(this.render,!1,!0);const{latestValues:a,renderState:l}=s;this.latestValues=a,this.baseTarget={...a},this.initialValues=i.initial?{...a}:{},this.renderState=l,this.parent=t,this.props=i,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.isControllingVariants=UM(i),this.isVariantNode=jX(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...h}=this.scrapeMotionValuesFromProps(i,{});for(const u in h){const d=h[u];a[u]!==void 0&&Xs(d)&&(d.set(a[u],!1),sS(c)&&c.add(u))}}scrapeMotionValuesFromProps(t,i){return{}}mount(t){this.current=t,this.projection&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,n)=>this.bindToMotionValue(n,i)),$Y.current||Bge(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:J3.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Nh.update(this.notifyUpdate),Nh.render(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,i){const n=Jf.has(t),r=i.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ms.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),s=i.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{r(),s()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...i},n,r,s,o){let a,l;for(let c=0;c<Rge;c++){const h=eq[c],{isEnabled:u,Feature:d,ProjectionNode:f,MeasureLayout:p}=px[h];f&&(a=f),u(i)&&(!this.features[h]&&d&&(this.features[h]=new d(this)),p&&(l=p))}if(!this.projection&&a){this.projection=new a(s,this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:h,drag:u,dragConstraints:d,layoutScroll:f,layoutRoot:p}=i;this.projection.setOptions({layoutId:c,layout:h,alwaysMeasureLayout:!!u||d&&Rm(d),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof h=="string"?h:"both",initialPromotionConfig:o,layoutScroll:f,layoutRoot:p})}return l}updateFeatures(){for(const t in this.features){const i=this.features[t];i.isMounted?i.update(this.props,this.prevProps):(i.mount(),i.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Nn()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,i){this.latestValues[t]=i}makeTargetAnimatable(t,i=!0){return this.makeTargetAnimatableFromInstance(t,this.props,i)}update(t,i){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let n=0;n<w5.length;n++){const r=w5[n];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s=t["on"+r];s&&(this.propEventSubscriptions[r]=this.on(r,s))}this.prevMotionValues=Lge(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const i={};for(let n=0;n<Ige;n++){const r=PI[n],s=this.props[r];(fx(s)||s===!1)&&(i[r]=s)}return i}addVariantChild(t){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(t),()=>i.variantChildren.delete(t)}addValue(t,i){i!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,i)),this.values.set(t,i),this.latestValues[t]=i.get()}removeValue(t){this.values.delete(t);const i=this.valueSubscriptions.get(t);i&&(i(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,i){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&i!==void 0&&(n=Rg(i,{owner:this}),this.addValue(t,n)),n}readValue(t){return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,i){this.baseTarget[t]=i}getBaseTarget(t){var i;const{initial:n}=this.props,r=typeof n=="string"||typeof n=="object"?(i=NI(this.props,n))===null||i===void 0?void 0:i[t]:void 0;if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Xs(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,i){return this.events[t]||(this.events[t]=new UI),this.events[t].add(i)}notify(t,...i){this.events[t]&&this.events[t].notify(...i)}}class tq extends Oge{sortInstanceNodePosition(t,i){return t.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(t,i){return t.style?t.style[i]:void 0}removeValueFromRenderState(t,{vars:i,style:n}){delete i[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:i,...n},{transformValues:r},s){let o=rpe(n,t||{},this);if(r&&(i&&(i=r(i)),n&&(n=r(n)),o&&(o=r(o))),s){ipe(this,n,o);const a=Dge(this,n,o,i);i=a.transitionEnd,n=a.target}return{transition:t,transitionEnd:i,...n}}}function Fge(e){return window.getComputedStyle(e)}class Nge extends tq{readValueFromInstance(t,i){if(Jf.has(i)){const n=VI(i);return n&&n.default||0}else{const n=Fge(t),r=(JX(i)?n.getPropertyValue(i):n[i])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(t,{transformPagePoint:i}){return VY(t,i)}build(t,i,n,r){BI(t,i,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,i){return FI(t,i)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Xs(t)&&(this.childSubscription=t.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}renderInstance(t,i,n,r){tY(t,i,n,r)}}class zge extends tq{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(t,i){return t[i]}readValueFromInstance(t,i){if(Jf.has(i)){const n=VI(i);return n&&n.default||0}return i=iY.has(i)?i:OI(i),t.getAttribute(i)}measureInstanceViewportBox(){return Nn()}scrapeMotionValuesFromProps(t,i){return rY(t,i)}build(t,i,n,r){RI(t,i,n,this.isSVGTag,r.transformTemplate)}renderInstance(t,i,n,r){nY(t,i,n,r)}mount(t){this.isSVGTag=II(t.tagName),super.mount(t)}}const kge=(e,t)=>DI(e)?new zge(t,{enableHardwareAcceleration:!1}):new Nge(t,{enableHardwareAcceleration:!0}),Uge={layout:{ProjectionNode:KY,MeasureLayout:WY}},Gge={...yme,...Dfe,..._ge,...Uge},ds=Vde((e,t)=>vfe(e,t,Gge,kge)),er={paddingX:"sm:px-16 px-6",paddingY:"sm:py-16 py-6",padding:"sm:px-16 px-6 sm:py-16 py-10",heroHeadText:"font-black text-white lg:text-[80px] sm:text-[60px] xs:text-[50px] text-[40px] lg:leading-[98px] mt-2",heroSubText:"text-[#dfd9ff] font-medium lg:text-[30px] sm:text-[26px] xs:text-[20px] text-[16px] lg:leading-[40px]",sectionHeadText:"text-black font-black md:text-[60px] sm:text-[50px] xs:text-[40px] text-[30px]",sectionHeadTextWhite:"text-white font-black md:text-[60px] sm:text-[50px] xs:text-[40px] text-[30px]",sectionSubText:"sm:text-[18px] text-[14px] text-secondary uppercase tracking-wider"},Hge=()=>{const e=["Hello","Bonjour","Hola","Ciao","Hallo","Oi"],[t,i]=ae.useState(0),[n,r]=ae.useState(e[t]),[s,o]=ae.useState(!1);return ae.useEffect(()=>{const a=setTimeout(()=>{i(l=>(l+1)%e.length),o(!1)},1e3);return()=>{clearTimeout(a)}},[t,e.length]),ae.useEffect(()=>{r(e[t]),o(!0)},[t,e]),Be("div",{className:"name-changer",children:Be("span",{className:`name ${s?"fade-in":""}`,children:n})})},Vge="modulepreload",jge=function(e){return"/"+e},_5={},y1=function(t,i,n){if(!i||i.length===0)return t();const r=document.getElementsByTagName("link");return Promise.all(i.map(s=>{if(s=jge(s),s in _5)return;_5[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!n)for(let h=r.length-1;h>=0;h--){const u=r[h];if(u.href===s&&(!o||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Vge,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((h,u)=>{c.addEventListener("load",h),c.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t())};var Wge=Object.create,ZI=Object.defineProperty,Xge=Object.getOwnPropertyDescriptor,Yge=Object.getOwnPropertyNames,qge=Object.getPrototypeOf,Qge=Object.prototype.hasOwnProperty,WM=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Jge=(e,t)=>{for(var i in t)ZI(e,i,{get:t[i],enumerable:!0})},Kge=(e,t,i,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Yge(t))!Qge.call(e,r)&&r!==i&&ZI(e,r,{get:()=>t[r],enumerable:!(n=Xge(t,r))||n.enumerable});return e},x1=(e,t,i)=>(i=e!=null?Wge(qge(e)):{},Kge(t||!e||!e.__esModule?ZI(i,"default",{value:e,enumerable:!0}):i,e)),Zge=WM((e,t)=>{(function(i,n){typeof e=="object"?t.exports=n():typeof define=="function"&&define.amd?define(n):i.Alea=n()})(e,function(){return i.importState=function(r){var s=new i;return s.importState(r),s},i;function i(){return function(r){var s=0,o=0,a=0,l=1;r.length==0&&(r=[+new Date]);var c=n();s=c(" "),o=c(" "),a=c(" ");for(var h=0;h<r.length;h++)s-=c(r[h]),s<0&&(s+=1),o-=c(r[h]),o<0&&(o+=1),a-=c(r[h]),a<0&&(a+=1);c=null;var u=function(){var d=2091639*s+l*23283064365386963e-26;return s=o,o=a,a=d-(l=d|0)};return u.next=u,u.uint32=function(){return u()*4294967296},u.fract53=function(){return u()+(u()*2097152|0)*11102230246251565e-32},u.version="Alea 0.9",u.args=r,u.exportState=function(){return[s,o,a,l]},u.importState=function(d){s=+d[0]||0,o=+d[1]||0,a=+d[2]||0,l=+d[3]||0},u}(Array.prototype.slice.call(arguments))}function n(){var r=4022871197,s=function(o){o=o.toString();for(var a=0;a<o.length;a++){r+=o.charCodeAt(a);var l=.02519603282416938*r;r=l>>>0,l-=r,l*=r,r=l>>>0,l-=r,r+=l*4294967296}return(r>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),iq=WM((e,t)=>{(function(i,n){typeof e=="object"&&typeof t<"u"?n(e):typeof define=="function"&&define.amd?define(["exports"],n):n((i=typeof globalThis<"u"?globalThis:i||self).SVDJS={})})(e,function(i){i.SVD=function(n,r,s,o,a){if(r=r===void 0||r,s=s===void 0||s,a=1e-64/(o=o||Math.pow(2,-52)),!n)throw new TypeError("Matrix a is not defined");var l,c,h,u,d,f,p,g,m,v,x,w,b=n[0].length,M=n.length;if(M<b)throw new TypeError("Invalid matrix: m < n");for(var A=[],T=[],S=[],C=r==="f"?M:b,P=v=p=0;P<M;P++)T[P]=new Array(C).fill(0);for(P=0;P<b;P++)S[P]=new Array(b).fill(0);var B,k=new Array(b).fill(0);for(P=0;P<M;P++)for(l=0;l<b;l++)T[P][l]=n[P][l];for(P=0;P<b;P++){for(A[P]=p,m=0,h=P+1,l=P;l<M;l++)m+=Math.pow(T[l][P],2);if(m<a)p=0;else for(g=(f=T[P][P])*(p=f<0?Math.sqrt(m):-Math.sqrt(m))-m,T[P][P]=f-p,l=h;l<b;l++){for(m=0,c=P;c<M;c++)m+=T[c][P]*T[c][l];for(f=m/g,c=P;c<M;c++)T[c][l]=T[c][l]+f*T[c][P]}for(k[P]=p,m=0,l=h;l<b;l++)m+=Math.pow(T[P][l],2);if(m<a)p=0;else{for(g=(f=T[P][P+1])*(p=f<0?Math.sqrt(m):-Math.sqrt(m))-m,T[P][P+1]=f-p,l=h;l<b;l++)A[l]=T[P][l]/g;for(l=h;l<M;l++){for(m=0,c=h;c<b;c++)m+=T[l][c]*T[P][c];for(c=h;c<b;c++)T[l][c]=T[l][c]+m*A[c]}}v<(x=Math.abs(k[P])+Math.abs(A[P]))&&(v=x)}if(s)for(P=b-1;0<=P;P--){if(p!==0){for(g=T[P][P+1]*p,l=h;l<b;l++)S[l][P]=T[P][l]/g;for(l=h;l<b;l++){for(m=0,c=h;c<b;c++)m+=T[P][c]*S[c][l];for(c=h;c<b;c++)S[c][l]=S[c][l]+m*S[c][P]}}for(l=h;l<b;l++)S[P][l]=0,S[l][P]=0;S[P][P]=1,p=A[P],h=P}if(r){if(r==="f")for(P=b;P<M;P++){for(l=b;l<M;l++)T[P][l]=0;T[P][P]=1}for(P=b-1;0<=P;P--){for(h=P+1,p=k[P],l=h;l<C;l++)T[P][l]=0;if(p!==0){for(g=T[P][P]*p,l=h;l<C;l++){for(m=0,c=h;c<M;c++)m+=T[c][P]*T[c][l];for(f=m/g,c=P;c<M;c++)T[c][l]=T[c][l]+f*T[c][P]}for(l=P;l<M;l++)T[l][P]=T[l][P]/p}else for(l=P;l<M;l++)T[l][P]=0;T[P][P]=T[P][P]+1}}for(o*=v,c=b-1;0<=c;c--)for(var z=0;z<50;z++){for(B=!1,h=c;0<=h;h--){if(Math.abs(A[h])<=o){B=!0;break}if(Math.abs(k[h-1])<=o)break}if(!B){for(d=0,u=h-(m=1),P=h;P<c+1&&(f=m*A[P],A[P]=d*A[P],!(Math.abs(f)<=o));P++)if(p=k[P],k[P]=Math.sqrt(f*f+p*p),d=p/(g=k[P]),m=-f/g,r)for(l=0;l<M;l++)x=T[l][u],w=T[l][P],T[l][u]=x*d+w*m,T[l][P]=-x*m+w*d}if(w=k[c],h===c){if(w<0&&(k[c]=-w,s))for(l=0;l<b;l++)S[l][c]=-S[l][c];break}for(v=k[h],f=(((x=k[c-1])-w)*(x+w)+((p=A[c-1])-(g=A[c]))*(p+g))/(2*g*x),p=Math.sqrt(f*f+1),f=((v-w)*(v+w)+g*(x/(f<0?f-p:f+p)-g))/v,P=h+(m=d=1);P<c+1;P++){if(p=A[P],x=k[P],g=m*p,p*=d,w=Math.sqrt(f*f+g*g),f=v*(d=f/(A[P-1]=w))+p*(m=g/w),p=-v*m+p*d,g=x*m,x*=d,s)for(l=0;l<b;l++)v=S[l][P-1],w=S[l][P],S[l][P-1]=v*d+w*m,S[l][P]=-v*m+w*d;if(w=Math.sqrt(f*f+g*g),f=(d=f/(k[P-1]=w))*p+(m=g/w)*x,v=-m*p+d*x,r)for(l=0;l<M;l++)x=T[l][P-1],w=T[l][P],T[l][P-1]=x*d+w*m,T[l][P]=-x*m+w*d}A[h]=0,A[c]=f,k[c]=v}for(P=0;P<b;P++)k[P]<o&&(k[P]=0);return{u:T,q:k,v:S}},i.VERSION="1.1.1",Object.defineProperty(i,"__esModule",{value:!0})})}),$ge=WM(e=>{(function(){var t=function(){this.init()};t.prototype={init:function(){var u=this||i;return u._counter=1e3,u._html5AudioPool=[],u.html5PoolSize=10,u._codecs={},u._howls=[],u._muted=!1,u._volume=1,u._canPlayEvent="canplaythrough",u._navigator=typeof window<"u"&&window.navigator?window.navigator:null,u.masterGain=null,u.noAudio=!1,u.usingWebAudio=!0,u.autoSuspend=!0,u.ctx=null,u.autoUnlock=!0,u._setup(),u},volume:function(u){var d=this||i;if(u=parseFloat(u),d.ctx||h(),typeof u<"u"&&u>=0&&u<=1){if(d._volume=u,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(u,i.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),g=0;g<p.length;g++){var m=d._howls[f]._soundById(p[g]);m&&m._node&&(m._node.volume=m._volume*u)}return d}return d._volume},mute:function(u){var d=this||i;d.ctx||h(),d._muted=u,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(u?0:d._volume,i.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),g=0;g<p.length;g++){var m=d._howls[f]._soundById(p[g]);m&&m._node&&(m._node.muted=u?!0:m._muted)}return d},stop:function(){for(var u=this||i,d=0;d<u._howls.length;d++)u._howls[d].stop();return u},unload:function(){for(var u=this||i,d=u._howls.length-1;d>=0;d--)u._howls[d].unload();return u.usingWebAudio&&u.ctx&&typeof u.ctx.close<"u"&&(u.ctx.close(),u.ctx=null,h()),u},codecs:function(u){return(this||i)._codecs[u.replace(/^x-/,"")]},_setup:function(){var u=this||i;if(u.state=u.ctx&&u.ctx.state||"suspended",u._autoSuspend(),!u.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(u._canPlayEvent="canplay")}catch{u.noAudio=!0}else u.noAudio=!0;try{var d=new Audio;d.muted&&(u.noAudio=!0)}catch{}return u.noAudio||u._setupCodecs(),u},_setupCodecs:function(){var u=this||i,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return u}if(!d||typeof d.canPlayType!="function")return u;var f=d.canPlayType("audio/mpeg;").replace(/^no$/,""),p=u._navigator?u._navigator.userAgent:"",g=p.match(/OPR\/([0-6].)/g),m=g&&parseInt(g[0].split("/")[1],10)<33,v=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,x=p.match(/Version\/(.*?) /),w=v&&x&&parseInt(x[1],10)<15;return u._codecs={mp3:!!(!m&&(f||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!w&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!w&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},u},_unlockAudio:function(){var u=this||i;if(!(u._audioUnlocked||!u.ctx)){u._audioUnlocked=!1,u.autoUnlock=!1,!u._mobileUnloaded&&u.ctx.sampleRate!==44100&&(u._mobileUnloaded=!0,u.unload()),u._scratchBuffer=u.ctx.createBuffer(1,1,22050);var d=function(f){for(;u._html5AudioPool.length<u.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,u._releaseHtml5Audio(p)}catch{u.noAudio=!0;break}for(var g=0;g<u._howls.length;g++)if(!u._howls[g]._webAudio)for(var m=u._howls[g]._getSoundIds(),v=0;v<m.length;v++){var x=u._howls[g]._soundById(m[v]);x&&x._node&&!x._node._unlocked&&(x._node._unlocked=!0,x._node.load())}u._autoResume();var w=u.ctx.createBufferSource();w.buffer=u._scratchBuffer,w.connect(u.ctx.destination),typeof w.start>"u"?w.noteOn(0):w.start(0),typeof u.ctx.resume=="function"&&u.ctx.resume(),w.onended=function(){w.disconnect(0),u._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var b=0;b<u._howls.length;b++)u._howls[b]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),u}},_obtainHtml5Audio:function(){var u=this||i;if(u._html5AudioPool.length)return u._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(u){var d=this||i;return u._unlocked&&d._html5AudioPool.push(u),d},_autoSuspend:function(){var u=this;if(!(!u.autoSuspend||!u.ctx||typeof u.ctx.suspend>"u"||!i.usingWebAudio)){for(var d=0;d<u._howls.length;d++)if(u._howls[d]._webAudio){for(var f=0;f<u._howls[d]._sounds.length;f++)if(!u._howls[d]._sounds[f]._paused)return u}return u._suspendTimer&&clearTimeout(u._suspendTimer),u._suspendTimer=setTimeout(function(){if(u.autoSuspend){u._suspendTimer=null,u.state="suspending";var p=function(){u.state="suspended",u._resumeAfterSuspend&&(delete u._resumeAfterSuspend,u._autoResume())};u.ctx.suspend().then(p,p)}},3e4),u}},_autoResume:function(){var u=this;if(!(!u.ctx||typeof u.ctx.resume>"u"||!i.usingWebAudio))return u.state==="running"&&u.ctx.state!=="interrupted"&&u._suspendTimer?(clearTimeout(u._suspendTimer),u._suspendTimer=null):u.state==="suspended"||u.state==="running"&&u.ctx.state==="interrupted"?(u.ctx.resume().then(function(){u.state="running";for(var d=0;d<u._howls.length;d++)u._howls[d]._emit("resume")}),u._suspendTimer&&(clearTimeout(u._suspendTimer),u._suspendTimer=null)):u.state==="suspending"&&(u._resumeAfterSuspend=!0),u}};var i=new t,n=function(u){var d=this;if(!u.src||u.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(u)};n.prototype={init:function(u){var d=this;return i.ctx||h(),d._autoplay=u.autoplay||!1,d._format=typeof u.format!="string"?u.format:[u.format],d._html5=u.html5||!1,d._muted=u.mute||!1,d._loop=u.loop||!1,d._pool=u.pool||5,d._preload=typeof u.preload=="boolean"||u.preload==="metadata"?u.preload:!0,d._rate=u.rate||1,d._sprite=u.sprite||{},d._src=typeof u.src!="string"?u.src:[u.src],d._volume=u.volume!==void 0?u.volume:1,d._xhr={method:u.xhr&&u.xhr.method?u.xhr.method:"GET",headers:u.xhr&&u.xhr.headers?u.xhr.headers:null,withCredentials:u.xhr&&u.xhr.withCredentials?u.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=u.onend?[{fn:u.onend}]:[],d._onfade=u.onfade?[{fn:u.onfade}]:[],d._onload=u.onload?[{fn:u.onload}]:[],d._onloaderror=u.onloaderror?[{fn:u.onloaderror}]:[],d._onplayerror=u.onplayerror?[{fn:u.onplayerror}]:[],d._onpause=u.onpause?[{fn:u.onpause}]:[],d._onplay=u.onplay?[{fn:u.onplay}]:[],d._onstop=u.onstop?[{fn:u.onstop}]:[],d._onmute=u.onmute?[{fn:u.onmute}]:[],d._onvolume=u.onvolume?[{fn:u.onvolume}]:[],d._onrate=u.onrate?[{fn:u.onrate}]:[],d._onseek=u.onseek?[{fn:u.onseek}]:[],d._onunlock=u.onunlock?[{fn:u.onunlock}]:[],d._onresume=[],d._webAudio=i.usingWebAudio&&!d._html5,typeof i.ctx<"u"&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var u=this,d=null;if(i.noAudio){u._emit("loaderror",null,"No audio support.");return}typeof u._src=="string"&&(u._src=[u._src]);for(var f=0;f<u._src.length;f++){var p,g;if(u._format&&u._format[f])p=u._format[f];else{if(g=u._src[f],typeof g!="string"){u._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(g),p||(p=/\.([^.]+)$/.exec(g.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&i.codecs(p)){d=u._src[f];break}}if(!d){u._emit("loaderror",null,"No codec support for selected audio sources.");return}return u._src=d,u._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(u._html5=!0,u._webAudio=!1),new r(u),u._webAudio&&o(u),u},play:function(u,d){var f=this,p=null;if(typeof u=="number")p=u,u=null;else{if(typeof u=="string"&&f._state==="loaded"&&!f._sprite[u])return null;if(typeof u>"u"&&(u="__default",!f._playLock)){for(var g=0,m=0;m<f._sounds.length;m++)f._sounds[m]._paused&&!f._sounds[m]._ended&&(g++,p=f._sounds[m]._id);g===1?u=null:p=null}}var v=p?f._soundById(p):f._inactiveSound();if(!v)return null;if(p&&!u&&(u=v._sprite||"__default"),f._state!=="loaded"){v._sprite=u,v._ended=!1;var x=v._id;return f._queue.push({event:"play",action:function(){f.play(x)}}),x}if(p&&!v._paused)return d||f._loadQueue("play"),v._id;f._webAudio&&i._autoResume();var w=Math.max(0,v._seek>0?v._seek:f._sprite[u][0]/1e3),b=Math.max(0,(f._sprite[u][0]+f._sprite[u][1])/1e3-w),M=b*1e3/Math.abs(v._rate),A=f._sprite[u][0]/1e3,T=(f._sprite[u][0]+f._sprite[u][1])/1e3;v._sprite=u,v._ended=!1;var S=function(){v._paused=!1,v._seek=w,v._start=A,v._stop=T,v._loop=!!(v._loop||f._sprite[u][2])};if(w>=T){f._ended(v);return}var C=v._node;if(f._webAudio){var P=function(){f._playLock=!1,S(),f._refreshBuffer(v);var F=v._muted||f._muted?0:v._volume;C.gain.setValueAtTime(F,i.ctx.currentTime),v._playStart=i.ctx.currentTime,typeof C.bufferSource.start>"u"?v._loop?C.bufferSource.noteGrainOn(0,w,86400):C.bufferSource.noteGrainOn(0,w,b):v._loop?C.bufferSource.start(0,w,86400):C.bufferSource.start(0,w,b),M!==1/0&&(f._endTimers[v._id]=setTimeout(f._ended.bind(f,v),M)),d||setTimeout(function(){f._emit("play",v._id),f._loadQueue()},0)};i.state==="running"&&i.ctx.state!=="interrupted"?P():(f._playLock=!0,f.once("resume",P),f._clearTimer(v._id))}else{var B=function(){C.currentTime=w,C.muted=v._muted||f._muted||i._muted||C.muted,C.volume=v._volume*i.volume(),C.playbackRate=v._rate;try{var F=C.play();if(F&&typeof Promise<"u"&&(F instanceof Promise||typeof F.then=="function")?(f._playLock=!0,S(),F.then(function(){f._playLock=!1,C._unlocked=!0,d?f._loadQueue():f._emit("play",v._id)}).catch(function(){f._playLock=!1,f._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),v._ended=!0,v._paused=!0})):d||(f._playLock=!1,S(),f._emit("play",v._id)),C.playbackRate=v._rate,C.paused){f._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}u!=="__default"||v._loop?f._endTimers[v._id]=setTimeout(f._ended.bind(f,v),M):(f._endTimers[v._id]=function(){f._ended(v),C.removeEventListener("ended",f._endTimers[v._id],!1)},C.addEventListener("ended",f._endTimers[v._id],!1))}catch(W){f._emit("playerror",v._id,W)}};C.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(C.src=f._src,C.load());var k=window&&window.ejecta||!C.readyState&&i._navigator.isCocoonJS;if(C.readyState>=3||k)B();else{f._playLock=!0,f._state="loading";var z=function(){f._state="loaded",B(),C.removeEventListener(i._canPlayEvent,z,!1)};C.addEventListener(i._canPlayEvent,z,!1),f._clearTimer(v._id)}}return v._id},pause:function(u){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(u)}}),d;for(var f=d._getSoundIds(u),p=0;p<f.length;p++){d._clearTimer(f[p]);var g=d._soundById(f[p]);if(g&&!g._paused&&(g._seek=d.seek(f[p]),g._rateSeek=0,g._paused=!0,d._stopFade(f[p]),g._node))if(d._webAudio){if(!g._node.bufferSource)continue;typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),d._cleanBuffer(g._node)}else(!isNaN(g._node.duration)||g._node.duration===1/0)&&g._node.pause();arguments[1]||d._emit("pause",g?g._id:null)}return d},stop:function(u,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(u)}}),f;for(var p=f._getSoundIds(u),g=0;g<p.length;g++){f._clearTimer(p[g]);var m=f._soundById(p[g]);m&&(m._seek=m._start||0,m._rateSeek=0,m._paused=!0,m._ended=!0,f._stopFade(p[g]),m._node&&(f._webAudio?m._node.bufferSource&&(typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),f._cleanBuffer(m._node)):(!isNaN(m._node.duration)||m._node.duration===1/0)&&(m._node.currentTime=m._start||0,m._node.pause(),m._node.duration===1/0&&f._clearSound(m._node))),d||f._emit("stop",m._id))}return f},mute:function(u,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(u,d)}}),f;if(typeof d>"u")if(typeof u=="boolean")f._muted=u;else return f._muted;for(var p=f._getSoundIds(d),g=0;g<p.length;g++){var m=f._soundById(p[g]);m&&(m._muted=u,m._interval&&f._stopFade(m._id),f._webAudio&&m._node?m._node.gain.setValueAtTime(u?0:m._volume,i.ctx.currentTime):m._node&&(m._node.muted=i._muted?!0:u),f._emit("mute",m._id))}return f},volume:function(){var u=this,d=arguments,f,p;if(d.length===0)return u._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var g=u._getSoundIds(),m=g.indexOf(d[0]);m>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length>=2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var v;if(typeof f<"u"&&f>=0&&f<=1){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"volume",action:function(){u.volume.apply(u,d)}}),u;typeof p>"u"&&(u._volume=f),p=u._getSoundIds(p);for(var x=0;x<p.length;x++)v=u._soundById(p[x]),v&&(v._volume=f,d[2]||u._stopFade(p[x]),u._webAudio&&v._node&&!v._muted?v._node.gain.setValueAtTime(f,i.ctx.currentTime):v._node&&!v._muted&&(v._node.volume=f*i.volume()),u._emit("volume",v._id))}else return v=p?u._soundById(p):u._sounds[0],v?v._volume:0;return u},fade:function(u,d,f,p){var g=this;if(g._state!=="loaded"||g._playLock)return g._queue.push({event:"fade",action:function(){g.fade(u,d,f,p)}}),g;u=Math.min(Math.max(0,parseFloat(u)),1),d=Math.min(Math.max(0,parseFloat(d)),1),f=parseFloat(f),g.volume(u,p);for(var m=g._getSoundIds(p),v=0;v<m.length;v++){var x=g._soundById(m[v]);if(x){if(p||g._stopFade(m[v]),g._webAudio&&!x._muted){var w=i.ctx.currentTime,b=w+f/1e3;x._volume=u,x._node.gain.setValueAtTime(u,w),x._node.gain.linearRampToValueAtTime(d,b)}g._startFadeInterval(x,u,d,f,m[v],typeof p>"u")}}return g},_startFadeInterval:function(u,d,f,p,g,m){var v=this,x=d,w=f-d,b=Math.abs(w/.01),M=Math.max(4,b>0?p/b:p),A=Date.now();u._fadeTo=f,u._interval=setInterval(function(){var T=(Date.now()-A)/p;A=Date.now(),x+=w*T,x=Math.round(x*100)/100,w<0?x=Math.max(f,x):x=Math.min(f,x),v._webAudio?u._volume=x:v.volume(x,u._id,!0),m&&(v._volume=x),(f<d&&x<=f||f>d&&x>=f)&&(clearInterval(u._interval),u._interval=null,u._fadeTo=null,v.volume(f,u._id),v._emit("fade",u._id))},M)},_stopFade:function(u){var d=this,f=d._soundById(u);return f&&f._interval&&(d._webAudio&&f._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(f._interval),f._interval=null,d.volume(f._fadeTo,u),f._fadeTo=null,d._emit("fade",u)),d},loop:function(){var u=this,d=arguments,f,p,g;if(d.length===0)return u._loop;if(d.length===1)if(typeof d[0]=="boolean")f=d[0],u._loop=f;else return g=u._soundById(parseInt(d[0],10)),g?g._loop:!1;else d.length===2&&(f=d[0],p=parseInt(d[1],10));for(var m=u._getSoundIds(p),v=0;v<m.length;v++)g=u._soundById(m[v]),g&&(g._loop=f,u._webAudio&&g._node&&g._node.bufferSource&&(g._node.bufferSource.loop=f,f&&(g._node.bufferSource.loopStart=g._start||0,g._node.bufferSource.loopEnd=g._stop,u.playing(m[v])&&(u.pause(m[v],!0),u.play(m[v],!0)))));return u},rate:function(){var u=this,d=arguments,f,p;if(d.length===0)p=u._sounds[0]._id;else if(d.length===1){var g=u._getSoundIds(),m=g.indexOf(d[0]);m>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var v;if(typeof f=="number"){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"rate",action:function(){u.rate.apply(u,d)}}),u;typeof p>"u"&&(u._rate=f),p=u._getSoundIds(p);for(var x=0;x<p.length;x++)if(v=u._soundById(p[x]),v){u.playing(p[x])&&(v._rateSeek=u.seek(p[x]),v._playStart=u._webAudio?i.ctx.currentTime:v._playStart),v._rate=f,u._webAudio&&v._node&&v._node.bufferSource?v._node.bufferSource.playbackRate.setValueAtTime(f,i.ctx.currentTime):v._node&&(v._node.playbackRate=f);var w=u.seek(p[x]),b=(u._sprite[v._sprite][0]+u._sprite[v._sprite][1])/1e3-w,M=b*1e3/Math.abs(v._rate);(u._endTimers[p[x]]||!v._paused)&&(u._clearTimer(p[x]),u._endTimers[p[x]]=setTimeout(u._ended.bind(u,v),M)),u._emit("rate",v._id)}}else return v=u._soundById(p),v?v._rate:u._rate;return u},seek:function(){var u=this,d=arguments,f,p;if(d.length===0)u._sounds.length&&(p=u._sounds[0]._id);else if(d.length===1){var g=u._getSoundIds(),m=g.indexOf(d[0]);m>=0?p=parseInt(d[0],10):u._sounds.length&&(p=u._sounds[0]._id,f=parseFloat(d[0]))}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));if(typeof p>"u")return 0;if(typeof f=="number"&&(u._state!=="loaded"||u._playLock))return u._queue.push({event:"seek",action:function(){u.seek.apply(u,d)}}),u;var v=u._soundById(p);if(v)if(typeof f=="number"&&f>=0){var x=u.playing(p);x&&u.pause(p,!0),v._seek=f,v._ended=!1,u._clearTimer(p),!u._webAudio&&v._node&&!isNaN(v._node.duration)&&(v._node.currentTime=f);var w=function(){x&&u.play(p,!0),u._emit("seek",p)};if(x&&!u._webAudio){var b=function(){u._playLock?setTimeout(b,0):w()};setTimeout(b,0)}else w()}else if(u._webAudio){var M=u.playing(p)?i.ctx.currentTime-v._playStart:0,A=v._rateSeek?v._rateSeek-v._seek:0;return v._seek+(A+M*Math.abs(v._rate))}else return v._node.currentTime;return u},playing:function(u){var d=this;if(typeof u=="number"){var f=d._soundById(u);return f?!f._paused:!1}for(var p=0;p<d._sounds.length;p++)if(!d._sounds[p]._paused)return!0;return!1},duration:function(u){var d=this,f=d._duration,p=d._soundById(u);return p&&(f=d._sprite[p._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var u=this,d=u._sounds,f=0;f<d.length;f++)d[f]._paused||u.stop(d[f]._id),u._webAudio||(u._clearSound(d[f]._node),d[f]._node.removeEventListener("error",d[f]._errorFn,!1),d[f]._node.removeEventListener(i._canPlayEvent,d[f]._loadFn,!1),d[f]._node.removeEventListener("ended",d[f]._endFn,!1),i._releaseHtml5Audio(d[f]._node)),delete d[f]._node,u._clearTimer(d[f]._id);var p=i._howls.indexOf(u);p>=0&&i._howls.splice(p,1);var g=!0;for(f=0;f<i._howls.length;f++)if(i._howls[f]._src===u._src||u._src.indexOf(i._howls[f]._src)>=0){g=!1;break}return s&&g&&delete s[u._src],i.noAudio=!1,u._state="unloaded",u._sounds=[],u=null,null},on:function(u,d,f,p){var g=this,m=g["_on"+u];return typeof d=="function"&&m.push(p?{id:f,fn:d,once:p}:{id:f,fn:d}),g},off:function(u,d,f){var p=this,g=p["_on"+u],m=0;if(typeof d=="number"&&(f=d,d=null),d||f)for(m=0;m<g.length;m++){var v=f===g[m].id;if(d===g[m].fn&&v||!d&&v){g.splice(m,1);break}}else if(u)p["_on"+u]=[];else{var x=Object.keys(p);for(m=0;m<x.length;m++)x[m].indexOf("_on")===0&&Array.isArray(p[x[m]])&&(p[x[m]]=[])}return p},once:function(u,d,f){var p=this;return p.on(u,d,f,1),p},_emit:function(u,d,f){for(var p=this,g=p["_on"+u],m=g.length-1;m>=0;m--)(!g[m].id||g[m].id===d||u==="load")&&(setTimeout(function(v){v.call(this,d,f)}.bind(p,g[m].fn),0),g[m].once&&p.off(u,g[m].fn,g[m].id));return p._loadQueue(u),p},_loadQueue:function(u){var d=this;if(d._queue.length>0){var f=d._queue[0];f.event===u&&(d._queue.shift(),d._loadQueue()),u||f.action()}return d},_ended:function(u){var d=this,f=u._sprite;if(!d._webAudio&&u._node&&!u._node.paused&&!u._node.ended&&u._node.currentTime<u._stop)return setTimeout(d._ended.bind(d,u),100),d;var p=!!(u._loop||d._sprite[f][2]);if(d._emit("end",u._id),!d._webAudio&&p&&d.stop(u._id,!0).play(u._id),d._webAudio&&p){d._emit("play",u._id),u._seek=u._start||0,u._rateSeek=0,u._playStart=i.ctx.currentTime;var g=(u._stop-u._start)*1e3/Math.abs(u._rate);d._endTimers[u._id]=setTimeout(d._ended.bind(d,u),g)}return d._webAudio&&!p&&(u._paused=!0,u._ended=!0,u._seek=u._start||0,u._rateSeek=0,d._clearTimer(u._id),d._cleanBuffer(u._node),i._autoSuspend()),!d._webAudio&&!p&&d.stop(u._id,!0),d},_clearTimer:function(u){var d=this;if(d._endTimers[u]){if(typeof d._endTimers[u]!="function")clearTimeout(d._endTimers[u]);else{var f=d._soundById(u);f&&f._node&&f._node.removeEventListener("ended",d._endTimers[u],!1)}delete d._endTimers[u]}return d},_soundById:function(u){for(var d=this,f=0;f<d._sounds.length;f++)if(u===d._sounds[f]._id)return d._sounds[f];return null},_inactiveSound:function(){var u=this;u._drain();for(var d=0;d<u._sounds.length;d++)if(u._sounds[d]._ended)return u._sounds[d].reset();return new r(u)},_drain:function(){var u=this,d=u._pool,f=0,p=0;if(!(u._sounds.length<d)){for(p=0;p<u._sounds.length;p++)u._sounds[p]._ended&&f++;for(p=u._sounds.length-1;p>=0;p--){if(f<=d)return;u._sounds[p]._ended&&(u._webAudio&&u._sounds[p]._node&&u._sounds[p]._node.disconnect(0),u._sounds.splice(p,1),f--)}}},_getSoundIds:function(u){var d=this;if(typeof u>"u"){for(var f=[],p=0;p<d._sounds.length;p++)f.push(d._sounds[p]._id);return f}else return[u]},_refreshBuffer:function(u){var d=this;return u._node.bufferSource=i.ctx.createBufferSource(),u._node.bufferSource.buffer=s[d._src],u._panner?u._node.bufferSource.connect(u._panner):u._node.bufferSource.connect(u._node),u._node.bufferSource.loop=u._loop,u._loop&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop||0),u._node.bufferSource.playbackRate.setValueAtTime(u._rate,i.ctx.currentTime),d},_cleanBuffer:function(u){var d=this,f=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&u.bufferSource&&(u.bufferSource.onended=null,u.bufferSource.disconnect(0),f))try{u.bufferSource.buffer=i._scratchBuffer}catch{}return u.bufferSource=null,d},_clearSound:function(u){var d=/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent);d||(u.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(u){this._parent=u,this.init()};r.prototype={init:function(){var u=this,d=u._parent;return u._muted=d._muted,u._loop=d._loop,u._volume=d._volume,u._rate=d._rate,u._seek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++i._counter,d._sounds.push(u),u.create(),u},create:function(){var u=this,d=u._parent,f=i._muted||u._muted||u._parent._muted?0:u._volume;return d._webAudio?(u._node=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),u._node.gain.setValueAtTime(f,i.ctx.currentTime),u._node.paused=!0,u._node.connect(i.masterGain)):i.noAudio||(u._node=i._obtainHtml5Audio(),u._errorFn=u._errorListener.bind(u),u._node.addEventListener("error",u._errorFn,!1),u._loadFn=u._loadListener.bind(u),u._node.addEventListener(i._canPlayEvent,u._loadFn,!1),u._endFn=u._endListener.bind(u),u._node.addEventListener("ended",u._endFn,!1),u._node.src=d._src,u._node.preload=d._preload===!0?"auto":d._preload,u._node.volume=f*i.volume(),u._node.load()),u},reset:function(){var u=this,d=u._parent;return u._muted=d._muted,u._loop=d._loop,u._volume=d._volume,u._rate=d._rate,u._seek=0,u._rateSeek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++i._counter,u},_errorListener:function(){var u=this;u._parent._emit("loaderror",u._id,u._node.error?u._node.error.code:0),u._node.removeEventListener("error",u._errorFn,!1)},_loadListener:function(){var u=this,d=u._parent;d._duration=Math.ceil(u._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),u._node.removeEventListener(i._canPlayEvent,u._loadFn,!1)},_endListener:function(){var u=this,d=u._parent;d._duration===1/0&&(d._duration=Math.ceil(u._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(u)),u._node.removeEventListener("ended",u._endFn,!1)}};var s={},o=function(u){var d=u._src;if(s[d]){u._duration=s[d].duration,c(u);return}if(/^data:[^;]+;base64,/.test(d)){for(var f=atob(d.split(",")[1]),p=new Uint8Array(f.length),g=0;g<f.length;++g)p[g]=f.charCodeAt(g);l(p.buffer,u)}else{var m=new XMLHttpRequest;m.open(u._xhr.method,d,!0),m.withCredentials=u._xhr.withCredentials,m.responseType="arraybuffer",u._xhr.headers&&Object.keys(u._xhr.headers).forEach(function(v){m.setRequestHeader(v,u._xhr.headers[v])}),m.onload=function(){var v=(m.status+"")[0];if(v!=="0"&&v!=="2"&&v!=="3"){u._emit("loaderror",null,"Failed loading audio file with status: "+m.status+".");return}l(m.response,u)},m.onerror=function(){u._webAudio&&(u._html5=!0,u._webAudio=!1,u._sounds=[],delete s[d],u.load())},a(m)}},a=function(u){try{u.send()}catch{u.onerror()}},l=function(u,d){var f=function(){d._emit("loaderror",null,"Decoding audio data failed.")},p=function(g){g&&d._sounds.length>0?(s[d._src]=g,c(d,g)):f()};typeof Promise<"u"&&i.ctx.decodeAudioData.length===1?i.ctx.decodeAudioData(u).then(p).catch(f):i.ctx.decodeAudioData(u,p,f)},c=function(u,d){d&&!u._duration&&(u._duration=d.duration),Object.keys(u._sprite).length===0&&(u._sprite={__default:[0,u._duration*1e3]}),u._state!=="loaded"&&(u._state="loaded",u._emit("load"),u._loadQueue())},h=function(){if(i.usingWebAudio){try{typeof AudioContext<"u"?i.ctx=new AudioContext:typeof webkitAudioContext<"u"?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch{i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var u=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),d=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=d?parseInt(d[1],10):null;if(u&&f&&f<9){var p=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!p&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:i,Howl:n}}),typeof e<"u"&&(e.Howler=i,e.Howl=n),typeof global<"u"?(global.HowlerGlobal=t,global.Howler=i,global.Howl=n,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=i,window.Howl=n,window.Sound=r)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(i){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(i);return n},HowlerGlobal.prototype.pos=function(i,n,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,r=typeof r!="number"?s._pos[2]:r,typeof i=="number")s._pos=[i,n,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(i,n,r,s,o,a){var l=this;if(!l.ctx||!l.ctx.listener)return l;var c=l._orientation;if(n=typeof n!="number"?c[1]:n,r=typeof r!="number"?c[2]:r,s=typeof s!="number"?c[3]:s,o=typeof o!="number"?c[4]:o,a=typeof a!="number"?c[5]:a,typeof i=="number")l._orientation=[i,n,r,s,o,a],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(i,n,r,s,o,a);else return c;return l},Howl.prototype.init=function(i){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],i.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(i,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(i,n)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof i=="number")r._stereo=i,r._pos=[i,0,0];else return r._stereo;for(var o=r._getSoundIds(n),a=0;a<o.length;a++){var l=r._soundById(o[a]);if(l)if(typeof i=="number")l._stereo=i,l._pos=[i,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&t(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(i,0,0):l._panner.pan.setValueAtTime(i,Howler.ctx.currentTime)),r._emit("stereo",l._id);else return l._stereo}return r},Howl.prototype.pos=function(i,n,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(i,n,r,s)}}),o;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof i=="number")o._pos=[i,n,r];else return o._pos;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var c=o._soundById(a[l]);if(c)if(typeof i=="number")c._pos=[i,n,r],c._node&&((!c._panner||c._panner.pan)&&t(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setPosition(i,n,r)),o._emit("pos",c._id);else return c._pos}return o},Howl.prototype.orientation=function(i,n,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(i,n,r,s)}}),o;if(n=typeof n!="number"?o._orientation[1]:n,r=typeof r!="number"?o._orientation[2]:r,typeof s>"u")if(typeof i=="number")o._orientation=[i,n,r];else return o._orientation;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var c=o._soundById(a[l]);if(c)if(typeof i=="number")c._orientation=[i,n,r],c._node&&(c._panner||(c._pos||(c._pos=o._pos||[0,0,-.5]),t(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(i,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setOrientation(i,n,r)),o._emit("orientation",c._id);else return c._orientation}return o},Howl.prototype.pannerAttr=function(){var i=this,n=arguments,r,s,o;if(!i._webAudio)return i;if(n.length===0)return i._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),i._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:i._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:i._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:i._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:i._panningModel});else return o=i._soundById(parseInt(n[0],10)),o?o._pannerAttr:i._pannerAttr;else n.length===2&&(r=n[0],s=parseInt(n[1],10));for(var a=i._getSoundIds(s),l=0;l<a.length;l++)if(o=i._soundById(a[l]),o){var c=o._pannerAttr;c={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:c.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:c.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:c.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:c.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:c.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:c.panningModel};var h=o._panner;h?(h.coneInnerAngle=c.coneInnerAngle,h.coneOuterAngle=c.coneOuterAngle,h.coneOuterGain=c.coneOuterGain,h.distanceModel=c.distanceModel,h.maxDistance=c.maxDistance,h.refDistance=c.refDistance,h.rolloffFactor=c.rolloffFactor,h.panningModel=c.panningModel):(o._pos||(o._pos=i._pos||[0,0,-.5]),t(o,"spatial"))}return i},Sound.prototype.init=function(i){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,i.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(i){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),i.call(this)}}(Sound.prototype.reset);var t=function(i,n){n=n||"spatial",n==="spatial"?(i._panner=Howler.ctx.createPanner(),i._panner.coneInnerAngle=i._pannerAttr.coneInnerAngle,i._panner.coneOuterAngle=i._pannerAttr.coneOuterAngle,i._panner.coneOuterGain=i._pannerAttr.coneOuterGain,i._panner.distanceModel=i._pannerAttr.distanceModel,i._panner.maxDistance=i._pannerAttr.maxDistance,i._panner.refDistance=i._pannerAttr.refDistance,i._panner.rolloffFactor=i._pannerAttr.rolloffFactor,i._panner.panningModel=i._pannerAttr.panningModel,typeof i._panner.positionX<"u"?(i._panner.positionX.setValueAtTime(i._pos[0],Howler.ctx.currentTime),i._panner.positionY.setValueAtTime(i._pos[1],Howler.ctx.currentTime),i._panner.positionZ.setValueAtTime(i._pos[2],Howler.ctx.currentTime)):i._panner.setPosition(i._pos[0],i._pos[1],i._pos[2]),typeof i._panner.orientationX<"u"?(i._panner.orientationX.setValueAtTime(i._orientation[0],Howler.ctx.currentTime),i._panner.orientationY.setValueAtTime(i._orientation[1],Howler.ctx.currentTime),i._panner.orientationZ.setValueAtTime(i._orientation[2],Howler.ctx.currentTime)):i._panner.setOrientation(i._orientation[0],i._orientation[1],i._orientation[2])):(i._panner=Howler.ctx.createStereoPanner(),i._panner.pan.setValueAtTime(i._stereo,Howler.ctx.currentTime)),i._panner.connect(i._node),i._paused||i._parent.pause(i._id,!0).play(i._id,!0)}}()}),eve=WM((e,t)=>{t.exports=function(i,n){for(var r=i.split("."),s=n.split("."),o=0;o<3;o++){var a=Number(r[o]),l=Number(s[o]);if(a>l)return 1;if(l>a)return-1;if(!isNaN(a)&&isNaN(l))return 1;if(isNaN(a)&&!isNaN(l))return-1}return 0}}),rv="149",Fo={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},tve=0,b5=1,ive=2,$I=1,nq=2,Q0=3,Ka=0,gr=1,uo=2,Hn=0,tg=1,A5=2,S5=3,M5=4,nve=5,hm=100,rve=101,sve=102,E5=103,C5=104,ove=200,ave=201,lve=202,cve=203,rq=204,sq=205,uve=206,hve=207,dve=208,fve=209,pve=210,mve=0,gve=1,vve=2,K3=3,yve=4,xve=5,wve=6,_ve=7,oq=0,bve=1,Ave=2,Zc=0,Sve=1,Mve=2,Eve=3,Cve=4,Tve=5,aq=300,Ff=301,Nf=302,Z3=303,$3=304,w1=306,Wc=1e3,Pn=1001,eB=1002,Ri=1003,T5=1004,t2=1005,Zt=1006,Pve=1007,Ig=1008,Kr=1009,Dve=1010,Bve=1011,lq=1012,Lve=1013,ch=1014,$o=1015,Og=1016,Rve=1017,Ive=1018,xf=1020,Ove=1021,Na=1023,Fve=1024,Nve=1025,wf=1026,zf=1027,zve=1028,kve=1029,cq=1030,Uve=1031,Gve=1033,i2=33776,n2=33777,r2=33778,s2=33779,P5=35840,D5=35841,B5=35842,L5=35843,Hve=36196,R5=37492,I5=37496,O5=37808,F5=37809,N5=37810,z5=37811,k5=37812,U5=37813,G5=37814,H5=37815,V5=37816,j5=37817,W5=37818,X5=37819,Y5=37820,q5=37821,o2=36492,Vve=36283,Q5=36284,J5=36285,K5=36286,Ql=3e3,Vt=3001,du=3200,uq=3201,jve=0,Wve=1,Cl="srgb",cS="srgb-linear",a2=7680,Xve=519,tB=35044,Z5="300 es",iB=1035,_s=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let i=this._listeners[e];if(i!==void 0){let n=i.indexOf(t);n!==-1&&i.splice(n,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let i=t.slice(0);for(let n=0,r=i.length;n<r;n++)i[n].call(this,e);e.target=null}}},Gr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],$5=1234567,Ay=Math.PI/180,yx=180/Math.PI;function Vl(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Gr[e&255]+Gr[e>>8&255]+Gr[e>>16&255]+Gr[e>>24&255]+"-"+Gr[t&255]+Gr[t>>8&255]+"-"+Gr[t>>16&15|64]+Gr[t>>24&255]+"-"+Gr[i&63|128]+Gr[i>>8&255]+"-"+Gr[i>>16&255]+Gr[i>>24&255]+Gr[n&255]+Gr[n>>8&255]+Gr[n>>16&255]+Gr[n>>24&255]).toLowerCase()}function Kn(e,t,i){return Math.max(t,Math.min(i,e))}function eO(e,t){return(e%t+t)%t}function Yve(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)}function qve(e,t,i){return e!==t?(i-e)/(t-e):0}function Sy(e,t,i){return(1-i)*e+i*t}function Qve(e,t,i,n){return Sy(e,t,1-Math.exp(-i*n))}function Jve(e,t=1){return t-Math.abs(eO(e,t*2)-t)}function Kve(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*(3-2*e))}function Zve(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*e*(e*(e*6-15)+10))}function $ve(e,t){return e+Math.floor(Math.random()*(t-e+1))}function e0e(e,t){return e+Math.random()*(t-e)}function t0e(e){return e*(.5-Math.random())}function i0e(e){e!==void 0&&($5=e);let t=$5+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function n0e(e){return e*Ay}function r0e(e){return e*yx}function nB(e){return(e&e-1)===0&&e!==0}function s0e(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function uS(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function o0e(e,t,i,n,r){let s=Math.cos,o=Math.sin,a=s(i/2),l=o(i/2),c=s((t+n)/2),h=o((t+n)/2),u=s((t-n)/2),d=o((t-n)/2),f=s((n-t)/2),p=o((n-t)/2);switch(r){case"XYX":e.set(a*h,l*u,l*d,a*c);break;case"YZY":e.set(l*d,a*h,l*u,a*c);break;case"ZXZ":e.set(l*u,l*d,a*h,a*c);break;case"XZX":e.set(a*h,l*p,l*f,a*c);break;case"YXY":e.set(l*f,a*h,l*p,a*c);break;case"ZYZ":e.set(l*p,l*f,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Xc(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function zi(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var si=Object.freeze({__proto__:null,DEG2RAD:Ay,RAD2DEG:yx,ceilPowerOfTwo:s0e,clamp:Kn,damp:Qve,degToRad:n0e,denormalize:Xc,euclideanModulo:eO,floorPowerOfTwo:uS,generateUUID:Vl,inverseLerp:qve,isPowerOfTwo:nB,lerp:Sy,mapLinear:Yve,normalize:zi,pingpong:Jve,radToDeg:r0e,randFloat:e0e,randFloatSpread:t0e,randInt:$ve,seededRandom:i0e,setQuaternionFromProperEuler:o0e,smootherstep:Zve,smoothstep:Kve}),ge=class{constructor(e=0,t=0){ge.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,i=this.y,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6],this.y=n[1]*t+n[4]*i+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*i-s*n+e.x,this.y=r*n+s*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Cr=class{constructor(){Cr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,n,r,s,o,a,l){let c=this.elements;return c[0]=e,c[1]=n,c[2]=o,c[3]=t,c[4]=r,c[5]=a,c[6]=i,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,n=t.elements,r=this.elements,s=i[0],o=i[3],a=i[6],l=i[1],c=i[4],h=i[7],u=i[2],d=i[5],f=i[8],p=n[0],g=n[3],m=n[6],v=n[1],x=n[4],w=n[7],b=n[2],M=n[5],A=n[8];return r[0]=s*p+o*v+a*b,r[3]=s*g+o*x+a*M,r[6]=s*m+o*w+a*A,r[1]=l*p+c*v+h*b,r[4]=l*g+c*x+h*M,r[7]=l*m+c*w+h*A,r[2]=u*p+d*v+f*b,r[5]=u*g+d*x+f*M,r[8]=u*m+d*w+f*A,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*s*c-t*o*l-i*r*c+i*o*a+n*r*l-n*s*a}invert(){let e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],h=c*s-o*l,u=o*a-c*r,d=l*r-s*a,f=t*h+i*u+n*d;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return e[0]=h*p,e[1]=(n*l-c*i)*p,e[2]=(o*i-n*s)*p,e[3]=u*p,e[4]=(c*t-n*a)*p,e[5]=(n*r-o*t)*p,e[6]=d*p,e[7]=(i*a-l*t)*p,e[8]=(s*t-i*r)*p,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,n,r,s,o){let a=Math.cos(r),l=Math.sin(r);return this.set(i*a,i*l,-i*(a*s+l*o)+s+e,-n*l,n*a,-n*(-l*s+a*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(l2.makeScale(e,t)),this}rotate(e){return this.premultiply(l2.makeRotation(-e)),this}translate(e,t){return this.premultiply(l2.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,i=e.elements;for(let n=0;n<9;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}},l2=new Cr;function hq(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var a0e={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function O_(e,t){return new a0e[e](t)}function hS(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function _f(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function fA(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var c2={[Cl]:{[cS]:_f},[cS]:{[Cl]:fA}},is={legacyMode:!0,get workingColorSpace(){return cS},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,i){if(this.legacyMode||t===i||!t||!i)return e;if(c2[t]&&c2[t][i]!==void 0){let n=c2[t][i];return e.r=n(e.r),e.g=n(e.g),e.b=n(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},dq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Xn={r:0,g:0,b:0},Aa={h:0,s:0,l:0},F_={h:0,s:0,l:0};function u2(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*6*(2/3-i):e}function N_(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var Pt=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Cl){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,is.toWorkingColorSpace(this,t),this}setRGB(e,t,i,n=is.workingColorSpace){return this.r=e,this.g=t,this.b=i,is.toWorkingColorSpace(this,n),this}setHSL(e,t,i,n=is.workingColorSpace){if(e=eO(e,1),t=Kn(t,0,1),i=Kn(i,0,1),t===0)this.r=this.g=this.b=i;else{let r=i<=.5?i*(1+t):i+t-i*t,s=2*i-r;this.r=u2(s,r,e+1/3),this.g=u2(s,r,e),this.b=u2(s,r,e-1/3)}return is.toWorkingColorSpace(this,n),this}setStyle(e,t=Cl){function i(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let r,s=n[1],o=n[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,is.toWorkingColorSpace(this,t),i(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,is.toWorkingColorSpace(this,t),i(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){let a=parseFloat(r[1])/360,l=parseFloat(r[2])/100,c=parseFloat(r[3])/100;return i(r[4]),this.setHSL(a,l,c,t)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){let r=n[1],s=r.length;if(s===3)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,is.toWorkingColorSpace(this,t),this;if(s===6)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,is.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Cl){let i=dq[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=_f(e.r),this.g=_f(e.g),this.b=_f(e.b),this}copyLinearToSRGB(e){return this.r=fA(e.r),this.g=fA(e.g),this.b=fA(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Cl){return is.fromWorkingColorSpace(N_(this,Xn),e),Kn(Xn.r*255,0,255)<<16^Kn(Xn.g*255,0,255)<<8^Kn(Xn.b*255,0,255)<<0}getHexString(e=Cl){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=is.workingColorSpace){is.fromWorkingColorSpace(N_(this,Xn),t);let i=Xn.r,n=Xn.g,r=Xn.b,s=Math.max(i,n,r),o=Math.min(i,n,r),a,l,c=(o+s)/2;if(o===s)a=0,l=0;else{let h=s-o;switch(l=c<=.5?h/(s+o):h/(2-s-o),s){case i:a=(n-r)/h+(n<r?6:0);break;case n:a=(r-i)/h+2;break;case r:a=(i-n)/h+4;break}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e,t=is.workingColorSpace){return is.fromWorkingColorSpace(N_(this,Xn),t),e.r=Xn.r,e.g=Xn.g,e.b=Xn.b,e}getStyle(e=Cl){return is.fromWorkingColorSpace(N_(this,Xn),e),e!==Cl?`color(${e} ${Xn.r} ${Xn.g} ${Xn.b})`:`rgb(${Xn.r*255|0},${Xn.g*255|0},${Xn.b*255|0})`}offsetHSL(e,t,i){return this.getHSL(Aa),Aa.h+=e,Aa.s+=t,Aa.l+=i,this.setHSL(Aa.h,Aa.s,Aa.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Aa),e.getHSL(F_);let i=Sy(Aa.h,F_.h,t),n=Sy(Aa.s,F_.s,t),r=Sy(Aa.l,F_.l,t);return this.setHSL(i,n,r),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Pt.NAMES=dq;var Fp,fq=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Fp===void 0&&(Fp=hS("canvas")),Fp.width=e.width,Fp.height=e.height;let i=Fp.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Fp}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=hS("canvas");t.width=e.width,t.height=e.height;let i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let n=i.getImageData(0,0,e.width,e.height),r=n.data;for(let s=0;s<r.length;s++)r[s]=_f(r[s]/255)*255;return i.putImageData(n,0,0),t}else if(e.data){let t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(_f(t[i]/255)*255):t[i]=_f(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},pq=class{constructor(e=null){this.isSource=!0,this.uuid=Vl(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let r;if(Array.isArray(n)){r=[];for(let s=0,o=n.length;s<o;s++)n[s].isDataTexture?r.push(h2(n[s].image)):r.push(h2(n[s]))}else r=h2(n);i.url=r}return t||(e.images[this.uuid]=i),i}};function h2(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?fq.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var l0e=0,tr=class extends _s{constructor(e=tr.DEFAULT_IMAGE,t=tr.DEFAULT_MAPPING,i=Pn,n=Pn,r=Zt,s=Ig,o=Na,a=Kr,l=tr.DEFAULT_ANISOTROPY,c=Ql){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:l0e++}),this.uuid=Vl(),this.name="",this.source=new pq(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=n,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new ge(0,0),this.repeat=new ge(1,1),this.center=new ge(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Cr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==aq)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Wc:e.x=e.x-Math.floor(e.x);break;case Pn:e.x=e.x<0?0:1;break;case eB:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Wc:e.y=e.y-Math.floor(e.y);break;case Pn:e.y=e.y<0?0:1;break;case eB:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};tr.DEFAULT_IMAGE=null;tr.DEFAULT_MAPPING=aq;tr.DEFAULT_ANISOTROPY=1;var Kt=class{constructor(e=0,t=0,i=0,n=1){Kt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,i=this.y,n=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*n+s[12]*r,this.y=s[1]*t+s[5]*i+s[9]*n+s[13]*r,this.z=s[2]*t+s[6]*i+s[10]*n+s[14]*r,this.w=s[3]*t+s[7]*i+s[11]*n+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,n,r,s=e.elements,o=s[0],a=s[4],l=s[8],c=s[1],h=s[5],u=s[9],d=s[2],f=s[6],p=s[10];if(Math.abs(a-c)<.01&&Math.abs(l-d)<.01&&Math.abs(u-f)<.01){if(Math.abs(a+c)<.1&&Math.abs(l+d)<.1&&Math.abs(u+f)<.1&&Math.abs(o+h+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let m=(o+1)/2,v=(h+1)/2,x=(p+1)/2,w=(a+c)/4,b=(l+d)/4,M=(u+f)/4;return m>v&&m>x?m<.01?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(m),n=w/i,r=b/i):v>x?v<.01?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(v),i=w/n,r=M/n):x<.01?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(x),i=b/r,n=M/r),this.set(i,n,r,t),this}let g=Math.sqrt((f-u)*(f-u)+(l-d)*(l-d)+(c-a)*(c-a));return Math.abs(g)<.001&&(g=1),this.x=(f-u)/g,this.y=(l-d)/g,this.z=(c-a)/g,this.w=Math.acos((o+h+p-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Pi=class extends _s{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Kt(0,0,e,t),this.scissorTest=!1,this.viewport=new Kt(0,0,e,t);let n={width:e,height:t,depth:1};this.texture=new tr(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Zt,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new pq(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},mq=class extends tr{constructor(e=null,t=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=Ri,this.minFilter=Ri,this.wrapR=Pn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},c0e=class extends tr{constructor(e=null,t=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=Ri,this.minFilter=Ri,this.wrapR=Pn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},u0e=class extends Pi{constructor(e=1,t=1,i=1,n={}){super(e,t,n),this.isWebGLMultipleRenderTargets=!0;let r=this.texture;this.texture=[];for(let s=0;s<i;s++)this.texture[s]=r.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let n=0,r=this.texture.length;n<r;n++)this.texture[n].image.width=e,this.texture[n].image.height=t,this.texture[n].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},ai=class{constructor(e=0,t=0,i=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=n}static slerpFlat(e,t,i,n,r,s,o){let a=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3],u=r[s+0],d=r[s+1],f=r[s+2],p=r[s+3];if(o===0){e[t+0]=a,e[t+1]=l,e[t+2]=c,e[t+3]=h;return}if(o===1){e[t+0]=u,e[t+1]=d,e[t+2]=f,e[t+3]=p;return}if(h!==p||a!==u||l!==d||c!==f){let g=1-o,m=a*u+l*d+c*f+h*p,v=m>=0?1:-1,x=1-m*m;if(x>Number.EPSILON){let b=Math.sqrt(x),M=Math.atan2(b,m*v);g=Math.sin(g*M)/b,o=Math.sin(o*M)/b}let w=o*v;if(a=a*g+u*w,l=l*g+d*w,c=c*g+f*w,h=h*g+p*w,g===1-o){let b=1/Math.sqrt(a*a+l*l+c*c+h*h);a*=b,l*=b,c*=b,h*=b}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,n,r,s){let o=i[n],a=i[n+1],l=i[n+2],c=i[n+3],h=r[s],u=r[s+1],d=r[s+2],f=r[s+3];return e[t]=o*f+c*h+a*d-l*u,e[t+1]=a*f+c*u+l*h-o*d,e[t+2]=l*f+c*d+o*u-a*h,e[t+3]=c*f-o*h-a*u-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let i=e._x,n=e._y,r=e._z,s=e._order,o=Math.cos,a=Math.sin,l=o(i/2),c=o(n/2),h=o(r/2),u=a(i/2),d=a(n/2),f=a(r/2);switch(s){case"XYZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"YXZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"ZXY":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"ZYX":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"YZX":this._x=u*c*h+l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h-u*d*f;break;case"XZY":this._x=u*c*h-l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h+u*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],n=t[4],r=t[8],s=t[1],o=t[5],a=t[9],l=t[2],c=t[6],h=t[10],u=i+o+h;if(u>0){let d=.5/Math.sqrt(u+1);this._w=.25/d,this._x=(c-a)*d,this._y=(r-l)*d,this._z=(s-n)*d}else if(i>o&&i>h){let d=2*Math.sqrt(1+i-o-h);this._w=(c-a)/d,this._x=.25*d,this._y=(n+s)/d,this._z=(r+l)/d}else if(o>h){let d=2*Math.sqrt(1+o-i-h);this._w=(r-l)/d,this._x=(n+s)/d,this._y=.25*d,this._z=(a+c)/d}else{let d=2*Math.sqrt(1+h-i-o);this._w=(s-n)/d,this._x=(r+l)/d,this._y=(a+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Kn(this.dot(e),-1,1)))}rotateTowards(e,t){let i=this.angleTo(e);if(i===0)return this;let n=Math.min(1,t/i);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,n=e._y,r=e._z,s=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=i*c+s*o+n*l-r*a,this._y=n*c+s*a+r*o-i*l,this._z=r*c+s*l+i*a-n*o,this._w=s*c-i*o-n*a-r*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let i=this._x,n=this._y,r=this._z,s=this._w,o=s*e._w+i*e._x+n*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=i,this._y=n,this._z=r,this;let a=1-o*o;if(a<=Number.EPSILON){let d=1-t;return this._w=d*s+t*this._w,this._x=d*i+t*this._x,this._y=d*n+t*this._y,this._z=d*r+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(a),c=Math.atan2(l,o),h=Math.sin((1-t)*c)/l,u=Math.sin(t*c)/l;return this._w=s*h+this._w*u,this._x=i*h+this._x*u,this._y=n*h+this._y*u,this._z=r*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){let e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),n=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(n),i*Math.sin(r),i*Math.cos(r),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},I=class{constructor(e=0,t=0,i=0){I.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(eG.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(eG.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,n=this.z,r=e.elements,s=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*s,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*s,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*s,this}applyQuaternion(e){let t=this.x,i=this.y,n=this.z,r=e.x,s=e.y,o=e.z,a=e.w,l=a*t+s*n-o*i,c=a*i+o*t-r*n,h=a*n+r*i-s*t,u=-r*t-s*i-o*n;return this.x=l*a+u*-r+c*-o-h*-s,this.y=c*a+u*-s+h*-r-l*-o,this.z=h*a+u*-o+l*-s-c*-r,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,n=e.y,r=e.z,s=t.x,o=t.y,a=t.z;return this.x=n*a-r*o,this.y=r*s-i*a,this.z=i*o-n*s,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return d2.copy(this).projectOnVector(e),this.sub(d2)}reflect(e){return this.sub(d2.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(Kn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){let n=Math.sin(t)*e;return this.x=n*Math.sin(i),this.y=Math.cos(t)*e,this.z=n*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},d2=new I,eG=new ai,Vn=class{constructor(e=new I(1/0,1/0,1/0),t=new I(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=e.length;a<l;a+=3){let c=e[a],h=e[a+1],u=e[a+2];c<t&&(t=c),h<i&&(i=h),u<n&&(n=u),c>r&&(r=c),h>s&&(s=h),u>o&&(o=u)}return this.min.set(t,i,n),this.max.set(r,s,o),this}setFromBufferAttribute(e){let t=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=e.count;a<l;a++){let c=e.getX(a),h=e.getY(a),u=e.getZ(a);c<t&&(t=c),h<i&&(i=h),u<n&&(n=u),c>r&&(r=c),h>s&&(s=h),u>o&&(o=u)}return this.min.set(t,i,n),this.max.set(r,s,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=Ad.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0)if(t&&i.attributes!=null&&i.attributes.position!==void 0){let r=i.attributes.position;for(let s=0,o=r.count;s<o;s++)Ad.fromBufferAttribute(r,s).applyMatrix4(e.matrixWorld),this.expandByPoint(Ad)}else i.boundingBox===null&&i.computeBoundingBox(),f2.copy(i.boundingBox),f2.applyMatrix4(e.matrixWorld),this.union(f2);let n=e.children;for(let r=0,s=n.length;r<s;r++)this.expandByObject(n[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ad),Ad.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(h0),z_.subVectors(this.max,h0),Np.subVectors(e.a,h0),zp.subVectors(e.b,h0),kp.subVectors(e.c,h0),Du.subVectors(zp,Np),Bu.subVectors(kp,zp),Sd.subVectors(Np,kp);let t=[0,-Du.z,Du.y,0,-Bu.z,Bu.y,0,-Sd.z,Sd.y,Du.z,0,-Du.x,Bu.z,0,-Bu.x,Sd.z,0,-Sd.x,-Du.y,Du.x,0,-Bu.y,Bu.x,0,-Sd.y,Sd.x,0];return!p2(t,Np,zp,kp,z_)||(t=[1,0,0,0,1,0,0,0,1],!p2(t,Np,zp,kp,z_))?!1:(k_.crossVectors(Du,Bu),t=[k_.x,k_.y,k_.z],p2(t,Np,zp,kp,z_))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ad.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Ad).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(vc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),vc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),vc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),vc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),vc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),vc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),vc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),vc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(vc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},vc=[new I,new I,new I,new I,new I,new I,new I,new I],Ad=new I,f2=new Vn,Np=new I,zp=new I,kp=new I,Du=new I,Bu=new I,Sd=new I,h0=new I,z_=new I,k_=new I,Md=new I;function p2(e,t,i,n,r){for(let s=0,o=e.length-3;s<=o;s+=3){Md.fromArray(e,s);let a=r.x*Math.abs(Md.x)+r.y*Math.abs(Md.y)+r.z*Math.abs(Md.z),l=t.dot(Md),c=i.dot(Md),h=n.dot(Md);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}var h0e=new Vn,d0=new I,m2=new I,ua=class{constructor(e=new I,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let i=this.center;t!==void 0?i.copy(t):h0e.setFromPoints(e).getCenter(i);let n=0;for(let r=0,s=e.length;r<s;r++)n=Math.max(n,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;d0.subVectors(e,this.center);let t=d0.lengthSq();if(t>this.radius*this.radius){let i=Math.sqrt(t),n=(i-this.radius)*.5;this.center.addScaledVector(d0,n/i),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(m2.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(d0.copy(e.center).add(m2)),this.expandByPoint(d0.copy(e.center).sub(m2))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},yc=new I,g2=new I,U_=new I,Lu=new I,v2=new I,G_=new I,y2=new I,sv=class{constructor(e=new I,t=new I(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,yc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=yc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(yc.copy(this.direction).multiplyScalar(t).add(this.origin),yc.distanceToSquared(e))}distanceSqToSegment(e,t,i,n){g2.copy(e).add(t).multiplyScalar(.5),U_.copy(t).sub(e).normalize(),Lu.copy(this.origin).sub(g2);let r=e.distanceTo(t)*.5,s=-this.direction.dot(U_),o=Lu.dot(this.direction),a=-Lu.dot(U_),l=Lu.lengthSq(),c=Math.abs(1-s*s),h,u,d,f;if(c>0)if(h=s*a-o,u=s*o-a,f=r*c,h>=0)if(u>=-f)if(u<=f){let p=1/c;h*=p,u*=p,d=h*(h+s*u+2*o)+u*(s*h+u+2*a)+l}else u=r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;else u=-r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;else u<=-f?(h=Math.max(0,-(-s*r+o)),u=h>0?-r:Math.min(Math.max(-r,-a),r),d=-h*h+u*(u+2*a)+l):u<=f?(h=0,u=Math.min(Math.max(-r,-a),r),d=u*(u+2*a)+l):(h=Math.max(0,-(s*r+o)),u=h>0?r:Math.min(Math.max(-r,-a),r),d=-h*h+u*(u+2*a)+l);else u=s>0?-r:r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;return i&&i.copy(this.direction).multiplyScalar(h).add(this.origin),n&&n.copy(U_).multiplyScalar(u).add(g2),d}intersectSphere(e,t){yc.subVectors(e.center,this.origin);let i=yc.dot(this.direction),n=yc.dot(yc)-i*i,r=e.radius*e.radius;if(n>r)return null;let s=Math.sqrt(r-n),o=i-s,a=i+s;return o<0&&a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){let i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,n,r,s,o,a,l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(i=(e.min.x-u.x)*l,n=(e.max.x-u.x)*l):(i=(e.max.x-u.x)*l,n=(e.min.x-u.x)*l),c>=0?(r=(e.min.y-u.y)*c,s=(e.max.y-u.y)*c):(r=(e.max.y-u.y)*c,s=(e.min.y-u.y)*c),i>s||r>n||((r>i||isNaN(i))&&(i=r),(s<n||isNaN(n))&&(n=s),h>=0?(o=(e.min.z-u.z)*h,a=(e.max.z-u.z)*h):(o=(e.max.z-u.z)*h,a=(e.min.z-u.z)*h),i>a||o>n)||((o>i||i!==i)&&(i=o),(a<n||n!==n)&&(n=a),n<0)?null:this.at(i>=0?i:n,t)}intersectsBox(e){return this.intersectBox(e,yc)!==null}intersectTriangle(e,t,i,n,r){v2.subVectors(t,e),G_.subVectors(i,e),y2.crossVectors(v2,G_);let s=this.direction.dot(y2),o;if(s>0){if(n)return null;o=1}else if(s<0)o=-1,s=-s;else return null;Lu.subVectors(this.origin,e);let a=o*this.direction.dot(G_.crossVectors(Lu,G_));if(a<0)return null;let l=o*this.direction.dot(v2.cross(Lu));if(l<0||a+l>s)return null;let c=-o*Lu.dot(y2);return c<0?null:this.at(c/s,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Je=class{constructor(){Je.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,g){let m=this.elements;return m[0]=e,m[4]=t,m[8]=i,m[12]=n,m[1]=r,m[5]=s,m[9]=o,m[13]=a,m[2]=l,m[6]=c,m[10]=h,m[14]=u,m[3]=d,m[7]=f,m[11]=p,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Je().fromArray(this.elements)}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){let t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,i=e.elements,n=1/Up.setFromMatrixColumn(e,0).length(),r=1/Up.setFromMatrixColumn(e,1).length(),s=1/Up.setFromMatrixColumn(e,2).length();return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t[3]=0,t[4]=i[4]*r,t[5]=i[5]*r,t[6]=i[6]*r,t[7]=0,t[8]=i[8]*s,t[9]=i[9]*s,t[10]=i[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,n=e.y,r=e.z,s=Math.cos(i),o=Math.sin(i),a=Math.cos(n),l=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if(e.order==="XYZ"){let u=s*c,d=s*h,f=o*c,p=o*h;t[0]=a*c,t[4]=-a*h,t[8]=l,t[1]=d+f*l,t[5]=u-p*l,t[9]=-o*a,t[2]=p-u*l,t[6]=f+d*l,t[10]=s*a}else if(e.order==="YXZ"){let u=a*c,d=a*h,f=l*c,p=l*h;t[0]=u+p*o,t[4]=f*o-d,t[8]=s*l,t[1]=s*h,t[5]=s*c,t[9]=-o,t[2]=d*o-f,t[6]=p+u*o,t[10]=s*a}else if(e.order==="ZXY"){let u=a*c,d=a*h,f=l*c,p=l*h;t[0]=u-p*o,t[4]=-s*h,t[8]=f+d*o,t[1]=d+f*o,t[5]=s*c,t[9]=p-u*o,t[2]=-s*l,t[6]=o,t[10]=s*a}else if(e.order==="ZYX"){let u=s*c,d=s*h,f=o*c,p=o*h;t[0]=a*c,t[4]=f*l-d,t[8]=u*l+p,t[1]=a*h,t[5]=p*l+u,t[9]=d*l-f,t[2]=-l,t[6]=o*a,t[10]=s*a}else if(e.order==="YZX"){let u=s*a,d=s*l,f=o*a,p=o*l;t[0]=a*c,t[4]=p-u*h,t[8]=f*h+d,t[1]=h,t[5]=s*c,t[9]=-o*c,t[2]=-l*c,t[6]=d*h+f,t[10]=u-p*h}else if(e.order==="XZY"){let u=s*a,d=s*l,f=o*a,p=o*l;t[0]=a*c,t[4]=-h,t[8]=l*c,t[1]=u*h+p,t[5]=s*c,t[9]=d*h-f,t[2]=f*h-d,t[6]=o*c,t[10]=p*h+u}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(d0e,e,f0e)}lookAt(e,t,i){let n=this.elements;return to.subVectors(e,t),to.lengthSq()===0&&(to.z=1),to.normalize(),Ru.crossVectors(i,to),Ru.lengthSq()===0&&(Math.abs(i.z)===1?to.x+=1e-4:to.z+=1e-4,to.normalize(),Ru.crossVectors(i,to)),Ru.normalize(),H_.crossVectors(to,Ru),n[0]=Ru.x,n[4]=H_.x,n[8]=to.x,n[1]=Ru.y,n[5]=H_.y,n[9]=to.y,n[2]=Ru.z,n[6]=H_.z,n[10]=to.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,n=t.elements,r=this.elements,s=i[0],o=i[4],a=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],f=i[2],p=i[6],g=i[10],m=i[14],v=i[3],x=i[7],w=i[11],b=i[15],M=n[0],A=n[4],T=n[8],S=n[12],C=n[1],P=n[5],B=n[9],k=n[13],z=n[2],F=n[6],W=n[10],K=n[14],Z=n[3],U=n[7],X=n[11],V=n[15];return r[0]=s*M+o*C+a*z+l*Z,r[4]=s*A+o*P+a*F+l*U,r[8]=s*T+o*B+a*W+l*X,r[12]=s*S+o*k+a*K+l*V,r[1]=c*M+h*C+u*z+d*Z,r[5]=c*A+h*P+u*F+d*U,r[9]=c*T+h*B+u*W+d*X,r[13]=c*S+h*k+u*K+d*V,r[2]=f*M+p*C+g*z+m*Z,r[6]=f*A+p*P+g*F+m*U,r[10]=f*T+p*B+g*W+m*X,r[14]=f*S+p*k+g*K+m*V,r[3]=v*M+x*C+w*z+b*Z,r[7]=v*A+x*P+w*F+b*U,r[11]=v*T+x*B+w*W+b*X,r[15]=v*S+x*k+w*K+b*V,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],s=e[1],o=e[5],a=e[9],l=e[13],c=e[2],h=e[6],u=e[10],d=e[14],f=e[3],p=e[7],g=e[11],m=e[15];return f*(+r*a*h-n*l*h-r*o*u+i*l*u+n*o*d-i*a*d)+p*(+t*a*d-t*l*u+r*s*u-n*s*d+n*l*c-r*a*c)+g*(+t*l*h-t*o*d-r*s*h+i*s*d+r*o*c-i*l*c)+m*(-n*o*c-t*a*h+t*o*u+n*s*h-i*s*u+i*a*c)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=i),this}invert(){let e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],h=e[9],u=e[10],d=e[11],f=e[12],p=e[13],g=e[14],m=e[15],v=h*g*l-p*u*l+p*a*d-o*g*d-h*a*m+o*u*m,x=f*u*l-c*g*l-f*a*d+s*g*d+c*a*m-s*u*m,w=c*p*l-f*h*l+f*o*d-s*p*d-c*o*m+s*h*m,b=f*h*a-c*p*a-f*o*u+s*p*u+c*o*g-s*h*g,M=t*v+i*x+n*w+r*b;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let A=1/M;return e[0]=v*A,e[1]=(p*u*r-h*g*r-p*n*d+i*g*d+h*n*m-i*u*m)*A,e[2]=(o*g*r-p*a*r+p*n*l-i*g*l-o*n*m+i*a*m)*A,e[3]=(h*a*r-o*u*r-h*n*l+i*u*l+o*n*d-i*a*d)*A,e[4]=x*A,e[5]=(c*g*r-f*u*r+f*n*d-t*g*d-c*n*m+t*u*m)*A,e[6]=(f*a*r-s*g*r-f*n*l+t*g*l+s*n*m-t*a*m)*A,e[7]=(s*u*r-c*a*r+c*n*l-t*u*l-s*n*d+t*a*d)*A,e[8]=w*A,e[9]=(f*h*r-c*p*r-f*i*d+t*p*d+c*i*m-t*h*m)*A,e[10]=(s*p*r-f*o*r+f*i*l-t*p*l-s*i*m+t*o*m)*A,e[11]=(c*o*r-s*h*r-c*i*l+t*h*l+s*i*d-t*o*d)*A,e[12]=b*A,e[13]=(c*p*n-f*h*n+f*i*u-t*p*u-c*i*g+t*h*g)*A,e[14]=(f*o*n-s*p*n-f*i*a+t*p*a+s*i*g-t*o*g)*A,e[15]=(s*h*n-c*o*n+c*i*a-t*h*a-s*i*u+t*o*u)*A,this}scale(e){let t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let i=Math.cos(t),n=Math.sin(t),r=1-i,s=e.x,o=e.y,a=e.z,l=r*s,c=r*o;return this.set(l*s+i,l*o-n*a,l*a+n*o,0,l*o+n*a,c*o+i,c*a-n*s,0,l*a-n*o,c*a+n*s,r*a*a+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,n,r,s){return this.set(1,i,r,0,e,1,s,0,t,n,1,0,0,0,0,1),this}compose(e,t,i){let n=this.elements,r=t._x,s=t._y,o=t._z,a=t._w,l=r+r,c=s+s,h=o+o,u=r*l,d=r*c,f=r*h,p=s*c,g=s*h,m=o*h,v=a*l,x=a*c,w=a*h,b=i.x,M=i.y,A=i.z;return n[0]=(1-(p+m))*b,n[1]=(d+w)*b,n[2]=(f-x)*b,n[3]=0,n[4]=(d-w)*M,n[5]=(1-(u+m))*M,n[6]=(g+v)*M,n[7]=0,n[8]=(f+x)*A,n[9]=(g-v)*A,n[10]=(1-(u+p))*A,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,i){let n=this.elements,r=Up.set(n[0],n[1],n[2]).length(),s=Up.set(n[4],n[5],n[6]).length(),o=Up.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),e.x=n[12],e.y=n[13],e.z=n[14],Sa.copy(this);let a=1/r,l=1/s,c=1/o;return Sa.elements[0]*=a,Sa.elements[1]*=a,Sa.elements[2]*=a,Sa.elements[4]*=l,Sa.elements[5]*=l,Sa.elements[6]*=l,Sa.elements[8]*=c,Sa.elements[9]*=c,Sa.elements[10]*=c,t.setFromRotationMatrix(Sa),i.x=r,i.y=s,i.z=o,this}makePerspective(e,t,i,n,r,s){let o=this.elements,a=2*r/(t-e),l=2*r/(i-n),c=(t+e)/(t-e),h=(i+n)/(i-n),u=-(s+r)/(s-r),d=-2*s*r/(s-r);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,i,n,r,s){let o=this.elements,a=1/(t-e),l=1/(i-n),c=1/(s-r),h=(t+e)*a,u=(i+n)*l,d=(s+r)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){let t=this.elements,i=e.elements;for(let n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}},Up=new I,Sa=new Je,d0e=new I(0,0,0),f0e=new I(1,1,1),Ru=new I,H_=new I,to=new I,tG=new Je,iG=new ai,Er=class{constructor(e=0,t=0,i=0,n=Er.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,n=this._order){return this._x=e,this._y=t,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){let n=e.elements,r=n[0],s=n[4],o=n[8],a=n[1],l=n[5],c=n[9],h=n[2],u=n[6],d=n[10];switch(t){case"XYZ":this._y=Math.asin(Kn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Kn(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(Kn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-Kn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Kn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Kn(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return tG.makeRotationFromQuaternion(e),this.setFromRotationMatrix(tG,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return iG.setFromEuler(this),this.setFromQuaternion(iG,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Er.DEFAULT_ORDER="XYZ";var tO=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},p0e=0,nG=new I,Gp=new ai,xc=new Je,V_=new I,f0=new I,m0e=new I,g0e=new ai,rG=new I(1,0,0),sG=new I(0,1,0),oG=new I(0,0,1),v0e={type:"added"},aG={type:"removed"},Ii=class extends _s{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:p0e++}),this.uuid=Vl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ii.DEFAULT_UP.clone();let e=new I,t=new Er,i=new ai,n=new I(1,1,1);function r(){i.setFromEuler(t,!1)}function s(){t.setFromQuaternion(i,void 0,!1)}t._onChange(r),i._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Je},normalMatrix:{value:new Cr}}),this.matrix=new Je,this.matrixWorld=new Je,this.matrixAutoUpdate=Ii.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Ii.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new tO,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Gp.setFromAxisAngle(e,t),this.quaternion.multiply(Gp),this}rotateOnWorldAxis(e,t){return Gp.setFromAxisAngle(e,t),this.quaternion.premultiply(Gp),this}rotateX(e){return this.rotateOnAxis(rG,e)}rotateY(e){return this.rotateOnAxis(sG,e)}rotateZ(e){return this.rotateOnAxis(oG,e)}translateOnAxis(e,t){return nG.copy(e).applyQuaternion(this.quaternion),this.position.add(nG.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(rG,e)}translateY(e){return this.translateOnAxis(sG,e)}translateZ(e){return this.translateOnAxis(oG,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(xc.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?V_.copy(e):V_.set(e,t,i);let n=this.parent;this.updateWorldMatrix(!0,!1),f0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?xc.lookAt(f0,V_,this.up):xc.lookAt(V_,f0,this.up),this.quaternion.setFromRotationMatrix(xc),n&&(xc.extractRotation(n.matrixWorld),Gp.setFromRotationMatrix(xc),this.quaternion.premultiply(Gp.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(v0e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(aG)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(aG)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),xc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),xc.multiply(e.parent.matrixWorld)),e.applyMatrix4(xc),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,n=this.children.length;i<n;i++){let r=this.children[i].getObjectByProperty(e,t);if(r!==void 0)return r}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let n=0,r=this.children.length;n<r;n++){let s=this.children[n].getObjectsByProperty(e,t);s.length>0&&(i=i.concat(s))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(f0,e,m0e),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(f0,g0e,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let i=0,n=t.length;i<n;i++){let r=t[i];(r.matrixWorldAutoUpdate===!0||e===!0)&&r.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let n=this.children;for(let r=0,s=n.length;r<s;r++){let o=n[r];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function r(o,a){return o[a.uuid]===void 0&&(o[a.uuid]=a.toJSON(e)),a.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=r(e.geometries,this.geometry);let o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){let a=o.shapes;if(Array.isArray(a))for(let l=0,c=a.length;l<c;l++){let h=a[l];r(e.shapes,h)}else r(e.shapes,a)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let o=[];for(let a=0,l=this.material.length;a<l;a++)o.push(r(e.materials,this.material[a]));n.material=o}else n.material=r(e.materials,this.material);if(this.children.length>0){n.children=[];for(let o=0;o<this.children.length;o++)n.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let o=0;o<this.animations.length;o++){let a=this.animations[o];n.animations.push(r(e.animations,a))}}if(t){let o=s(e.geometries),a=s(e.materials),l=s(e.textures),c=s(e.images),h=s(e.shapes),u=s(e.skeletons),d=s(e.animations),f=s(e.nodes);o.length>0&&(i.geometries=o),a.length>0&&(i.materials=a),l.length>0&&(i.textures=l),c.length>0&&(i.images=c),h.length>0&&(i.shapes=h),u.length>0&&(i.skeletons=u),d.length>0&&(i.animations=d),f.length>0&&(i.nodes=f)}return i.object=n,i;function s(o){let a=[];for(let l in o){let c=o[l];delete c.metadata,a.push(c)}return a}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){let n=e.children[i];this.add(n.clone())}return this}};Ii.DEFAULT_UP=new I(0,1,0);Ii.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ii.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Ma=new I,wc=new I,x2=new I,_c=new I,Hp=new I,Vp=new I,lG=new I,w2=new I,_2=new I,b2=new I,Rs=class{constructor(e=new I,t=new I,i=new I){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,n){n.subVectors(i,t),Ma.subVectors(e,t),n.cross(Ma);let r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(e,t,i,n,r){Ma.subVectors(n,t),wc.subVectors(i,t),x2.subVectors(e,t);let s=Ma.dot(Ma),o=Ma.dot(wc),a=Ma.dot(x2),l=wc.dot(wc),c=wc.dot(x2),h=s*l-o*o;if(h===0)return r.set(-2,-1,-1);let u=1/h,d=(l*a-o*c)*u,f=(s*c-o*a)*u;return r.set(1-d-f,f,d)}static containsPoint(e,t,i,n){return this.getBarycoord(e,t,i,n,_c),_c.x>=0&&_c.y>=0&&_c.x+_c.y<=1}static getUV(e,t,i,n,r,s,o,a){return this.getBarycoord(e,t,i,n,_c),a.set(0,0),a.addScaledVector(r,_c.x),a.addScaledVector(s,_c.y),a.addScaledVector(o,_c.z),a}static isFrontFacing(e,t,i,n){return Ma.subVectors(i,t),wc.subVectors(e,t),Ma.cross(wc).dot(n)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,i,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ma.subVectors(this.c,this.b),wc.subVectors(this.a,this.b),Ma.cross(wc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Rs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Rs.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,n,r){return Rs.getUV(e,this.a,this.b,this.c,t,i,n,r)}containsPoint(e){return Rs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Rs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let i=this.a,n=this.b,r=this.c,s,o;Hp.subVectors(n,i),Vp.subVectors(r,i),w2.subVectors(e,i);let a=Hp.dot(w2),l=Vp.dot(w2);if(a<=0&&l<=0)return t.copy(i);_2.subVectors(e,n);let c=Hp.dot(_2),h=Vp.dot(_2);if(c>=0&&h<=c)return t.copy(n);let u=a*h-c*l;if(u<=0&&a>=0&&c<=0)return s=a/(a-c),t.copy(i).addScaledVector(Hp,s);b2.subVectors(e,r);let d=Hp.dot(b2),f=Vp.dot(b2);if(f>=0&&d<=f)return t.copy(r);let p=d*l-a*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),t.copy(i).addScaledVector(Vp,o);let g=c*f-d*h;if(g<=0&&h-c>=0&&d-f>=0)return lG.subVectors(r,n),o=(h-c)/(h-c+(d-f)),t.copy(n).addScaledVector(lG,o);let m=1/(g+p+u);return s=p*m,o=u*m,t.copy(i).addScaledVector(Hp,s).addScaledVector(Vp,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},y0e=0,_1=class extends _s{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:y0e++}),this.uuid=Vl(),this.name="",this.type="Material",this.blending=tg,this.side=Ka,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=rq,this.blendDst=sq,this.blendEquation=hm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=K3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Xve,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=a2,this.stencilZFail=a2,this.stencilZPass=a2,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let i=e[t];if(i===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let n=this[t];if(n===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[t]=i}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==tg&&(i.blending=this.blending),this.side!==Ka&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function n(r){let s=[];for(let o in r){let a=r[o];delete a.metadata,s.push(a)}return s}if(t){let r=n(e.textures),s=n(e.images);r.length>0&&(i.textures=r),s.length>0&&(i.images=s)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,i=null;if(t!==null){let n=t.length;i=new Array(n);for(let r=0;r!==n;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},ov=class extends _1{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=oq,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},On=new I,j_=new ge,zt=class{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=tB,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[i+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)j_.fromBufferAttribute(this,t),j_.applyMatrix3(e),this.setXY(t,j_.x,j_.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)On.fromBufferAttribute(this,t),On.applyMatrix3(e),this.setXYZ(t,On.x,On.y,On.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)On.fromBufferAttribute(this,t),On.applyMatrix4(e),this.setXYZ(t,On.x,On.y,On.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)On.fromBufferAttribute(this,t),On.applyNormalMatrix(e),this.setXYZ(t,On.x,On.y,On.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)On.fromBufferAttribute(this,t),On.transformDirection(e),this.setXYZ(t,On.x,On.y,On.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Xc(t,this.array)),t}setX(e,t){return this.normalized&&(t=zi(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Xc(t,this.array)),t}setY(e,t){return this.normalized&&(t=zi(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Xc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=zi(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Xc(t,this.array)),t}setW(e,t){return this.normalized&&(t=zi(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=zi(t,this.array),i=zi(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,n){return e*=this.itemSize,this.normalized&&(t=zi(t,this.array),i=zi(i,this.array),n=zi(n,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this}setXYZW(e,t,i,n,r){return e*=this.itemSize,this.normalized&&(t=zi(t,this.array),i=zi(i,this.array),n=zi(n,this.array),r=zi(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==tB&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},gq=class extends zt{constructor(e,t,i){super(new Uint16Array(e),t,i)}},ig=class extends zt{constructor(e,t,i){super(new Uint32Array(e),t,i)}},gt=class extends zt{constructor(e,t,i){super(new Float32Array(e),t,i)}},x0e=0,No=new Je,A2=new Ii,jp=new I,io=new Vn,p0=new Vn,fr=new I,Ot=class extends _s{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:x0e++}),this.uuid=Vl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(hq(e)?ig:gq)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let r=new Cr().getNormalMatrix(e);i.applyNormalMatrix(r),i.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return No.makeRotationFromQuaternion(e),this.applyMatrix4(No),this}rotateX(e){return No.makeRotationX(e),this.applyMatrix4(No),this}rotateY(e){return No.makeRotationY(e),this.applyMatrix4(No),this}rotateZ(e){return No.makeRotationZ(e),this.applyMatrix4(No),this}translate(e,t,i){return No.makeTranslation(e,t,i),this.applyMatrix4(No),this}scale(e,t,i){return No.makeScale(e,t,i),this.applyMatrix4(No),this}lookAt(e){return A2.lookAt(e),A2.updateMatrix(),this.applyMatrix4(A2.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(jp).negate(),this.translate(jp.x,jp.y,jp.z),this}setFromPoints(e){let t=[];for(let i=0,n=e.length;i<n;i++){let r=e[i];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new gt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Vn);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new I(-1/0,-1/0,-1/0),new I(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,n=t.length;i<n;i++){let r=t[i];io.setFromBufferAttribute(r),this.morphTargetsRelative?(fr.addVectors(this.boundingBox.min,io.min),this.boundingBox.expandByPoint(fr),fr.addVectors(this.boundingBox.max,io.max),this.boundingBox.expandByPoint(fr)):(this.boundingBox.expandByPoint(io.min),this.boundingBox.expandByPoint(io.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ua);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new I,1/0);return}if(e){let i=this.boundingSphere.center;if(io.setFromBufferAttribute(e),t)for(let r=0,s=t.length;r<s;r++){let o=t[r];p0.setFromBufferAttribute(o),this.morphTargetsRelative?(fr.addVectors(io.min,p0.min),io.expandByPoint(fr),fr.addVectors(io.max,p0.max),io.expandByPoint(fr)):(io.expandByPoint(p0.min),io.expandByPoint(p0.max))}io.getCenter(i);let n=0;for(let r=0,s=e.count;r<s;r++)fr.fromBufferAttribute(e,r),n=Math.max(n,i.distanceToSquared(fr));if(t)for(let r=0,s=t.length;r<s;r++){let o=t[r],a=this.morphTargetsRelative;for(let l=0,c=o.count;l<c;l++)fr.fromBufferAttribute(o,l),a&&(jp.fromBufferAttribute(e,l),fr.add(jp)),n=Math.max(n,i.distanceToSquared(fr))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=e.array,n=t.position.array,r=t.normal.array,s=t.uv.array,o=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new zt(new Float32Array(4*o),4));let a=this.getAttribute("tangent").array,l=[],c=[];for(let C=0;C<o;C++)l[C]=new I,c[C]=new I;let h=new I,u=new I,d=new I,f=new ge,p=new ge,g=new ge,m=new I,v=new I;function x(C,P,B){h.fromArray(n,C*3),u.fromArray(n,P*3),d.fromArray(n,B*3),f.fromArray(s,C*2),p.fromArray(s,P*2),g.fromArray(s,B*2),u.sub(h),d.sub(h),p.sub(f),g.sub(f);let k=1/(p.x*g.y-g.x*p.y);!isFinite(k)||(m.copy(u).multiplyScalar(g.y).addScaledVector(d,-p.y).multiplyScalar(k),v.copy(d).multiplyScalar(p.x).addScaledVector(u,-g.x).multiplyScalar(k),l[C].add(m),l[P].add(m),l[B].add(m),c[C].add(v),c[P].add(v),c[B].add(v))}let w=this.groups;w.length===0&&(w=[{start:0,count:i.length}]);for(let C=0,P=w.length;C<P;++C){let B=w[C],k=B.start,z=B.count;for(let F=k,W=k+z;F<W;F+=3)x(i[F+0],i[F+1],i[F+2])}let b=new I,M=new I,A=new I,T=new I;function S(C){A.fromArray(r,C*3),T.copy(A);let P=l[C];b.copy(P),b.sub(A.multiplyScalar(A.dot(P))).normalize(),M.crossVectors(T,P);let B=M.dot(c[C])<0?-1:1;a[C*4]=b.x,a[C*4+1]=b.y,a[C*4+2]=b.z,a[C*4+3]=B}for(let C=0,P=w.length;C<P;++C){let B=w[C],k=B.start,z=B.count;for(let F=k,W=k+z;F<W;F+=3)S(i[F+0]),S(i[F+1]),S(i[F+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new zt(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let u=0,d=i.count;u<d;u++)i.setXYZ(u,0,0,0);let n=new I,r=new I,s=new I,o=new I,a=new I,l=new I,c=new I,h=new I;if(e)for(let u=0,d=e.count;u<d;u+=3){let f=e.getX(u+0),p=e.getX(u+1),g=e.getX(u+2);n.fromBufferAttribute(t,f),r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,g),c.subVectors(s,r),h.subVectors(n,r),c.cross(h),o.fromBufferAttribute(i,f),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,g),o.add(c),a.add(c),l.add(c),i.setXYZ(f,o.x,o.y,o.z),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(g,l.x,l.y,l.z)}else for(let u=0,d=t.count;u<d;u+=3)n.fromBufferAttribute(t,u+0),r.fromBufferAttribute(t,u+1),s.fromBufferAttribute(t,u+2),c.subVectors(s,r),h.subVectors(n,r),c.cross(h),i.setXYZ(u+0,c.x,c.y,c.z),i.setXYZ(u+1,c.x,c.y,c.z),i.setXYZ(u+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)fr.fromBufferAttribute(e,t),fr.normalize(),e.setXYZ(t,fr.x,fr.y,fr.z)}toNonIndexed(){function e(o,a){let l=o.array,c=o.itemSize,h=o.normalized,u=new l.constructor(a.length*c),d=0,f=0;for(let p=0,g=a.length;p<g;p++){o.isInterleavedBufferAttribute?d=a[p]*o.data.stride+o.offset:d=a[p]*c;for(let m=0;m<c;m++)u[f++]=l[d++]}return new zt(u,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new Ot,i=this.index.array,n=this.attributes;for(let o in n){let a=n[o],l=e(a,i);t.setAttribute(o,l)}let r=this.morphAttributes;for(let o in r){let a=[],l=r[o];for(let c=0,h=l.length;c<h;c++){let u=l[c],d=e(u,i);a.push(d)}t.morphAttributes[o]=a}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let o=0,a=s.length;o<a;o++){let l=s[o];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let a=this.parameters;for(let l in a)a[l]!==void 0&&(e[l]=a[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let i=this.attributes;for(let a in i){let l=i[a];e.data.attributes[a]=l.toJSON(e.data)}let n={},r=!1;for(let a in this.morphAttributes){let l=this.morphAttributes[a],c=[];for(let h=0,u=l.length;h<u;h++){let d=l[h];c.push(d.toJSON(e.data))}c.length>0&&(n[a]=c,r=!0)}r&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(t));let n=e.attributes;for(let l in n){let c=n[l];this.setAttribute(l,c.clone(t))}let r=e.morphAttributes;for(let l in r){let c=[],h=r[l];for(let u=0,d=h.length;u<d;u++)c.push(h[u].clone(t));this.morphAttributes[l]=c}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let l=0,c=s.length;l<c;l++){let h=s[l];this.addGroup(h.start,h.count,h.materialIndex)}let o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());let a=e.boundingSphere;return a!==null&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},cG=new Je,Wp=new sv,S2=new ua,m0=new I,g0=new I,v0=new I,M2=new I,W_=new I,X_=new ge,Y_=new ge,q_=new ge,E2=new I,Q_=new I,Ns=class extends Ii{constructor(e=new Ot,t=new ov){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,r=i.length;n<r;n++){let s=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=n}}}}getVertexPosition(e,t){let i=this.geometry,n=i.attributes.position,r=i.morphAttributes.position,s=i.morphTargetsRelative;t.fromBufferAttribute(n,e);let o=this.morphTargetInfluences;if(r&&o){W_.set(0,0,0);for(let a=0,l=r.length;a<l;a++){let c=o[a],h=r[a];c!==0&&(M2.fromBufferAttribute(h,e),s?W_.addScaledVector(M2,c):W_.addScaledVector(M2.sub(t),c))}t.add(W_)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let i=this.geometry,n=this.material,r=this.matrixWorld;if(n===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),S2.copy(i.boundingSphere),S2.applyMatrix4(r),e.ray.intersectsSphere(S2)===!1)||(cG.copy(r).invert(),Wp.copy(e.ray).applyMatrix4(cG),i.boundingBox!==null&&Wp.intersectsBox(i.boundingBox)===!1))return;let s,o=i.index,a=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv2,h=i.groups,u=i.drawRange;if(o!==null)if(Array.isArray(n))for(let d=0,f=h.length;d<f;d++){let p=h[d],g=n[p.materialIndex],m=Math.max(p.start,u.start),v=Math.min(o.count,Math.min(p.start+p.count,u.start+u.count));for(let x=m,w=v;x<w;x+=3){let b=o.getX(x),M=o.getX(x+1),A=o.getX(x+2);s=J_(this,g,e,Wp,l,c,b,M,A),s&&(s.faceIndex=Math.floor(x/3),s.face.materialIndex=p.materialIndex,t.push(s))}}else{let d=Math.max(0,u.start),f=Math.min(o.count,u.start+u.count);for(let p=d,g=f;p<g;p+=3){let m=o.getX(p),v=o.getX(p+1),x=o.getX(p+2);s=J_(this,n,e,Wp,l,c,m,v,x),s&&(s.faceIndex=Math.floor(p/3),t.push(s))}}else if(a!==void 0)if(Array.isArray(n))for(let d=0,f=h.length;d<f;d++){let p=h[d],g=n[p.materialIndex],m=Math.max(p.start,u.start),v=Math.min(a.count,Math.min(p.start+p.count,u.start+u.count));for(let x=m,w=v;x<w;x+=3){let b=x,M=x+1,A=x+2;s=J_(this,g,e,Wp,l,c,b,M,A),s&&(s.faceIndex=Math.floor(x/3),s.face.materialIndex=p.materialIndex,t.push(s))}}else{let d=Math.max(0,u.start),f=Math.min(a.count,u.start+u.count);for(let p=d,g=f;p<g;p+=3){let m=p,v=p+1,x=p+2;s=J_(this,n,e,Wp,l,c,m,v,x),s&&(s.faceIndex=Math.floor(p/3),t.push(s))}}}};function w0e(e,t,i,n,r,s,o,a){let l;if(t.side===gr?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,t.side===Ka,a),l===null)return null;Q_.copy(a),Q_.applyMatrix4(e.matrixWorld);let c=i.ray.origin.distanceTo(Q_);return c<i.near||c>i.far?null:{distance:c,point:Q_.clone(),object:e}}function J_(e,t,i,n,r,s,o,a,l){e.getVertexPosition(o,m0),e.getVertexPosition(a,g0),e.getVertexPosition(l,v0);let c=w0e(e,t,i,n,m0,g0,v0,E2);if(c){r&&(X_.fromBufferAttribute(r,o),Y_.fromBufferAttribute(r,a),q_.fromBufferAttribute(r,l),c.uv=Rs.getUV(E2,m0,g0,v0,X_,Y_,q_,new ge)),s&&(X_.fromBufferAttribute(s,o),Y_.fromBufferAttribute(s,a),q_.fromBufferAttribute(s,l),c.uv2=Rs.getUV(E2,m0,g0,v0,X_,Y_,q_,new ge));let h={a:o,b:a,c:l,normal:new I,materialIndex:0};Rs.getNormal(m0,g0,v0,h.normal),c.face=h}return c}var Jl=class extends Ot{constructor(e=1,t=1,i=1,n=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:s};let o=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s);let a=[],l=[],c=[],h=[],u=0,d=0;f("z","y","x",-1,-1,i,t,e,s,r,0),f("z","y","x",1,-1,i,t,-e,s,r,1),f("x","z","y",1,1,e,i,t,n,s,2),f("x","z","y",1,-1,e,i,-t,n,s,3),f("x","y","z",1,-1,e,t,i,n,r,4),f("x","y","z",-1,-1,e,t,-i,n,r,5),this.setIndex(a),this.setAttribute("position",new gt(l,3)),this.setAttribute("normal",new gt(c,3)),this.setAttribute("uv",new gt(h,2));function f(p,g,m,v,x,w,b,M,A,T,S){let C=w/A,P=b/T,B=w/2,k=b/2,z=M/2,F=A+1,W=T+1,K=0,Z=0,U=new I;for(let X=0;X<W;X++){let V=X*P-k;for(let q=0;q<F;q++){let H=q*C-B;U[p]=H*v,U[g]=V*x,U[m]=z,l.push(U.x,U.y,U.z),U[p]=0,U[g]=0,U[m]=M>0?1:-1,c.push(U.x,U.y,U.z),h.push(q/A),h.push(1-X/T),K+=1}}for(let X=0;X<T;X++)for(let V=0;V<A;V++){let q=u+V+F*X,H=u+V+F*(X+1),Q=u+(V+1)+F*(X+1),J=u+(V+1)+F*X;a.push(q,H,J),a.push(H,Q,J),Z+=6}o.addGroup(d,Z,S),d+=Z,u+=K}}static fromJSON(e){return new Jl(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Fg(e){let t={};for(let i in e){t[i]={};for(let n in e[i]){let r=e[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[i][n]=r.clone():Array.isArray(r)?t[i][n]=r.slice():t[i][n]=r}}return t}function os(e){let t={};for(let i=0;i<e.length;i++){let n=Fg(e[i]);for(let r in n)t[r]=n[r]}return t}function _0e(e){let t=[];for(let i=0;i<e.length;i++)t.push(e[i].clone());return t}function vq(e){return e.getRenderTarget()===null&&e.outputEncoding===Vt?Cl:cS}var av={clone:Fg,merge:os},b0e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,A0e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,ji=class extends _1{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=b0e,this.fragmentShader=A0e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Fg(e.uniforms),this.uniformsGroups=_0e(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let n in this.uniforms){let r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let i={};for(let n in this.extensions)this.extensions[n]===!0&&(i[n]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}},lv=class extends Ii{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Je,this.projectionMatrix=new Je,this.projectionMatrixInverse=new Je}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Yr=class extends lv{constructor(e=50,t=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=yx*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Ay*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return yx*2*Math.atan(Math.tan(Ay*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,n,r,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Ay*.5*this.fov)/this.zoom,i=2*t,n=this.aspect*i,r=-.5*n,s=this.view;if(this.view!==null&&this.view.enabled){let a=s.fullWidth,l=s.fullHeight;r+=s.offsetX*n/a,t-=s.offsetY*i/l,n*=s.width/a,i*=s.height/l}let o=this.filmOffset;o!==0&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},Xp=-90,Yp=1,S0e=class extends Ii{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;let n=new Yr(Xp,Yp,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(1,0,0),this.add(n);let r=new Yr(Xp,Yp,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(-1,0,0),this.add(r);let s=new Yr(Xp,Yp,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let o=new Yr(Xp,Yp,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);let a=new Yr(Xp,Yp,e,t);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(0,0,1),this.add(a);let l=new Yr(Xp,Yp,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let i=this.renderTarget,[n,r,s,o,a,l]=this.children,c=e.getRenderTarget(),h=e.toneMapping,u=e.xr.enabled;e.toneMapping=Zc,e.xr.enabled=!1;let d=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,n),e.setRenderTarget(i,1),e.render(t,r),e.setRenderTarget(i,2),e.render(t,s),e.setRenderTarget(i,3),e.render(t,o),e.setRenderTarget(i,4),e.render(t,a),i.texture.generateMipmaps=d,e.setRenderTarget(i,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=h,e.xr.enabled=u,i.texture.needsPMREMUpdate=!0}},iO=class extends tr{constructor(e,t,i,n,r,s,o,a,l,c){e=e!==void 0?e:[],t=t!==void 0?t:Ff,super(e,t,i,n,r,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},M0e=class extends Pi{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},n=[i,i,i,i,i,i];this.texture=new iO(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Zt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new Jl(5,5,5),r=new ji({name:"CubemapFromEquirect",uniforms:Fg(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:gr,blending:Hn});r.uniforms.tEquirect.value=t;let s=new Ns(n,r),o=t.minFilter;return t.minFilter===Ig&&(t.minFilter=Zt),new S0e(1,10,this).update(e,s),t.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,i,n){let r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,i,n);e.setRenderTarget(r)}},C2=new I,E0e=new I,C0e=new Cr,oo=class{constructor(e=new I(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){let n=C2.subVectors(i,t).cross(E0e.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let i=e.delta(C2),n=this.normal.dot(i);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let r=-(e.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:t.copy(i).multiplyScalar(r).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let i=t||C0e.getNormalMatrix(e),n=this.coplanarPoint(C2).applyMatrix4(e),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},qp=new ua,K_=new I,nO=class{constructor(e=new oo,t=new oo,i=new oo,n=new oo,r=new oo,s=new oo){this.planes=[e,t,i,n,r,s]}set(e,t,i,n,r,s){let o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(s),this}copy(e){let t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){let t=this.planes,i=e.elements,n=i[0],r=i[1],s=i[2],o=i[3],a=i[4],l=i[5],c=i[6],h=i[7],u=i[8],d=i[9],f=i[10],p=i[11],g=i[12],m=i[13],v=i[14],x=i[15];return t[0].setComponents(o-n,h-a,p-u,x-g).normalize(),t[1].setComponents(o+n,h+a,p+u,x+g).normalize(),t[2].setComponents(o+r,h+l,p+d,x+m).normalize(),t[3].setComponents(o-r,h-l,p-d,x-m).normalize(),t[4].setComponents(o-s,h-c,p-f,x-v).normalize(),t[5].setComponents(o+s,h+c,p+f,x+v).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),qp.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(qp)}intersectsSprite(e){return qp.center.set(0,0,0),qp.radius=.7071067811865476,qp.applyMatrix4(e.matrixWorld),this.intersectsSphere(qp)}intersectsSphere(e){let t=this.planes,i=e.center,n=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(i)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let i=0;i<6;i++){let n=t[i];if(K_.x=n.normal.x>0?e.max.x:e.min.x,K_.y=n.normal.y>0?e.max.y:e.min.y,K_.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(K_)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function yq(){let e=null,t=!1,i=null,n=null;function r(s,o){i(s,o),n=e.requestAnimationFrame(r)}return{start:function(){t!==!0&&i!==null&&(n=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(s){i=s},setContext:function(s){e=s}}}function T0e(e,t){let i=t.isWebGL2,n=new WeakMap;function r(c,h){let u=c.array,d=c.usage,f=e.createBuffer();e.bindBuffer(h,f),e.bufferData(h,u,d),c.onUploadCallback();let p;if(u instanceof Float32Array)p=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(i)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(u instanceof Int16Array)p=5122;else if(u instanceof Uint32Array)p=5125;else if(u instanceof Int32Array)p=5124;else if(u instanceof Int8Array)p=5120;else if(u instanceof Uint8Array)p=5121;else if(u instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,h,u){let d=h.array,f=h.updateRange;e.bindBuffer(u,c),f.count===-1?e.bufferSubData(u,0,d):(i?e.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):e.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),h.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);let h=n.get(c);h&&(e.deleteBuffer(h.buffer),n.delete(c))}function l(c,h){if(c.isGLBufferAttribute){let d=n.get(c);(!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let u=n.get(c);u===void 0?n.set(c,r(c,h)):u.version<c.version&&(s(u.buffer,c,h),u.version=c.version)}return{get:o,remove:a,update:l}}var XM=class extends Ot{constructor(e=1,t=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};let r=e/2,s=t/2,o=Math.floor(i),a=Math.floor(n),l=o+1,c=a+1,h=e/o,u=t/a,d=[],f=[],p=[],g=[];for(let m=0;m<c;m++){let v=m*u-s;for(let x=0;x<l;x++){let w=x*h-r;f.push(w,-v,0),p.push(0,0,1),g.push(x/o),g.push(1-m/a)}}for(let m=0;m<a;m++)for(let v=0;v<o;v++){let x=v+l*m,w=v+l*(m+1),b=v+1+l*(m+1),M=v+1+l*m;d.push(x,w,M),d.push(w,b,M)}this.setIndex(d),this.setAttribute("position",new gt(f,3)),this.setAttribute("normal",new gt(p,3)),this.setAttribute("uv",new gt(g,2))}static fromJSON(e){return new XM(e.width,e.height,e.widthSegments,e.heightSegments)}},P0e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,D0e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,B0e=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,L0e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,R0e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,I0e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,O0e="vec3 transformed = vec3( position );",F0e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,N0e=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,z0e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,k0e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,U0e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,G0e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,H0e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,V0e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,j0e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,W0e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,X0e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Y0e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,q0e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Q0e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,J0e=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,K0e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Z0e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,$0e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,eye=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,tye="gl_FragColor = linearToOutputTexel( gl_FragColor );",iye=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,nye=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,rye=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,sye=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,oye=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,aye=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,lye=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,cye=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,uye=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,hye=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,dye=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,fye=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,pye=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,mye=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,gye=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,vye=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,yye=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,xye=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,wye=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,_ye=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,bye=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Aye=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,Sye=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Mye=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Eye=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Cye=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Tye=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Pye=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Dye=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Bye=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Lye=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Rye=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Iye=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Oye=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Fye=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Nye=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,zye=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,kye=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Uye=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Gye=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Hye=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Vye=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,jye=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Wye=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Xye=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Yye=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,qye=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Qye=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Jye=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Kye=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Zye=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,$ye=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,exe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,txe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,ixe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,nxe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,rxe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,sxe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,oxe=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,axe=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,lxe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,cxe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,uxe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,hxe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,dxe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,fxe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,pxe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,mxe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,gxe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,vxe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,yxe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,xxe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,wxe=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,_xe=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,bxe=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Axe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Sxe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,Mxe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Exe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Cxe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Txe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Pxe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Dxe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Bxe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Lxe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Rxe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Ixe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Oxe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Fxe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Nxe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,zxe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,kxe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Uxe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Gxe=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Hxe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vxe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jxe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Wxe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Xxe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Yxe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,qxe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Qxe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Jxe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Kxe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Zxe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$xe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,e1e=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,t1e=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,i1e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,n1e=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,r1e=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,s1e=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,o1e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Wt={alphamap_fragment:P0e,alphamap_pars_fragment:D0e,alphatest_fragment:B0e,alphatest_pars_fragment:L0e,aomap_fragment:R0e,aomap_pars_fragment:I0e,begin_vertex:O0e,beginnormal_vertex:F0e,bsdfs:N0e,iridescence_fragment:z0e,bumpmap_pars_fragment:k0e,clipping_planes_fragment:U0e,clipping_planes_pars_fragment:G0e,clipping_planes_pars_vertex:H0e,clipping_planes_vertex:V0e,color_fragment:j0e,color_pars_fragment:W0e,color_pars_vertex:X0e,color_vertex:Y0e,common:q0e,cube_uv_reflection_fragment:Q0e,defaultnormal_vertex:J0e,displacementmap_pars_vertex:K0e,displacementmap_vertex:Z0e,emissivemap_fragment:$0e,emissivemap_pars_fragment:eye,encodings_fragment:tye,encodings_pars_fragment:iye,envmap_fragment:nye,envmap_common_pars_fragment:rye,envmap_pars_fragment:sye,envmap_pars_vertex:oye,envmap_physical_pars_fragment:yye,envmap_vertex:aye,fog_vertex:lye,fog_pars_vertex:cye,fog_fragment:uye,fog_pars_fragment:hye,gradientmap_pars_fragment:dye,lightmap_fragment:fye,lightmap_pars_fragment:pye,lights_lambert_fragment:mye,lights_lambert_pars_fragment:gye,lights_pars_begin:vye,lights_toon_fragment:xye,lights_toon_pars_fragment:wye,lights_phong_fragment:_ye,lights_phong_pars_fragment:bye,lights_physical_fragment:Aye,lights_physical_pars_fragment:Sye,lights_fragment_begin:Mye,lights_fragment_maps:Eye,lights_fragment_end:Cye,logdepthbuf_fragment:Tye,logdepthbuf_pars_fragment:Pye,logdepthbuf_pars_vertex:Dye,logdepthbuf_vertex:Bye,map_fragment:Lye,map_pars_fragment:Rye,map_particle_fragment:Iye,map_particle_pars_fragment:Oye,metalnessmap_fragment:Fye,metalnessmap_pars_fragment:Nye,morphcolor_vertex:zye,morphnormal_vertex:kye,morphtarget_pars_vertex:Uye,morphtarget_vertex:Gye,normal_fragment_begin:Hye,normal_fragment_maps:Vye,normal_pars_fragment:jye,normal_pars_vertex:Wye,normal_vertex:Xye,normalmap_pars_fragment:Yye,clearcoat_normal_fragment_begin:qye,clearcoat_normal_fragment_maps:Qye,clearcoat_pars_fragment:Jye,iridescence_pars_fragment:Kye,output_fragment:Zye,packing:$ye,premultiplied_alpha_fragment:exe,project_vertex:txe,dithering_fragment:ixe,dithering_pars_fragment:nxe,roughnessmap_fragment:rxe,roughnessmap_pars_fragment:sxe,shadowmap_pars_fragment:oxe,shadowmap_pars_vertex:axe,shadowmap_vertex:lxe,shadowmask_pars_fragment:cxe,skinbase_vertex:uxe,skinning_pars_vertex:hxe,skinning_vertex:dxe,skinnormal_vertex:fxe,specularmap_fragment:pxe,specularmap_pars_fragment:mxe,tonemapping_fragment:gxe,tonemapping_pars_fragment:vxe,transmission_fragment:yxe,transmission_pars_fragment:xxe,uv_pars_fragment:wxe,uv_pars_vertex:_xe,uv_vertex:bxe,uv2_pars_fragment:Axe,uv2_pars_vertex:Sxe,uv2_vertex:Mxe,worldpos_vertex:Exe,background_vert:Cxe,background_frag:Txe,backgroundCube_vert:Pxe,backgroundCube_frag:Dxe,cube_vert:Bxe,cube_frag:Lxe,depth_vert:Rxe,depth_frag:Ixe,distanceRGBA_vert:Oxe,distanceRGBA_frag:Fxe,equirect_vert:Nxe,equirect_frag:zxe,linedashed_vert:kxe,linedashed_frag:Uxe,meshbasic_vert:Gxe,meshbasic_frag:Hxe,meshlambert_vert:Vxe,meshlambert_frag:jxe,meshmatcap_vert:Wxe,meshmatcap_frag:Xxe,meshnormal_vert:Yxe,meshnormal_frag:qxe,meshphong_vert:Qxe,meshphong_frag:Jxe,meshphysical_vert:Kxe,meshphysical_frag:Zxe,meshtoon_vert:$xe,meshtoon_frag:e1e,points_vert:t1e,points_frag:i1e,shadow_vert:n1e,shadow_frag:r1e,sprite_vert:s1e,sprite_frag:o1e},et={common:{diffuse:{value:new Pt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Cr},uv2Transform:{value:new Cr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ge(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Pt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Cr}},sprite:{diffuse:{value:new Pt(16777215)},opacity:{value:1},center:{value:new ge(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Cr}}},Pl={basic:{uniforms:os([et.common,et.specularmap,et.envmap,et.aomap,et.lightmap,et.fog]),vertexShader:Wt.meshbasic_vert,fragmentShader:Wt.meshbasic_frag},lambert:{uniforms:os([et.common,et.specularmap,et.envmap,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.fog,et.lights,{emissive:{value:new Pt(0)}}]),vertexShader:Wt.meshlambert_vert,fragmentShader:Wt.meshlambert_frag},phong:{uniforms:os([et.common,et.specularmap,et.envmap,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.fog,et.lights,{emissive:{value:new Pt(0)},specular:{value:new Pt(1118481)},shininess:{value:30}}]),vertexShader:Wt.meshphong_vert,fragmentShader:Wt.meshphong_frag},standard:{uniforms:os([et.common,et.envmap,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.roughnessmap,et.metalnessmap,et.fog,et.lights,{emissive:{value:new Pt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Wt.meshphysical_vert,fragmentShader:Wt.meshphysical_frag},toon:{uniforms:os([et.common,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.gradientmap,et.fog,et.lights,{emissive:{value:new Pt(0)}}]),vertexShader:Wt.meshtoon_vert,fragmentShader:Wt.meshtoon_frag},matcap:{uniforms:os([et.common,et.bumpmap,et.normalmap,et.displacementmap,et.fog,{matcap:{value:null}}]),vertexShader:Wt.meshmatcap_vert,fragmentShader:Wt.meshmatcap_frag},points:{uniforms:os([et.points,et.fog]),vertexShader:Wt.points_vert,fragmentShader:Wt.points_frag},dashed:{uniforms:os([et.common,et.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Wt.linedashed_vert,fragmentShader:Wt.linedashed_frag},depth:{uniforms:os([et.common,et.displacementmap]),vertexShader:Wt.depth_vert,fragmentShader:Wt.depth_frag},normal:{uniforms:os([et.common,et.bumpmap,et.normalmap,et.displacementmap,{opacity:{value:1}}]),vertexShader:Wt.meshnormal_vert,fragmentShader:Wt.meshnormal_frag},sprite:{uniforms:os([et.sprite,et.fog]),vertexShader:Wt.sprite_vert,fragmentShader:Wt.sprite_frag},background:{uniforms:{uvTransform:{value:new Cr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Wt.background_vert,fragmentShader:Wt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Wt.backgroundCube_vert,fragmentShader:Wt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Wt.cube_vert,fragmentShader:Wt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Wt.equirect_vert,fragmentShader:Wt.equirect_frag},distanceRGBA:{uniforms:os([et.common,et.displacementmap,{referencePosition:{value:new I},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Wt.distanceRGBA_vert,fragmentShader:Wt.distanceRGBA_frag},shadow:{uniforms:os([et.lights,et.fog,{color:{value:new Pt(0)},opacity:{value:1}}]),vertexShader:Wt.shadow_vert,fragmentShader:Wt.shadow_frag}};Pl.physical={uniforms:os([Pl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ge(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Pt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ge},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Pt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Pt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Wt.meshphysical_vert,fragmentShader:Wt.meshphysical_frag};var Z_={r:0,b:0,g:0};function a1e(e,t,i,n,r,s,o){let a=new Pt(0),l=s===!0?0:1,c,h,u=null,d=0,f=null;function p(m,v){let x=!1,w=v.isScene===!0?v.background:null;w&&w.isTexture&&(w=(v.backgroundBlurriness>0?i:t).get(w));let b=e.xr,M=b.getSession&&b.getSession();M&&M.environmentBlendMode==="additive"&&(w=null),w===null?g(a,l):w&&w.isColor&&(g(w,1),x=!0),(e.autoClear||x)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),w&&(w.isCubeTexture||w.mapping===w1)?(h===void 0&&(h=new Ns(new Jl(1,1,1),new ji({name:"BackgroundCubeMaterial",uniforms:Fg(Pl.backgroundCube.uniforms),vertexShader:Pl.backgroundCube.vertexShader,fragmentShader:Pl.backgroundCube.fragmentShader,side:gr,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(A,T,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=w,h.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,h.material.toneMapped=w.encoding!==Vt,(u!==w||d!==w.version||f!==e.toneMapping)&&(h.material.needsUpdate=!0,u=w,d=w.version,f=e.toneMapping),h.layers.enableAll(),m.unshift(h,h.geometry,h.material,0,0,null)):w&&w.isTexture&&(c===void 0&&(c=new Ns(new XM(2,2),new ji({name:"BackgroundMaterial",uniforms:Fg(Pl.background.uniforms),vertexShader:Pl.background.vertexShader,fragmentShader:Pl.background.fragmentShader,side:Ka,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=w,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=w.encoding!==Vt,w.matrixAutoUpdate===!0&&w.updateMatrix(),c.material.uniforms.uvTransform.value.copy(w.matrix),(u!==w||d!==w.version||f!==e.toneMapping)&&(c.material.needsUpdate=!0,u=w,d=w.version,f=e.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null))}function g(m,v){m.getRGB(Z_,vq(e)),n.buffers.color.setClear(Z_.r,Z_.g,Z_.b,v,o)}return{getClearColor:function(){return a},setClearColor:function(m,v=1){a.set(m),l=v,g(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,g(a,l)},render:p}}function l1e(e,t,i,n){let r=e.getParameter(34921),s=n.isWebGL2?null:t.get("OES_vertex_array_object"),o=n.isWebGL2||s!==null,a={},l=m(null),c=l,h=!1;function u(F,W,K,Z,U){let X=!1;if(o){let V=g(Z,K,W);c!==V&&(c=V,f(c.object)),X=v(F,Z,K,U),X&&x(F,Z,K,U)}else{let V=W.wireframe===!0;(c.geometry!==Z.id||c.program!==K.id||c.wireframe!==V)&&(c.geometry=Z.id,c.program=K.id,c.wireframe=V,X=!0)}U!==null&&i.update(U,34963),(X||h)&&(h=!1,S(F,W,K,Z),U!==null&&e.bindBuffer(34963,i.get(U).buffer))}function d(){return n.isWebGL2?e.createVertexArray():s.createVertexArrayOES()}function f(F){return n.isWebGL2?e.bindVertexArray(F):s.bindVertexArrayOES(F)}function p(F){return n.isWebGL2?e.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function g(F,W,K){let Z=K.wireframe===!0,U=a[F.id];U===void 0&&(U={},a[F.id]=U);let X=U[W.id];X===void 0&&(X={},U[W.id]=X);let V=X[Z];return V===void 0&&(V=m(d()),X[Z]=V),V}function m(F){let W=[],K=[],Z=[];for(let U=0;U<r;U++)W[U]=0,K[U]=0,Z[U]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:W,enabledAttributes:K,attributeDivisors:Z,object:F,attributes:{},index:null}}function v(F,W,K,Z){let U=c.attributes,X=W.attributes,V=0,q=K.getAttributes();for(let H in q)if(q[H].location>=0){let Q=U[H],J=X[H];if(J===void 0&&(H==="instanceMatrix"&&F.instanceMatrix&&(J=F.instanceMatrix),H==="instanceColor"&&F.instanceColor&&(J=F.instanceColor)),Q===void 0||Q.attribute!==J||J&&Q.data!==J.data)return!0;V++}return c.attributesNum!==V||c.index!==Z}function x(F,W,K,Z){let U={},X=W.attributes,V=0,q=K.getAttributes();for(let H in q)if(q[H].location>=0){let Q=X[H];Q===void 0&&(H==="instanceMatrix"&&F.instanceMatrix&&(Q=F.instanceMatrix),H==="instanceColor"&&F.instanceColor&&(Q=F.instanceColor));let J={};J.attribute=Q,Q&&Q.data&&(J.data=Q.data),U[H]=J,V++}c.attributes=U,c.attributesNum=V,c.index=Z}function w(){let F=c.newAttributes;for(let W=0,K=F.length;W<K;W++)F[W]=0}function b(F){M(F,0)}function M(F,W){let K=c.newAttributes,Z=c.enabledAttributes,U=c.attributeDivisors;K[F]=1,Z[F]===0&&(e.enableVertexAttribArray(F),Z[F]=1),U[F]!==W&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,W),U[F]=W)}function A(){let F=c.newAttributes,W=c.enabledAttributes;for(let K=0,Z=W.length;K<Z;K++)W[K]!==F[K]&&(e.disableVertexAttribArray(K),W[K]=0)}function T(F,W,K,Z,U,X){n.isWebGL2===!0&&(K===5124||K===5125)?e.vertexAttribIPointer(F,W,K,U,X):e.vertexAttribPointer(F,W,K,Z,U,X)}function S(F,W,K,Z){if(n.isWebGL2===!1&&(F.isInstancedMesh||Z.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;w();let U=Z.attributes,X=K.getAttributes(),V=W.defaultAttributeValues;for(let q in X){let H=X[q];if(H.location>=0){let Q=U[q];if(Q===void 0&&(q==="instanceMatrix"&&F.instanceMatrix&&(Q=F.instanceMatrix),q==="instanceColor"&&F.instanceColor&&(Q=F.instanceColor)),Q!==void 0){let J=Q.normalized,le=Q.itemSize,j=i.get(Q);if(j===void 0)continue;let ve=j.buffer,pe=j.type,me=j.bytesPerElement;if(Q.isInterleavedBufferAttribute){let de=Q.data,Se=de.stride,ce=Q.offset;if(de.isInstancedInterleavedBuffer){for(let se=0;se<H.locationSize;se++)M(H.location+se,de.meshPerAttribute);F.isInstancedMesh!==!0&&Z._maxInstanceCount===void 0&&(Z._maxInstanceCount=de.meshPerAttribute*de.count)}else for(let se=0;se<H.locationSize;se++)b(H.location+se);e.bindBuffer(34962,ve);for(let se=0;se<H.locationSize;se++)T(H.location+se,le/H.locationSize,pe,J,Se*me,(ce+le/H.locationSize*se)*me)}else{if(Q.isInstancedBufferAttribute){for(let de=0;de<H.locationSize;de++)M(H.location+de,Q.meshPerAttribute);F.isInstancedMesh!==!0&&Z._maxInstanceCount===void 0&&(Z._maxInstanceCount=Q.meshPerAttribute*Q.count)}else for(let de=0;de<H.locationSize;de++)b(H.location+de);e.bindBuffer(34962,ve);for(let de=0;de<H.locationSize;de++)T(H.location+de,le/H.locationSize,pe,J,le*me,le/H.locationSize*de*me)}}else if(V!==void 0){let J=V[q];if(J!==void 0)switch(J.length){case 2:e.vertexAttrib2fv(H.location,J);break;case 3:e.vertexAttrib3fv(H.location,J);break;case 4:e.vertexAttrib4fv(H.location,J);break;default:e.vertexAttrib1fv(H.location,J)}}}}A()}function C(){k();for(let F in a){let W=a[F];for(let K in W){let Z=W[K];for(let U in Z)p(Z[U].object),delete Z[U];delete W[K]}delete a[F]}}function P(F){if(a[F.id]===void 0)return;let W=a[F.id];for(let K in W){let Z=W[K];for(let U in Z)p(Z[U].object),delete Z[U];delete W[K]}delete a[F.id]}function B(F){for(let W in a){let K=a[W];if(K[F.id]===void 0)continue;let Z=K[F.id];for(let U in Z)p(Z[U].object),delete Z[U];delete K[F.id]}}function k(){z(),h=!0,c!==l&&(c=l,f(c.object))}function z(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:k,resetDefaultState:z,dispose:C,releaseStatesOfGeometry:P,releaseStatesOfProgram:B,initAttributes:w,enableAttribute:b,disableUnusedAttributes:A}}function c1e(e,t,i,n){let r=n.isWebGL2,s;function o(c){s=c}function a(c,h){e.drawArrays(s,c,h),i.update(h,s,1)}function l(c,h,u){if(u===0)return;let d,f;if(r)d=e,f="drawArraysInstanced";else if(d=t.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,h,u),i.update(h,s,u)}this.setMode=o,this.render=a,this.renderInstances=l}function u1e(e,t,i){let n;function r(){if(n!==void 0)return n;if(t.has("EXT_texture_filter_anisotropic")===!0){let T=t.get("EXT_texture_filter_anisotropic");n=e.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(T){if(T==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";T="mediump"}return T==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let o=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,a=i.precision!==void 0?i.precision:"highp",l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);let c=o||t.has("WEBGL_draw_buffers"),h=i.logarithmicDepthBuffer===!0,u=e.getParameter(34930),d=e.getParameter(35660),f=e.getParameter(3379),p=e.getParameter(34076),g=e.getParameter(34921),m=e.getParameter(36347),v=e.getParameter(36348),x=e.getParameter(36349),w=d>0,b=o||t.has("OES_texture_float"),M=w&&b,A=o?e.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:g,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:x,vertexTextures:w,floatFragmentTextures:b,floatVertexTextures:M,maxSamples:A}}function h1e(e){let t=this,i=null,n=0,r=!1,s=!1,o=new oo,a=new Cr,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,d){let f=u.length!==0||d||n!==0||r;return r=d,n=u.length,f},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,d){i=h(u,d,0)},this.setState=function(u,d,f){let p=u.clippingPlanes,g=u.clipIntersection,m=u.clipShadows,v=e.get(u);if(!r||p===null||p.length===0||s&&!m)s?h(null):c();else{let x=s?0:n,w=x*4,b=v.clippingState||null;l.value=b,b=h(p,d,w,f);for(let M=0;M!==w;++M)b[M]=i[M];v.clippingState=b,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=x}};function c(){l.value!==i&&(l.value=i,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function h(u,d,f,p){let g=u!==null?u.length:0,m=null;if(g!==0){if(m=l.value,p!==!0||m===null){let v=f+g*4,x=d.matrixWorldInverse;a.getNormalMatrix(x),(m===null||m.length<v)&&(m=new Float32Array(v));for(let w=0,b=f;w!==g;++w,b+=4)o.copy(u[w]).applyMatrix4(x,a),o.normal.toArray(m,b),m[b+3]=o.constant}l.value=m,l.needsUpdate=!0}return t.numPlanes=g,t.numIntersection=0,m}}function d1e(e){let t=new WeakMap;function i(o,a){return a===Z3?o.mapping=Ff:a===$3&&(o.mapping=Nf),o}function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){let a=o.mapping;if(a===Z3||a===$3)if(t.has(o)){let l=t.get(o).texture;return i(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let c=new M0e(l.height/2);return c.fromEquirectangularTexture(e,o),t.set(o,c),o.addEventListener("dispose",r),i(c.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let l=t.get(a);l!==void 0&&(t.delete(a),l.dispose())}function s(){t=new WeakMap}return{get:n,dispose:s}}var dS=class extends lv{constructor(e=-1,t=1,i=1,n=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,n,r,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-e,s=i+e,o=n+t,a=n-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=l*this.view.offsetX,s=r+l*this.view.width,o-=c*this.view.offsetY,a=o-c*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},Fm=4,uG=[.125,.215,.35,.446,.526,.582],jd=20,T2=new dS,hG=new Pt,P2=null,zd=(1+Math.sqrt(5))/2,Qp=1/zd,dG=[new I(1,1,1),new I(-1,1,1),new I(1,1,-1),new I(-1,1,-1),new I(0,zd,Qp),new I(0,zd,-Qp),new I(Qp,0,zd),new I(-Qp,0,zd),new I(zd,Qp,0),new I(-zd,Qp,0)],fG=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,n=100){P2=this._renderer.getRenderTarget(),this._setSize(256);let r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,i,n,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=gG(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=mG(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(P2),e.scissorTest=!1,$_(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ff||e.mapping===Nf?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),P2=this._renderer.getRenderTarget();let i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Zt,minFilter:Zt,generateMipmaps:!1,type:Og,format:Na,encoding:Ql,depthBuffer:!1},n=pG(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=pG(e,t,i);let{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=f1e(r)),this._blurMaterial=p1e(r,e,t)}return n}_compileMaterial(e){let t=new Ns(this._lodPlanes[0],e);this._renderer.compile(t,T2)}_sceneToCubeUV(e,t,i,n){let r=new Yr(90,1,t,i),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(hG),a.toneMapping=Zc,a.autoClear=!1;let h=new ov({name:"PMREM.Background",side:gr,depthWrite:!1,depthTest:!1}),u=new Ns(new Jl,h),d=!1,f=e.background;f?f.isColor&&(h.color.copy(f),e.background=null,d=!0):(h.color.copy(hG),d=!0);for(let p=0;p<6;p++){let g=p%3;g===0?(r.up.set(0,s[p],0),r.lookAt(o[p],0,0)):g===1?(r.up.set(0,0,s[p]),r.lookAt(0,o[p],0)):(r.up.set(0,s[p],0),r.lookAt(0,0,o[p]));let m=this._cubeSize;$_(n,g*m,p>2?m:0,m,m),a.setRenderTarget(n),d&&a.render(u,r),a.render(e,r)}u.geometry.dispose(),u.material.dispose(),a.toneMapping=c,a.autoClear=l,e.background=f}_textureToCubeUV(e,t){let i=this._renderer,n=e.mapping===Ff||e.mapping===Nf;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=gG()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=mG());let r=n?this._cubemapMaterial:this._equirectMaterial,s=new Ns(this._lodPlanes[0],r),o=r.uniforms;o.envMap.value=e;let a=this._cubeSize;$_(t,0,0,3*a,2*a),i.setRenderTarget(t),i.render(s,T2)}_applyPMREM(e){let t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){let r=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),s=dG[(n-1)%dG.length];this._blur(e,n-1,n,r,s)}t.autoClear=i}_blur(e,t,i,n,r){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,i,n,"latitudinal",r),this._halfBlur(s,e,i,i,n,"longitudinal",r)}_halfBlur(e,t,i,n,r,s,o){let a=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,h=new Ns(this._lodPlanes[n],l),u=l.uniforms,d=this._sizeLods[i]-1,f=isFinite(r)?Math.PI/(2*d):2*Math.PI/(2*jd-1),p=r/f,g=isFinite(r)?1+Math.floor(c*p):jd;g>jd&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${jd}`);let m=[],v=0;for(let A=0;A<jd;++A){let T=A/p,S=Math.exp(-T*T/2);m.push(S),A===0?v+=S:A<g&&(v+=2*S)}for(let A=0;A<m.length;A++)m[A]=m[A]/v;u.envMap.value=e.texture,u.samples.value=g,u.weights.value=m,u.latitudinal.value=s==="latitudinal",o&&(u.poleAxis.value=o);let{_lodMax:x}=this;u.dTheta.value=f,u.mipInt.value=x-i;let w=this._sizeLods[n],b=3*w*(n>x-Fm?n-x+Fm:0),M=4*(this._cubeSize-w);$_(t,b,M,3*w,2*w),a.setRenderTarget(t),a.render(h,T2)}};function f1e(e){let t=[],i=[],n=[],r=e,s=e-Fm+1+uG.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);i.push(a);let l=1/a;o>e-Fm?l=uG[o-e+Fm-1]:o===0&&(l=0),n.push(l);let c=1/(a-2),h=-c,u=1+c,d=[h,h,u,h,u,u,h,h,u,u,h,u],f=6,p=6,g=3,m=2,v=1,x=new Float32Array(g*p*f),w=new Float32Array(m*p*f),b=new Float32Array(v*p*f);for(let A=0;A<f;A++){let T=A%3*2/3-1,S=A>2?0:-1,C=[T,S,0,T+2/3,S,0,T+2/3,S+1,0,T,S,0,T+2/3,S+1,0,T,S+1,0];x.set(C,g*p*A),w.set(d,m*p*A);let P=[A,A,A,A,A,A];b.set(P,v*p*A)}let M=new Ot;M.setAttribute("position",new zt(x,g)),M.setAttribute("uv",new zt(w,m)),M.setAttribute("faceIndex",new zt(b,v)),t.push(M),r>Fm&&r--}return{lodPlanes:t,sizeLods:i,sigmas:n}}function pG(e,t,i){let n=new Pi(e,t,i);return n.texture.mapping=w1,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function $_(e,t,i,n,r){e.viewport.set(t,i,n,r),e.scissor.set(t,i,n,r)}function p1e(e,t,i){let n=new Float32Array(jd),r=new I(0,1,0);return new ji({name:"SphericalGaussianBlur",defines:{n:jd,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:rO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Hn,depthTest:!1,depthWrite:!1})}function mG(){return new ji({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:rO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Hn,depthTest:!1,depthWrite:!1})}function gG(){return new ji({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:rO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Hn,depthTest:!1,depthWrite:!1})}function rO(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function m1e(e){let t=new WeakMap,i=null;function n(a){if(a&&a.isTexture){let l=a.mapping,c=l===Z3||l===$3,h=l===Ff||l===Nf;if(c||h)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let u=t.get(a);return i===null&&(i=new fG(e)),u=c?i.fromEquirectangular(a,u):i.fromCubemap(a,u),t.set(a,u),u.texture}else{if(t.has(a))return t.get(a).texture;{let u=a.image;if(c&&u&&u.height>0||h&&u&&r(u)){i===null&&(i=new fG(e));let d=c?i.fromEquirectangular(a):i.fromCubemap(a);return t.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0,c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function s(a){let l=a.target;l.removeEventListener("dispose",s);let c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function o(){t=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:o}}function g1e(e){let t={};function i(n){if(t[n]!==void 0)return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(n){return i(n)!==null},init:function(n){n.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(n){let r=i(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function v1e(e,t,i,n){let r={},s=new WeakMap;function o(u){let d=u.target;d.index!==null&&t.remove(d.index);for(let p in d.attributes)t.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];let f=s.get(d);f&&(t.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function a(u,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,i.memory.geometries++),d}function l(u){let d=u.attributes;for(let p in d)t.update(d[p],34962);let f=u.morphAttributes;for(let p in f){let g=f[p];for(let m=0,v=g.length;m<v;m++)t.update(g[m],34962)}}function c(u){let d=[],f=u.index,p=u.attributes.position,g=0;if(f!==null){let x=f.array;g=f.version;for(let w=0,b=x.length;w<b;w+=3){let M=x[w+0],A=x[w+1],T=x[w+2];d.push(M,A,A,T,T,M)}}else{let x=p.array;g=p.version;for(let w=0,b=x.length/3-1;w<b;w+=3){let M=w+0,A=w+1,T=w+2;d.push(M,A,A,T,T,M)}}let m=new(hq(d)?ig:gq)(d,1);m.version=g;let v=s.get(u);v&&t.remove(v),s.set(u,m)}function h(u){let d=s.get(u);if(d){let f=u.index;f!==null&&d.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:h}}function y1e(e,t,i,n){let r=n.isWebGL2,s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function h(d,f){e.drawElements(s,f,a,d*l),i.update(f,s,1)}function u(d,f,p){if(p===0)return;let g,m;if(r)g=e,m="drawElementsInstanced";else if(g=t.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",g===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[m](s,f,a,d*l,p),i.update(f,s,p)}this.setMode=o,this.setIndex=c,this.render=h,this.renderInstances=u}function x1e(e){let t={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(i.calls++,o){case 4:i.triangles+=a*(s/3);break;case 1:i.lines+=a*(s/2);break;case 3:i.lines+=a*(s-1);break;case 2:i.lines+=a*s;break;case 0:i.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:t,render:i,programs:null,autoReset:!0,reset:r,update:n}}function w1e(e,t){return e[0]-t[0]}function _1e(e,t){return Math.abs(t[1])-Math.abs(e[1])}function b1e(e,t,i){let n={},r=new Float32Array(8),s=new WeakMap,o=new Kt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,h,u,d){let f=c.morphTargetInfluences;if(t.isWebGL2===!0){let p=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,g=p!==void 0?p.length:0,m=s.get(h);if(m===void 0||m.count!==g){let w=function(){F.dispose(),s.delete(h),h.removeEventListener("dispose",w)};m!==void 0&&m.texture.dispose();let b=h.morphAttributes.position!==void 0,M=h.morphAttributes.normal!==void 0,A=h.morphAttributes.color!==void 0,T=h.morphAttributes.position||[],S=h.morphAttributes.normal||[],C=h.morphAttributes.color||[],P=0;b===!0&&(P=1),M===!0&&(P=2),A===!0&&(P=3);let B=h.attributes.position.count*P,k=1;B>t.maxTextureSize&&(k=Math.ceil(B/t.maxTextureSize),B=t.maxTextureSize);let z=new Float32Array(B*k*4*g),F=new mq(z,B,k,g);F.type=$o,F.needsUpdate=!0;let W=P*4;for(let K=0;K<g;K++){let Z=T[K],U=S[K],X=C[K],V=B*k*4*K;for(let q=0;q<Z.count;q++){let H=q*W;b===!0&&(o.fromBufferAttribute(Z,q),z[V+H+0]=o.x,z[V+H+1]=o.y,z[V+H+2]=o.z,z[V+H+3]=0),M===!0&&(o.fromBufferAttribute(U,q),z[V+H+4]=o.x,z[V+H+5]=o.y,z[V+H+6]=o.z,z[V+H+7]=0),A===!0&&(o.fromBufferAttribute(X,q),z[V+H+8]=o.x,z[V+H+9]=o.y,z[V+H+10]=o.z,z[V+H+11]=X.itemSize===4?o.w:1)}}m={count:g,texture:F,size:new ge(B,k)},s.set(h,m),h.addEventListener("dispose",w)}let v=0;for(let w=0;w<f.length;w++)v+=f[w];let x=h.morphTargetsRelative?1:1-v;d.getUniforms().setValue(e,"morphTargetBaseInfluence",x),d.getUniforms().setValue(e,"morphTargetInfluences",f),d.getUniforms().setValue(e,"morphTargetsTexture",m.texture,i),d.getUniforms().setValue(e,"morphTargetsTextureSize",m.size)}else{let p=f===void 0?0:f.length,g=n[h.id];if(g===void 0||g.length!==p){g=[];for(let b=0;b<p;b++)g[b]=[b,0];n[h.id]=g}for(let b=0;b<p;b++){let M=g[b];M[0]=b,M[1]=f[b]}g.sort(_1e);for(let b=0;b<8;b++)b<p&&g[b][1]?(a[b][0]=g[b][0],a[b][1]=g[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(w1e);let m=h.morphAttributes.position,v=h.morphAttributes.normal,x=0;for(let b=0;b<8;b++){let M=a[b],A=M[0],T=M[1];A!==Number.MAX_SAFE_INTEGER&&T?(m&&h.getAttribute("morphTarget"+b)!==m[A]&&h.setAttribute("morphTarget"+b,m[A]),v&&h.getAttribute("morphNormal"+b)!==v[A]&&h.setAttribute("morphNormal"+b,v[A]),r[b]=T,x+=T):(m&&h.hasAttribute("morphTarget"+b)===!0&&h.deleteAttribute("morphTarget"+b),v&&h.hasAttribute("morphNormal"+b)===!0&&h.deleteAttribute("morphNormal"+b),r[b]=0)}let w=h.morphTargetsRelative?1:1-x;d.getUniforms().setValue(e,"morphTargetBaseInfluence",w),d.getUniforms().setValue(e,"morphTargetInfluences",r)}}return{update:l}}function A1e(e,t,i,n){let r=new WeakMap;function s(l){let c=n.render.frame,h=l.geometry,u=t.get(l,h);return r.get(u)!==c&&(t.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.update(l.instanceMatrix,34962),l.instanceColor!==null&&i.update(l.instanceColor,34962)),u}function o(){r=new WeakMap}function a(l){let c=l.target;c.removeEventListener("dispose",a),i.remove(c.instanceMatrix),c.instanceColor!==null&&i.remove(c.instanceColor)}return{update:s,dispose:o}}var xq=new tr,wq=new mq,_q=new c0e,bq=new iO,vG=[],yG=[],xG=new Float32Array(16),wG=new Float32Array(9),_G=new Float32Array(4);function cv(e,t,i){let n=e[0];if(n<=0||n>0)return e;let r=t*i,s=vG[r];if(s===void 0&&(s=new Float32Array(r),vG[r]=s),t!==0){n.toArray(s,0);for(let o=1,a=0;o!==t;++o)a+=i,e[o].toArray(s,a)}return s}function rr(e,t){if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(e[i]!==t[i])return!1;return!0}function sr(e,t){for(let i=0,n=t.length;i<n;i++)e[i]=t[i]}function YM(e,t){let i=yG[t];i===void 0&&(i=new Int32Array(t),yG[t]=i);for(let n=0;n!==t;++n)i[n]=e.allocateTextureUnit();return i}function S1e(e,t){let i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function M1e(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(rr(i,t))return;e.uniform2fv(this.addr,t),sr(i,t)}}function E1e(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(t.r!==void 0)(i[0]!==t.r||i[1]!==t.g||i[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(rr(i,t))return;e.uniform3fv(this.addr,t),sr(i,t)}}function C1e(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(rr(i,t))return;e.uniform4fv(this.addr,t),sr(i,t)}}function T1e(e,t){let i=this.cache,n=t.elements;if(n===void 0){if(rr(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),sr(i,t)}else{if(rr(i,n))return;_G.set(n),e.uniformMatrix2fv(this.addr,!1,_G),sr(i,n)}}function P1e(e,t){let i=this.cache,n=t.elements;if(n===void 0){if(rr(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),sr(i,t)}else{if(rr(i,n))return;wG.set(n),e.uniformMatrix3fv(this.addr,!1,wG),sr(i,n)}}function D1e(e,t){let i=this.cache,n=t.elements;if(n===void 0){if(rr(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),sr(i,t)}else{if(rr(i,n))return;xG.set(n),e.uniformMatrix4fv(this.addr,!1,xG),sr(i,n)}}function B1e(e,t){let i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function L1e(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(rr(i,t))return;e.uniform2iv(this.addr,t),sr(i,t)}}function R1e(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(rr(i,t))return;e.uniform3iv(this.addr,t),sr(i,t)}}function I1e(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(rr(i,t))return;e.uniform4iv(this.addr,t),sr(i,t)}}function O1e(e,t){let i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function F1e(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(rr(i,t))return;e.uniform2uiv(this.addr,t),sr(i,t)}}function N1e(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(rr(i,t))return;e.uniform3uiv(this.addr,t),sr(i,t)}}function z1e(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(rr(i,t))return;e.uniform4uiv(this.addr,t),sr(i,t)}}function k1e(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(t||xq,r)}function U1e(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(t||_q,r)}function G1e(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(t||bq,r)}function H1e(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(t||wq,r)}function V1e(e){switch(e){case 5126:return S1e;case 35664:return M1e;case 35665:return E1e;case 35666:return C1e;case 35674:return T1e;case 35675:return P1e;case 35676:return D1e;case 5124:case 35670:return B1e;case 35667:case 35671:return L1e;case 35668:case 35672:return R1e;case 35669:case 35673:return I1e;case 5125:return O1e;case 36294:return F1e;case 36295:return N1e;case 36296:return z1e;case 35678:case 36198:case 36298:case 36306:case 35682:return k1e;case 35679:case 36299:case 36307:return U1e;case 35680:case 36300:case 36308:case 36293:return G1e;case 36289:case 36303:case 36311:case 36292:return H1e}}function j1e(e,t){e.uniform1fv(this.addr,t)}function W1e(e,t){let i=cv(t,this.size,2);e.uniform2fv(this.addr,i)}function X1e(e,t){let i=cv(t,this.size,3);e.uniform3fv(this.addr,i)}function Y1e(e,t){let i=cv(t,this.size,4);e.uniform4fv(this.addr,i)}function q1e(e,t){let i=cv(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function Q1e(e,t){let i=cv(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function J1e(e,t){let i=cv(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function K1e(e,t){e.uniform1iv(this.addr,t)}function Z1e(e,t){e.uniform2iv(this.addr,t)}function $1e(e,t){e.uniform3iv(this.addr,t)}function ewe(e,t){e.uniform4iv(this.addr,t)}function twe(e,t){e.uniform1uiv(this.addr,t)}function iwe(e,t){e.uniform2uiv(this.addr,t)}function nwe(e,t){e.uniform3uiv(this.addr,t)}function rwe(e,t){e.uniform4uiv(this.addr,t)}function swe(e,t,i){let n=this.cache,r=t.length,s=YM(i,r);rr(n,s)||(e.uniform1iv(this.addr,s),sr(n,s));for(let o=0;o!==r;++o)i.setTexture2D(t[o]||xq,s[o])}function owe(e,t,i){let n=this.cache,r=t.length,s=YM(i,r);rr(n,s)||(e.uniform1iv(this.addr,s),sr(n,s));for(let o=0;o!==r;++o)i.setTexture3D(t[o]||_q,s[o])}function awe(e,t,i){let n=this.cache,r=t.length,s=YM(i,r);rr(n,s)||(e.uniform1iv(this.addr,s),sr(n,s));for(let o=0;o!==r;++o)i.setTextureCube(t[o]||bq,s[o])}function lwe(e,t,i){let n=this.cache,r=t.length,s=YM(i,r);rr(n,s)||(e.uniform1iv(this.addr,s),sr(n,s));for(let o=0;o!==r;++o)i.setTexture2DArray(t[o]||wq,s[o])}function cwe(e){switch(e){case 5126:return j1e;case 35664:return W1e;case 35665:return X1e;case 35666:return Y1e;case 35674:return q1e;case 35675:return Q1e;case 35676:return J1e;case 5124:case 35670:return K1e;case 35667:case 35671:return Z1e;case 35668:case 35672:return $1e;case 35669:case 35673:return ewe;case 5125:return twe;case 36294:return iwe;case 36295:return nwe;case 36296:return rwe;case 35678:case 36198:case 36298:case 36306:case 35682:return swe;case 35679:case 36299:case 36307:return owe;case 35680:case 36300:case 36308:case 36293:return awe;case 36289:case 36303:case 36311:case 36292:return lwe}}var uwe=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=V1e(t.type)}},hwe=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=cwe(t.type)}},dwe=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){let n=this.seq;for(let r=0,s=n.length;r!==s;++r){let o=n[r];o.setValue(e,t[o.id],i)}}},D2=/(\w+)(\])?(\[|\.)?/g;function bG(e,t){e.seq.push(t),e.map[t.id]=t}function fwe(e,t,i){let n=e.name,r=n.length;for(D2.lastIndex=0;;){let s=D2.exec(n),o=D2.lastIndex,a=s[1],l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){bG(i,c===void 0?new uwe(a,e,t):new hwe(a,e,t));break}else{let h=i.map[a];h===void 0&&(h=new dwe(a),bG(i,h)),i=h}}}var pA=class{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,35718);for(let n=0;n<i;++n){let r=e.getActiveUniform(t,n),s=e.getUniformLocation(t,r.name);fwe(r,s,this)}}setValue(e,t,i,n){let r=this.map[t];r!==void 0&&r.setValue(e,i,n)}setOptional(e,t,i){let n=t[i];n!==void 0&&this.setValue(e,i,n)}static upload(e,t,i,n){for(let r=0,s=t.length;r!==s;++r){let o=t[r],a=i[o.id];a.needsUpdate!==!1&&o.setValue(e,a.value,n)}}static seqWithValue(e,t){let i=[];for(let n=0,r=e.length;n!==r;++n){let s=e[n];s.id in t&&i.push(s)}return i}};function AG(e,t,i){let n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),n}var pwe=0;function mwe(e,t){let i=e.split(`
`),n=[],r=Math.max(t-6,0),s=Math.min(t+6,i.length);for(let o=r;o<s;o++){let a=o+1;n.push(`${a===t?">":" "} ${a}: ${i[o]}`)}return n.join(`
`)}function gwe(e){switch(e){case Ql:return["Linear","( value )"];case Vt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function SG(e,t,i){let n=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();if(n&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let o=parseInt(s[1]);return i.toUpperCase()+`

`+r+`

`+mwe(e.getShaderSource(t),o)}else return r}function vwe(e,t){let i=gwe(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function ywe(e,t){let i;switch(t){case Sve:i="Linear";break;case Mve:i="Reinhard";break;case Eve:i="OptimizedCineon";break;case Cve:i="ACESFilmic";break;case Tve:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function xwe(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(J0).join(`
`)}function wwe(e){let t=[];for(let i in e){let n=e[i];n!==!1&&t.push("#define "+i+" "+n)}return t.join(`
`)}function _we(e,t){let i={},n=e.getProgramParameter(t,35721);for(let r=0;r<n;r++){let s=e.getActiveAttrib(t,r),o=s.name,a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),i[o]={type:s.type,location:e.getAttribLocation(t,o),locationSize:a}}return i}function J0(e){return e!==""}function MG(e,t){let i=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function EG(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var bwe=/^[ \t]*#include +<([\w\d./]+)>/gm;function rB(e){return e.replace(bwe,Awe)}function Awe(e,t){let i=Wt[t];if(i===void 0)throw new Error("Can not resolve #include <"+t+">");return rB(i)}var Swe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function CG(e){return e.replace(Swe,Mwe)}function Mwe(e,t,i,n){let r="";for(let s=parseInt(t);s<parseInt(i);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function TG(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function Ewe(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===$I?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===nq?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Q0&&(t="SHADOWMAP_TYPE_VSM"),t}function Cwe(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Ff:case Nf:t="ENVMAP_TYPE_CUBE";break;case w1:t="ENVMAP_TYPE_CUBE_UV";break}return t}function Twe(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Nf:t="ENVMAP_MODE_REFRACTION";break}return t}function Pwe(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case oq:t="ENVMAP_BLENDING_MULTIPLY";break;case bve:t="ENVMAP_BLENDING_MIX";break;case Ave:t="ENVMAP_BLENDING_ADD";break}return t}function Dwe(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let i=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function Bwe(e,t,i,n){let r=e.getContext(),s=i.defines,o=i.vertexShader,a=i.fragmentShader,l=Ewe(i),c=Cwe(i),h=Twe(i),u=Pwe(i),d=Dwe(i),f=i.isWebGL2?"":xwe(i),p=wwe(s),g=r.createProgram(),m,v,x=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(m=[p].filter(J0).join(`
`),m.length>0&&(m+=`
`),v=[f,p].filter(J0).join(`
`),v.length>0&&(v+=`
`)):(m=[TG(i),"#define SHADER_NAME "+i.shaderName,p,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(J0).join(`
`),v=[f,TG(i),"#define SHADER_NAME "+i.shaderName,p,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.envMap?"#define "+h:"",i.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Zc?"#define TONE_MAPPING":"",i.toneMapping!==Zc?Wt.tonemapping_pars_fragment:"",i.toneMapping!==Zc?ywe("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",Wt.encodings_pars_fragment,vwe("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(J0).join(`
`)),o=rB(o),o=MG(o,i),o=EG(o,i),a=rB(a),a=MG(a,i),a=EG(a,i),o=CG(o),a=CG(a),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(x=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,v=["#define varying in",i.glslVersion===Z5?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===Z5?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);let w=x+m+o,b=x+v+a,M=AG(r,35633,w),A=AG(r,35632,b);if(r.attachShader(g,M),r.attachShader(g,A),i.index0AttributeName!==void 0?r.bindAttribLocation(g,0,i.index0AttributeName):i.morphTargets===!0&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g),e.debug.checkShaderErrors){let C=r.getProgramInfoLog(g).trim(),P=r.getShaderInfoLog(M).trim(),B=r.getShaderInfoLog(A).trim(),k=!0,z=!0;if(r.getProgramParameter(g,35714)===!1){k=!1;let F=SG(r,M,"vertex"),W=SG(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,35715)+`

Program Info Log: `+C+`
`+F+`
`+W)}else C!==""?console.warn("THREE.WebGLProgram: Program Info Log:",C):(P===""||B==="")&&(z=!1);z&&(this.diagnostics={runnable:k,programLog:C,vertexShader:{log:P,prefix:m},fragmentShader:{log:B,prefix:v}})}r.deleteShader(M),r.deleteShader(A);let T;this.getUniforms=function(){return T===void 0&&(T=new pA(r,g)),T};let S;return this.getAttributes=function(){return S===void 0&&(S=_we(r,g)),S},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.name=i.shaderName,this.id=pwe++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=M,this.fragmentShader=A,this}var Lwe=0,Rwe=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,n=this._getShaderStage(t),r=this._getShaderStage(i),s=this._getShaderCacheForMaterial(e);return s.has(n)===!1&&(s.add(n),n.usedTimes++),s.has(r)===!1&&(s.add(r),r.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return i===void 0&&(i=new Iwe(e),t.set(e,i)),i}},Iwe=class{constructor(e){this.id=Lwe++,this.code=e,this.usedTimes=0}};function Owe(e,t,i,n,r,s,o){let a=new tO,l=new Rwe,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures,f=r.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(S,C,P,B,k){let z=B.fog,F=k.geometry,W=S.isMeshStandardMaterial?B.environment:null,K=(S.isMeshStandardMaterial?i:t).get(S.envMap||W),Z=K&&K.mapping===w1?K.image.height:null,U=p[S.type];S.precision!==null&&(f=r.getMaxPrecision(S.precision),f!==S.precision&&console.warn("THREE.WebGLProgram.getParameters:",S.precision,"not supported, using",f,"instead."));let X=F.morphAttributes.position||F.morphAttributes.normal||F.morphAttributes.color,V=X!==void 0?X.length:0,q=0;F.morphAttributes.position!==void 0&&(q=1),F.morphAttributes.normal!==void 0&&(q=2),F.morphAttributes.color!==void 0&&(q=3);let H,Q,J,le;if(U){let de=Pl[U];H=de.vertexShader,Q=de.fragmentShader}else H=S.vertexShader,Q=S.fragmentShader,l.update(S),J=l.getVertexShaderID(S),le=l.getFragmentShaderID(S);let j=e.getRenderTarget(),ve=S.alphaTest>0,pe=S.clearcoat>0,me=S.iridescence>0;return{isWebGL2:h,shaderID:U,shaderName:S.type,vertexShader:H,fragmentShader:Q,defines:S.defines,customVertexShaderID:J,customFragmentShaderID:le,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:f,instancing:k.isInstancedMesh===!0,instancingColor:k.isInstancedMesh===!0&&k.instanceColor!==null,supportsVertexTextures:d,outputEncoding:j===null?e.outputEncoding:j.isXRRenderTarget===!0?j.texture.encoding:Ql,map:!!S.map,matcap:!!S.matcap,envMap:!!K,envMapMode:K&&K.mapping,envMapCubeUVHeight:Z,lightMap:!!S.lightMap,aoMap:!!S.aoMap,emissiveMap:!!S.emissiveMap,bumpMap:!!S.bumpMap,normalMap:!!S.normalMap,objectSpaceNormalMap:S.normalMapType===Wve,tangentSpaceNormalMap:S.normalMapType===jve,decodeVideoTexture:!!S.map&&S.map.isVideoTexture===!0&&S.map.encoding===Vt,clearcoat:pe,clearcoatMap:pe&&!!S.clearcoatMap,clearcoatRoughnessMap:pe&&!!S.clearcoatRoughnessMap,clearcoatNormalMap:pe&&!!S.clearcoatNormalMap,iridescence:me,iridescenceMap:me&&!!S.iridescenceMap,iridescenceThicknessMap:me&&!!S.iridescenceThicknessMap,displacementMap:!!S.displacementMap,roughnessMap:!!S.roughnessMap,metalnessMap:!!S.metalnessMap,specularMap:!!S.specularMap,specularIntensityMap:!!S.specularIntensityMap,specularColorMap:!!S.specularColorMap,opaque:S.transparent===!1&&S.blending===tg,alphaMap:!!S.alphaMap,alphaTest:ve,gradientMap:!!S.gradientMap,sheen:S.sheen>0,sheenColorMap:!!S.sheenColorMap,sheenRoughnessMap:!!S.sheenRoughnessMap,transmission:S.transmission>0,transmissionMap:!!S.transmissionMap,thicknessMap:!!S.thicknessMap,combine:S.combine,vertexTangents:!!S.normalMap&&!!F.attributes.tangent,vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!F.attributes.color&&F.attributes.color.itemSize===4,vertexUvs:!!S.map||!!S.bumpMap||!!S.normalMap||!!S.specularMap||!!S.alphaMap||!!S.emissiveMap||!!S.roughnessMap||!!S.metalnessMap||!!S.clearcoatMap||!!S.clearcoatRoughnessMap||!!S.clearcoatNormalMap||!!S.iridescenceMap||!!S.iridescenceThicknessMap||!!S.displacementMap||!!S.transmissionMap||!!S.thicknessMap||!!S.specularIntensityMap||!!S.specularColorMap||!!S.sheenColorMap||!!S.sheenRoughnessMap,uvsVertexOnly:!(S.map||S.bumpMap||S.normalMap||S.specularMap||S.alphaMap||S.emissiveMap||S.roughnessMap||S.metalnessMap||S.clearcoatNormalMap||S.iridescenceMap||S.iridescenceThicknessMap||S.transmission>0||S.transmissionMap||S.thicknessMap||S.specularIntensityMap||S.specularColorMap||S.sheen>0||S.sheenColorMap||S.sheenRoughnessMap)&&!!S.displacementMap,fog:!!z,useFog:S.fog===!0,fogExp2:z&&z.isFogExp2,flatShading:!!S.flatShading,sizeAttenuation:S.sizeAttenuation,logarithmicDepthBuffer:u,skinning:k.isSkinnedMesh===!0,morphTargets:F.morphAttributes.position!==void 0,morphNormals:F.morphAttributes.normal!==void 0,morphColors:F.morphAttributes.color!==void 0,morphTargetsCount:V,morphTextureStride:q,numDirLights:C.directional.length,numPointLights:C.point.length,numSpotLights:C.spot.length,numSpotLightMaps:C.spotLightMap.length,numRectAreaLights:C.rectArea.length,numHemiLights:C.hemi.length,numDirLightShadows:C.directionalShadowMap.length,numPointLightShadows:C.pointShadowMap.length,numSpotLightShadows:C.spotShadowMap.length,numSpotLightShadowsWithMaps:C.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:S.dithering,shadowMapEnabled:e.shadowMap.enabled&&P.length>0,shadowMapType:e.shadowMap.type,toneMapping:S.toneMapped?e.toneMapping:Zc,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===uo,flipSided:S.side===gr,useDepthPacking:!!S.depthPacking,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionDerivatives:S.extensions&&S.extensions.derivatives,extensionFragDepth:S.extensions&&S.extensions.fragDepth,extensionDrawBuffers:S.extensions&&S.extensions.drawBuffers,extensionShaderTextureLOD:S.extensions&&S.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||n.has("EXT_shader_texture_lod"),customProgramCacheKey:S.customProgramCacheKey()}}function m(S){let C=[];if(S.shaderID?C.push(S.shaderID):(C.push(S.customVertexShaderID),C.push(S.customFragmentShaderID)),S.defines!==void 0)for(let P in S.defines)C.push(P),C.push(S.defines[P]);return S.isRawShaderMaterial===!1&&(v(C,S),x(C,S),C.push(e.outputEncoding)),C.push(S.customProgramCacheKey),C.join()}function v(S,C){S.push(C.precision),S.push(C.outputEncoding),S.push(C.envMapMode),S.push(C.envMapCubeUVHeight),S.push(C.combine),S.push(C.vertexUvs),S.push(C.fogExp2),S.push(C.sizeAttenuation),S.push(C.morphTargetsCount),S.push(C.morphAttributeCount),S.push(C.numDirLights),S.push(C.numPointLights),S.push(C.numSpotLights),S.push(C.numSpotLightMaps),S.push(C.numHemiLights),S.push(C.numRectAreaLights),S.push(C.numDirLightShadows),S.push(C.numPointLightShadows),S.push(C.numSpotLightShadows),S.push(C.numSpotLightShadowsWithMaps),S.push(C.shadowMapType),S.push(C.toneMapping),S.push(C.numClippingPlanes),S.push(C.numClipIntersection),S.push(C.depthPacking)}function x(S,C){a.disableAll(),C.isWebGL2&&a.enable(0),C.supportsVertexTextures&&a.enable(1),C.instancing&&a.enable(2),C.instancingColor&&a.enable(3),C.map&&a.enable(4),C.matcap&&a.enable(5),C.envMap&&a.enable(6),C.lightMap&&a.enable(7),C.aoMap&&a.enable(8),C.emissiveMap&&a.enable(9),C.bumpMap&&a.enable(10),C.normalMap&&a.enable(11),C.objectSpaceNormalMap&&a.enable(12),C.tangentSpaceNormalMap&&a.enable(13),C.clearcoat&&a.enable(14),C.clearcoatMap&&a.enable(15),C.clearcoatRoughnessMap&&a.enable(16),C.clearcoatNormalMap&&a.enable(17),C.iridescence&&a.enable(18),C.iridescenceMap&&a.enable(19),C.iridescenceThicknessMap&&a.enable(20),C.displacementMap&&a.enable(21),C.specularMap&&a.enable(22),C.roughnessMap&&a.enable(23),C.metalnessMap&&a.enable(24),C.gradientMap&&a.enable(25),C.alphaMap&&a.enable(26),C.alphaTest&&a.enable(27),C.vertexColors&&a.enable(28),C.vertexAlphas&&a.enable(29),C.vertexUvs&&a.enable(30),C.vertexTangents&&a.enable(31),C.uvsVertexOnly&&a.enable(32),S.push(a.mask),a.disableAll(),C.fog&&a.enable(0),C.useFog&&a.enable(1),C.flatShading&&a.enable(2),C.logarithmicDepthBuffer&&a.enable(3),C.skinning&&a.enable(4),C.morphTargets&&a.enable(5),C.morphNormals&&a.enable(6),C.morphColors&&a.enable(7),C.premultipliedAlpha&&a.enable(8),C.shadowMapEnabled&&a.enable(9),C.physicallyCorrectLights&&a.enable(10),C.doubleSided&&a.enable(11),C.flipSided&&a.enable(12),C.useDepthPacking&&a.enable(13),C.dithering&&a.enable(14),C.specularIntensityMap&&a.enable(15),C.specularColorMap&&a.enable(16),C.transmission&&a.enable(17),C.transmissionMap&&a.enable(18),C.thicknessMap&&a.enable(19),C.sheen&&a.enable(20),C.sheenColorMap&&a.enable(21),C.sheenRoughnessMap&&a.enable(22),C.decodeVideoTexture&&a.enable(23),C.opaque&&a.enable(24),S.push(a.mask)}function w(S){let C=p[S.type],P;if(C){let B=Pl[C];P=av.clone(B.uniforms)}else P=S.uniforms;return P}function b(S,C){let P;for(let B=0,k=c.length;B<k;B++){let z=c[B];if(z.cacheKey===C){P=z,++P.usedTimes;break}}return P===void 0&&(P=new Bwe(e,C,S,s),c.push(P)),P}function M(S){if(--S.usedTimes===0){let C=c.indexOf(S);c[C]=c[c.length-1],c.pop(),S.destroy()}}function A(S){l.remove(S)}function T(){l.dispose()}return{getParameters:g,getProgramCacheKey:m,getUniforms:w,acquireProgram:b,releaseProgram:M,releaseShaderCache:A,programs:c,dispose:T}}function Fwe(){let e=new WeakMap;function t(s){let o=e.get(s);return o===void 0&&(o={},e.set(s,o)),o}function i(s){e.delete(s)}function n(s,o,a){e.get(s)[o]=a}function r(){e=new WeakMap}return{get:t,remove:i,update:n,dispose:r}}function Nwe(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function PG(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function DG(){let e=[],t=0,i=[],n=[],r=[];function s(){t=0,i.length=0,n.length=0,r.length=0}function o(u,d,f,p,g,m){let v=e[t];return v===void 0?(v={id:u.id,object:u,geometry:d,material:f,groupOrder:p,renderOrder:u.renderOrder,z:g,group:m},e[t]=v):(v.id=u.id,v.object=u,v.geometry=d,v.material=f,v.groupOrder=p,v.renderOrder=u.renderOrder,v.z=g,v.group=m),t++,v}function a(u,d,f,p,g,m){let v=o(u,d,f,p,g,m);f.transmission>0?n.push(v):f.transparent===!0?r.push(v):i.push(v)}function l(u,d,f,p,g,m){let v=o(u,d,f,p,g,m);f.transmission>0?n.unshift(v):f.transparent===!0?r.unshift(v):i.unshift(v)}function c(u,d){i.length>1&&i.sort(u||Nwe),n.length>1&&n.sort(d||PG),r.length>1&&r.sort(d||PG)}function h(){for(let u=t,d=e.length;u<d;u++){let f=e[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:i,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:h,sort:c}}function zwe(){let e=new WeakMap;function t(n,r){let s=e.get(n),o;return s===void 0?(o=new DG,e.set(n,[o])):r>=s.length?(o=new DG,s.push(o)):o=s[r],o}function i(){e=new WeakMap}return{get:t,dispose:i}}function kwe(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={direction:new I,color:new Pt};break;case"SpotLight":i={position:new I,direction:new I,color:new Pt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new I,color:new Pt,distance:0,decay:0};break;case"HemisphereLight":i={direction:new I,skyColor:new Pt,groundColor:new Pt};break;case"RectAreaLight":i={color:new Pt,position:new I,halfWidth:new I,halfHeight:new I};break}return e[t.id]=i,i}}}function Uwe(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=i,i}}}var Gwe=0;function Hwe(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Vwe(e,t){let i=new kwe,n=Uwe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)r.probe.push(new I);let s=new I,o=new Je,a=new Je;function l(h,u){let d=0,f=0,p=0;for(let B=0;B<9;B++)r.probe[B].set(0,0,0);let g=0,m=0,v=0,x=0,w=0,b=0,M=0,A=0,T=0,S=0;h.sort(Hwe);let C=u!==!0?Math.PI:1;for(let B=0,k=h.length;B<k;B++){let z=h[B],F=z.color,W=z.intensity,K=z.distance,Z=z.shadow&&z.shadow.map?z.shadow.map.texture:null;if(z.isAmbientLight)d+=F.r*W*C,f+=F.g*W*C,p+=F.b*W*C;else if(z.isLightProbe)for(let U=0;U<9;U++)r.probe[U].addScaledVector(z.sh.coefficients[U],W);else if(z.isDirectionalLight){let U=i.get(z);if(U.color.copy(z.color).multiplyScalar(z.intensity*C),z.castShadow){let X=z.shadow,V=n.get(z);V.shadowBias=X.bias,V.shadowNormalBias=X.normalBias,V.shadowRadius=X.radius,V.shadowMapSize=X.mapSize,r.directionalShadow[g]=V,r.directionalShadowMap[g]=Z,r.directionalShadowMatrix[g]=z.shadow.matrix,b++}r.directional[g]=U,g++}else if(z.isSpotLight){let U=i.get(z);U.position.setFromMatrixPosition(z.matrixWorld),U.color.copy(F).multiplyScalar(W*C),U.distance=K,U.coneCos=Math.cos(z.angle),U.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),U.decay=z.decay,r.spot[v]=U;let X=z.shadow;if(z.map&&(r.spotLightMap[T]=z.map,T++,X.updateMatrices(z),z.castShadow&&S++),r.spotLightMatrix[v]=X.matrix,z.castShadow){let V=n.get(z);V.shadowBias=X.bias,V.shadowNormalBias=X.normalBias,V.shadowRadius=X.radius,V.shadowMapSize=X.mapSize,r.spotShadow[v]=V,r.spotShadowMap[v]=Z,A++}v++}else if(z.isRectAreaLight){let U=i.get(z);U.color.copy(F).multiplyScalar(W),U.halfWidth.set(z.width*.5,0,0),U.halfHeight.set(0,z.height*.5,0),r.rectArea[x]=U,x++}else if(z.isPointLight){let U=i.get(z);if(U.color.copy(z.color).multiplyScalar(z.intensity*C),U.distance=z.distance,U.decay=z.decay,z.castShadow){let X=z.shadow,V=n.get(z);V.shadowBias=X.bias,V.shadowNormalBias=X.normalBias,V.shadowRadius=X.radius,V.shadowMapSize=X.mapSize,V.shadowCameraNear=X.camera.near,V.shadowCameraFar=X.camera.far,r.pointShadow[m]=V,r.pointShadowMap[m]=Z,r.pointShadowMatrix[m]=z.shadow.matrix,M++}r.point[m]=U,m++}else if(z.isHemisphereLight){let U=i.get(z);U.skyColor.copy(z.color).multiplyScalar(W*C),U.groundColor.copy(z.groundColor).multiplyScalar(W*C),r.hemi[w]=U,w++}}x>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=et.LTC_FLOAT_1,r.rectAreaLTC2=et.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=et.LTC_HALF_1,r.rectAreaLTC2=et.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;let P=r.hash;(P.directionalLength!==g||P.pointLength!==m||P.spotLength!==v||P.rectAreaLength!==x||P.hemiLength!==w||P.numDirectionalShadows!==b||P.numPointShadows!==M||P.numSpotShadows!==A||P.numSpotMaps!==T)&&(r.directional.length=g,r.spot.length=v,r.rectArea.length=x,r.point.length=m,r.hemi.length=w,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=M,r.pointShadowMap.length=M,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=M,r.spotLightMatrix.length=A+T-S,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=S,P.directionalLength=g,P.pointLength=m,P.spotLength=v,P.rectAreaLength=x,P.hemiLength=w,P.numDirectionalShadows=b,P.numPointShadows=M,P.numSpotShadows=A,P.numSpotMaps=T,r.version=Gwe++)}function c(h,u){let d=0,f=0,p=0,g=0,m=0,v=u.matrixWorldInverse;for(let x=0,w=h.length;x<w;x++){let b=h[x];if(b.isDirectionalLight){let M=r.directional[d];M.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(v),d++}else if(b.isSpotLight){let M=r.spot[p];M.position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(v),M.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(v),p++}else if(b.isRectAreaLight){let M=r.rectArea[g];M.position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(v),a.identity(),o.copy(b.matrixWorld),o.premultiply(v),a.extractRotation(o),M.halfWidth.set(b.width*.5,0,0),M.halfHeight.set(0,b.height*.5,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),g++}else if(b.isPointLight){let M=r.point[f];M.position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(v),f++}else if(b.isHemisphereLight){let M=r.hemi[m];M.direction.setFromMatrixPosition(b.matrixWorld),M.direction.transformDirection(v),m++}}}return{setup:l,setupView:c,state:r}}function BG(e,t){let i=new Vwe(e,t),n=[],r=[];function s(){n.length=0,r.length=0}function o(h){n.push(h)}function a(h){r.push(h)}function l(h){i.setup(n,h)}function c(h){i.setupView(n,h)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function jwe(e,t){let i=new WeakMap;function n(s,o=0){let a=i.get(s),l;return a===void 0?(l=new BG(e,t),i.set(s,[l])):o>=a.length?(l=new BG(e,t),a.push(l)):l=a[o],l}function r(){i=new WeakMap}return{get:n,dispose:r}}var Aq=class extends _1{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=du,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},Wwe=class extends _1{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new I,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},Xwe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Ywe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function qwe(e,t,i){let n=new nO,r=new ge,s=new ge,o=new Kt,a=new Aq({depthPacking:uq}),l=new Wwe,c={},h=i.maxTextureSize,u={[Ka]:gr,[gr]:Ka,[uo]:uo},d=new ji({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ge},radius:{value:4}},vertexShader:Xwe,fragmentShader:Ywe}),f=d.clone();f.defines.HORIZONTAL_PASS=1;let p=new Ot;p.setAttribute("position",new zt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let g=new Ns(p,d),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=$I,this.render=function(b,M,A){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||b.length===0)return;let T=e.getRenderTarget(),S=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),P=e.state;P.setBlending(Hn),P.buffers.color.setClear(1,1,1,1),P.buffers.depth.setTest(!0),P.setScissorTest(!1);for(let B=0,k=b.length;B<k;B++){let z=b[B],F=z.shadow;if(F===void 0){console.warn("THREE.WebGLShadowMap:",z,"has no shadow.");continue}if(F.autoUpdate===!1&&F.needsUpdate===!1)continue;r.copy(F.mapSize);let W=F.getFrameExtents();if(r.multiply(W),s.copy(F.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/W.x),r.x=s.x*W.x,F.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/W.y),r.y=s.y*W.y,F.mapSize.y=s.y)),F.map===null){let Z=this.type!==Q0?{minFilter:Ri,magFilter:Ri}:{};F.map=new Pi(r.x,r.y,Z),F.map.texture.name=z.name+".shadowMap",F.camera.updateProjectionMatrix()}e.setRenderTarget(F.map),e.clear();let K=F.getViewportCount();for(let Z=0;Z<K;Z++){let U=F.getViewport(Z);o.set(s.x*U.x,s.y*U.y,s.x*U.z,s.y*U.w),P.viewport(o),F.updateMatrices(z,Z),n=F.getFrustum(),w(M,A,F.camera,z,this.type)}F.isPointLightShadow!==!0&&this.type===Q0&&v(F,A),F.needsUpdate=!1}m.needsUpdate=!1,e.setRenderTarget(T,S,C)};function v(b,M){let A=t.update(g);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new Pi(r.x,r.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,e.setRenderTarget(b.mapPass),e.clear(),e.renderBufferDirect(M,null,A,d,g,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,e.setRenderTarget(b.map),e.clear(),e.renderBufferDirect(M,null,A,f,g,null)}function x(b,M,A,T,S,C){let P=null,B=A.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(B!==void 0)P=B;else if(P=A.isPointLight===!0?l:a,e.localClippingEnabled&&M.clipShadows===!0&&Array.isArray(M.clippingPlanes)&&M.clippingPlanes.length!==0||M.displacementMap&&M.displacementScale!==0||M.alphaMap&&M.alphaTest>0||M.map&&M.alphaTest>0){let k=P.uuid,z=M.uuid,F=c[k];F===void 0&&(F={},c[k]=F);let W=F[z];W===void 0&&(W=P.clone(),F[z]=W),P=W}return P.visible=M.visible,P.wireframe=M.wireframe,C===Q0?P.side=M.shadowSide!==null?M.shadowSide:M.side:P.side=M.shadowSide!==null?M.shadowSide:u[M.side],P.alphaMap=M.alphaMap,P.alphaTest=M.alphaTest,P.map=M.map,P.clipShadows=M.clipShadows,P.clippingPlanes=M.clippingPlanes,P.clipIntersection=M.clipIntersection,P.displacementMap=M.displacementMap,P.displacementScale=M.displacementScale,P.displacementBias=M.displacementBias,P.wireframeLinewidth=M.wireframeLinewidth,P.linewidth=M.linewidth,A.isPointLight===!0&&P.isMeshDistanceMaterial===!0&&(P.referencePosition.setFromMatrixPosition(A.matrixWorld),P.nearDistance=T,P.farDistance=S),P}function w(b,M,A,T,S){if(b.visible===!1)return;if(b.layers.test(M.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&S===Q0)&&(!b.frustumCulled||n.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,b.matrixWorld);let P=t.update(b),B=b.material;if(Array.isArray(B)){let k=P.groups;for(let z=0,F=k.length;z<F;z++){let W=k[z],K=B[W.materialIndex];if(K&&K.visible){let Z=x(b,K,T,A.near,A.far,S);e.renderBufferDirect(A,null,P,Z,b,W)}}}else if(B.visible){let k=x(b,B,T,A.near,A.far,S);e.renderBufferDirect(A,null,P,k,b,null)}}let C=b.children;for(let P=0,B=C.length;P<B;P++)w(C[P],M,A,T,S)}}function Qwe(e,t,i){let n=i.isWebGL2;function r(){let Y=!1,oe=new Kt,ye=null,Fe=new Kt(0,0,0,0);return{setMask:function(Xe){ye!==Xe&&!Y&&(e.colorMask(Xe,Xe,Xe,Xe),ye=Xe)},setLocked:function(Xe){Y=Xe},setClear:function(Xe,pt,ei,ui,ar){ar===!0&&(Xe*=ui,pt*=ui,ei*=ui),oe.set(Xe,pt,ei,ui),Fe.equals(oe)===!1&&(e.clearColor(Xe,pt,ei,ui),Fe.copy(oe))},reset:function(){Y=!1,ye=null,Fe.set(-1,0,0,0)}}}function s(){let Y=!1,oe=null,ye=null,Fe=null;return{setTest:function(Xe){Xe?ve(2929):pe(2929)},setMask:function(Xe){oe!==Xe&&!Y&&(e.depthMask(Xe),oe=Xe)},setFunc:function(Xe){if(ye!==Xe){switch(Xe){case mve:e.depthFunc(512);break;case gve:e.depthFunc(519);break;case vve:e.depthFunc(513);break;case K3:e.depthFunc(515);break;case yve:e.depthFunc(514);break;case xve:e.depthFunc(518);break;case wve:e.depthFunc(516);break;case _ve:e.depthFunc(517);break;default:e.depthFunc(515)}ye=Xe}},setLocked:function(Xe){Y=Xe},setClear:function(Xe){Fe!==Xe&&(e.clearDepth(Xe),Fe=Xe)},reset:function(){Y=!1,oe=null,ye=null,Fe=null}}}function o(){let Y=!1,oe=null,ye=null,Fe=null,Xe=null,pt=null,ei=null,ui=null,ar=null;return{setTest:function(Dt){Y||(Dt?ve(2960):pe(2960))},setMask:function(Dt){oe!==Dt&&!Y&&(e.stencilMask(Dt),oe=Dt)},setFunc:function(Dt,un,Oi){(ye!==Dt||Fe!==un||Xe!==Oi)&&(e.stencilFunc(Dt,un,Oi),ye=Dt,Fe=un,Xe=Oi)},setOp:function(Dt,un,Oi){(pt!==Dt||ei!==un||ui!==Oi)&&(e.stencilOp(Dt,un,Oi),pt=Dt,ei=un,ui=Oi)},setLocked:function(Dt){Y=Dt},setClear:function(Dt){ar!==Dt&&(e.clearStencil(Dt),ar=Dt)},reset:function(){Y=!1,oe=null,ye=null,Fe=null,Xe=null,pt=null,ei=null,ui=null,ar=null}}}let a=new r,l=new s,c=new o,h=new WeakMap,u=new WeakMap,d={},f={},p=new WeakMap,g=[],m=null,v=!1,x=null,w=null,b=null,M=null,A=null,T=null,S=null,C=!1,P=null,B=null,k=null,z=null,F=null,W=e.getParameter(35661),K=!1,Z=0,U=e.getParameter(7938);U.indexOf("WebGL")!==-1?(Z=parseFloat(/^WebGL (\d)/.exec(U)[1]),K=Z>=1):U.indexOf("OpenGL ES")!==-1&&(Z=parseFloat(/^OpenGL ES (\d)/.exec(U)[1]),K=Z>=2);let X=null,V={},q=e.getParameter(3088),H=e.getParameter(2978),Q=new Kt().fromArray(q),J=new Kt().fromArray(H);function le(Y,oe,ye){let Fe=new Uint8Array(4),Xe=e.createTexture();e.bindTexture(Y,Xe),e.texParameteri(Y,10241,9728),e.texParameteri(Y,10240,9728);for(let pt=0;pt<ye;pt++)e.texImage2D(oe+pt,0,6408,1,1,0,6408,5121,Fe);return Xe}let j={};j[3553]=le(3553,3553,1),j[34067]=le(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ve(2929),l.setFunc(K3),Le(!1),ze(b5),ve(2884),be(Hn);function ve(Y){d[Y]!==!0&&(e.enable(Y),d[Y]=!0)}function pe(Y){d[Y]!==!1&&(e.disable(Y),d[Y]=!1)}function me(Y,oe){return f[Y]!==oe?(e.bindFramebuffer(Y,oe),f[Y]=oe,n&&(Y===36009&&(f[36160]=oe),Y===36160&&(f[36009]=oe)),!0):!1}function de(Y,oe){let ye=g,Fe=!1;if(Y)if(ye=p.get(oe),ye===void 0&&(ye=[],p.set(oe,ye)),Y.isWebGLMultipleRenderTargets){let Xe=Y.texture;if(ye.length!==Xe.length||ye[0]!==36064){for(let pt=0,ei=Xe.length;pt<ei;pt++)ye[pt]=36064+pt;ye.length=Xe.length,Fe=!0}}else ye[0]!==36064&&(ye[0]=36064,Fe=!0);else ye[0]!==1029&&(ye[0]=1029,Fe=!0);Fe&&(i.isWebGL2?e.drawBuffers(ye):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(ye))}function Se(Y){return m!==Y?(e.useProgram(Y),m=Y,!0):!1}let ce={[hm]:32774,[rve]:32778,[sve]:32779};if(n)ce[E5]=32775,ce[C5]=32776;else{let Y=t.get("EXT_blend_minmax");Y!==null&&(ce[E5]=Y.MIN_EXT,ce[C5]=Y.MAX_EXT)}let se={[ove]:0,[ave]:1,[lve]:768,[rq]:770,[pve]:776,[dve]:774,[uve]:772,[cve]:769,[sq]:771,[fve]:775,[hve]:773};function be(Y,oe,ye,Fe,Xe,pt,ei,ui){if(Y===Hn){v===!0&&(pe(3042),v=!1);return}if(v===!1&&(ve(3042),v=!0),Y!==nve){if(Y!==x||ui!==C){if((w!==hm||A!==hm)&&(e.blendEquation(32774),w=hm,A=hm),ui)switch(Y){case tg:e.blendFuncSeparate(1,771,1,771);break;case A5:e.blendFunc(1,1);break;case S5:e.blendFuncSeparate(0,769,0,1);break;case M5:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Y);break}else switch(Y){case tg:e.blendFuncSeparate(770,771,1,771);break;case A5:e.blendFunc(770,1);break;case S5:e.blendFuncSeparate(0,769,0,1);break;case M5:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Y);break}b=null,M=null,T=null,S=null,x=Y,C=ui}return}Xe=Xe||oe,pt=pt||ye,ei=ei||Fe,(oe!==w||Xe!==A)&&(e.blendEquationSeparate(ce[oe],ce[Xe]),w=oe,A=Xe),(ye!==b||Fe!==M||pt!==T||ei!==S)&&(e.blendFuncSeparate(se[ye],se[Fe],se[pt],se[ei]),b=ye,M=Fe,T=pt,S=ei),x=Y,C=!1}function Ee(Y,oe){Y.side===uo?pe(2884):ve(2884);let ye=Y.side===gr;oe&&(ye=!ye),Le(ye),Y.blending===tg&&Y.transparent===!1?be(Hn):be(Y.blending,Y.blendEquation,Y.blendSrc,Y.blendDst,Y.blendEquationAlpha,Y.blendSrcAlpha,Y.blendDstAlpha,Y.premultipliedAlpha),l.setFunc(Y.depthFunc),l.setTest(Y.depthTest),l.setMask(Y.depthWrite),a.setMask(Y.colorWrite);let Fe=Y.stencilWrite;c.setTest(Fe),Fe&&(c.setMask(Y.stencilWriteMask),c.setFunc(Y.stencilFunc,Y.stencilRef,Y.stencilFuncMask),c.setOp(Y.stencilFail,Y.stencilZFail,Y.stencilZPass)),Ge(Y.polygonOffset,Y.polygonOffsetFactor,Y.polygonOffsetUnits),Y.alphaToCoverage===!0?ve(32926):pe(32926)}function Le(Y){P!==Y&&(Y?e.frontFace(2304):e.frontFace(2305),P=Y)}function ze(Y){Y!==tve?(ve(2884),Y!==B&&(Y===b5?e.cullFace(1029):Y===ive?e.cullFace(1028):e.cullFace(1032))):pe(2884),B=Y}function Oe(Y){Y!==k&&(K&&e.lineWidth(Y),k=Y)}function Ge(Y,oe,ye){Y?(ve(32823),(z!==oe||F!==ye)&&(e.polygonOffset(oe,ye),z=oe,F=ye)):pe(32823)}function tt(Y){Y?ve(3089):pe(3089)}function ot(Y){Y===void 0&&(Y=33984+W-1),X!==Y&&(e.activeTexture(Y),X=Y)}function N(Y,oe,ye){ye===void 0&&(X===null?ye=33984+W-1:ye=X);let Fe=V[ye];Fe===void 0&&(Fe={type:void 0,texture:void 0},V[ye]=Fe),(Fe.type!==Y||Fe.texture!==oe)&&(X!==ye&&(e.activeTexture(ye),X=ye),e.bindTexture(Y,oe||j[Y]),Fe.type=Y,Fe.texture=oe)}function R(){let Y=V[X];Y!==void 0&&Y.type!==void 0&&(e.bindTexture(Y.type,null),Y.type=void 0,Y.texture=void 0)}function ie(){try{e.compressedTexImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function xe(){try{e.compressedTexImage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function Me(){try{e.texSubImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function Te(){try{e.texSubImage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function qe(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function De(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function ue(){try{e.texStorage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function He(){try{e.texStorage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function ne(){try{e.texImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function we(){try{e.texImage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function Re(Y){Q.equals(Y)===!1&&(e.scissor(Y.x,Y.y,Y.z,Y.w),Q.copy(Y))}function Ne(Y){J.equals(Y)===!1&&(e.viewport(Y.x,Y.y,Y.z,Y.w),J.copy(Y))}function $e(Y,oe){let ye=u.get(oe);ye===void 0&&(ye=new WeakMap,u.set(oe,ye));let Fe=ye.get(Y);Fe===void 0&&(Fe=e.getUniformBlockIndex(oe,Y.name),ye.set(Y,Fe))}function xt(Y,oe){let ye=u.get(oe).get(Y);h.get(oe)!==ye&&(e.uniformBlockBinding(oe,ye,Y.__bindingPointIndex),h.set(oe,ye))}function kt(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),n===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},X=null,V={},f={},p=new WeakMap,g=[],m=null,v=!1,x=null,w=null,b=null,M=null,A=null,T=null,S=null,C=!1,P=null,B=null,k=null,z=null,F=null,Q.set(0,0,e.canvas.width,e.canvas.height),J.set(0,0,e.canvas.width,e.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:ve,disable:pe,bindFramebuffer:me,drawBuffers:de,useProgram:Se,setBlending:be,setMaterial:Ee,setFlipSided:Le,setCullFace:ze,setLineWidth:Oe,setPolygonOffset:Ge,setScissorTest:tt,activeTexture:ot,bindTexture:N,unbindTexture:R,compressedTexImage2D:ie,compressedTexImage3D:xe,texImage2D:ne,texImage3D:we,updateUBOMapping:$e,uniformBlockBinding:xt,texStorage2D:ue,texStorage3D:He,texSubImage2D:Me,texSubImage3D:Te,compressedTexSubImage2D:qe,compressedTexSubImage3D:De,scissor:Re,viewport:Ne,reset:kt}}function Jwe(e,t,i,n,r,s,o){let a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,u=r.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap,g,m=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(N,R){return v?new OffscreenCanvas(N,R):hS("canvas")}function w(N,R,ie,xe){let Me=1;if((N.width>xe||N.height>xe)&&(Me=xe/Math.max(N.width,N.height)),Me<1||R===!0)if(typeof HTMLImageElement<"u"&&N instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&N instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&N instanceof ImageBitmap){let Te=R?uS:Math.floor,qe=Te(Me*N.width),De=Te(Me*N.height);g===void 0&&(g=x(qe,De));let ue=ie?x(qe,De):g;return ue.width=qe,ue.height=De,ue.getContext("2d").drawImage(N,0,0,qe,De),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+N.width+"x"+N.height+") to ("+qe+"x"+De+")."),ue}else return"data"in N&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+N.width+"x"+N.height+")."),N;return N}function b(N){return nB(N.width)&&nB(N.height)}function M(N){return a?!1:N.wrapS!==Pn||N.wrapT!==Pn||N.minFilter!==Ri&&N.minFilter!==Zt}function A(N,R){return N.generateMipmaps&&R&&N.minFilter!==Ri&&N.minFilter!==Zt}function T(N){e.generateMipmap(N)}function S(N,R,ie,xe,Me=!1){if(a===!1)return R;if(N!==null){if(e[N]!==void 0)return e[N];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+N+"'")}let Te=R;return R===6403&&(ie===5126&&(Te=33326),ie===5131&&(Te=33325),ie===5121&&(Te=33321)),R===33319&&(ie===5126&&(Te=33328),ie===5131&&(Te=33327),ie===5121&&(Te=33323)),R===6408&&(ie===5126&&(Te=34836),ie===5131&&(Te=34842),ie===5121&&(Te=xe===Vt&&Me===!1?35907:32856),ie===32819&&(Te=32854),ie===32820&&(Te=32855)),(Te===33325||Te===33326||Te===33327||Te===33328||Te===34842||Te===34836)&&t.get("EXT_color_buffer_float"),Te}function C(N,R,ie){return A(N,ie)===!0||N.isFramebufferTexture&&N.minFilter!==Ri&&N.minFilter!==Zt?Math.log2(Math.max(R.width,R.height))+1:N.mipmaps!==void 0&&N.mipmaps.length>0?N.mipmaps.length:N.isCompressedTexture&&Array.isArray(N.image)?R.mipmaps.length:1}function P(N){return N===Ri||N===T5||N===t2?9728:9729}function B(N){let R=N.target;R.removeEventListener("dispose",B),z(R),R.isVideoTexture&&p.delete(R)}function k(N){let R=N.target;R.removeEventListener("dispose",k),W(R)}function z(N){let R=n.get(N);if(R.__webglInit===void 0)return;let ie=N.source,xe=m.get(ie);if(xe){let Me=xe[R.__cacheKey];Me.usedTimes--,Me.usedTimes===0&&F(N),Object.keys(xe).length===0&&m.delete(ie)}n.remove(N)}function F(N){let R=n.get(N);e.deleteTexture(R.__webglTexture);let ie=N.source,xe=m.get(ie);delete xe[R.__cacheKey],o.memory.textures--}function W(N){let R=N.texture,ie=n.get(N),xe=n.get(R);if(xe.__webglTexture!==void 0&&(e.deleteTexture(xe.__webglTexture),o.memory.textures--),N.depthTexture&&N.depthTexture.dispose(),N.isWebGLCubeRenderTarget)for(let Me=0;Me<6;Me++)e.deleteFramebuffer(ie.__webglFramebuffer[Me]),ie.__webglDepthbuffer&&e.deleteRenderbuffer(ie.__webglDepthbuffer[Me]);else{if(e.deleteFramebuffer(ie.__webglFramebuffer),ie.__webglDepthbuffer&&e.deleteRenderbuffer(ie.__webglDepthbuffer),ie.__webglMultisampledFramebuffer&&e.deleteFramebuffer(ie.__webglMultisampledFramebuffer),ie.__webglColorRenderbuffer)for(let Me=0;Me<ie.__webglColorRenderbuffer.length;Me++)ie.__webglColorRenderbuffer[Me]&&e.deleteRenderbuffer(ie.__webglColorRenderbuffer[Me]);ie.__webglDepthRenderbuffer&&e.deleteRenderbuffer(ie.__webglDepthRenderbuffer)}if(N.isWebGLMultipleRenderTargets)for(let Me=0,Te=R.length;Me<Te;Me++){let qe=n.get(R[Me]);qe.__webglTexture&&(e.deleteTexture(qe.__webglTexture),o.memory.textures--),n.remove(R[Me])}n.remove(R),n.remove(N)}let K=0;function Z(){K=0}function U(){let N=K;return N>=l&&console.warn("THREE.WebGLTextures: Trying to use "+N+" texture units while this GPU supports only "+l),K+=1,N}function X(N){let R=[];return R.push(N.wrapS),R.push(N.wrapT),R.push(N.wrapR||0),R.push(N.magFilter),R.push(N.minFilter),R.push(N.anisotropy),R.push(N.internalFormat),R.push(N.format),R.push(N.type),R.push(N.generateMipmaps),R.push(N.premultiplyAlpha),R.push(N.flipY),R.push(N.unpackAlignment),R.push(N.encoding),R.join()}function V(N,R){let ie=n.get(N);if(N.isVideoTexture&&tt(N),N.isRenderTargetTexture===!1&&N.version>0&&ie.__version!==N.version){let xe=N.image;if(xe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(xe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{pe(ie,N,R);return}}i.bindTexture(3553,ie.__webglTexture,33984+R)}function q(N,R){let ie=n.get(N);if(N.version>0&&ie.__version!==N.version){pe(ie,N,R);return}i.bindTexture(35866,ie.__webglTexture,33984+R)}function H(N,R){let ie=n.get(N);if(N.version>0&&ie.__version!==N.version){pe(ie,N,R);return}i.bindTexture(32879,ie.__webglTexture,33984+R)}function Q(N,R){let ie=n.get(N);if(N.version>0&&ie.__version!==N.version){me(ie,N,R);return}i.bindTexture(34067,ie.__webglTexture,33984+R)}let J={[Wc]:10497,[Pn]:33071,[eB]:33648},le={[Ri]:9728,[T5]:9984,[t2]:9986,[Zt]:9729,[Pve]:9985,[Ig]:9987};function j(N,R,ie){if(ie?(e.texParameteri(N,10242,J[R.wrapS]),e.texParameteri(N,10243,J[R.wrapT]),(N===32879||N===35866)&&e.texParameteri(N,32882,J[R.wrapR]),e.texParameteri(N,10240,le[R.magFilter]),e.texParameteri(N,10241,le[R.minFilter])):(e.texParameteri(N,10242,33071),e.texParameteri(N,10243,33071),(N===32879||N===35866)&&e.texParameteri(N,32882,33071),(R.wrapS!==Pn||R.wrapT!==Pn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(N,10240,P(R.magFilter)),e.texParameteri(N,10241,P(R.minFilter)),R.minFilter!==Ri&&R.minFilter!==Zt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let xe=t.get("EXT_texture_filter_anisotropic");if(R.magFilter===Ri||R.minFilter!==t2&&R.minFilter!==Ig||R.type===$o&&t.has("OES_texture_float_linear")===!1||a===!1&&R.type===Og&&t.has("OES_texture_half_float_linear")===!1)return;(R.anisotropy>1||n.get(R).__currentAnisotropy)&&(e.texParameterf(N,xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(R.anisotropy,r.getMaxAnisotropy())),n.get(R).__currentAnisotropy=R.anisotropy)}}function ve(N,R){let ie=!1;N.__webglInit===void 0&&(N.__webglInit=!0,R.addEventListener("dispose",B));let xe=R.source,Me=m.get(xe);Me===void 0&&(Me={},m.set(xe,Me));let Te=X(R);if(Te!==N.__cacheKey){Me[Te]===void 0&&(Me[Te]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,ie=!0),Me[Te].usedTimes++;let qe=Me[N.__cacheKey];qe!==void 0&&(Me[N.__cacheKey].usedTimes--,qe.usedTimes===0&&F(R)),N.__cacheKey=Te,N.__webglTexture=Me[Te].texture}return ie}function pe(N,R,ie){let xe=3553;(R.isDataArrayTexture||R.isCompressedArrayTexture)&&(xe=35866),R.isData3DTexture&&(xe=32879);let Me=ve(N,R),Te=R.source;i.bindTexture(xe,N.__webglTexture,33984+ie);let qe=n.get(Te);if(Te.version!==qe.__version||Me===!0){i.activeTexture(33984+ie),e.pixelStorei(37440,R.flipY),e.pixelStorei(37441,R.premultiplyAlpha),e.pixelStorei(3317,R.unpackAlignment),e.pixelStorei(37443,0);let De=M(R)&&b(R.image)===!1,ue=w(R.image,De,!1,h);ue=ot(R,ue);let He=b(ue)||a,ne=s.convert(R.format,R.encoding),we=s.convert(R.type),Re=S(R.internalFormat,ne,we,R.encoding,R.isVideoTexture);j(xe,R,He);let Ne,$e=R.mipmaps,xt=a&&R.isVideoTexture!==!0,kt=qe.__version===void 0||Me===!0,Y=C(R,ue,He);if(R.isDepthTexture)Re=6402,a?R.type===$o?Re=36012:R.type===ch?Re=33190:R.type===xf?Re=35056:Re=33189:R.type===$o&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),R.format===wf&&Re===6402&&R.type!==lq&&R.type!==ch&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),R.type=ch,we=s.convert(R.type)),R.format===zf&&Re===6402&&(Re=34041,R.type!==xf&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),R.type=xf,we=s.convert(R.type))),kt&&(xt?i.texStorage2D(3553,1,Re,ue.width,ue.height):i.texImage2D(3553,0,Re,ue.width,ue.height,0,ne,we,null));else if(R.isDataTexture)if($e.length>0&&He){xt&&kt&&i.texStorage2D(3553,Y,Re,$e[0].width,$e[0].height);for(let oe=0,ye=$e.length;oe<ye;oe++)Ne=$e[oe],xt?i.texSubImage2D(3553,oe,0,0,Ne.width,Ne.height,ne,we,Ne.data):i.texImage2D(3553,oe,Re,Ne.width,Ne.height,0,ne,we,Ne.data);R.generateMipmaps=!1}else xt?(kt&&i.texStorage2D(3553,Y,Re,ue.width,ue.height),i.texSubImage2D(3553,0,0,0,ue.width,ue.height,ne,we,ue.data)):i.texImage2D(3553,0,Re,ue.width,ue.height,0,ne,we,ue.data);else if(R.isCompressedTexture)if(R.isCompressedArrayTexture){xt&&kt&&i.texStorage3D(35866,Y,Re,$e[0].width,$e[0].height,ue.depth);for(let oe=0,ye=$e.length;oe<ye;oe++)Ne=$e[oe],R.format!==Na?ne!==null?xt?i.compressedTexSubImage3D(35866,oe,0,0,0,Ne.width,Ne.height,ue.depth,ne,Ne.data,0,0):i.compressedTexImage3D(35866,oe,Re,Ne.width,Ne.height,ue.depth,0,Ne.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):xt?i.texSubImage3D(35866,oe,0,0,0,Ne.width,Ne.height,ue.depth,ne,we,Ne.data):i.texImage3D(35866,oe,Re,Ne.width,Ne.height,ue.depth,0,ne,we,Ne.data)}else{xt&&kt&&i.texStorage2D(3553,Y,Re,$e[0].width,$e[0].height);for(let oe=0,ye=$e.length;oe<ye;oe++)Ne=$e[oe],R.format!==Na?ne!==null?xt?i.compressedTexSubImage2D(3553,oe,0,0,Ne.width,Ne.height,ne,Ne.data):i.compressedTexImage2D(3553,oe,Re,Ne.width,Ne.height,0,Ne.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):xt?i.texSubImage2D(3553,oe,0,0,Ne.width,Ne.height,ne,we,Ne.data):i.texImage2D(3553,oe,Re,Ne.width,Ne.height,0,ne,we,Ne.data)}else if(R.isDataArrayTexture)xt?(kt&&i.texStorage3D(35866,Y,Re,ue.width,ue.height,ue.depth),i.texSubImage3D(35866,0,0,0,0,ue.width,ue.height,ue.depth,ne,we,ue.data)):i.texImage3D(35866,0,Re,ue.width,ue.height,ue.depth,0,ne,we,ue.data);else if(R.isData3DTexture)xt?(kt&&i.texStorage3D(32879,Y,Re,ue.width,ue.height,ue.depth),i.texSubImage3D(32879,0,0,0,0,ue.width,ue.height,ue.depth,ne,we,ue.data)):i.texImage3D(32879,0,Re,ue.width,ue.height,ue.depth,0,ne,we,ue.data);else if(R.isFramebufferTexture){if(kt)if(xt)i.texStorage2D(3553,Y,Re,ue.width,ue.height);else{let oe=ue.width,ye=ue.height;for(let Fe=0;Fe<Y;Fe++)i.texImage2D(3553,Fe,Re,oe,ye,0,ne,we,null),oe>>=1,ye>>=1}}else if($e.length>0&&He){xt&&kt&&i.texStorage2D(3553,Y,Re,$e[0].width,$e[0].height);for(let oe=0,ye=$e.length;oe<ye;oe++)Ne=$e[oe],xt?i.texSubImage2D(3553,oe,0,0,ne,we,Ne):i.texImage2D(3553,oe,Re,ne,we,Ne);R.generateMipmaps=!1}else xt?(kt&&i.texStorage2D(3553,Y,Re,ue.width,ue.height),i.texSubImage2D(3553,0,0,0,ne,we,ue)):i.texImage2D(3553,0,Re,ne,we,ue);A(R,He)&&T(xe),qe.__version=Te.version,R.onUpdate&&R.onUpdate(R)}N.__version=R.version}function me(N,R,ie){if(R.image.length!==6)return;let xe=ve(N,R),Me=R.source;i.bindTexture(34067,N.__webglTexture,33984+ie);let Te=n.get(Me);if(Me.version!==Te.__version||xe===!0){i.activeTexture(33984+ie),e.pixelStorei(37440,R.flipY),e.pixelStorei(37441,R.premultiplyAlpha),e.pixelStorei(3317,R.unpackAlignment),e.pixelStorei(37443,0);let qe=R.isCompressedTexture||R.image[0].isCompressedTexture,De=R.image[0]&&R.image[0].isDataTexture,ue=[];for(let oe=0;oe<6;oe++)!qe&&!De?ue[oe]=w(R.image[oe],!1,!0,c):ue[oe]=De?R.image[oe].image:R.image[oe],ue[oe]=ot(R,ue[oe]);let He=ue[0],ne=b(He)||a,we=s.convert(R.format,R.encoding),Re=s.convert(R.type),Ne=S(R.internalFormat,we,Re,R.encoding),$e=a&&R.isVideoTexture!==!0,xt=Te.__version===void 0||xe===!0,kt=C(R,He,ne);j(34067,R,ne);let Y;if(qe){$e&&xt&&i.texStorage2D(34067,kt,Ne,He.width,He.height);for(let oe=0;oe<6;oe++){Y=ue[oe].mipmaps;for(let ye=0;ye<Y.length;ye++){let Fe=Y[ye];R.format!==Na?we!==null?$e?i.compressedTexSubImage2D(34069+oe,ye,0,0,Fe.width,Fe.height,we,Fe.data):i.compressedTexImage2D(34069+oe,ye,Ne,Fe.width,Fe.height,0,Fe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):$e?i.texSubImage2D(34069+oe,ye,0,0,Fe.width,Fe.height,we,Re,Fe.data):i.texImage2D(34069+oe,ye,Ne,Fe.width,Fe.height,0,we,Re,Fe.data)}}}else{Y=R.mipmaps,$e&&xt&&(Y.length>0&&kt++,i.texStorage2D(34067,kt,Ne,ue[0].width,ue[0].height));for(let oe=0;oe<6;oe++)if(De){$e?i.texSubImage2D(34069+oe,0,0,0,ue[oe].width,ue[oe].height,we,Re,ue[oe].data):i.texImage2D(34069+oe,0,Ne,ue[oe].width,ue[oe].height,0,we,Re,ue[oe].data);for(let ye=0;ye<Y.length;ye++){let Fe=Y[ye].image[oe].image;$e?i.texSubImage2D(34069+oe,ye+1,0,0,Fe.width,Fe.height,we,Re,Fe.data):i.texImage2D(34069+oe,ye+1,Ne,Fe.width,Fe.height,0,we,Re,Fe.data)}}else{$e?i.texSubImage2D(34069+oe,0,0,0,we,Re,ue[oe]):i.texImage2D(34069+oe,0,Ne,we,Re,ue[oe]);for(let ye=0;ye<Y.length;ye++){let Fe=Y[ye];$e?i.texSubImage2D(34069+oe,ye+1,0,0,we,Re,Fe.image[oe]):i.texImage2D(34069+oe,ye+1,Ne,we,Re,Fe.image[oe])}}}A(R,ne)&&T(34067),Te.__version=Me.version,R.onUpdate&&R.onUpdate(R)}N.__version=R.version}function de(N,R,ie,xe,Me){let Te=s.convert(ie.format,ie.encoding),qe=s.convert(ie.type),De=S(ie.internalFormat,Te,qe,ie.encoding);n.get(R).__hasExternalTextures||(Me===32879||Me===35866?i.texImage3D(Me,0,De,R.width,R.height,R.depth,0,Te,qe,null):i.texImage2D(Me,0,De,R.width,R.height,0,Te,qe,null)),i.bindFramebuffer(36160,N),Ge(R)?d.framebufferTexture2DMultisampleEXT(36160,xe,Me,n.get(ie).__webglTexture,0,Oe(R)):(Me===3553||Me>=34069&&Me<=34074)&&e.framebufferTexture2D(36160,xe,Me,n.get(ie).__webglTexture,0),i.bindFramebuffer(36160,null)}function Se(N,R,ie){if(e.bindRenderbuffer(36161,N),R.depthBuffer&&!R.stencilBuffer){let xe=33189;if(ie||Ge(R)){let Me=R.depthTexture;Me&&Me.isDepthTexture&&(Me.type===$o?xe=36012:Me.type===ch&&(xe=33190));let Te=Oe(R);Ge(R)?d.renderbufferStorageMultisampleEXT(36161,Te,xe,R.width,R.height):e.renderbufferStorageMultisample(36161,Te,xe,R.width,R.height)}else e.renderbufferStorage(36161,xe,R.width,R.height);e.framebufferRenderbuffer(36160,36096,36161,N)}else if(R.depthBuffer&&R.stencilBuffer){let xe=Oe(R);ie&&Ge(R)===!1?e.renderbufferStorageMultisample(36161,xe,35056,R.width,R.height):Ge(R)?d.renderbufferStorageMultisampleEXT(36161,xe,35056,R.width,R.height):e.renderbufferStorage(36161,34041,R.width,R.height),e.framebufferRenderbuffer(36160,33306,36161,N)}else{let xe=R.isWebGLMultipleRenderTargets===!0?R.texture:[R.texture];for(let Me=0;Me<xe.length;Me++){let Te=xe[Me],qe=s.convert(Te.format,Te.encoding),De=s.convert(Te.type),ue=S(Te.internalFormat,qe,De,Te.encoding),He=Oe(R);ie&&Ge(R)===!1?e.renderbufferStorageMultisample(36161,He,ue,R.width,R.height):Ge(R)?d.renderbufferStorageMultisampleEXT(36161,He,ue,R.width,R.height):e.renderbufferStorage(36161,ue,R.width,R.height)}}e.bindRenderbuffer(36161,null)}function ce(N,R){if(R&&R.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,N),!(R.depthTexture&&R.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(R.depthTexture).__webglTexture||R.depthTexture.image.width!==R.width||R.depthTexture.image.height!==R.height)&&(R.depthTexture.image.width=R.width,R.depthTexture.image.height=R.height,R.depthTexture.needsUpdate=!0),V(R.depthTexture,0);let ie=n.get(R.depthTexture).__webglTexture,xe=Oe(R);if(R.depthTexture.format===wf)Ge(R)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,ie,0,xe):e.framebufferTexture2D(36160,36096,3553,ie,0);else if(R.depthTexture.format===zf)Ge(R)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,ie,0,xe):e.framebufferTexture2D(36160,33306,3553,ie,0);else throw new Error("Unknown depthTexture format")}function se(N){let R=n.get(N),ie=N.isWebGLCubeRenderTarget===!0;if(N.depthTexture&&!R.__autoAllocateDepthBuffer){if(ie)throw new Error("target.depthTexture not supported in Cube render targets");ce(R.__webglFramebuffer,N)}else if(ie){R.__webglDepthbuffer=[];for(let xe=0;xe<6;xe++)i.bindFramebuffer(36160,R.__webglFramebuffer[xe]),R.__webglDepthbuffer[xe]=e.createRenderbuffer(),Se(R.__webglDepthbuffer[xe],N,!1)}else i.bindFramebuffer(36160,R.__webglFramebuffer),R.__webglDepthbuffer=e.createRenderbuffer(),Se(R.__webglDepthbuffer,N,!1);i.bindFramebuffer(36160,null)}function be(N,R,ie){let xe=n.get(N);R!==void 0&&de(xe.__webglFramebuffer,N,N.texture,36064,3553),ie!==void 0&&se(N)}function Ee(N){let R=N.texture,ie=n.get(N),xe=n.get(R);N.addEventListener("dispose",k),N.isWebGLMultipleRenderTargets!==!0&&(xe.__webglTexture===void 0&&(xe.__webglTexture=e.createTexture()),xe.__version=R.version,o.memory.textures++);let Me=N.isWebGLCubeRenderTarget===!0,Te=N.isWebGLMultipleRenderTargets===!0,qe=b(N)||a;if(Me){ie.__webglFramebuffer=[];for(let De=0;De<6;De++)ie.__webglFramebuffer[De]=e.createFramebuffer()}else{if(ie.__webglFramebuffer=e.createFramebuffer(),Te)if(r.drawBuffers){let De=N.texture;for(let ue=0,He=De.length;ue<He;ue++){let ne=n.get(De[ue]);ne.__webglTexture===void 0&&(ne.__webglTexture=e.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&N.samples>0&&Ge(N)===!1){let De=Te?R:[R];ie.__webglMultisampledFramebuffer=e.createFramebuffer(),ie.__webglColorRenderbuffer=[],i.bindFramebuffer(36160,ie.__webglMultisampledFramebuffer);for(let ue=0;ue<De.length;ue++){let He=De[ue];ie.__webglColorRenderbuffer[ue]=e.createRenderbuffer(),e.bindRenderbuffer(36161,ie.__webglColorRenderbuffer[ue]);let ne=s.convert(He.format,He.encoding),we=s.convert(He.type),Re=S(He.internalFormat,ne,we,He.encoding,N.isXRRenderTarget===!0),Ne=Oe(N);e.renderbufferStorageMultisample(36161,Ne,Re,N.width,N.height),e.framebufferRenderbuffer(36160,36064+ue,36161,ie.__webglColorRenderbuffer[ue])}e.bindRenderbuffer(36161,null),N.depthBuffer&&(ie.__webglDepthRenderbuffer=e.createRenderbuffer(),Se(ie.__webglDepthRenderbuffer,N,!0)),i.bindFramebuffer(36160,null)}}if(Me){i.bindTexture(34067,xe.__webglTexture),j(34067,R,qe);for(let De=0;De<6;De++)de(ie.__webglFramebuffer[De],N,R,36064,34069+De);A(R,qe)&&T(34067),i.unbindTexture()}else if(Te){let De=N.texture;for(let ue=0,He=De.length;ue<He;ue++){let ne=De[ue],we=n.get(ne);i.bindTexture(3553,we.__webglTexture),j(3553,ne,qe),de(ie.__webglFramebuffer,N,ne,36064+ue,3553),A(ne,qe)&&T(3553)}i.unbindTexture()}else{let De=3553;(N.isWebGL3DRenderTarget||N.isWebGLArrayRenderTarget)&&(a?De=N.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(De,xe.__webglTexture),j(De,R,qe),de(ie.__webglFramebuffer,N,R,36064,De),A(R,qe)&&T(De),i.unbindTexture()}N.depthBuffer&&se(N)}function Le(N){let R=b(N)||a,ie=N.isWebGLMultipleRenderTargets===!0?N.texture:[N.texture];for(let xe=0,Me=ie.length;xe<Me;xe++){let Te=ie[xe];if(A(Te,R)){let qe=N.isWebGLCubeRenderTarget?34067:3553,De=n.get(Te).__webglTexture;i.bindTexture(qe,De),T(qe),i.unbindTexture()}}}function ze(N){if(a&&N.samples>0&&Ge(N)===!1){let R=N.isWebGLMultipleRenderTargets?N.texture:[N.texture],ie=N.width,xe=N.height,Me=16384,Te=[],qe=N.stencilBuffer?33306:36096,De=n.get(N),ue=N.isWebGLMultipleRenderTargets===!0;if(ue)for(let He=0;He<R.length;He++)i.bindFramebuffer(36160,De.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+He,36161,null),i.bindFramebuffer(36160,De.__webglFramebuffer),e.framebufferTexture2D(36009,36064+He,3553,null,0);i.bindFramebuffer(36008,De.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,De.__webglFramebuffer);for(let He=0;He<R.length;He++){Te.push(36064+He),N.depthBuffer&&Te.push(qe);let ne=De.__ignoreDepthValues!==void 0?De.__ignoreDepthValues:!1;if(ne===!1&&(N.depthBuffer&&(Me|=256),N.stencilBuffer&&(Me|=1024)),ue&&e.framebufferRenderbuffer(36008,36064,36161,De.__webglColorRenderbuffer[He]),ne===!0&&(e.invalidateFramebuffer(36008,[qe]),e.invalidateFramebuffer(36009,[qe])),ue){let we=n.get(R[He]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,we,0)}e.blitFramebuffer(0,0,ie,xe,0,0,ie,xe,Me,9728),f&&e.invalidateFramebuffer(36008,Te)}if(i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),ue)for(let He=0;He<R.length;He++){i.bindFramebuffer(36160,De.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+He,36161,De.__webglColorRenderbuffer[He]);let ne=n.get(R[He]).__webglTexture;i.bindFramebuffer(36160,De.__webglFramebuffer),e.framebufferTexture2D(36009,36064+He,3553,ne,0)}i.bindFramebuffer(36009,De.__webglMultisampledFramebuffer)}}function Oe(N){return Math.min(u,N.samples)}function Ge(N){let R=n.get(N);return a&&N.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&R.__useRenderToTexture!==!1}function tt(N){let R=o.render.frame;p.get(N)!==R&&(p.set(N,R),N.update())}function ot(N,R){let ie=N.encoding,xe=N.format,Me=N.type;return N.isCompressedTexture===!0||N.isVideoTexture===!0||N.format===iB||ie!==Ql&&(ie===Vt?a===!1?t.has("EXT_sRGB")===!0&&xe===Na?(N.format=iB,N.minFilter=Zt,N.generateMipmaps=!1):R=fq.sRGBToLinear(R):(xe!==Na||Me!==Kr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ie)),R}this.allocateTextureUnit=U,this.resetTextureUnits=Z,this.setTexture2D=V,this.setTexture2DArray=q,this.setTexture3D=H,this.setTextureCube=Q,this.rebindTextures=be,this.setupRenderTarget=Ee,this.updateRenderTargetMipmap=Le,this.updateMultisampleRenderTarget=ze,this.setupDepthRenderbuffer=se,this.setupFrameBufferTexture=de,this.useMultisampledRTT=Ge}function Kwe(e,t,i){let n=i.isWebGL2;function r(s,o=null){let a;if(s===Kr)return 5121;if(s===Rve)return 32819;if(s===Ive)return 32820;if(s===Dve)return 5120;if(s===Bve)return 5122;if(s===lq)return 5123;if(s===Lve)return 5124;if(s===ch)return 5125;if(s===$o)return 5126;if(s===Og)return n?5131:(a=t.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===Ove)return 6406;if(s===Na)return 6408;if(s===Fve)return 6409;if(s===Nve)return 6410;if(s===wf)return 6402;if(s===zf)return 34041;if(s===iB)return a=t.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===zve)return 6403;if(s===kve)return 36244;if(s===cq)return 33319;if(s===Uve)return 33320;if(s===Gve)return 36249;if(s===i2||s===n2||s===r2||s===s2)if(o===Vt)if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===i2)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===n2)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===r2)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===s2)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=t.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===i2)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===n2)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===r2)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===s2)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===P5||s===D5||s===B5||s===L5)if(a=t.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===P5)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===D5)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===B5)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===L5)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===Hve)return a=t.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===R5||s===I5)if(a=t.get("WEBGL_compressed_texture_etc"),a!==null){if(s===R5)return o===Vt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===I5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===O5||s===F5||s===N5||s===z5||s===k5||s===U5||s===G5||s===H5||s===V5||s===j5||s===W5||s===X5||s===Y5||s===q5)if(a=t.get("WEBGL_compressed_texture_astc"),a!==null){if(s===O5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===F5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===N5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===z5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===k5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===U5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===G5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===H5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===V5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===j5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===W5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===X5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===Y5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===q5)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===o2)if(a=t.get("EXT_texture_compression_bptc"),a!==null){if(s===o2)return o===Vt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===Vve||s===Q5||s===J5||s===K5)if(a=t.get("EXT_texture_compression_rgtc"),a!==null){if(s===o2)return a.COMPRESSED_RED_RGTC1_EXT;if(s===Q5)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===J5)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===K5)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===xf?n?34042:(a=t.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):e[s]!==void 0?e[s]:null}return{convert:r}}var Zwe=class extends Yr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},Nm=class extends Ii{constructor(){super(),this.isGroup=!0,this.type="Group"}},$we={type:"move"},B2=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Nm,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Nm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new I,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new I),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Nm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new I,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new I),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let n=null,r=null,s=null,o=this._targetRay,a=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){s=!0;for(let p of e.hand.values()){let g=t.getJointPose(p,i),m=this._getHandJoint(l,p);g!==null&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.jointRadius=g.radius),m.visible=g!==null}let c=l.joints["index-finger-tip"],h=l.joints["thumb-tip"],u=c.position.distanceTo(h.position),d=.02,f=.005;l.inputState.pinching&&u>d+f?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&u<=d-f&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else a!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,i),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));o!==null&&(n=t.getPose(e.targetRaySpace,i),n===null&&r!==null&&(n=r),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent($we)))}return o!==null&&(o.visible=n!==null),a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let i=new Nm;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}},Ng=class extends tr{constructor(e,t,i,n,r,s,o,a,l,c){if(c=c!==void 0?c:wf,c!==wf&&c!==zf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&c===wf&&(i=ch),i===void 0&&c===zf&&(i=xf),super(null,n,r,s,o,a,c,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=o!==void 0?o:Ri,this.minFilter=a!==void 0?a:Ri,this.flipY=!1,this.generateMipmaps=!1}},e_e=class extends _s{constructor(e,t){super();let i=this,n=null,r=1,s=null,o="local-floor",a=1,l=null,c=null,h=null,u=null,d=null,f=null,p=t.getContextAttributes(),g=null,m=null,v=[],x=[],w=new Set,b=new Map,M=new Yr;M.layers.enable(1),M.viewport=new Kt;let A=new Yr;A.layers.enable(2),A.viewport=new Kt;let T=[M,A],S=new Zwe;S.layers.enable(1),S.layers.enable(2);let C=null,P=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(q){let H=v[q];return H===void 0&&(H=new B2,v[q]=H),H.getTargetRaySpace()},this.getControllerGrip=function(q){let H=v[q];return H===void 0&&(H=new B2,v[q]=H),H.getGripSpace()},this.getHand=function(q){let H=v[q];return H===void 0&&(H=new B2,v[q]=H),H.getHandSpace()};function B(q){let H=x.indexOf(q.inputSource);if(H===-1)return;let Q=v[H];Q!==void 0&&Q.dispatchEvent({type:q.type,data:q.inputSource})}function k(){n.removeEventListener("select",B),n.removeEventListener("selectstart",B),n.removeEventListener("selectend",B),n.removeEventListener("squeeze",B),n.removeEventListener("squeezestart",B),n.removeEventListener("squeezeend",B),n.removeEventListener("end",k),n.removeEventListener("inputsourceschange",z);for(let q=0;q<v.length;q++){let H=x[q];H!==null&&(x[q]=null,v[q].disconnect(H))}C=null,P=null,e.setRenderTarget(g),d=null,u=null,h=null,n=null,m=null,V.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(q){r=q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(q){o=q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(q){l=q},this.getBaseLayer=function(){return u!==null?u:d},this.getBinding=function(){return h},this.getFrame=function(){return f},this.getSession=function(){return n},this.setSession=async function(q){if(n=q,n!==null){if(g=e.getRenderTarget(),n.addEventListener("select",B),n.addEventListener("selectstart",B),n.addEventListener("selectend",B),n.addEventListener("squeeze",B),n.addEventListener("squeezestart",B),n.addEventListener("squeezeend",B),n.addEventListener("end",k),n.addEventListener("inputsourceschange",z),p.xrCompatible!==!0&&await t.makeXRCompatible(),n.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let H={antialias:n.renderState.layers===void 0?p.antialias:!0,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(n,t,H),n.updateRenderState({baseLayer:d}),m=new Pi(d.framebufferWidth,d.framebufferHeight,{format:Na,type:Kr,encoding:e.outputEncoding,stencilBuffer:p.stencil})}else{let H=null,Q=null,J=null;p.depth&&(J=p.stencil?35056:33190,H=p.stencil?zf:wf,Q=p.stencil?xf:ch);let le={colorFormat:32856,depthFormat:J,scaleFactor:r};h=new XRWebGLBinding(n,t),u=h.createProjectionLayer(le),n.updateRenderState({layers:[u]}),m=new Pi(u.textureWidth,u.textureHeight,{format:Na,type:Kr,depthTexture:new Ng(u.textureWidth,u.textureHeight,Q,void 0,void 0,void 0,void 0,void 0,void 0,H),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0});let j=e.properties.get(m);j.__ignoreDepthValues=u.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(a),l=null,s=await n.requestReferenceSpace(o),V.setContext(n),V.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function z(q){for(let H=0;H<q.removed.length;H++){let Q=q.removed[H],J=x.indexOf(Q);J>=0&&(x[J]=null,v[J].disconnect(Q))}for(let H=0;H<q.added.length;H++){let Q=q.added[H],J=x.indexOf(Q);if(J===-1){for(let j=0;j<v.length;j++)if(j>=x.length){x.push(Q),J=j;break}else if(x[j]===null){x[j]=Q,J=j;break}if(J===-1)break}let le=v[J];le&&le.connect(Q)}}let F=new I,W=new I;function K(q,H,Q){F.setFromMatrixPosition(H.matrixWorld),W.setFromMatrixPosition(Q.matrixWorld);let J=F.distanceTo(W),le=H.projectionMatrix.elements,j=Q.projectionMatrix.elements,ve=le[14]/(le[10]-1),pe=le[14]/(le[10]+1),me=(le[9]+1)/le[5],de=(le[9]-1)/le[5],Se=(le[8]-1)/le[0],ce=(j[8]+1)/j[0],se=ve*Se,be=ve*ce,Ee=J/(-Se+ce),Le=Ee*-Se;H.matrixWorld.decompose(q.position,q.quaternion,q.scale),q.translateX(Le),q.translateZ(Ee),q.matrixWorld.compose(q.position,q.quaternion,q.scale),q.matrixWorldInverse.copy(q.matrixWorld).invert();let ze=ve+Ee,Oe=pe+Ee,Ge=se-Le,tt=be+(J-Le),ot=me*pe/Oe*ze,N=de*pe/Oe*ze;q.projectionMatrix.makePerspective(Ge,tt,ot,N,ze,Oe)}function Z(q,H){H===null?q.matrixWorld.copy(q.matrix):q.matrixWorld.multiplyMatrices(H.matrixWorld,q.matrix),q.matrixWorldInverse.copy(q.matrixWorld).invert()}this.updateCamera=function(q){if(n===null)return;S.near=A.near=M.near=q.near,S.far=A.far=M.far=q.far,(C!==S.near||P!==S.far)&&(n.updateRenderState({depthNear:S.near,depthFar:S.far}),C=S.near,P=S.far);let H=q.parent,Q=S.cameras;Z(S,H);for(let le=0;le<Q.length;le++)Z(Q[le],H);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),q.matrix.copy(S.matrix),q.matrix.decompose(q.position,q.quaternion,q.scale);let J=q.children;for(let le=0,j=J.length;le<j;le++)J[le].updateMatrixWorld(!0);Q.length===2?K(S,M,A):S.projectionMatrix.copy(M.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(!(u===null&&d===null))return a},this.setFoveation=function(q){a=q,u!==null&&(u.fixedFoveation=q),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=q)},this.getPlanes=function(){return w};let U=null;function X(q,H){if(c=H.getViewerPose(l||s),f=H,c!==null){let Q=c.views;d!==null&&(e.setRenderTargetFramebuffer(m,d.framebuffer),e.setRenderTarget(m));let J=!1;Q.length!==S.cameras.length&&(S.cameras.length=0,J=!0);for(let le=0;le<Q.length;le++){let j=Q[le],ve=null;if(d!==null)ve=d.getViewport(j);else{let me=h.getViewSubImage(u,j);ve=me.viewport,le===0&&(e.setRenderTargetTextures(m,me.colorTexture,u.ignoreDepthValues?void 0:me.depthStencilTexture),e.setRenderTarget(m))}let pe=T[le];pe===void 0&&(pe=new Yr,pe.layers.enable(le),pe.viewport=new Kt,T[le]=pe),pe.matrix.fromArray(j.transform.matrix),pe.projectionMatrix.fromArray(j.projectionMatrix),pe.viewport.set(ve.x,ve.y,ve.width,ve.height),le===0&&S.matrix.copy(pe.matrix),J===!0&&S.cameras.push(pe)}}for(let Q=0;Q<v.length;Q++){let J=x[Q],le=v[Q];J!==null&&le!==void 0&&le.update(J,H,l||s)}if(U&&U(q,H),H.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:H.detectedPlanes});let Q=null;for(let J of w)H.detectedPlanes.has(J)||(Q===null&&(Q=[]),Q.push(J));if(Q!==null)for(let J of Q)w.delete(J),b.delete(J),i.dispatchEvent({type:"planeremoved",data:J});for(let J of H.detectedPlanes)if(!w.has(J))w.add(J),b.set(J,H.lastChangedTime),i.dispatchEvent({type:"planeadded",data:J});else{let le=b.get(J);J.lastChangedTime>le&&(b.set(J,J.lastChangedTime),i.dispatchEvent({type:"planechanged",data:J}))}}f=null}let V=new yq;V.setAnimationLoop(X),this.setAnimationLoop=function(q){U=q},this.dispose=function(){}}};function t_e(e,t){function i(g,m){m.color.getRGB(g.fogColor.value,vq(e)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)}function n(g,m,v,x,w){m.isMeshBasicMaterial||m.isMeshLambertMaterial?r(g,m):m.isMeshToonMaterial?(r(g,m),h(g,m)):m.isMeshPhongMaterial?(r(g,m),c(g,m)):m.isMeshStandardMaterial?(r(g,m),u(g,m),m.isMeshPhysicalMaterial&&d(g,m,w)):m.isMeshMatcapMaterial?(r(g,m),f(g,m)):m.isMeshDepthMaterial?r(g,m):m.isMeshDistanceMaterial?(r(g,m),p(g,m)):m.isMeshNormalMaterial?r(g,m):m.isLineBasicMaterial?(s(g,m),m.isLineDashedMaterial&&o(g,m)):m.isPointsMaterial?a(g,m,v,x):m.isSpriteMaterial?l(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function r(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.bumpMap&&(g.bumpMap.value=m.bumpMap,g.bumpScale.value=m.bumpScale,m.side===gr&&(g.bumpScale.value*=-1)),m.displacementMap&&(g.displacementMap.value=m.displacementMap,g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap),m.normalMap&&(g.normalMap.value=m.normalMap,g.normalScale.value.copy(m.normalScale),m.side===gr&&g.normalScale.value.negate()),m.specularMap&&(g.specularMap.value=m.specularMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);let v=t.get(m).envMap;if(v&&(g.envMap.value=v,g.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;let b=e.physicallyCorrectLights!==!0?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*b}m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity);let x;m.map?x=m.map:m.specularMap?x=m.specularMap:m.displacementMap?x=m.displacementMap:m.normalMap?x=m.normalMap:m.bumpMap?x=m.bumpMap:m.roughnessMap?x=m.roughnessMap:m.metalnessMap?x=m.metalnessMap:m.alphaMap?x=m.alphaMap:m.emissiveMap?x=m.emissiveMap:m.clearcoatMap?x=m.clearcoatMap:m.clearcoatNormalMap?x=m.clearcoatNormalMap:m.clearcoatRoughnessMap?x=m.clearcoatRoughnessMap:m.iridescenceMap?x=m.iridescenceMap:m.iridescenceThicknessMap?x=m.iridescenceThicknessMap:m.specularIntensityMap?x=m.specularIntensityMap:m.specularColorMap?x=m.specularColorMap:m.transmissionMap?x=m.transmissionMap:m.thicknessMap?x=m.thicknessMap:m.sheenColorMap?x=m.sheenColorMap:m.sheenRoughnessMap&&(x=m.sheenRoughnessMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),g.uvTransform.value.copy(x.matrix));let w;m.aoMap?w=m.aoMap:m.lightMap&&(w=m.lightMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),g.uv2Transform.value.copy(w.matrix))}function s(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity}function o(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}function a(g,m,v,x){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*v,g.scale.value=x*.5,m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);let w;m.map?w=m.map:m.alphaMap&&(w=m.alphaMap),w!==void 0&&(w.matrixAutoUpdate===!0&&w.updateMatrix(),g.uvTransform.value.copy(w.matrix))}function l(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);let v;m.map?v=m.map:m.alphaMap&&(v=m.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),g.uvTransform.value.copy(v.matrix))}function c(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}function h(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}function u(g,m){g.roughness.value=m.roughness,g.metalness.value=m.metalness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap),t.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}function d(g,m,v){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),g.clearcoatNormalMap.value=m.clearcoatNormalMap,m.side===gr&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap)),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=v.texture,g.transmissionSamplerSize.value.set(v.width,v.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap)}function f(g,m){m.matcap&&(g.matcap.value=m.matcap)}function p(g,m){g.referencePosition.value.copy(m.referencePosition),g.nearDistance.value=m.nearDistance,g.farDistance.value=m.farDistance}return{refreshFogUniforms:i,refreshMaterialUniforms:n}}function i_e(e,t,i,n){let r={},s={},o=[],a=i.isWebGL2?e.getParameter(35375):0;function l(x,w){let b=w.program;n.uniformBlockBinding(x,b)}function c(x,w){let b=r[x.id];b===void 0&&(p(x),b=h(x),r[x.id]=b,x.addEventListener("dispose",m));let M=w.program;n.updateUBOMapping(x,M);let A=t.render.frame;s[x.id]!==A&&(d(x),s[x.id]=A)}function h(x){let w=u();x.__bindingPointIndex=w;let b=e.createBuffer(),M=x.__size,A=x.usage;return e.bindBuffer(35345,b),e.bufferData(35345,M,A),e.bindBuffer(35345,null),e.bindBufferBase(35345,w,b),b}function u(){for(let x=0;x<a;x++)if(o.indexOf(x)===-1)return o.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(x){let w=r[x.id],b=x.uniforms,M=x.__cache;e.bindBuffer(35345,w);for(let A=0,T=b.length;A<T;A++){let S=b[A];if(f(S,A,M)===!0){let C=S.__offset,P=Array.isArray(S.value)?S.value:[S.value],B=0;for(let k=0;k<P.length;k++){let z=P[k],F=g(z);typeof z=="number"?(S.__data[0]=z,e.bufferSubData(35345,C+B,S.__data)):z.isMatrix3?(S.__data[0]=z.elements[0],S.__data[1]=z.elements[1],S.__data[2]=z.elements[2],S.__data[3]=z.elements[0],S.__data[4]=z.elements[3],S.__data[5]=z.elements[4],S.__data[6]=z.elements[5],S.__data[7]=z.elements[0],S.__data[8]=z.elements[6],S.__data[9]=z.elements[7],S.__data[10]=z.elements[8],S.__data[11]=z.elements[0]):(z.toArray(S.__data,B),B+=F.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,C,S.__data)}}e.bindBuffer(35345,null)}function f(x,w,b){let M=x.value;if(b[w]===void 0){if(typeof M=="number")b[w]=M;else{let A=Array.isArray(M)?M:[M],T=[];for(let S=0;S<A.length;S++)T.push(A[S].clone());b[w]=T}return!0}else if(typeof M=="number"){if(b[w]!==M)return b[w]=M,!0}else{let A=Array.isArray(b[w])?b[w]:[b[w]],T=Array.isArray(M)?M:[M];for(let S=0;S<A.length;S++){let C=A[S];if(C.equals(T[S])===!1)return C.copy(T[S]),!0}}return!1}function p(x){let w=x.uniforms,b=0,M=16,A=0;for(let T=0,S=w.length;T<S;T++){let C=w[T],P={boundary:0,storage:0},B=Array.isArray(C.value)?C.value:[C.value];for(let k=0,z=B.length;k<z;k++){let F=B[k],W=g(F);P.boundary+=W.boundary,P.storage+=W.storage}if(C.__data=new Float32Array(P.storage/Float32Array.BYTES_PER_ELEMENT),C.__offset=b,T>0){A=b%M;let k=M-A;A!==0&&k-P.boundary<0&&(b+=M-A,C.__offset=b)}b+=P.storage}return A=b%M,A>0&&(b+=M-A),x.__size=b,x.__cache={},this}function g(x){let w={boundary:0,storage:0};return typeof x=="number"?(w.boundary=4,w.storage=4):x.isVector2?(w.boundary=8,w.storage=8):x.isVector3||x.isColor?(w.boundary=16,w.storage=12):x.isVector4?(w.boundary=16,w.storage=16):x.isMatrix3?(w.boundary=48,w.storage=48):x.isMatrix4?(w.boundary=64,w.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),w}function m(x){let w=x.target;w.removeEventListener("dispose",m);let b=o.indexOf(w.__bindingPointIndex);o.splice(b,1),e.deleteBuffer(r[w.id]),delete r[w.id],delete s[w.id]}function v(){for(let x in r)e.deleteBuffer(r[x]);o=[],r={},s={}}return{bind:l,update:c,dispose:v}}function n_e(){let e=hS("canvas");return e.style.display="block",e}function Sq(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:n_e(),i=e.context!==void 0?e.context:null,n=e.depth!==void 0?e.depth:!0,r=e.stencil!==void 0?e.stencil:!0,s=e.antialias!==void 0?e.antialias:!1,o=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,a=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",c=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,h;i!==null?h=i.getContextAttributes().alpha:h=e.alpha!==void 0?e.alpha:!1;let u=null,d=null,f=[],p=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ql,this.physicallyCorrectLights=!1,this.toneMapping=Zc,this.toneMappingExposure=1;let g=this,m=!1,v=0,x=0,w=null,b=-1,M=null,A=new Kt,T=new Kt,S=null,C=t.width,P=t.height,B=1,k=null,z=null,F=new Kt(0,0,C,P),W=new Kt(0,0,C,P),K=!1,Z=new nO,U=!1,X=!1,V=null,q=new Je,H=new ge,Q=new I,J={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function le(){return w===null?B:1}let j=i;function ve(O,ee){for(let he=0;he<O.length;he++){let $=O[he],fe=t.getContext($,ee);if(fe!==null)return fe}return null}try{let O={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${rv}`),t.addEventListener("webglcontextlost",Re,!1),t.addEventListener("webglcontextrestored",Ne,!1),t.addEventListener("webglcontextcreationerror",$e,!1),j===null){let ee=["webgl2","webgl","experimental-webgl"];if(g.isWebGL1Renderer===!0&&ee.shift(),j=ve(ee,O),j===null)throw ve(ee)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}j.getShaderPrecisionFormat===void 0&&(j.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(O){throw console.error("THREE.WebGLRenderer: "+O.message),O}let pe,me,de,Se,ce,se,be,Ee,Le,ze,Oe,Ge,tt,ot,N,R,ie,xe,Me,Te,qe,De,ue,He;function ne(){pe=new g1e(j),me=new u1e(j,pe,e),pe.init(me),De=new Kwe(j,pe,me),de=new Qwe(j,pe,me),Se=new x1e,ce=new Fwe,se=new Jwe(j,pe,de,ce,me,De,Se),be=new d1e(g),Ee=new m1e(g),Le=new T0e(j,me),ue=new l1e(j,pe,Le,me),ze=new v1e(j,Le,Se,ue),Oe=new A1e(j,ze,Le,Se),Me=new b1e(j,me,se),R=new h1e(ce),Ge=new Owe(g,be,Ee,pe,me,ue,R),tt=new t_e(g,ce),ot=new zwe,N=new jwe(pe,me),xe=new a1e(g,be,Ee,de,Oe,h,o),ie=new qwe(g,Oe,me),He=new i_e(j,Se,me,de),Te=new c1e(j,pe,Se,me),qe=new y1e(j,pe,Se,me),Se.programs=Ge.programs,g.capabilities=me,g.extensions=pe,g.properties=ce,g.renderLists=ot,g.shadowMap=ie,g.state=de,g.info=Se}ne();let we=new e_e(g,j);this.xr=we,this.getContext=function(){return j},this.getContextAttributes=function(){return j.getContextAttributes()},this.forceContextLoss=function(){let O=pe.get("WEBGL_lose_context");O&&O.loseContext()},this.forceContextRestore=function(){let O=pe.get("WEBGL_lose_context");O&&O.restoreContext()},this.getPixelRatio=function(){return B},this.setPixelRatio=function(O){O!==void 0&&(B=O,this.setSize(C,P,!1))},this.getSize=function(O){return O.set(C,P)},this.setSize=function(O,ee,he){if(we.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}C=O,P=ee,t.width=Math.floor(O*B),t.height=Math.floor(ee*B),he!==!1&&(t.style.width=O+"px",t.style.height=ee+"px"),this.setViewport(0,0,O,ee)},this.getDrawingBufferSize=function(O){return O.set(C*B,P*B).floor()},this.setDrawingBufferSize=function(O,ee,he){C=O,P=ee,B=he,t.width=Math.floor(O*he),t.height=Math.floor(ee*he),this.setViewport(0,0,O,ee)},this.getCurrentViewport=function(O){return O.copy(A)},this.getViewport=function(O){return O.copy(F)},this.setViewport=function(O,ee,he,$){O.isVector4?F.set(O.x,O.y,O.z,O.w):F.set(O,ee,he,$),de.viewport(A.copy(F).multiplyScalar(B).floor())},this.getScissor=function(O){return O.copy(W)},this.setScissor=function(O,ee,he,$){O.isVector4?W.set(O.x,O.y,O.z,O.w):W.set(O,ee,he,$),de.scissor(T.copy(W).multiplyScalar(B).floor())},this.getScissorTest=function(){return K},this.setScissorTest=function(O){de.setScissorTest(K=O)},this.setOpaqueSort=function(O){k=O},this.setTransparentSort=function(O){z=O},this.getClearColor=function(O){return O.copy(xe.getClearColor())},this.setClearColor=function(){xe.setClearColor.apply(xe,arguments)},this.getClearAlpha=function(){return xe.getClearAlpha()},this.setClearAlpha=function(){xe.setClearAlpha.apply(xe,arguments)},this.clear=function(O=!0,ee=!0,he=!0){let $=0;O&&($|=16384),ee&&($|=256),he&&($|=1024),j.clear($)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Re,!1),t.removeEventListener("webglcontextrestored",Ne,!1),t.removeEventListener("webglcontextcreationerror",$e,!1),ot.dispose(),N.dispose(),ce.dispose(),be.dispose(),Ee.dispose(),Oe.dispose(),ue.dispose(),He.dispose(),Ge.dispose(),we.dispose(),we.removeEventListener("sessionstart",Fe),we.removeEventListener("sessionend",Xe),V&&(V.dispose(),V=null),pt.stop()};function Re(O){O.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function Ne(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;let O=Se.autoReset,ee=ie.enabled,he=ie.autoUpdate,$=ie.needsUpdate,fe=ie.type;ne(),Se.autoReset=O,ie.enabled=ee,ie.autoUpdate=he,ie.needsUpdate=$,ie.type=fe}function $e(O){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",O.statusMessage)}function xt(O){let ee=O.target;ee.removeEventListener("dispose",xt),kt(ee)}function kt(O){Y(O),ce.remove(O)}function Y(O){let ee=ce.get(O).programs;ee!==void 0&&(ee.forEach(function(he){Ge.releaseProgram(he)}),O.isShaderMaterial&&Ge.releaseShaderCache(O))}this.renderBufferDirect=function(O,ee,he,$,fe,We){ee===null&&(ee=J);let Ke=fe.isMesh&&fe.matrixWorld.determinant()<0,nt=yv(O,ee,he,$,fe);de.setMaterial($,Ke);let st=he.index,_t=1;$.wireframe===!0&&(st=ze.getWireframeAttribute(he),_t=2);let mt=he.drawRange,ht=he.attributes.position,ni=mt.start*_t,Ai=(mt.start+mt.count)*_t;We!==null&&(ni=Math.max(ni,We.start*_t),Ai=Math.min(Ai,(We.start+We.count)*_t)),st!==null?(ni=Math.max(ni,0),Ai=Math.min(Ai,st.count)):ht!=null&&(ni=Math.max(ni,0),Ai=Math.min(Ai,ht.count));let wn=Ai-ni;if(wn<0||wn===1/0)return;ue.setup(fe,$,nt,he,st);let wr,Gt=Te;if(st!==null&&(wr=Le.get(st),Gt=qe,Gt.setIndex(wr)),fe.isMesh)$.wireframe===!0?(de.setLineWidth($.wireframeLinewidth*le()),Gt.setMode(1)):Gt.setMode(4);else if(fe.isLine){let at=$.linewidth;at===void 0&&(at=1),de.setLineWidth(at*le()),fe.isLineSegments?Gt.setMode(1):fe.isLineLoop?Gt.setMode(2):Gt.setMode(3)}else fe.isPoints?Gt.setMode(0):fe.isSprite&&Gt.setMode(4);if(fe.isInstancedMesh)Gt.renderInstances(ni,wn,fe.count);else if(he.isInstancedBufferGeometry){let at=he._maxInstanceCount!==void 0?he._maxInstanceCount:1/0,pa=Math.min(he.instanceCount,at);Gt.renderInstances(ni,wn,pa)}else Gt.render(ni,wn)},this.compile=function(O,ee){function he($,fe,We){$.transparent===!0&&$.side===uo&&$.forceSinglePass===!1?($.side=gr,$.needsUpdate=!0,Oi($,fe,We),$.side=Ka,$.needsUpdate=!0,Oi($,fe,We),$.side=uo):Oi($,fe,We)}d=N.get(O),d.init(),p.push(d),O.traverseVisible(function($){$.isLight&&$.layers.test(ee.layers)&&(d.pushLight($),$.castShadow&&d.pushShadow($))}),d.setupLights(g.physicallyCorrectLights),O.traverse(function($){let fe=$.material;if(fe)if(Array.isArray(fe))for(let We=0;We<fe.length;We++){let Ke=fe[We];he(Ke,O,$)}else he(fe,O,$)}),p.pop(),d=null};let oe=null;function ye(O){oe&&oe(O)}function Fe(){pt.stop()}function Xe(){pt.start()}let pt=new yq;pt.setAnimationLoop(ye),typeof self<"u"&&pt.setContext(self),this.setAnimationLoop=function(O){oe=O,we.setAnimationLoop(O),O===null?pt.stop():pt.start()},we.addEventListener("sessionstart",Fe),we.addEventListener("sessionend",Xe),this.render=function(O,ee){if(ee!==void 0&&ee.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(m===!0)return;O.matrixWorldAutoUpdate===!0&&O.updateMatrixWorld(),ee.parent===null&&ee.matrixWorldAutoUpdate===!0&&ee.updateMatrixWorld(),we.enabled===!0&&we.isPresenting===!0&&(we.cameraAutoUpdate===!0&&we.updateCamera(ee),ee=we.getCamera()),O.isScene===!0&&O.onBeforeRender(g,O,ee,w),d=N.get(O,p.length),d.init(),p.push(d),q.multiplyMatrices(ee.projectionMatrix,ee.matrixWorldInverse),Z.setFromProjectionMatrix(q),X=this.localClippingEnabled,U=R.init(this.clippingPlanes,X),u=ot.get(O,f.length),u.init(),f.push(u),ei(O,ee,0,g.sortObjects),u.finish(),g.sortObjects===!0&&u.sort(k,z),U===!0&&R.beginShadows();let he=d.state.shadowsArray;if(ie.render(he,O,ee),U===!0&&R.endShadows(),this.info.autoReset===!0&&this.info.reset(),xe.render(u,O),d.setupLights(g.physicallyCorrectLights),ee.isArrayCamera){let $=ee.cameras;for(let fe=0,We=$.length;fe<We;fe++){let Ke=$[fe];ui(u,O,Ke,Ke.viewport)}}else ui(u,O,ee);w!==null&&(se.updateMultisampleRenderTarget(w),se.updateRenderTargetMipmap(w)),O.isScene===!0&&O.onAfterRender(g,O,ee),ue.resetDefaultState(),b=-1,M=null,p.pop(),p.length>0?d=p[p.length-1]:d=null,f.pop(),f.length>0?u=f[f.length-1]:u=null};function ei(O,ee,he,$){if(O.visible===!1)return;if(O.layers.test(ee.layers)){if(O.isGroup)he=O.renderOrder;else if(O.isLOD)O.autoUpdate===!0&&O.update(ee);else if(O.isLight)d.pushLight(O),O.castShadow&&d.pushShadow(O);else if(O.isSprite){if(!O.frustumCulled||Z.intersectsSprite(O)){$&&Q.setFromMatrixPosition(O.matrixWorld).applyMatrix4(q);let We=Oe.update(O),Ke=O.material;Ke.visible&&u.push(O,We,Ke,he,Q.z,null)}}else if((O.isMesh||O.isLine||O.isPoints)&&(O.isSkinnedMesh&&O.skeleton.frame!==Se.render.frame&&(O.skeleton.update(),O.skeleton.frame=Se.render.frame),!O.frustumCulled||Z.intersectsObject(O))){$&&Q.setFromMatrixPosition(O.matrixWorld).applyMatrix4(q);let We=Oe.update(O),Ke=O.material;if(Array.isArray(Ke)){let nt=We.groups;for(let st=0,_t=nt.length;st<_t;st++){let mt=nt[st],ht=Ke[mt.materialIndex];ht&&ht.visible&&u.push(O,We,ht,he,Q.z,mt)}}else Ke.visible&&u.push(O,We,Ke,he,Q.z,null)}}let fe=O.children;for(let We=0,Ke=fe.length;We<Ke;We++)ei(fe[We],ee,he,$)}function ui(O,ee,he,$){let fe=O.opaque,We=O.transmissive,Ke=O.transparent;d.setupLightsView(he),U===!0&&R.setGlobalState(g.clippingPlanes,he),We.length>0&&ar(fe,ee,he),$&&de.viewport(A.copy($)),fe.length>0&&Dt(fe,ee,he),We.length>0&&Dt(We,ee,he),Ke.length>0&&Dt(Ke,ee,he),de.buffers.depth.setTest(!0),de.buffers.depth.setMask(!0),de.buffers.color.setMask(!0),de.setPolygonOffset(!1)}function ar(O,ee,he){let $=me.isWebGL2;V===null&&(V=new Pi(1,1,{generateMipmaps:!0,type:pe.has("EXT_color_buffer_half_float")?Og:Kr,minFilter:Ig,samples:$&&s===!0?4:0})),g.getDrawingBufferSize(H),$?V.setSize(H.x,H.y):V.setSize(uS(H.x),uS(H.y));let fe=g.getRenderTarget();g.setRenderTarget(V),g.clear();let We=g.toneMapping;g.toneMapping=Zc,Dt(O,ee,he),g.toneMapping=We,se.updateMultisampleRenderTarget(V),se.updateRenderTargetMipmap(V),g.setRenderTarget(fe)}function Dt(O,ee,he){let $=ee.isScene===!0?ee.overrideMaterial:null;for(let fe=0,We=O.length;fe<We;fe++){let Ke=O[fe],nt=Ke.object,st=Ke.geometry,_t=$===null?Ke.material:$,mt=Ke.group;nt.layers.test(he.layers)&&un(nt,ee,he,st,_t,mt)}}function un(O,ee,he,$,fe,We){O.onBeforeRender(g,ee,he,$,fe,We),O.modelViewMatrix.multiplyMatrices(he.matrixWorldInverse,O.matrixWorld),O.normalMatrix.getNormalMatrix(O.modelViewMatrix),fe.onBeforeRender(g,ee,he,$,O,We),fe.transparent===!0&&fe.side===uo&&fe.forceSinglePass===!1?(fe.side=gr,fe.needsUpdate=!0,g.renderBufferDirect(he,ee,$,fe,O,We),fe.side=Ka,fe.needsUpdate=!0,g.renderBufferDirect(he,ee,$,fe,O,We),fe.side=uo):g.renderBufferDirect(he,ee,$,fe,O,We),O.onAfterRender(g,ee,he,$,fe,We)}function Oi(O,ee,he){ee.isScene!==!0&&(ee=J);let $=ce.get(O),fe=d.state.lights,We=d.state.shadowsArray,Ke=fe.state.version,nt=Ge.getParameters(O,fe.state,We,ee,he),st=Ge.getProgramCacheKey(nt),_t=$.programs;$.environment=O.isMeshStandardMaterial?ee.environment:null,$.fog=ee.fog,$.envMap=(O.isMeshStandardMaterial?Ee:be).get(O.envMap||$.environment),_t===void 0&&(O.addEventListener("dispose",xt),_t=new Map,$.programs=_t);let mt=_t.get(st);if(mt!==void 0){if($.currentProgram===mt&&$.lightsStateVersion===Ke)return td(O,nt),mt}else nt.uniforms=Ge.getUniforms(O),O.onBuild(he,nt,g),O.onBeforeCompile(nt,g),mt=Ge.acquireProgram(nt,st),_t.set(st,mt),$.uniforms=nt.uniforms;let ht=$.uniforms;(!O.isShaderMaterial&&!O.isRawShaderMaterial||O.clipping===!0)&&(ht.clippingPlanes=R.uniform),td(O,nt),$.needsLights=id(O),$.lightsStateVersion=Ke,$.needsLights&&(ht.ambientLightColor.value=fe.state.ambient,ht.lightProbe.value=fe.state.probe,ht.directionalLights.value=fe.state.directional,ht.directionalLightShadows.value=fe.state.directionalShadow,ht.spotLights.value=fe.state.spot,ht.spotLightShadows.value=fe.state.spotShadow,ht.rectAreaLights.value=fe.state.rectArea,ht.ltc_1.value=fe.state.rectAreaLTC1,ht.ltc_2.value=fe.state.rectAreaLTC2,ht.pointLights.value=fe.state.point,ht.pointLightShadows.value=fe.state.pointShadow,ht.hemisphereLights.value=fe.state.hemi,ht.directionalShadowMap.value=fe.state.directionalShadowMap,ht.directionalShadowMatrix.value=fe.state.directionalShadowMatrix,ht.spotShadowMap.value=fe.state.spotShadowMap,ht.spotLightMatrix.value=fe.state.spotLightMatrix,ht.spotLightMap.value=fe.state.spotLightMap,ht.pointShadowMap.value=fe.state.pointShadowMap,ht.pointShadowMatrix.value=fe.state.pointShadowMatrix);let ni=mt.getUniforms(),Ai=pA.seqWithValue(ni.seq,ht);return $.currentProgram=mt,$.uniformsList=Ai,mt}function td(O,ee){let he=ce.get(O);he.outputEncoding=ee.outputEncoding,he.instancing=ee.instancing,he.skinning=ee.skinning,he.morphTargets=ee.morphTargets,he.morphNormals=ee.morphNormals,he.morphColors=ee.morphColors,he.morphTargetsCount=ee.morphTargetsCount,he.numClippingPlanes=ee.numClippingPlanes,he.numIntersection=ee.numClipIntersection,he.vertexAlphas=ee.vertexAlphas,he.vertexTangents=ee.vertexTangents,he.toneMapping=ee.toneMapping}function yv(O,ee,he,$,fe){ee.isScene!==!0&&(ee=J),se.resetTextureUnits();let We=ee.fog,Ke=$.isMeshStandardMaterial?ee.environment:null,nt=w===null?g.outputEncoding:w.isXRRenderTarget===!0?w.texture.encoding:Ql,st=($.isMeshStandardMaterial?Ee:be).get($.envMap||Ke),_t=$.vertexColors===!0&&!!he.attributes.color&&he.attributes.color.itemSize===4,mt=!!$.normalMap&&!!he.attributes.tangent,ht=!!he.morphAttributes.position,ni=!!he.morphAttributes.normal,Ai=!!he.morphAttributes.color,wn=$.toneMapped?g.toneMapping:Zc,wr=he.morphAttributes.position||he.morphAttributes.normal||he.morphAttributes.color,Gt=wr!==void 0?wr.length:0,at=ce.get($),pa=d.state.lights;if(U===!0&&(X===!0||O!==M)){let jt=O===M&&$.id===b;R.setState($,O,jt)}let ki=!1;$.version===at.__version?(at.needsLights&&at.lightsStateVersion!==pa.state.version||at.outputEncoding!==nt||fe.isInstancedMesh&&at.instancing===!1||!fe.isInstancedMesh&&at.instancing===!0||fe.isSkinnedMesh&&at.skinning===!1||!fe.isSkinnedMesh&&at.skinning===!0||at.envMap!==st||$.fog===!0&&at.fog!==We||at.numClippingPlanes!==void 0&&(at.numClippingPlanes!==R.numPlanes||at.numIntersection!==R.numIntersection)||at.vertexAlphas!==_t||at.vertexTangents!==mt||at.morphTargets!==ht||at.morphNormals!==ni||at.morphColors!==Ai||at.toneMapping!==wn||me.isWebGL2===!0&&at.morphTargetsCount!==Gt)&&(ki=!0):(ki=!0,at.__version=$.version);let _r=at.currentProgram;ki===!0&&(_r=Oi($,ee,fe));let rc=!1,lr=!1,Lr=!1,bt=_r.getUniforms(),Jt=at.uniforms;if(de.useProgram(_r.program)&&(rc=!0,lr=!0,Lr=!0),$.id!==b&&(b=$.id,lr=!0),rc||M!==O){if(bt.setValue(j,"projectionMatrix",O.projectionMatrix),me.logarithmicDepthBuffer&&bt.setValue(j,"logDepthBufFC",2/(Math.log(O.far+1)/Math.LN2)),M!==O&&(M=O,lr=!0,Lr=!0),$.isShaderMaterial||$.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshStandardMaterial||$.envMap){let jt=bt.map.cameraPosition;jt!==void 0&&jt.setValue(j,Q.setFromMatrixPosition(O.matrixWorld))}($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial)&&bt.setValue(j,"isOrthographic",O.isOrthographicCamera===!0),($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial||$.isShadowMaterial||fe.isSkinnedMesh)&&bt.setValue(j,"viewMatrix",O.matrixWorldInverse)}if(fe.isSkinnedMesh){bt.setOptional(j,fe,"bindMatrix"),bt.setOptional(j,fe,"bindMatrixInverse");let jt=fe.skeleton;jt&&(me.floatVertexTextures?(jt.boneTexture===null&&jt.computeBoneTexture(),bt.setValue(j,"boneTexture",jt.boneTexture,se),bt.setValue(j,"boneTextureSize",jt.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let Rr=he.morphAttributes;if((Rr.position!==void 0||Rr.normal!==void 0||Rr.color!==void 0&&me.isWebGL2===!0)&&Me.update(fe,he,$,_r),(lr||at.receiveShadow!==fe.receiveShadow)&&(at.receiveShadow=fe.receiveShadow,bt.setValue(j,"receiveShadow",fe.receiveShadow)),$.isMeshGouraudMaterial&&$.envMap!==null&&(Jt.envMap.value=st,Jt.flipEnvMap.value=st.isCubeTexture&&st.isRenderTargetTexture===!1?-1:1),lr&&(bt.setValue(j,"toneMappingExposure",g.toneMappingExposure),at.needsLights&&np(Jt,Lr),We&&$.fog===!0&&tt.refreshFogUniforms(Jt,We),tt.refreshMaterialUniforms(Jt,$,B,P,V),pA.upload(j,at.uniformsList,Jt,se)),$.isShaderMaterial&&$.uniformsNeedUpdate===!0&&(pA.upload(j,at.uniformsList,Jt,se),$.uniformsNeedUpdate=!1),$.isSpriteMaterial&&bt.setValue(j,"center",fe.center),bt.setValue(j,"modelViewMatrix",fe.modelViewMatrix),bt.setValue(j,"normalMatrix",fe.normalMatrix),bt.setValue(j,"modelMatrix",fe.matrixWorld),fe.previousModelViewMatrix&&bt.setValue(j,"previousModelViewMatrix",fe.previousModelViewMatrix),O.previousProjectionMatrix&&bt.setValue(j,"previousProjectionMatrix",O.previousProjectionMatrix),$.isShaderMaterial||$.isRawShaderMaterial){let jt=$.uniformsGroups;for(let hn=0,ma=jt.length;hn<ma;hn++)if(me.isWebGL2){let So=jt[hn];He.update(So,_r),He.bind(So,_r)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return _r}function np(O,ee){O.ambientLightColor.needsUpdate=ee,O.lightProbe.needsUpdate=ee,O.directionalLights.needsUpdate=ee,O.directionalLightShadows.needsUpdate=ee,O.pointLights.needsUpdate=ee,O.pointLightShadows.needsUpdate=ee,O.spotLights.needsUpdate=ee,O.spotLightShadows.needsUpdate=ee,O.rectAreaLights.needsUpdate=ee,O.hemisphereLights.needsUpdate=ee}function id(O){return O.isMeshLambertMaterial||O.isMeshToonMaterial||O.isMeshPhongMaterial||O.isMeshStandardMaterial||O.isShadowMaterial||O.isShaderMaterial&&O.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(O,ee,he){ce.get(O.texture).__webglTexture=ee,ce.get(O.depthTexture).__webglTexture=he;let $=ce.get(O);$.__hasExternalTextures=!0,$.__hasExternalTextures&&($.__autoAllocateDepthBuffer=he===void 0,$.__autoAllocateDepthBuffer||pe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),$.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(O,ee){let he=ce.get(O);he.__webglFramebuffer=ee,he.__useDefaultFramebuffer=ee===void 0},this.setRenderTarget=function(O,ee=0,he=0){w=O,v=ee,x=he;let $=!0,fe=null,We=!1,Ke=!1;if(O){let nt=ce.get(O);nt.__useDefaultFramebuffer!==void 0?(de.bindFramebuffer(36160,null),$=!1):nt.__webglFramebuffer===void 0?se.setupRenderTarget(O):nt.__hasExternalTextures&&se.rebindTextures(O,ce.get(O.texture).__webglTexture,ce.get(O.depthTexture).__webglTexture);let st=O.texture;(st.isData3DTexture||st.isDataArrayTexture||st.isCompressedArrayTexture)&&(Ke=!0);let _t=ce.get(O).__webglFramebuffer;O.isWebGLCubeRenderTarget?(fe=_t[ee],We=!0):me.isWebGL2&&O.samples>0&&se.useMultisampledRTT(O)===!1?fe=ce.get(O).__webglMultisampledFramebuffer:fe=_t,A.copy(O.viewport),T.copy(O.scissor),S=O.scissorTest}else A.copy(F).multiplyScalar(B).floor(),T.copy(W).multiplyScalar(B).floor(),S=K;if(de.bindFramebuffer(36160,fe)&&me.drawBuffers&&$&&de.drawBuffers(O,fe),de.viewport(A),de.scissor(T),de.setScissorTest(S),We){let nt=ce.get(O.texture);j.framebufferTexture2D(36160,36064,34069+ee,nt.__webglTexture,he)}else if(Ke){let nt=ce.get(O.texture),st=ee||0;j.framebufferTextureLayer(36160,36064,nt.__webglTexture,he||0,st)}b=-1},this.readRenderTargetPixels=function(O,ee,he,$,fe,We,Ke){if(!(O&&O.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let nt=ce.get(O).__webglFramebuffer;if(O.isWebGLCubeRenderTarget&&Ke!==void 0&&(nt=nt[Ke]),nt){de.bindFramebuffer(36160,nt);try{let st=O.texture,_t=st.format,mt=st.type;if(_t!==Na&&De.convert(_t)!==j.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let ht=mt===Og&&(pe.has("EXT_color_buffer_half_float")||me.isWebGL2&&pe.has("EXT_color_buffer_float"));if(mt!==Kr&&De.convert(mt)!==j.getParameter(35738)&&!(mt===$o&&(me.isWebGL2||pe.has("OES_texture_float")||pe.has("WEBGL_color_buffer_float")))&&!ht){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ee>=0&&ee<=O.width-$&&he>=0&&he<=O.height-fe&&j.readPixels(ee,he,$,fe,De.convert(_t),De.convert(mt),We)}finally{let st=w!==null?ce.get(w).__webglFramebuffer:null;de.bindFramebuffer(36160,st)}}},this.copyFramebufferToTexture=function(O,ee,he=0){let $=Math.pow(2,-he),fe=Math.floor(ee.image.width*$),We=Math.floor(ee.image.height*$);se.setTexture2D(ee,0),j.copyTexSubImage2D(3553,he,0,0,O.x,O.y,fe,We),de.unbindTexture()},this.copyTextureToTexture=function(O,ee,he,$=0){let fe=ee.image.width,We=ee.image.height,Ke=De.convert(he.format),nt=De.convert(he.type);se.setTexture2D(he,0),j.pixelStorei(37440,he.flipY),j.pixelStorei(37441,he.premultiplyAlpha),j.pixelStorei(3317,he.unpackAlignment),ee.isDataTexture?j.texSubImage2D(3553,$,O.x,O.y,fe,We,Ke,nt,ee.image.data):ee.isCompressedTexture?j.compressedTexSubImage2D(3553,$,O.x,O.y,ee.mipmaps[0].width,ee.mipmaps[0].height,Ke,ee.mipmaps[0].data):j.texSubImage2D(3553,$,O.x,O.y,Ke,nt,ee.image),$===0&&he.generateMipmaps&&j.generateMipmap(3553),de.unbindTexture()},this.copyTextureToTexture3D=function(O,ee,he,$,fe=0){if(g.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let We=O.max.x-O.min.x+1,Ke=O.max.y-O.min.y+1,nt=O.max.z-O.min.z+1,st=De.convert($.format),_t=De.convert($.type),mt;if($.isData3DTexture)se.setTexture3D($,0),mt=32879;else if($.isDataArrayTexture)se.setTexture2DArray($,0),mt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}j.pixelStorei(37440,$.flipY),j.pixelStorei(37441,$.premultiplyAlpha),j.pixelStorei(3317,$.unpackAlignment);let ht=j.getParameter(3314),ni=j.getParameter(32878),Ai=j.getParameter(3316),wn=j.getParameter(3315),wr=j.getParameter(32877),Gt=he.isCompressedTexture?he.mipmaps[0]:he.image;j.pixelStorei(3314,Gt.width),j.pixelStorei(32878,Gt.height),j.pixelStorei(3316,O.min.x),j.pixelStorei(3315,O.min.y),j.pixelStorei(32877,O.min.z),he.isDataTexture||he.isData3DTexture?j.texSubImage3D(mt,fe,ee.x,ee.y,ee.z,We,Ke,nt,st,_t,Gt.data):he.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),j.compressedTexSubImage3D(mt,fe,ee.x,ee.y,ee.z,We,Ke,nt,st,Gt.data)):j.texSubImage3D(mt,fe,ee.x,ee.y,ee.z,We,Ke,nt,st,_t,Gt),j.pixelStorei(3314,ht),j.pixelStorei(32878,ni),j.pixelStorei(3316,Ai),j.pixelStorei(3315,wn),j.pixelStorei(32877,wr),fe===0&&$.generateMipmaps&&j.generateMipmap(mt),de.unbindTexture()},this.initTexture=function(O){O.isCubeTexture?se.setTextureCube(O,0):O.isData3DTexture?se.setTexture3D(O,0):O.isDataArrayTexture||O.isCompressedArrayTexture?se.setTexture2DArray(O,0):se.setTexture2D(O,0),de.unbindTexture()},this.resetState=function(){v=0,x=0,w=null,de.reset(),ue.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var r_e=class extends Sq{};r_e.prototype.isWebGL1Renderer=!0;var Mq=class{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Pt(e),this.near=t,this.far=i}clone(){return new Mq(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},bf=class extends Ii{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,i){return super.copy(t,i),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){let i=super.toJSON(t);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(t){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=t}},s_e=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=tB,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Vl()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let n=0,r=this.stride;n<r;n++)this.array[e+n]=t.array[i+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Vl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Vl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},ns=new I,sB=class{constructor(e,t,i,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ns.fromBufferAttribute(this,t),ns.applyMatrix4(e),this.setXYZ(t,ns.x,ns.y,ns.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ns.fromBufferAttribute(this,t),ns.applyNormalMatrix(e),this.setXYZ(t,ns.x,ns.y,ns.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ns.fromBufferAttribute(this,t),ns.transformDirection(e),this.setXYZ(t,ns.x,ns.y,ns.z);return this}setX(e,t){return this.normalized&&(t=zi(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=zi(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=zi(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=zi(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Xc(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Xc(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Xc(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Xc(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=zi(t,this.array),i=zi(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=zi(t,this.array),i=zi(i,this.array),n=zi(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this}setXYZW(e,t,i,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=zi(t,this.array),i=zi(i,this.array),n=zi(n,this.array),r=zi(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=r,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[n+r])}return new zt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new sB(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[n+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},oB=class extends tr{constructor(e=null,t=1,i=1,n,r,s,o,a,l=Ri,c=Ri,h,u){super(null,s,o,a,l,c,n,r,h,u),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},o_e=class extends zt{constructor(e,t,i,n=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},Zh=class extends _1{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Pt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},LG=new I,RG=new I,IG=new Je,L2=new sv,eb=new ua,fS=class extends Ii{constructor(e=new Ot,t=new Zh){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[0];for(let n=1,r=t.count;n<r;n++)LG.fromBufferAttribute(t,n-1),RG.fromBufferAttribute(t,n),i[n]=i[n-1],i[n]+=LG.distanceTo(RG);e.setAttribute("lineDistance",new gt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let i=this.geometry,n=this.matrixWorld,r=e.params.Line.threshold,s=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),eb.copy(i.boundingSphere),eb.applyMatrix4(n),eb.radius+=r,e.ray.intersectsSphere(eb)===!1)return;IG.copy(n).invert(),L2.copy(e.ray).applyMatrix4(IG);let o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new I,c=new I,h=new I,u=new I,d=this.isLineSegments?2:1,f=i.index,p=i.attributes.position;if(f!==null){let g=Math.max(0,s.start),m=Math.min(f.count,s.start+s.count);for(let v=g,x=m-1;v<x;v+=d){let w=f.getX(v),b=f.getX(v+1);if(l.fromBufferAttribute(p,w),c.fromBufferAttribute(p,b),L2.distanceSqToSegment(l,c,u,h)>a)continue;u.applyMatrix4(this.matrixWorld);let M=e.ray.origin.distanceTo(u);M<e.near||M>e.far||t.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else{let g=Math.max(0,s.start),m=Math.min(p.count,s.start+s.count);for(let v=g,x=m-1;v<x;v+=d){if(l.fromBufferAttribute(p,v),c.fromBufferAttribute(p,v+1),L2.distanceSqToSegment(l,c,u,h)>a)continue;u.applyMatrix4(this.matrixWorld);let w=e.ray.origin.distanceTo(u);w<e.near||w>e.far||t.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,r=i.length;n<r;n++){let s=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=n}}}}},OG=new I,FG=new I,b1=class extends fS{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[];for(let n=0,r=t.count;n<r;n+=2)OG.fromBufferAttribute(t,n),FG.fromBufferAttribute(t,n+1),i[n]=n===0?0:i[n-1],i[n+1]=i[n]+OG.distanceTo(FG);e.setAttribute("lineDistance",new gt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},a_e=class extends tr{constructor(e,t,i,n,r,s,o,a,l){super(e,t,i,n,r,s,o,a,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:Zt,this.magFilter=r!==void 0?r:Zt,this.generateMipmaps=!1;let c=this;function h(){c.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},ic=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],i,n=this.getPoint(0),r=0;t.push(0);for(let s=1;s<=e;s++)i=this.getPoint(s/e),r+=i.distanceTo(n),t.push(r),n=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let i=this.getLengths(),n=0,r=i.length,s;t?s=t:s=e*i[r-1];let o=0,a=r-1,l;for(;o<=a;)if(n=Math.floor(o+(a-o)/2),l=i[n]-s,l<0)o=n+1;else if(l>0)a=n-1;else{a=n;break}if(n=a,i[n]===s)return n/(r-1);let c=i[n],h=i[n+1]-c,u=(s-c)/h;return(n+u)/(r-1)}getTangent(e,t){let i=e-1e-4,n=e+1e-4;i<0&&(i=0),n>1&&(n=1);let r=this.getPoint(i),s=this.getPoint(n),o=t||(r.isVector2?new ge:new I);return o.copy(s).sub(r).normalize(),o}getTangentAt(e,t){let i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){let i=new I,n=[],r=[],s=[],o=new I,a=new Je;for(let d=0;d<=e;d++){let f=d/e;n[d]=this.getTangentAt(f,new I)}r[0]=new I,s[0]=new I;let l=Number.MAX_VALUE,c=Math.abs(n[0].x),h=Math.abs(n[0].y),u=Math.abs(n[0].z);c<=l&&(l=c,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),u<=l&&i.set(0,0,1),o.crossVectors(n[0],i).normalize(),r[0].crossVectors(n[0],o),s[0].crossVectors(n[0],r[0]);for(let d=1;d<=e;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(n[d-1],n[d]),o.length()>Number.EPSILON){o.normalize();let f=Math.acos(Kn(n[d-1].dot(n[d]),-1,1));r[d].applyMatrix4(a.makeRotationAxis(o,f))}s[d].crossVectors(n[d],r[d])}if(t===!0){let d=Math.acos(Kn(r[0].dot(r[e]),-1,1));d/=e,n[0].dot(o.crossVectors(r[0],r[e]))>0&&(d=-d);for(let f=1;f<=e;f++)r[f].applyMatrix4(a.makeRotationAxis(n[f],d*f)),s[f].crossVectors(n[f],r[f])}return{tangents:n,normals:r,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},qM=class extends ic{constructor(e=0,t=0,i=1,n=1,r=0,s=Math.PI*2,o=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(e,t){let i=t||new ge,n=Math.PI*2,r=this.aEndAngle-this.aStartAngle,s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(s?r=0:r=n),this.aClockwise===!0&&!s&&(r===n?r=-n:r=r-n);let o=this.aStartAngle+e*r,a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){let c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),u=a-this.aX,d=l-this.aY;a=u*c-d*h+this.aX,l=u*h+d*c+this.aY}return i.set(a,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},l_e=class extends qM{constructor(e,t,i,n,r,s){super(e,t,i,i,n,r,s),this.isArcCurve=!0,this.type="ArcCurve"}};function sO(){let e=0,t=0,i=0,n=0;function r(s,o,a,l){e=s,t=a,i=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,u){let d=(o-s)/c-(a-s)/(c+h)+(a-o)/h,f=(a-o)/h-(l-o)/(h+u)+(l-a)/u;d*=h,f*=h,r(o,a,d,f)},calc:function(s){let o=s*s,a=o*s;return e+t*s+i*o+n*a}}}var tb=new I,R2=new sO,I2=new sO,O2=new sO,c_e=class extends ic{constructor(e=[],t=!1,i="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=n}getPoint(e,t=new I){let i=t,n=this.points,r=n.length,s=(r-(this.closed?0:1))*e,o=Math.floor(s),a=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/r)+1)*r:a===0&&o===r-1&&(o=r-2,a=1);let l,c;this.closed||o>0?l=n[(o-1)%r]:(tb.subVectors(n[0],n[1]).add(n[0]),l=tb);let h=n[o%r],u=n[(o+1)%r];if(this.closed||o+2<r?c=n[(o+2)%r]:(tb.subVectors(n[r-1],n[r-2]).add(n[r-1]),c=tb),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,f=Math.pow(l.distanceToSquared(h),d),p=Math.pow(h.distanceToSquared(u),d),g=Math.pow(u.distanceToSquared(c),d);p<1e-4&&(p=1),f<1e-4&&(f=p),g<1e-4&&(g=p),R2.initNonuniformCatmullRom(l.x,h.x,u.x,c.x,f,p,g),I2.initNonuniformCatmullRom(l.y,h.y,u.y,c.y,f,p,g),O2.initNonuniformCatmullRom(l.z,h.z,u.z,c.z,f,p,g)}else this.curveType==="catmullrom"&&(R2.initCatmullRom(l.x,h.x,u.x,c.x,this.tension),I2.initCatmullRom(l.y,h.y,u.y,c.y,this.tension),O2.initCatmullRom(l.z,h.z,u.z,c.z,this.tension));return i.set(R2.calc(a),I2.calc(a),O2.calc(a)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let n=e.points[t];this.points.push(new I().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function NG(e,t,i,n,r){let s=(n-t)*.5,o=(r-i)*.5,a=e*e,l=e*a;return(2*i-2*n+s+o)*l+(-3*i+3*n-2*s-o)*a+s*e+i}function u_e(e,t){let i=1-e;return i*i*t}function h_e(e,t){return 2*(1-e)*e*t}function d_e(e,t){return e*e*t}function My(e,t,i,n){return u_e(e,t)+h_e(e,i)+d_e(e,n)}function f_e(e,t){let i=1-e;return i*i*i*t}function p_e(e,t){let i=1-e;return 3*i*i*e*t}function m_e(e,t){return 3*(1-e)*e*e*t}function g_e(e,t){return e*e*e*t}function Ey(e,t,i,n,r){return f_e(e,t)+p_e(e,i)+m_e(e,n)+g_e(e,r)}var ka=class extends ic{constructor(t=new ge,i=new ge,n=new ge,r=new ge){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=i,this.v2=n,this.v3=r}getPoint(t,i=new ge){let n=i,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Ey(t,r.x,s.x,o.x,a.x),Ey(t,r.y,s.y,o.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},mA=class extends ic{constructor(e=new I,t=new I,i=new I,n=new I){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=n}getPoint(e,t=new I){let i=t,n=this.v0,r=this.v1,s=this.v2,o=this.v3;return i.set(Ey(e,n.x,r.x,s.x,o.x),Ey(e,n.y,r.y,s.y,o.y),Ey(e,n.z,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},qa=class extends ic{constructor(t=new ge,i=new ge){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=i}getPoint(t,i=new ge){let n=i;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,i){return this.getPoint(t,i)}getTangent(t,i){let n=i||new ge;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},Eq=class extends ic{constructor(e=new I,t=new I){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new I){let i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},kh=class extends ic{constructor(e=new ge,t=new ge,i=new ge){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new ge){let i=t,n=this.v0,r=this.v1,s=this.v2;return i.set(My(e,n.x,r.x,s.x),My(e,n.y,r.y,s.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},v_e=class extends ic{constructor(e=new I,t=new I,i=new I){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new I){let i=t,n=this.v0,r=this.v1,s=this.v2;return i.set(My(e,n.x,r.x,s.x),My(e,n.y,r.y,s.y),My(e,n.z,r.z,s.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},oO=class extends ic{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ge){let i=t,n=this.points,r=(n.length-1)*e,s=Math.floor(r),o=r-s,a=n[s===0?s:s-1],l=n[s],c=n[s>n.length-2?n.length-1:s+1],h=n[s>n.length-3?n.length-1:s+2];return i.set(NG(o,a.x,l.x,c.x,h.x),NG(o,a.y,l.y,c.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let n=e.points[t];this.points.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let n=e.points[t];this.points.push(new ge().fromArray(n))}return this}},y_e=Object.freeze({__proto__:null,ArcCurve:l_e,CatmullRomCurve3:c_e,CubicBezierCurve:ka,CubicBezierCurve3:mA,EllipseCurve:qM,LineCurve:qa,LineCurve3:Eq,QuadraticBezierCurve:kh,QuadraticBezierCurve3:v_e,SplineCurve:oO}),Cq=class extends ic{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new qa(t,e))}getPoint(e,t){let i=e*this.getLength(),n=this.getCurveLengths(),r=0;for(;r<n.length;){if(n[r]>=i){let s=n[r]-i,o=this.curves[r],a=o.getLength(),l=a===0?0:1-s/a;return o.getPointAt(l,t)}r++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let i=0,n=this.curves.length;i<n;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],i;for(let n=0,r=this.curves;n<r.length;n++){let s=r[n],o=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,a=s.getPoints(o);for(let l=0;l<a.length;l++){let c=a[l];i&&i.equals(c)||(t.push(c),i=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){let n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let n=e.curves[t];this.curves.push(new y_e[n.type]().fromJSON(n))}return this}},pS=class extends Cq{constructor(e){super(),this.type="Path",this.currentPoint=new ge,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let i=new qa(this.currentPoint.clone(),new ge(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,n){let r=new kh(this.currentPoint.clone(),new ge(e,t),new ge(i,n));return this.curves.push(r),this.currentPoint.set(i,n),this}bezierCurveTo(e,t,i,n,r,s){let o=new ka(this.currentPoint.clone(),new ge(e,t),new ge(i,n),new ge(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),i=new oO(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,n,r,s){let o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+o,t+a,i,n,r,s),this}absarc(e,t,i,n,r,s){return this.absellipse(e,t,i,i,n,r,s),this}ellipse(e,t,i,n,r,s,o,a){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,i,n,r,s,o,a),this}absellipse(e,t,i,n,r,s,o,a){let l=new qM(e,t,i,n,r,s,o,a);if(this.curves.length>0){let h=l.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},Tq=class extends Ot{constructor(e=[new ge(0,-.5),new ge(.5,0),new ge(0,.5)],t=12,i=0,n=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},t=Math.floor(t),n=Kn(n,0,Math.PI*2);let r=[],s=[],o=[],a=[],l=[],c=1/t,h=new I,u=new ge,d=new I,f=new I,p=new I,g=0,m=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:g=e[v+1].x-e[v].x,m=e[v+1].y-e[v].y,d.x=m*1,d.y=-g,d.z=m*0,p.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case e.length-1:a.push(p.x,p.y,p.z);break;default:g=e[v+1].x-e[v].x,m=e[v+1].y-e[v].y,d.x=m*1,d.y=-g,d.z=m*0,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),a.push(d.x,d.y,d.z),p.copy(f)}for(let v=0;v<=t;v++){let x=i+v*c*n,w=Math.sin(x),b=Math.cos(x);for(let M=0;M<=e.length-1;M++){h.x=e[M].x*w,h.y=e[M].y,h.z=e[M].x*b,s.push(h.x,h.y,h.z),u.x=v/t,u.y=M/(e.length-1),o.push(u.x,u.y);let A=a[3*M+0]*w,T=a[3*M+1],S=a[3*M+0]*b;l.push(A,T,S)}}for(let v=0;v<t;v++)for(let x=0;x<e.length-1;x++){let w=x+v*e.length,b=w,M=w+e.length,A=w+e.length+1,T=w+1;r.push(b,M,T),r.push(A,T,M)}this.setIndex(r),this.setAttribute("position",new gt(s,3)),this.setAttribute("uv",new gt(o,2)),this.setAttribute("normal",new gt(l,3))}static fromJSON(e){return new Tq(e.points,e.segments,e.phiStart,e.phiLength)}},aO=class extends Ot{constructor(e=1,t=1,i=1,n=32,r=1,s=!1,o=0,a=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a};let l=this;n=Math.floor(n),r=Math.floor(r);let c=[],h=[],u=[],d=[],f=0,p=[],g=i/2,m=0;v(),s===!1&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex(c),this.setAttribute("position",new gt(h,3)),this.setAttribute("normal",new gt(u,3)),this.setAttribute("uv",new gt(d,2));function v(){let w=new I,b=new I,M=0,A=(t-e)/i;for(let T=0;T<=r;T++){let S=[],C=T/r,P=C*(t-e)+e;for(let B=0;B<=n;B++){let k=B/n,z=k*a+o,F=Math.sin(z),W=Math.cos(z);b.x=P*F,b.y=-C*i+g,b.z=P*W,h.push(b.x,b.y,b.z),w.set(F,A,W).normalize(),u.push(w.x,w.y,w.z),d.push(k,1-C),S.push(f++)}p.push(S)}for(let T=0;T<n;T++)for(let S=0;S<r;S++){let C=p[S][T],P=p[S+1][T],B=p[S+1][T+1],k=p[S][T+1];c.push(C,P,k),c.push(P,B,k),M+=6}l.addGroup(m,M,0),m+=M}function x(w){let b=f,M=new ge,A=new I,T=0,S=w===!0?e:t,C=w===!0?1:-1;for(let B=1;B<=n;B++)h.push(0,g*C,0),u.push(0,C,0),d.push(.5,.5),f++;let P=f;for(let B=0;B<=n;B++){let k=B/n*a+o,z=Math.cos(k),F=Math.sin(k);A.x=S*F,A.y=g*C,A.z=S*z,h.push(A.x,A.y,A.z),u.push(0,C,0),M.x=z*.5+.5,M.y=F*.5*C+.5,d.push(M.x,M.y),f++}for(let B=0;B<n;B++){let k=b+B,z=P+B;w===!0?c.push(z,z+1,k):c.push(z+1,z,k),T+=3}l.addGroup(m,T,w===!0?1:2),m+=T}}static fromJSON(e){return new aO(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},Pq=class extends aO{constructor(e=1,t=1,i=32,n=1,r=!1,s=0,o=Math.PI*2){super(0,e,t,i,n,r,s,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:s,thetaLength:o}}static fromJSON(e){return new Pq(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},lO=class extends Ot{constructor(e=[],t=[],i=1,n=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n};let r=[],s=[];o(n),l(i),c(),this.setAttribute("position",new gt(r,3)),this.setAttribute("normal",new gt(r.slice(),3)),this.setAttribute("uv",new gt(s,2)),n===0?this.computeVertexNormals():this.normalizeNormals();function o(v){let x=new I,w=new I,b=new I;for(let M=0;M<t.length;M+=3)d(t[M+0],x),d(t[M+1],w),d(t[M+2],b),a(x,w,b,v)}function a(v,x,w,b){let M=b+1,A=[];for(let T=0;T<=M;T++){A[T]=[];let S=v.clone().lerp(w,T/M),C=x.clone().lerp(w,T/M),P=M-T;for(let B=0;B<=P;B++)B===0&&T===M?A[T][B]=S:A[T][B]=S.clone().lerp(C,B/P)}for(let T=0;T<M;T++)for(let S=0;S<2*(M-T)-1;S++){let C=Math.floor(S/2);S%2===0?(u(A[T][C+1]),u(A[T+1][C]),u(A[T][C])):(u(A[T][C+1]),u(A[T+1][C+1]),u(A[T+1][C]))}}function l(v){let x=new I;for(let w=0;w<r.length;w+=3)x.x=r[w+0],x.y=r[w+1],x.z=r[w+2],x.normalize().multiplyScalar(v),r[w+0]=x.x,r[w+1]=x.y,r[w+2]=x.z}function c(){let v=new I;for(let x=0;x<r.length;x+=3){v.x=r[x+0],v.y=r[x+1],v.z=r[x+2];let w=g(v)/2/Math.PI+.5,b=m(v)/Math.PI+.5;s.push(w,1-b)}f(),h()}function h(){for(let v=0;v<s.length;v+=6){let x=s[v+0],w=s[v+2],b=s[v+4],M=Math.max(x,w,b),A=Math.min(x,w,b);M>.9&&A<.1&&(x<.2&&(s[v+0]+=1),w<.2&&(s[v+2]+=1),b<.2&&(s[v+4]+=1))}}function u(v){r.push(v.x,v.y,v.z)}function d(v,x){let w=v*3;x.x=e[w+0],x.y=e[w+1],x.z=e[w+2]}function f(){let v=new I,x=new I,w=new I,b=new I,M=new ge,A=new ge,T=new ge;for(let S=0,C=0;S<r.length;S+=9,C+=6){v.set(r[S+0],r[S+1],r[S+2]),x.set(r[S+3],r[S+4],r[S+5]),w.set(r[S+6],r[S+7],r[S+8]),M.set(s[C+0],s[C+1]),A.set(s[C+2],s[C+3]),T.set(s[C+4],s[C+5]),b.copy(v).add(x).add(w).divideScalar(3);let P=g(b);p(M,C+0,v,P),p(A,C+2,x,P),p(T,C+4,w,P)}}function p(v,x,w,b){b<0&&v.x===1&&(s[x]=v.x-1),w.x===0&&w.z===0&&(s[x]=b/2/Math.PI+.5)}function g(v){return Math.atan2(v.z,-v.x)}function m(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}static fromJSON(e){return new lO(e.vertices,e.indices,e.radius,e.details)}},Dq=class extends lO{constructor(e=1,t=0){let i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Dq(e.radius,e.detail)}},mS=class extends pS{constructor(e){super(e),this.uuid=Vl(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let i=0,n=this.holes.length;i<n;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){let n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let n=e.holes[t];this.holes.push(new pS().fromJSON(n))}return this}},x_e={triangulate:function(e,t,i=2){let n=t&&t.length,r=n?t[0]*i:e.length,s=Bq(e,0,r,i,!0),o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,u,d,f;if(n&&(s=S_e(e,t,s,i)),e.length>80*i){a=c=e[0],l=h=e[1];for(let p=i;p<r;p+=i)u=e[p],d=e[p+1],u<a&&(a=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);f=Math.max(c-a,h-l),f=f!==0?32767/f:0}return xx(s,o,i,a,l,f,0),o}};function Bq(e,t,i,n,r){let s,o;if(r===O_e(e,t,i,n)>0)for(s=t;s<i;s+=n)o=zG(s,e[s],e[s+1],o);else for(s=i-n;s>=t;s-=n)o=zG(s,e[s],e[s+1],o);return o&&QM(o,o.next)&&(_x(o),o=o.next),o}function kf(e,t){if(!e)return e;t||(t=e);let i=e,n;do if(n=!1,!i.steiner&&(QM(i,i.next)||an(i.prev,i,i.next)===0)){if(_x(i),i=t=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==t);return t}function xx(e,t,i,n,r,s,o){if(!e)return;!o&&s&&P_e(e,n,r,s);let a=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,s?__e(e,n,r,s):w_e(e)){t.push(l.i/i|0),t.push(e.i/i|0),t.push(c.i/i|0),_x(e),e=c.next,a=c.next;continue}if(e=c,e===a){o?o===1?(e=b_e(kf(e),t,i),xx(e,t,i,n,r,s,2)):o===2&&A_e(e,t,i,n,r,s):xx(kf(e),t,i,n,r,s,1);break}}}function w_e(e){let t=e.prev,i=e,n=e.next;if(an(t,i,n)>=0)return!1;let r=t.x,s=i.x,o=n.x,a=t.y,l=i.y,c=n.y,h=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c,p=n.next;for(;p!==t;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&zm(r,a,s,l,o,c,p.x,p.y)&&an(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function __e(e,t,i,n){let r=e.prev,s=e,o=e.next;if(an(r,s,o)>=0)return!1;let a=r.x,l=s.x,c=o.x,h=r.y,u=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<u?h<d?h:d:u<d?u:d,g=a>l?a>c?a:c:l>c?l:c,m=h>u?h>d?h:d:u>d?u:d,v=aB(f,p,t,i,n),x=aB(g,m,t,i,n),w=e.prevZ,b=e.nextZ;for(;w&&w.z>=v&&b&&b.z<=x;){if(w.x>=f&&w.x<=g&&w.y>=p&&w.y<=m&&w!==r&&w!==o&&zm(a,h,l,u,c,d,w.x,w.y)&&an(w.prev,w,w.next)>=0||(w=w.prevZ,b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==o&&zm(a,h,l,u,c,d,b.x,b.y)&&an(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;w&&w.z>=v;){if(w.x>=f&&w.x<=g&&w.y>=p&&w.y<=m&&w!==r&&w!==o&&zm(a,h,l,u,c,d,w.x,w.y)&&an(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;b&&b.z<=x;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==o&&zm(a,h,l,u,c,d,b.x,b.y)&&an(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function b_e(e,t,i){let n=e;do{let r=n.prev,s=n.next.next;!QM(r,s)&&Lq(r,n,n.next,s)&&wx(r,s)&&wx(s,r)&&(t.push(r.i/i|0),t.push(n.i/i|0),t.push(s.i/i|0),_x(n),_x(n.next),n=e=s),n=n.next}while(n!==e);return kf(n)}function A_e(e,t,i,n,r,s){let o=e;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&L_e(o,a)){let l=Rq(o,a);o=kf(o,o.next),l=kf(l,l.next),xx(o,t,i,n,r,s,0),xx(l,t,i,n,r,s,0);return}a=a.next}o=o.next}while(o!==e)}function S_e(e,t,i,n){let r=[],s,o,a,l,c;for(s=0,o=t.length;s<o;s++)a=t[s]*n,l=s<o-1?t[s+1]*n:e.length,c=Bq(e,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(B_e(c));for(r.sort(M_e),s=0;s<r.length;s++)i=E_e(r[s],i);return i}function M_e(e,t){return e.x-t.x}function E_e(e,t){let i=C_e(e,t);if(!i)return t;let n=Rq(i,e);return kf(n,n.next),kf(i,i.next)}function C_e(e,t){let i=t,n=-1/0,r,s=e.x,o=e.y;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){let d=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(d<=s&&d>n&&(n=d,r=i.x<i.next.x?i:i.next,d===s))return r}i=i.next}while(i!==t);if(!r)return null;let a=r,l=r.x,c=r.y,h=1/0,u;i=r;do s>=i.x&&i.x>=l&&s!==i.x&&zm(o<c?s:n,o,l,c,o<c?n:s,o,i.x,i.y)&&(u=Math.abs(o-i.y)/(s-i.x),wx(i,e)&&(u<h||u===h&&(i.x>r.x||i.x===r.x&&T_e(r,i)))&&(r=i,h=u)),i=i.next;while(i!==a);return r}function T_e(e,t){return an(e.prev,e,t.prev)<0&&an(t.next,e,e.next)<0}function P_e(e,t,i,n){let r=e;do r.z===0&&(r.z=aB(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,D_e(r)}function D_e(e){let t,i,n,r,s,o,a,l,c=1;do{for(i=e,e=null,s=null,o=0;i;){for(o++,n=i,a=0,t=0;t<c&&(a++,n=n.nextZ,!!n);t++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;i=n}s.nextZ=null,c*=2}while(o>1);return e}function aB(e,t,i,n,r){return e=(e-i)*r|0,t=(t-n)*r|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function B_e(e){let t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function zm(e,t,i,n,r,s,o,a){return(r-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(n-a)>=(i-o)*(t-a)&&(i-o)*(s-a)>=(r-o)*(n-a)}function L_e(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!R_e(e,t)&&(wx(e,t)&&wx(t,e)&&I_e(e,t)&&(an(e.prev,e,t.prev)||an(e,t.prev,t))||QM(e,t)&&an(e.prev,e,e.next)>0&&an(t.prev,t,t.next)>0)}function an(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function QM(e,t){return e.x===t.x&&e.y===t.y}function Lq(e,t,i,n){let r=nb(an(e,t,i)),s=nb(an(e,t,n)),o=nb(an(i,n,e)),a=nb(an(i,n,t));return!!(r!==s&&o!==a||r===0&&ib(e,i,t)||s===0&&ib(e,n,t)||o===0&&ib(i,e,n)||a===0&&ib(i,t,n))}function ib(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function nb(e){return e>0?1:e<0?-1:0}function R_e(e,t){let i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&Lq(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function wx(e,t){return an(e.prev,e,e.next)<0?an(e,t,e.next)>=0&&an(e,e.prev,t)>=0:an(e,t,e.prev)<0||an(e,e.next,t)<0}function I_e(e,t){let i=e,n=!1,r=(e.x+t.x)/2,s=(e.y+t.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==e);return n}function Rq(e,t){let i=new lB(e.i,e.x,e.y),n=new lB(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function zG(e,t,i,n){let r=new lB(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function _x(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function lB(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O_e(e,t,i,n){let r=0;for(let s=t,o=i-n;s<i;s+=n)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}var Iq=class{static area(e){let t=e.length,i=0;for(let n=t-1,r=0;r<t;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return i*.5}static isClockWise(e){return Iq.area(e)<0}static triangulateShape(e,t){let i=[],n=[],r=[];kG(e),UG(i,e);let s=e.length;t.forEach(kG);for(let a=0;a<t.length;a++)n.push(s),s+=t[a].length,UG(i,t[a]);let o=x_e.triangulate(i,n);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}};function kG(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function UG(e,t){for(let i=0;i<t.length;i++)e.push(t[i].x),e.push(t[i].y)}var Oq=class extends lO{constructor(e=1,t=0){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(n,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Oq(e.radius,e.detail)}},cO=class extends Ot{constructor(e=1,t=32,i=16,n=0,r=Math.PI*2,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));let a=Math.min(s+o,Math.PI),l=0,c=[],h=new I,u=new I,d=[],f=[],p=[],g=[];for(let m=0;m<=i;m++){let v=[],x=m/i,w=0;m==0&&s==0?w=.5/t:m==i&&a==Math.PI&&(w=-.5/t);for(let b=0;b<=t;b++){let M=b/t;h.x=-e*Math.cos(n+M*r)*Math.sin(s+x*o),h.y=e*Math.cos(s+x*o),h.z=e*Math.sin(n+M*r)*Math.sin(s+x*o),f.push(h.x,h.y,h.z),u.copy(h).normalize(),p.push(u.x,u.y,u.z),g.push(M+w,1-x),v.push(l++)}c.push(v)}for(let m=0;m<i;m++)for(let v=0;v<t;v++){let x=c[m][v+1],w=c[m][v],b=c[m+1][v],M=c[m+1][v+1];(m!==0||s>0)&&d.push(x,w,M),(m!==i-1||a<Math.PI)&&d.push(w,b,M)}this.setIndex(d),this.setAttribute("position",new gt(f,3)),this.setAttribute("normal",new gt(p,3)),this.setAttribute("uv",new gt(g,2))}static fromJSON(e){return new cO(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},Fq=class extends Ot{constructor(e=1,t=.4,i=64,n=8,r=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:s},i=Math.floor(i),n=Math.floor(n);let o=[],a=[],l=[],c=[],h=new I,u=new I,d=new I,f=new I,p=new I,g=new I,m=new I;for(let x=0;x<=i;++x){let w=x/i*r*Math.PI*2;v(w,r,s,e,d),v(w+.01,r,s,e,f),g.subVectors(f,d),m.addVectors(f,d),p.crossVectors(g,m),m.crossVectors(p,g),p.normalize(),m.normalize();for(let b=0;b<=n;++b){let M=b/n*Math.PI*2,A=-t*Math.cos(M),T=t*Math.sin(M);h.x=d.x+(A*m.x+T*p.x),h.y=d.y+(A*m.y+T*p.y),h.z=d.z+(A*m.z+T*p.z),a.push(h.x,h.y,h.z),u.subVectors(h,d).normalize(),l.push(u.x,u.y,u.z),c.push(x/i),c.push(b/n)}}for(let x=1;x<=i;x++)for(let w=1;w<=n;w++){let b=(n+1)*(x-1)+(w-1),M=(n+1)*x+(w-1),A=(n+1)*x+w,T=(n+1)*(x-1)+w;o.push(b,M,T),o.push(M,A,T)}this.setIndex(o),this.setAttribute("position",new gt(a,3)),this.setAttribute("normal",new gt(l,3)),this.setAttribute("uv",new gt(c,2));function v(x,w,b,M,A){let T=Math.cos(x),S=Math.sin(x),C=b/w*x,P=Math.cos(C);A.x=M*(2+P)*.5*T,A.y=M*(2+P)*S*.5,A.z=M*Math.sin(C)*.5}}static fromJSON(e){return new Fq(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}},GG={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Nq=class{constructor(e,t,i){let n=this,r=!1,s=0,o=0,a,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(c){o++,r===!1&&n.onStart!==void 0&&n.onStart(c,s,o),r=!0},this.itemEnd=function(c){s++,n.onProgress!==void 0&&n.onProgress(c,s,o),s===o&&(r=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(c){n.onError!==void 0&&n.onError(c)},this.resolveURL=function(c){return a?a(c):c},this.setURLModifier=function(c){return a=c,this},this.addHandler=function(c,h){return l.push(c,h),this},this.removeHandler=function(c){let h=l.indexOf(c);return h!==-1&&l.splice(h,2),this},this.getHandler=function(c){for(let h=0,u=l.length;h<u;h+=2){let d=l[h],f=l[h+1];if(d.global&&(d.lastIndex=0),d.test(c))return f}return null}}},F_e=new Nq,uO=class{constructor(e){this.manager=e!==void 0?e:F_e,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let i=this;return new Promise(function(n,r){i.load(e,n,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},bc={},N_e=class extends Error{constructor(e,t){super(e),this.response=t}},cB=class extends uO{constructor(e){super(e)}load(e,t,i,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let r=GG.get(e);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(bc[e]!==void 0){bc[e].push({onLoad:t,onProgress:i,onError:n});return}bc[e]=[],bc[e].push({onLoad:t,onProgress:i,onError:n});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=bc[e],h=l.body.getReader(),u=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),d=u?parseInt(u):0,f=d!==0,p=0,g=new ReadableStream({start(m){v();function v(){h.read().then(({done:x,value:w})=>{if(x)m.close();else{p+=w.byteLength;let b=new ProgressEvent("progress",{lengthComputable:f,loaded:p,total:d});for(let M=0,A=c.length;M<A;M++){let T=c[M];T.onProgress&&T.onProgress(b)}m.enqueue(w),v()}})}}});return new Response(g)}else throw new N_e(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(a){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,o));case"json":return l.json();default:if(o===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(o),h=c&&c[1]?c[1].toLowerCase():void 0,u=new TextDecoder(h);return l.arrayBuffer().then(d=>u.decode(d))}}}).then(l=>{GG.add(e,l);let c=bc[e];delete bc[e];for(let h=0,u=c.length;h<u;h++){let d=c[h];d.onLoad&&d.onLoad(l)}}).catch(l=>{let c=bc[e];if(c===void 0)throw this.manager.itemError(e),l;delete bc[e];for(let h=0,u=c.length;h<u;h++){let d=c[h];d.onError&&d.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},A1=class extends Ii{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Pt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},z_e=class extends A1{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ii.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Pt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},F2=new Je,HG=new I,VG=new I,hO=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ge(512,512),this.map=null,this.mapPass=null,this.matrix=new Je,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new nO,this._frameExtents=new ge(1,1),this._viewportCount=1,this._viewports=[new Kt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,i=this.matrix;HG.setFromMatrixPosition(e.matrixWorld),t.position.copy(HG),VG.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(VG),t.updateMatrixWorld(),F2.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(F2),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(F2)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},k_e=class extends hO{constructor(){super(new Yr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,i=yx*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(i!==t.fov||n!==t.aspect||r!==t.far)&&(t.fov=i,t.aspect=n,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},U_e=class extends A1{constructor(e,t,i=0,n=Math.PI/3,r=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ii.DEFAULT_UP),this.updateMatrix(),this.target=new Ii,this.distance=i,this.angle=n,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new k_e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},jG=new Je,y0=new I,N2=new I,G_e=class extends hO{constructor(){super(new Yr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ge(4,2),this._viewportCount=6,this._viewports=[new Kt(2,1,1,1),new Kt(0,1,1,1),new Kt(3,1,1,1),new Kt(1,1,1,1),new Kt(3,0,1,1),new Kt(1,0,1,1)],this._cubeDirections=[new I(1,0,0),new I(-1,0,0),new I(0,0,1),new I(0,0,-1),new I(0,1,0),new I(0,-1,0)],this._cubeUps=[new I(0,1,0),new I(0,1,0),new I(0,1,0),new I(0,1,0),new I(0,0,1),new I(0,0,-1)]}updateMatrices(e,t=0){let i=this.camera,n=this.matrix,r=e.distance||i.far;r!==i.far&&(i.far=r,i.updateProjectionMatrix()),y0.setFromMatrixPosition(e.matrixWorld),i.position.copy(y0),N2.copy(i.position),N2.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(N2),i.updateMatrixWorld(),n.makeTranslation(-y0.x,-y0.y,-y0.z),jG.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(jG)}},H_e=class extends A1{constructor(e,t,i=0,n=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new G_e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},V_e=class extends hO{constructor(){super(new dS(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},j_e=class extends A1{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ii.DEFAULT_UP),this.updateMatrix(),this.target=new Ii,this.shadow=new V_e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},W_e=class extends Ot{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},zq=class extends uO{constructor(e){super(e)}load(e,t,i,n){let r=this,s=new cB(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,function(o){try{t(r.parse(JSON.parse(o)))}catch(a){n?n(a):console.error(a),r.manager.itemError(e)}},i,n)}parse(e){let t={},i={};function n(u,d){if(t[d]!==void 0)return t[d];let f=u.interleavedBuffers[d],p=r(u,f.buffer),g=O_(f.type,p),m=new s_e(g,f.stride);return m.uuid=f.uuid,t[d]=m,m}function r(u,d){if(i[d]!==void 0)return i[d];let f=u.arrayBuffers[d],p=new Uint32Array(f).buffer;return i[d]=p,p}let s=e.isInstancedBufferGeometry?new W_e:new Ot,o=e.data.index;if(o!==void 0){let u=O_(o.type,o.array);s.setIndex(new zt(u,1))}let a=e.data.attributes;for(let u in a){let d=a[u],f;if(d.isInterleavedBufferAttribute){let p=n(e.data,d.data);f=new sB(p,d.itemSize,d.offset,d.normalized)}else{let p=O_(d.type,d.array),g=d.isInstancedBufferAttribute?o_e:zt;f=new g(p,d.itemSize,d.normalized)}d.name!==void 0&&(f.name=d.name),d.usage!==void 0&&f.setUsage(d.usage),d.updateRange!==void 0&&(f.updateRange.offset=d.updateRange.offset,f.updateRange.count=d.updateRange.count),s.setAttribute(u,f)}let l=e.data.morphAttributes;if(l)for(let u in l){let d=l[u],f=[];for(let p=0,g=d.length;p<g;p++){let m=d[p],v;if(m.isInterleavedBufferAttribute){let x=n(e.data,m.data);v=new sB(x,m.itemSize,m.offset,m.normalized)}else{let x=O_(m.type,m.array);v=new zt(x,m.itemSize,m.normalized)}m.name!==void 0&&(v.name=m.name),f.push(v)}s.morphAttributes[u]=f}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let u=0,d=c.length;u!==d;++u){let f=c[u];s.addGroup(f.start,f.count,f.materialIndex)}let h=e.data.boundingSphere;if(h!==void 0){let u=new I;h.center!==void 0&&u.fromArray(h.center),s.boundingSphere=new ua(u,h.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}},X_e=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=WG(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=WG();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function WG(){return(typeof performance>"u"?Date:performance).now()}var kq="\\[\\]\\.:\\/",dO="[^"+kq+"]",Y_e="[^"+kq.replace("\\.","")+"]";/((?:WC+[\/:])*)/.source.replace("WC",dO);/(WCOD+)?/.source.replace("WCOD",Y_e);/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",dO);/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",dO);var Ye=class{constructor(e){this.value=e}clone(){return new Ye(this.value.clone===void 0?this.value:this.value.clone())}},Uq=class{constructor(e,t,i=0,n=1/0){this.ray=new sv(e,t),this.near=i,this.far=n,this.camera=null,this.layers=new tO,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return uB(e,this,i,t),i.sort(XG),i}intersectObjects(e,t=!0,i=[]){for(let n=0,r=e.length;n<r;n++)uB(e[n],this,i,t);return i.sort(XG),i}};function XG(e,t){return e.distance-t.distance}function uB(e,t,i,n){if(e.layers.test(t.layers)&&e.raycast(t,i),n===!0){let r=e.children;for(let s=0,o=r.length;s<o;s++)uB(r[s],t,i,!0)}}var YG=class{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Kn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},qG=new ge,q_e=class{constructor(e=new ge(1/0,1/0),t=new ge(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=qG.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qG.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},QG=new I,rb=new I,na=class{constructor(e=new I,t=new I){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){QG.subVectors(e,this.start),rb.subVectors(this.end,this.start);let i=rb.dot(rb),n=rb.dot(QG)/i;return t&&(n=Kn(n,0,1)),n}closestPointToPoint(e,t,i){let n=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},JG=new I,Q_e=class extends Ii{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let i=new Ot,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,o=1,a=32;s<a;s++,o++){let l=s/a*Math.PI*2,c=o/a*Math.PI*2;n.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}i.setAttribute("position",new gt(n,3));let r=new Zh({fog:!1,toneMapped:!1});this.cone=new b1(i,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),JG.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(JG),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},J_e=class extends Ns{constructor(e,t,i){let n=new cO(t,4,2),r=new ov({wireframe:!0,fog:!1,toneMapped:!1});super(n,r),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},KG=new I,sb=new I,ZG=new I,K_e=class extends Ii{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let n=new Ot;n.setAttribute("position",new gt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let r=new Zh({fog:!1,toneMapped:!1});this.lightPlane=new fS(n,r),this.add(this.lightPlane),n=new Ot,n.setAttribute("position",new gt([0,0,0,0,0,1],3)),this.targetLine=new fS(n,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),KG.setFromMatrixPosition(this.light.matrixWorld),sb.setFromMatrixPosition(this.light.target.matrixWorld),ZG.subVectors(sb,KG),this.lightPlane.lookAt(sb),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(sb),this.targetLine.scale.z=ZG.length()}},ob=new I,pn=new lv,gS=class extends b1{constructor(e){let t=new Ot,i=new Zh({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],s={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(f,p){a(f),a(p)}function a(f){n.push(0,0,0),r.push(0,0,0),s[f]===void 0&&(s[f]=[]),s[f].push(n.length/3-1)}t.setAttribute("position",new gt(n,3)),t.setAttribute("color",new gt(r,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new Pt(16755200),c=new Pt(16711680),h=new Pt(43775),u=new Pt(16777215),d=new Pt(3355443);this.setColors(l,c,h,u,d)}setColors(e,t,i,n,r){let s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,i.r,i.g,i.b),s.setXYZ(33,i.r,i.g,i.b),s.setXYZ(34,i.r,i.g,i.b),s.setXYZ(35,i.r,i.g,i.b),s.setXYZ(36,i.r,i.g,i.b),s.setXYZ(37,i.r,i.g,i.b),s.setXYZ(38,n.r,n.g,n.b),s.setXYZ(39,n.r,n.g,n.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,i=1,n=1;pn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),An("c",t,e,pn,0,0,-1),An("t",t,e,pn,0,0,1),An("n1",t,e,pn,-i,-n,-1),An("n2",t,e,pn,i,-n,-1),An("n3",t,e,pn,-i,n,-1),An("n4",t,e,pn,i,n,-1),An("f1",t,e,pn,-i,-n,1),An("f2",t,e,pn,i,-n,1),An("f3",t,e,pn,-i,n,1),An("f4",t,e,pn,i,n,1),An("u1",t,e,pn,i*.7,n*1.1,-1),An("u2",t,e,pn,-i*.7,n*1.1,-1),An("u3",t,e,pn,0,n*2,-1),An("cf1",t,e,pn,-i,0,1),An("cf2",t,e,pn,i,0,1),An("cf3",t,e,pn,0,-n,1),An("cf4",t,e,pn,0,n,1),An("cn1",t,e,pn,-i,0,-1),An("cn2",t,e,pn,i,0,-1),An("cn3",t,e,pn,0,-n,-1),An("cn4",t,e,pn,0,n,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function An(e,t,i,n,r,s,o){ob.set(r,s,o).unproject(n);let a=t[e];if(a!==void 0){let l=i.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],ob.x,ob.y,ob.z)}}var vS=class extends b1{constructor(e,t=16776960){let i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new Ot;r.setIndex(new zt(i,1)),r.setAttribute("position",new gt(n,3)),super(r,new Zh({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},Z_e=class extends b1{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new Ot;n.setAttribute("position",new gt(t,3)),n.setAttribute("color",new gt(i,3));let r=new Zh({vertexColors:!0,toneMapped:!1});super(n,r),this.type="AxesHelper"}setColors(e,t,i){let n=new Pt,r=this.geometry.attributes.color.array;return n.set(e),n.toArray(r,0),n.toArray(r,3),n.set(t),n.toArray(r,6),n.toArray(r,9),n.set(i),n.toArray(r,12),n.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:rv}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=rv);var x0=".",fO=Symbol("target"),Gq=Symbol("unsubscribe");function hB(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function $_e(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var Ll=Array.isArray;function pO(e){return typeof e=="symbol"}var ebe={after:(e,t)=>Ll(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>Ll(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=x0),pO(t)?e+t.toString():e+t):e,initial:e=>{if(Ll(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(x0);return t===-1?"":e.slice(0,t)},last:e=>{if(Ll(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(x0);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(Ll(e))for(let i of e)t(i);else if(e!==""){let i=0,n=e.indexOf(x0);if(n===-1)t(e);else for(;i<e.length;)n===-1&&(n=e.length),t(e.slice(i,n)),i=n+1,n=e.indexOf(x0,i)}},get(e,t){return this.walk(t,i=>{e&&(e=e[i])}),e}},Wo=ebe;function tbe(e){return typeof e=="object"&&typeof e.next=="function"}function ibe(e,t,i,n,r){let s=e.next;if(t.name==="entries")e.next=function(){let o=s.call(this);return o.done===!1&&(o.value[0]=r(o.value[0],t,o.value[0],n),o.value[1]=r(o.value[1],t,o.value[0],n)),o};else if(t.name==="values"){let o=i[fO].keys();e.next=function(){let a=s.call(this);return a.done===!1&&(a.value=r(a.value,t,o.next().value,n)),a}}else e.next=function(){let o=s.call(this);return o.done===!1&&(o.value=r(o.value,t,o.value,n)),o};return e}function $G(e,t,i){return e.isUnsubscribed||t.ignoreSymbols&&pO(i)||t.ignoreUnderscores&&i.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(i)}var nbe=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),i=t.get(e);return i===void 0&&(i={},t.set(e,i)),i}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let i=this._getProperties(e),n=i[t];return n===void 0&&(n=Reflect.getOwnPropertyDescriptor(e,t),i[t]=n),n}getProxy(e,t,i,n){if(this.isUnsubscribed)return e;let r=e[n],s=r||e;this._pathCache.set(s,t);let o=this._proxyCache.get(s);return o===void 0&&(o=r===void 0?new Proxy(e,i):e,this._proxyCache.set(s,o)),o}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,Wo.get(t,this.getPath(e)))}defineProperty(e,t,i){return Reflect.defineProperty(e,t,i)?(this.isUnsubscribed||(this._getProperties(e)[t]=i),!0):!1}setProperty(e,t,i,n,r){if(!this._equals(r,i)||!(t in e)){let s=this._getOwnPropertyDescriptor(e,t);return s!==void 0&&"set"in s?Reflect.set(e,t,i,n):Reflect.set(e,t,i)}return!0}deleteProperty(e,t,i){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let n=this._getDescriptorCache().get(e);n&&(delete n[t],this._pathCache.delete(i))}return!0}return!1}isSameDescriptor(e,t,i){let n=this._getOwnPropertyDescriptor(t,i);return e!==void 0&&n!==void 0&&Object.is(e.value,n.value)&&(e.writable||!1)===(n.writable||!1)&&(e.enumerable||!1)===(n.enumerable||!1)&&(e.configurable||!1)===(n.configurable||!1)&&e.get===n.get&&e.set===n.set}isGetInvariant(e,t){let i=this._getOwnPropertyDescriptor(e,t);return i!==void 0&&i.configurable!==!0&&i.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function dB(e){return toString.call(e)==="[object Object]"}function ab(){return!0}function Jp(e,t){return e.length!==t.length||e.some((i,n)=>t[n]!==i)}var Hq=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),rbe=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),Vq={push:ab,pop:ab,shift:ab,unshift:ab,copyWithin:Jp,reverse:Jp,sort:Jp,splice:Jp,flat:Jp,fill:Jp},sbe=new Set([...Hq,...rbe,...Object.keys(Vq)]);function lb(e,t){if(e.size!==t.size)return!0;for(let i of e)if(!t.has(i))return!0;return!1}var jq=["keys","values","entries"],Wq=new Set(["has","toString"]),Xq={add:lb,clear:lb,delete:lb,forEach:lb},obe=new Set([...Wq,...Object.keys(Xq),...jq]);function cb(e,t){if(e.size!==t.size)return!0;let i;for(let[n,r]of e)if(i=t.get(n),i!==r||i===void 0&&!t.has(n))return!0;return!1}var abe=new Set([...Wq,"get"]),Yq={set:cb,clear:cb,delete:cb,forEach:cb},lbe=new Set([...abe,...Object.keys(Yq),...jq]),Uh=class{constructor(e,t,i,n){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=n,this._changes=n?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return Hq.has(e)}_shallowClone(e){let t=e;if(dB(e))t={...e};else if(Ll(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(i=>this._shallowClone(i)));else if(e instanceof Map){t=new Map;for(let[i,n]of e.entries())t.set(i,this._shallowClone(n))}return this._clonedCache.add(t),t}preferredThisArg(e,t,i,n){return e?(Ll(n)?this._onIsChanged=Vq[t]:n instanceof Set?this._onIsChanged=Xq[t]:n instanceof Map&&(this._onIsChanged=Yq[t]),n):i}update(e,t,i){let n=Wo.after(e,this._path);if(t!=="length"){let r=this.clone;Wo.walk(n,s=>{r&&r[s]&&(this._clonedCache.has(r[s])||(r[s]=this._shallowClone(r[s])),r=r[s])}),this._hasOnValidate&&this._changes.push({path:n,property:t,previous:i}),r&&r[t]&&(r[t]=i)}this._isChanged=!0}undo(e){let t;for(let i=this._changes.length-1;i!==-1;i--)t=this._changes[i],Wo.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},eH=class extends Uh{static isHandledMethod(e){return sbe.has(e)}},cbe=class extends Uh{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},tH=class extends Uh{static isHandledMethod(e){return obe.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},iH=class extends Uh{static isHandledMethod(e){return lbe.has(e)}undo(e){for(let[t,i]of this.clone.entries())e.set(t,i);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},ube=class extends Uh{constructor(e,t,i,n){super(void 0,t,i,n),this._arg1=i[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},hbe=class extends Uh{constructor(e,t,i,n){super(void 0,t,i,n),this._weakKey=i[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},dm=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return dB(e)||Ll(e)||hB(e)}static isHandledMethod(e,t){return dB(e)?Uh.isHandledMethod(t):Ll(e)?eH.isHandledMethod(t):e instanceof Set?tH.isHandledMethod(t):e instanceof Map?iH.isHandledMethod(t):hB(e)}get isCloning(){return this._stack.length>0}start(e,t,i){let n=Uh;Ll(e)?n=eH:e instanceof Date?n=cbe:e instanceof Set?n=tH:e instanceof Map?n=iH:e instanceof WeakSet?n=ube:e instanceof WeakMap&&(n=hbe),this._stack.push(new n(e,t,i,this._hasOnValidate))}update(e,t,i){this._stack[this._stack.length-1].update(e,t,i)}preferredThisArg(e,t,i){let{name:n}=e,r=dm.isHandledMethod(i,n);return this._stack[this._stack.length-1].preferredThisArg(r,n,t,i)}isChanged(e,t,i){return this._stack[this._stack.length-1].isChanged(e,t,i)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},dbe={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},mO=(e,t,i={})=>{i={...dbe,...i};let n=Symbol("ProxyTarget"),{equals:r,isShallow:s,ignoreDetached:o,details:a}=i,l=new nbe(r),c=typeof i.onValidate=="function",h=new dm(c),u=(x,w,b,M,A)=>!c||h.isCloning||i.onValidate(Wo.concat(l.getPath(x),w),b,M,A)===!0,d=(x,w,b,M)=>{!$G(l,i,w)&&!(o&&l.isDetached(x,e))&&f(l.getPath(x),w,b,M)},f=(x,w,b,M,A)=>{h.isCloning?h.update(x,w,M):t(Wo.concat(x,w),b,M,A)},p=x=>x&&(x[n]||x),g=(x,w,b,M)=>$_e(x)||b==="constructor"||s&&!dm.isHandledMethod(w,b)||$G(l,i,b)||l.isGetInvariant(w,b)||o&&l.isDetached(w,e)?x:(M===void 0&&(M=l.getPath(w)),l.getProxy(x,Wo.concat(M,b),m,n)),m={get(x,w,b){if(pO(w)){if(w===n||w===fO)return x;if(w===Gq&&!l.isUnsubscribed&&l.getPath(x).length===0)return l.unsubscribe(),x}let M=hB(x)?Reflect.get(x,w):Reflect.get(x,w,b);return g(M,x,w)},set(x,w,b,M){b=p(b);let A=x[n]||x,T=A[w];if(r(T,b)&&w in x)return!0;let S=u(x,w,b,T);return S&&l.setProperty(A,w,b,M,T)?(d(x,w,x[w],T),!0):!S},defineProperty(x,w,b){if(!l.isSameDescriptor(b,x,w)){let M=x[w];u(x,w,b.value,M)&&l.defineProperty(x,w,b,M)&&d(x,w,b.value,M)}return!0},deleteProperty(x,w){if(!Reflect.has(x,w))return!0;let b=Reflect.get(x,w),M=u(x,w,void 0,b);return M&&l.deleteProperty(x,w,b)?(d(x,w,void 0,b),!0):!M},apply(x,w,b){let M=w[n]||w;if(l.isUnsubscribed)return Reflect.apply(x,M,b);if((a===!1||a!==!0&&!a.includes(x.name))&&dm.isHandledType(M)){let A=Wo.initial(l.getPath(x)),T=dm.isHandledMethod(M,x.name);h.start(M,A,b);let S=Reflect.apply(x,h.preferredThisArg(x,w,M),T?b.map(B=>p(B)):b),C=h.isChanged(M,r),P=h.stop();if(dm.isHandledType(S)&&T&&(w instanceof Map&&x.name==="get"&&(A=Wo.concat(A,b[0])),S=l.getProxy(S,A,m)),C){let B={name:x.name,args:b,result:S},k=h.isCloning?Wo.initial(A):A,z=h.isCloning?Wo.last(A):"";u(Wo.get(e,k),z,M,P,B)?f(k,z,M,P,B):h.undo(M)}return(w instanceof Map||w instanceof Set)&&tbe(S)?ibe(S,x,w,A,g):S}return Reflect.apply(x,w,b)}},v=l.getProxy(e,i.pathAsArray?[]:"",m);return t=t.bind(v),c&&(i.onValidate=i.onValidate.bind(v)),v};mO.target=e=>e&&e[fO]||e;mO.unsubscribe=e=>e[Gq]||e;var nH=mO,fbe=typeof global=="object"&&global&&global.Object===Object&&global,qq=fbe,pbe=typeof self=="object"&&self&&self.Object===Object&&self,mbe=qq||pbe||Function("return this")(),nl=mbe,gbe=nl.Symbol,ha=gbe,Qq=Object.prototype,vbe=Qq.hasOwnProperty,ybe=Qq.toString,w0=ha?ha.toStringTag:void 0;function xbe(e){var t=vbe.call(e,w0),i=e[w0];try{e[w0]=void 0;var n=!0}catch{}var r=ybe.call(e);return n&&(t?e[w0]=i:delete e[w0]),r}var wbe=xbe,_be=Object.prototype,bbe=_be.toString;function Abe(e){return bbe.call(e)}var Sbe=Abe,Mbe="[object Null]",Ebe="[object Undefined]",rH=ha?ha.toStringTag:void 0;function Cbe(e){return e==null?e===void 0?Ebe:Mbe:rH&&rH in Object(e)?wbe(e):Sbe(e)}var Zf=Cbe;function Tbe(e){return e!=null&&typeof e=="object"}var au=Tbe,Pbe="[object Symbol]";function Dbe(e){return typeof e=="symbol"||au(e)&&Zf(e)==Pbe}var JM=Dbe;function Bbe(e,t){for(var i=-1,n=e==null?0:e.length,r=Array(n);++i<n;)r[i]=t(e[i],i,e);return r}var Jq=Bbe,Lbe=Array.isArray,Kl=Lbe,Rbe=1/0,sH=ha?ha.prototype:void 0,oH=sH?sH.toString:void 0;function Kq(e){if(typeof e=="string")return e;if(Kl(e))return Jq(e,Kq)+"";if(JM(e))return oH?oH.call(e):"";var t=e+"";return t=="0"&&1/e==-Rbe?"-0":t}var Ibe=Kq,Obe=/\s/;function Fbe(e){for(var t=e.length;t--&&Obe.test(e.charAt(t)););return t}var Nbe=Fbe,zbe=/^\s+/;function kbe(e){return e&&e.slice(0,Nbe(e)+1).replace(zbe,"")}var Ube=kbe;function Gbe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Za=Gbe,aH=0/0,Hbe=/^[-+]0x[0-9a-f]+$/i,Vbe=/^0b[01]+$/i,jbe=/^0o[0-7]+$/i,Wbe=parseInt;function Xbe(e){if(typeof e=="number")return e;if(JM(e))return aH;if(Za(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Za(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Ube(e);var i=Vbe.test(e);return i||jbe.test(e)?Wbe(e.slice(2),i?2:8):Hbe.test(e)?aH:+e}var lH=Xbe;function Ybe(e){return e}var qbe=Ybe,Qbe="[object AsyncFunction]",Jbe="[object Function]",Kbe="[object GeneratorFunction]",Zbe="[object Proxy]";function $be(e){if(!Za(e))return!1;var t=Zf(e);return t==Jbe||t==Kbe||t==Qbe||t==Zbe}var Zq=$be,eAe=nl["__core-js_shared__"],z2=eAe,cH=function(){var e=/[^.]+$/.exec(z2&&z2.keys&&z2.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function tAe(e){return!!cH&&cH in e}var iAe=tAe,nAe=Function.prototype,rAe=nAe.toString;function sAe(e){if(e!=null){try{return rAe.call(e)}catch{}try{return e+""}catch{}}return""}var $f=sAe,oAe=/[\\^$.*+?()[\]{}|]/g,aAe=/^\[object .+?Constructor\]$/,lAe=Function.prototype,cAe=Object.prototype,uAe=lAe.toString,hAe=cAe.hasOwnProperty,dAe=RegExp("^"+uAe.call(hAe).replace(oAe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function fAe(e){if(!Za(e)||iAe(e))return!1;var t=Zq(e)?dAe:aAe;return t.test($f(e))}var pAe=fAe;function mAe(e,t){return e==null?void 0:e[t]}var gAe=mAe;function vAe(e,t){var i=gAe(e,t);return pAe(i)?i:void 0}var ep=vAe,yAe=ep(nl,"WeakMap"),fB=yAe,uH=Object.create,xAe=function(){function e(){}return function(t){if(!Za(t))return{};if(uH)return uH(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}(),wAe=xAe;function _Ae(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}var bAe=_Ae;function AAe(e,t){var i=-1,n=e.length;for(t||(t=Array(n));++i<n;)t[i]=e[i];return t}var SAe=AAe,MAe=800,EAe=16,CAe=Date.now;function TAe(e){var t=0,i=0;return function(){var n=CAe(),r=EAe-(n-i);if(i=n,r>0){if(++t>=MAe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var PAe=TAe;function DAe(e){return function(){return e}}var BAe=DAe,LAe=function(){try{var e=ep(Object,"defineProperty");return e({},"",{}),e}catch{}}(),yS=LAe,RAe=yS?function(e,t){return yS(e,"toString",{configurable:!0,enumerable:!1,value:BAe(t),writable:!0})}:qbe,IAe=RAe,OAe=PAe(IAe),FAe=OAe;function NAe(e,t){for(var i=-1,n=e==null?0:e.length;++i<n&&t(e[i],i,e)!==!1;);return e}var zAe=NAe,kAe=9007199254740991,UAe=/^(?:0|[1-9]\d*)$/;function GAe(e,t){var i=typeof e;return t=t??kAe,!!t&&(i=="number"||i!="symbol"&&UAe.test(e))&&e>-1&&e%1==0&&e<t}var gO=GAe;function HAe(e,t,i){t=="__proto__"&&yS?yS(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}var $q=HAe;function VAe(e,t){return e===t||e!==e&&t!==t}var vO=VAe,jAe=Object.prototype,WAe=jAe.hasOwnProperty;function XAe(e,t,i){var n=e[t];(!(WAe.call(e,t)&&vO(n,i))||i===void 0&&!(t in e))&&$q(e,t,i)}var yO=XAe;function YAe(e,t,i,n){var r=!i;i||(i={});for(var s=-1,o=t.length;++s<o;){var a=t[s],l=n?n(i[a],e[a],a,i,e):void 0;l===void 0&&(l=e[a]),r?$q(i,a,l):yO(i,a,l)}return i}var S1=YAe,hH=Math.max;function qAe(e,t,i){return t=hH(t===void 0?e.length-1:t,0),function(){for(var n=arguments,r=-1,s=hH(n.length-t,0),o=Array(s);++r<s;)o[r]=n[t+r];r=-1;for(var a=Array(t+1);++r<t;)a[r]=n[r];return a[t]=i(o),bAe(e,this,a)}}var QAe=qAe,JAe=9007199254740991;function KAe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=JAe}var xO=KAe;function ZAe(e){return e!=null&&xO(e.length)&&!Zq(e)}var eQ=ZAe,$Ae=Object.prototype;function eSe(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||$Ae;return e===i}var wO=eSe;function tSe(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}var iSe=tSe,nSe="[object Arguments]";function rSe(e){return au(e)&&Zf(e)==nSe}var dH=rSe,tQ=Object.prototype,sSe=tQ.hasOwnProperty,oSe=tQ.propertyIsEnumerable,aSe=dH(function(){return arguments}())?dH:function(e){return au(e)&&sSe.call(e,"callee")&&!oSe.call(e,"callee")},_O=aSe;function lSe(){return!1}var cSe=lSe,iQ=typeof po=="object"&&po&&!po.nodeType&&po,fH=iQ&&typeof mo=="object"&&mo&&!mo.nodeType&&mo,uSe=fH&&fH.exports===iQ,pH=uSe?nl.Buffer:void 0,hSe=pH?pH.isBuffer:void 0,dSe=hSe||cSe,xS=dSe,fSe="[object Arguments]",pSe="[object Array]",mSe="[object Boolean]",gSe="[object Date]",vSe="[object Error]",ySe="[object Function]",xSe="[object Map]",wSe="[object Number]",_Se="[object Object]",bSe="[object RegExp]",ASe="[object Set]",SSe="[object String]",MSe="[object WeakMap]",ESe="[object ArrayBuffer]",CSe="[object DataView]",TSe="[object Float32Array]",PSe="[object Float64Array]",DSe="[object Int8Array]",BSe="[object Int16Array]",LSe="[object Int32Array]",RSe="[object Uint8Array]",ISe="[object Uint8ClampedArray]",OSe="[object Uint16Array]",FSe="[object Uint32Array]",Xi={};Xi[TSe]=Xi[PSe]=Xi[DSe]=Xi[BSe]=Xi[LSe]=Xi[RSe]=Xi[ISe]=Xi[OSe]=Xi[FSe]=!0;Xi[fSe]=Xi[pSe]=Xi[ESe]=Xi[mSe]=Xi[CSe]=Xi[gSe]=Xi[vSe]=Xi[ySe]=Xi[xSe]=Xi[wSe]=Xi[_Se]=Xi[bSe]=Xi[ASe]=Xi[SSe]=Xi[MSe]=!1;function NSe(e){return au(e)&&xO(e.length)&&!!Xi[Zf(e)]}var zSe=NSe;function kSe(e){return function(t){return e(t)}}var bO=kSe,nQ=typeof po=="object"&&po&&!po.nodeType&&po,Cy=nQ&&typeof mo=="object"&&mo&&!mo.nodeType&&mo,USe=Cy&&Cy.exports===nQ,k2=USe&&qq.process,GSe=function(){try{var e=Cy&&Cy.require&&Cy.require("util").types;return e||k2&&k2.binding&&k2.binding("util")}catch{}}(),zg=GSe,mH=zg&&zg.isTypedArray,HSe=mH?bO(mH):zSe,rQ=HSe,VSe=Object.prototype,jSe=VSe.hasOwnProperty;function WSe(e,t){var i=Kl(e),n=!i&&_O(e),r=!i&&!n&&xS(e),s=!i&&!n&&!r&&rQ(e),o=i||n||r||s,a=o?iSe(e.length,String):[],l=a.length;for(var c in e)(t||jSe.call(e,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||gO(c,l)))&&a.push(c);return a}var sQ=WSe;function XSe(e,t){return function(i){return e(t(i))}}var oQ=XSe,YSe=oQ(Object.keys,Object),qSe=YSe,QSe=Object.prototype,JSe=QSe.hasOwnProperty;function KSe(e){if(!wO(e))return qSe(e);var t=[];for(var i in Object(e))JSe.call(e,i)&&i!="constructor"&&t.push(i);return t}var ZSe=KSe;function $Se(e){return eQ(e)?sQ(e):ZSe(e)}var AO=$Se;function eMe(e){var t=[];if(e!=null)for(var i in Object(e))t.push(i);return t}var tMe=eMe,iMe=Object.prototype,nMe=iMe.hasOwnProperty;function rMe(e){if(!Za(e))return tMe(e);var t=wO(e),i=[];for(var n in e)n=="constructor"&&(t||!nMe.call(e,n))||i.push(n);return i}var sMe=rMe;function oMe(e){return eQ(e)?sQ(e,!0):sMe(e)}var SO=oMe,aMe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,lMe=/^\w*$/;function cMe(e,t){if(Kl(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||JM(e)?!0:lMe.test(e)||!aMe.test(e)||t!=null&&e in Object(t)}var uMe=cMe,hMe=ep(Object,"create"),bx=hMe;function dMe(){this.__data__=bx?bx(null):{},this.size=0}var fMe=dMe;function pMe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var mMe=pMe,gMe="__lodash_hash_undefined__",vMe=Object.prototype,yMe=vMe.hasOwnProperty;function xMe(e){var t=this.__data__;if(bx){var i=t[e];return i===gMe?void 0:i}return yMe.call(t,e)?t[e]:void 0}var wMe=xMe,_Me=Object.prototype,bMe=_Me.hasOwnProperty;function AMe(e){var t=this.__data__;return bx?t[e]!==void 0:bMe.call(t,e)}var SMe=AMe,MMe="__lodash_hash_undefined__";function EMe(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=bx&&t===void 0?MMe:t,this}var CMe=EMe;function uv(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}uv.prototype.clear=fMe;uv.prototype.delete=mMe;uv.prototype.get=wMe;uv.prototype.has=SMe;uv.prototype.set=CMe;var gH=uv;function TMe(){this.__data__=[],this.size=0}var PMe=TMe;function DMe(e,t){for(var i=e.length;i--;)if(vO(e[i][0],t))return i;return-1}var KM=DMe,BMe=Array.prototype,LMe=BMe.splice;function RMe(e){var t=this.__data__,i=KM(t,e);if(i<0)return!1;var n=t.length-1;return i==n?t.pop():LMe.call(t,i,1),--this.size,!0}var IMe=RMe;function OMe(e){var t=this.__data__,i=KM(t,e);return i<0?void 0:t[i][1]}var FMe=OMe;function NMe(e){return KM(this.__data__,e)>-1}var zMe=NMe;function kMe(e,t){var i=this.__data__,n=KM(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this}var UMe=kMe;function hv(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}hv.prototype.clear=PMe;hv.prototype.delete=IMe;hv.prototype.get=FMe;hv.prototype.has=zMe;hv.prototype.set=UMe;var ZM=hv,GMe=ep(nl,"Map"),Ax=GMe;function HMe(){this.size=0,this.__data__={hash:new gH,map:new(Ax||ZM),string:new gH}}var VMe=HMe;function jMe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var WMe=jMe;function XMe(e,t){var i=e.__data__;return WMe(t)?i[typeof t=="string"?"string":"hash"]:i.map}var $M=XMe;function YMe(e){var t=$M(this,e).delete(e);return this.size-=t?1:0,t}var qMe=YMe;function QMe(e){return $M(this,e).get(e)}var JMe=QMe;function KMe(e){return $M(this,e).has(e)}var ZMe=KMe;function $Me(e,t){var i=$M(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this}var eEe=$Me;function dv(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}dv.prototype.clear=VMe;dv.prototype.delete=qMe;dv.prototype.get=JMe;dv.prototype.has=ZMe;dv.prototype.set=eEe;var eE=dv,tEe="Expected a function";function MO(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(tEe);var i=function(){var n=arguments,r=t?t.apply(this,n):n[0],s=i.cache;if(s.has(r))return s.get(r);var o=e.apply(this,n);return i.cache=s.set(r,o)||s,o};return i.cache=new(MO.Cache||eE),i}MO.Cache=eE;var iEe=MO,nEe=500;function rEe(e){var t=iEe(e,function(n){return i.size===nEe&&i.clear(),n}),i=t.cache;return t}var sEe=rEe,oEe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,aEe=/\\(\\)?/g,lEe=sEe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(oEe,function(i,n,r,s){t.push(r?s.replace(aEe,"$1"):n||i)}),t}),cEe=lEe;function uEe(e){return e==null?"":Ibe(e)}var hEe=uEe;function dEe(e,t){return Kl(e)?e:uMe(e,t)?[e]:cEe(hEe(e))}var fv=dEe,fEe=1/0;function pEe(e){if(typeof e=="string"||JM(e))return e;var t=e+"";return t=="0"&&1/e==-fEe?"-0":t}var tE=pEe;function mEe(e,t){t=fv(t,e);for(var i=0,n=t.length;e!=null&&i<n;)e=e[tE(t[i++])];return i&&i==n?e:void 0}var aQ=mEe;function gEe(e,t){for(var i=-1,n=t.length,r=e.length;++i<n;)e[r+i]=t[i];return e}var EO=gEe,vH=ha?ha.isConcatSpreadable:void 0;function vEe(e){return Kl(e)||_O(e)||!!(vH&&e&&e[vH])}var yEe=vEe;function lQ(e,t,i,n,r){var s=-1,o=e.length;for(i||(i=yEe),r||(r=[]);++s<o;){var a=e[s];t>0&&i(a)?t>1?lQ(a,t-1,i,n,r):EO(r,a):n||(r[r.length]=a)}return r}var xEe=lQ;function wEe(e){var t=e==null?0:e.length;return t?xEe(e,1):[]}var _Ee=wEe;function bEe(e){return FAe(QAe(e,void 0,_Ee),e+"")}var cQ=bEe,AEe=oQ(Object.getPrototypeOf,Object),CO=AEe,SEe="[object Object]",MEe=Function.prototype,EEe=Object.prototype,uQ=MEe.toString,CEe=EEe.hasOwnProperty,TEe=uQ.call(Object);function PEe(e){if(!au(e)||Zf(e)!=SEe)return!1;var t=CO(e);if(t===null)return!0;var i=CEe.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&uQ.call(i)==TEe}var DEe=PEe;function BEe(e,t,i){var n=-1,r=e.length;t<0&&(t=-t>r?0:r+t),i=i>r?r:i,i<0&&(i+=r),r=t>i?0:i-t>>>0,t>>>=0;for(var s=Array(r);++n<r;)s[n]=e[n+t];return s}var LEe=BEe;function REe(){this.__data__=new ZM,this.size=0}var IEe=REe;function OEe(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}var FEe=OEe;function NEe(e){return this.__data__.get(e)}var zEe=NEe;function kEe(e){return this.__data__.has(e)}var UEe=kEe,GEe=200;function HEe(e,t){var i=this.__data__;if(i instanceof ZM){var n=i.__data__;if(!Ax||n.length<GEe-1)return n.push([e,t]),this.size=++i.size,this;i=this.__data__=new eE(n)}return i.set(e,t),this.size=i.size,this}var VEe=HEe;function pv(e){var t=this.__data__=new ZM(e);this.size=t.size}pv.prototype.clear=IEe;pv.prototype.delete=FEe;pv.prototype.get=zEe;pv.prototype.has=UEe;pv.prototype.set=VEe;var gA=pv;function jEe(e,t){return e&&S1(t,AO(t),e)}var WEe=jEe;function XEe(e,t){return e&&S1(t,SO(t),e)}var YEe=XEe,hQ=typeof po=="object"&&po&&!po.nodeType&&po,yH=hQ&&typeof mo=="object"&&mo&&!mo.nodeType&&mo,qEe=yH&&yH.exports===hQ,xH=qEe?nl.Buffer:void 0,wH=xH?xH.allocUnsafe:void 0;function QEe(e,t){if(t)return e.slice();var i=e.length,n=wH?wH(i):new e.constructor(i);return e.copy(n),n}var JEe=QEe;function KEe(e,t){for(var i=-1,n=e==null?0:e.length,r=0,s=[];++i<n;){var o=e[i];t(o,i,e)&&(s[r++]=o)}return s}var ZEe=KEe;function $Ee(){return[]}var dQ=$Ee,eCe=Object.prototype,tCe=eCe.propertyIsEnumerable,_H=Object.getOwnPropertySymbols,iCe=_H?function(e){return e==null?[]:(e=Object(e),ZEe(_H(e),function(t){return tCe.call(e,t)}))}:dQ,TO=iCe;function nCe(e,t){return S1(e,TO(e),t)}var rCe=nCe,sCe=Object.getOwnPropertySymbols,oCe=sCe?function(e){for(var t=[];e;)EO(t,TO(e)),e=CO(e);return t}:dQ,fQ=oCe;function aCe(e,t){return S1(e,fQ(e),t)}var lCe=aCe;function cCe(e,t,i){var n=t(e);return Kl(e)?n:EO(n,i(e))}var pQ=cCe;function uCe(e){return pQ(e,AO,TO)}var pB=uCe;function hCe(e){return pQ(e,SO,fQ)}var mQ=hCe,dCe=ep(nl,"DataView"),mB=dCe,fCe=ep(nl,"Promise"),gB=fCe,pCe=ep(nl,"Set"),vB=pCe,bH="[object Map]",mCe="[object Object]",AH="[object Promise]",SH="[object Set]",MH="[object WeakMap]",EH="[object DataView]",gCe=$f(mB),vCe=$f(Ax),yCe=$f(gB),xCe=$f(vB),wCe=$f(fB),kd=Zf;(mB&&kd(new mB(new ArrayBuffer(1)))!=EH||Ax&&kd(new Ax)!=bH||gB&&kd(gB.resolve())!=AH||vB&&kd(new vB)!=SH||fB&&kd(new fB)!=MH)&&(kd=function(e){var t=Zf(e),i=t==mCe?e.constructor:void 0,n=i?$f(i):"";if(n)switch(n){case gCe:return EH;case vCe:return bH;case yCe:return AH;case xCe:return SH;case wCe:return MH}return t});var Sx=kd,_Ce=Object.prototype,bCe=_Ce.hasOwnProperty;function ACe(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&bCe.call(e,"index")&&(i.index=e.index,i.input=e.input),i}var SCe=ACe,MCe=nl.Uint8Array,wS=MCe;function ECe(e){var t=new e.constructor(e.byteLength);return new wS(t).set(new wS(e)),t}var PO=ECe;function CCe(e,t){var i=t?PO(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}var TCe=CCe,PCe=/\w*$/;function DCe(e){var t=new e.constructor(e.source,PCe.exec(e));return t.lastIndex=e.lastIndex,t}var BCe=DCe,CH=ha?ha.prototype:void 0,TH=CH?CH.valueOf:void 0;function LCe(e){return TH?Object(TH.call(e)):{}}var RCe=LCe;function ICe(e,t){var i=t?PO(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var OCe=ICe,FCe="[object Boolean]",NCe="[object Date]",zCe="[object Map]",kCe="[object Number]",UCe="[object RegExp]",GCe="[object Set]",HCe="[object String]",VCe="[object Symbol]",jCe="[object ArrayBuffer]",WCe="[object DataView]",XCe="[object Float32Array]",YCe="[object Float64Array]",qCe="[object Int8Array]",QCe="[object Int16Array]",JCe="[object Int32Array]",KCe="[object Uint8Array]",ZCe="[object Uint8ClampedArray]",$Ce="[object Uint16Array]",eTe="[object Uint32Array]";function tTe(e,t,i){var n=e.constructor;switch(t){case jCe:return PO(e);case FCe:case NCe:return new n(+e);case WCe:return TCe(e,i);case XCe:case YCe:case qCe:case QCe:case JCe:case KCe:case ZCe:case $Ce:case eTe:return OCe(e,i);case zCe:return new n;case kCe:case HCe:return new n(e);case UCe:return BCe(e);case GCe:return new n;case VCe:return RCe(e)}}var iTe=tTe;function nTe(e){return typeof e.constructor=="function"&&!wO(e)?wAe(CO(e)):{}}var rTe=nTe,sTe="[object Map]";function oTe(e){return au(e)&&Sx(e)==sTe}var aTe=oTe,PH=zg&&zg.isMap,lTe=PH?bO(PH):aTe,cTe=lTe,uTe="[object Set]";function hTe(e){return au(e)&&Sx(e)==uTe}var dTe=hTe,DH=zg&&zg.isSet,fTe=DH?bO(DH):dTe,pTe=fTe,mTe=1,gTe=2,vTe=4,gQ="[object Arguments]",yTe="[object Array]",xTe="[object Boolean]",wTe="[object Date]",_Te="[object Error]",vQ="[object Function]",bTe="[object GeneratorFunction]",ATe="[object Map]",STe="[object Number]",yQ="[object Object]",MTe="[object RegExp]",ETe="[object Set]",CTe="[object String]",TTe="[object Symbol]",PTe="[object WeakMap]",DTe="[object ArrayBuffer]",BTe="[object DataView]",LTe="[object Float32Array]",RTe="[object Float64Array]",ITe="[object Int8Array]",OTe="[object Int16Array]",FTe="[object Int32Array]",NTe="[object Uint8Array]",zTe="[object Uint8ClampedArray]",kTe="[object Uint16Array]",UTe="[object Uint32Array]",Ui={};Ui[gQ]=Ui[yTe]=Ui[DTe]=Ui[BTe]=Ui[xTe]=Ui[wTe]=Ui[LTe]=Ui[RTe]=Ui[ITe]=Ui[OTe]=Ui[FTe]=Ui[ATe]=Ui[STe]=Ui[yQ]=Ui[MTe]=Ui[ETe]=Ui[CTe]=Ui[TTe]=Ui[NTe]=Ui[zTe]=Ui[kTe]=Ui[UTe]=!0;Ui[_Te]=Ui[vQ]=Ui[PTe]=!1;function vA(e,t,i,n,r,s){var o,a=t&mTe,l=t&gTe,c=t&vTe;if(i&&(o=r?i(e,n,r,s):i(e)),o!==void 0)return o;if(!Za(e))return e;var h=Kl(e);if(h){if(o=SCe(e),!a)return SAe(e,o)}else{var u=Sx(e),d=u==vQ||u==bTe;if(xS(e))return JEe(e,a);if(u==yQ||u==gQ||d&&!r){if(o=l||d?{}:rTe(e),!a)return l?lCe(e,YEe(o,e)):rCe(e,WEe(o,e))}else{if(!Ui[u])return r?e:{};o=iTe(e,u,a)}}s||(s=new gA);var f=s.get(e);if(f)return f;s.set(e,o),pTe(e)?e.forEach(function(m){o.add(vA(m,t,i,m,e,s))}):cTe(e)&&e.forEach(function(m,v){o.set(v,vA(m,t,i,v,e,s))});var p=c?l?mQ:pB:l?SO:AO,g=h?void 0:p(e);return zAe(g||e,function(m,v){g&&(v=m,m=e[v]),yO(o,v,vA(m,t,i,v,e,s))}),o}var xQ=vA,GTe=1,HTe=4;function VTe(e){return xQ(e,GTe|HTe)}var iE=VTe,jTe="__lodash_hash_undefined__";function WTe(e){return this.__data__.set(e,jTe),this}var XTe=WTe;function YTe(e){return this.__data__.has(e)}var qTe=YTe;function _S(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new eE;++t<i;)this.add(e[t])}_S.prototype.add=_S.prototype.push=XTe;_S.prototype.has=qTe;var QTe=_S;function JTe(e,t){for(var i=-1,n=e==null?0:e.length;++i<n;)if(t(e[i],i,e))return!0;return!1}var KTe=JTe;function ZTe(e,t){return e.has(t)}var $Te=ZTe,e2e=1,t2e=2;function i2e(e,t,i,n,r,s){var o=i&e2e,a=e.length,l=t.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(e),h=s.get(t);if(c&&h)return c==t&&h==e;var u=-1,d=!0,f=i&t2e?new QTe:void 0;for(s.set(e,t),s.set(t,e);++u<a;){var p=e[u],g=t[u];if(n)var m=o?n(g,p,u,t,e,s):n(p,g,u,e,t,s);if(m!==void 0){if(m)continue;d=!1;break}if(f){if(!KTe(t,function(v,x){if(!$Te(f,x)&&(p===v||r(p,v,i,n,s)))return f.push(x)})){d=!1;break}}else if(!(p===g||r(p,g,i,n,s))){d=!1;break}}return s.delete(e),s.delete(t),d}var wQ=i2e;function n2e(e){var t=-1,i=Array(e.size);return e.forEach(function(n,r){i[++t]=[r,n]}),i}var r2e=n2e;function s2e(e){var t=-1,i=Array(e.size);return e.forEach(function(n){i[++t]=n}),i}var o2e=s2e,a2e=1,l2e=2,c2e="[object Boolean]",u2e="[object Date]",h2e="[object Error]",d2e="[object Map]",f2e="[object Number]",p2e="[object RegExp]",m2e="[object Set]",g2e="[object String]",v2e="[object Symbol]",y2e="[object ArrayBuffer]",x2e="[object DataView]",BH=ha?ha.prototype:void 0,U2=BH?BH.valueOf:void 0;function w2e(e,t,i,n,r,s,o){switch(i){case x2e:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case y2e:return!(e.byteLength!=t.byteLength||!s(new wS(e),new wS(t)));case c2e:case u2e:case f2e:return vO(+e,+t);case h2e:return e.name==t.name&&e.message==t.message;case p2e:case g2e:return e==t+"";case d2e:var a=r2e;case m2e:var l=n&a2e;if(a||(a=o2e),e.size!=t.size&&!l)return!1;var c=o.get(e);if(c)return c==t;n|=l2e,o.set(e,t);var h=wQ(a(e),a(t),n,r,s,o);return o.delete(e),h;case v2e:if(U2)return U2.call(e)==U2.call(t)}return!1}var _2e=w2e,b2e=1,A2e=Object.prototype,S2e=A2e.hasOwnProperty;function M2e(e,t,i,n,r,s){var o=i&b2e,a=pB(e),l=a.length,c=pB(t),h=c.length;if(l!=h&&!o)return!1;for(var u=l;u--;){var d=a[u];if(!(o?d in t:S2e.call(t,d)))return!1}var f=s.get(e),p=s.get(t);if(f&&p)return f==t&&p==e;var g=!0;s.set(e,t),s.set(t,e);for(var m=o;++u<l;){d=a[u];var v=e[d],x=t[d];if(n)var w=o?n(x,v,d,t,e,s):n(v,x,d,e,t,s);if(!(w===void 0?v===x||r(v,x,i,n,s):w)){g=!1;break}m||(m=d=="constructor")}if(g&&!m){var b=e.constructor,M=t.constructor;b!=M&&"constructor"in e&&"constructor"in t&&!(typeof b=="function"&&b instanceof b&&typeof M=="function"&&M instanceof M)&&(g=!1)}return s.delete(e),s.delete(t),g}var E2e=M2e,C2e=1,LH="[object Arguments]",RH="[object Array]",ub="[object Object]",T2e=Object.prototype,IH=T2e.hasOwnProperty;function P2e(e,t,i,n,r,s){var o=Kl(e),a=Kl(t),l=o?RH:Sx(e),c=a?RH:Sx(t);l=l==LH?ub:l,c=c==LH?ub:c;var h=l==ub,u=c==ub,d=l==c;if(d&&xS(e)){if(!xS(t))return!1;o=!0,h=!1}if(d&&!h)return s||(s=new gA),o||rQ(e)?wQ(e,t,i,n,r,s):_2e(e,t,l,i,n,r,s);if(!(i&C2e)){var f=h&&IH.call(e,"__wrapped__"),p=u&&IH.call(t,"__wrapped__");if(f||p){var g=f?e.value():e,m=p?t.value():t;return s||(s=new gA),r(g,m,i,n,s)}}return d?(s||(s=new gA),E2e(e,t,i,n,r,s)):!1}var D2e=P2e;function _Q(e,t,i,n,r){return e===t?!0:e==null||t==null||!au(e)&&!au(t)?e!==e&&t!==t:D2e(e,t,i,n,_Q,r)}var B2e=_Q;function L2e(e,t){return e!=null&&t in Object(e)}var R2e=L2e;function I2e(e,t,i){t=fv(t,e);for(var n=-1,r=t.length,s=!1;++n<r;){var o=tE(t[n]);if(!(s=e!=null&&i(e,o)))break;e=e[o]}return s||++n!=r?s:(r=e==null?0:e.length,!!r&&xO(r)&&gO(o,r)&&(Kl(e)||_O(e)))}var O2e=I2e;function F2e(e,t){return e!=null&&O2e(e,t,R2e)}var N2e=F2e,z2e=function(){return nl.Date.now()},G2=z2e,k2e="Expected a function",U2e=Math.max,G2e=Math.min;function H2e(e,t,i){var n,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;if(typeof e!="function")throw new TypeError(k2e);t=lH(t)||0,Za(i)&&(h=!!i.leading,u="maxWait"in i,s=u?U2e(lH(i.maxWait)||0,t):s,d="trailing"in i?!!i.trailing:d);function f(A){var T=n,S=r;return n=r=void 0,c=A,o=e.apply(S,T),o}function p(A){return c=A,a=setTimeout(v,t),h?f(A):o}function g(A){var T=A-l,S=A-c,C=t-T;return u?G2e(C,s-S):C}function m(A){var T=A-l,S=A-c;return l===void 0||T>=t||T<0||u&&S>=s}function v(){var A=G2();if(m(A))return x(A);a=setTimeout(v,g(A))}function x(A){return a=void 0,d&&n?f(A):(n=r=void 0,o)}function w(){a!==void 0&&clearTimeout(a),c=0,n=l=r=a=void 0}function b(){return a===void 0?o:x(G2())}function M(){var A=G2(),T=m(A);if(n=arguments,r=this,l=A,T){if(a===void 0)return p(l);if(u)return clearTimeout(a),a=setTimeout(v,t),f(l)}return a===void 0&&(a=setTimeout(v,t)),o}return M.cancel=w,M.flush=b,M}var DO=H2e;function V2e(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var j2e=V2e;function W2e(e,t){return t.length<2?e:aQ(e,LEe(t,0,-1))}var X2e=W2e;function Y2e(e,t){return B2e(e,t)}var BO=Y2e;function q2e(e,t){return t=fv(t,e),e=X2e(e,t),e==null||delete e[tE(j2e(t))]}var Q2e=q2e;function J2e(e){return DEe(e)?void 0:e}var K2e=J2e,Z2e=1,$2e=2,ePe=4,tPe=cQ(function(e,t){var i={};if(e==null)return i;var n=!1;t=Jq(t,function(s){return s=fv(s,e),n||(n=s.length>1),s}),S1(e,mQ(e),i),n&&(i=xQ(i,Z2e|$2e|ePe,K2e));for(var r=t.length;r--;)Q2e(i,t[r]);return i}),yB=tPe;function iPe(e,t,i,n){if(!Za(e))return e;t=fv(t,e);for(var r=-1,s=t.length,o=s-1,a=e;a!=null&&++r<s;){var l=tE(t[r]),c=i;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(r!=o){var h=a[l];c=n?n(h,l,a):void 0,c===void 0&&(c=Za(h)?h:gO(t[r+1])?[]:{})}yO(a,l,c),a=a[l]}return e}var nPe=iPe;function rPe(e,t,i){for(var n=-1,r=t.length,s={};++n<r;){var o=t[n],a=aQ(e,o);i(a,o)&&nPe(s,fv(o,e),a)}return s}var sPe=rPe;function oPe(e,t){return sPe(e,t,function(i,n){return N2e(e,n)})}var aPe=oPe,lPe=cQ(function(e,t){return e==null?{}:aPe(e,t)}),Mx=lPe,cPe="Expected a function";function uPe(e,t,i){var n=!0,r=!0;if(typeof e!="function")throw new TypeError(cPe);return Za(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),DO(e,t,{leading:n,maxWait:t,trailing:r})}var hPe=uPe;function dPe(e){for(let t of Object.keys(e))e[t]===void 0&&delete e[t];return e}function Uf(e,t){return Object.setPrototypeOf(e,t),e}var fPe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),pPe=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),mPe=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||nE&&"ontouchend"in document,gPe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,vPe=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,yPe=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},xPe=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]};fPe();var nE=pPe(),bQ=mPe(),wPe=gPe(),ho=vPe(),OH=yPe(),FH=Number(xPe());function AQ(e){return Array.isArray(e)?e:[e]}function _Pe(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1;i+=1}return i!==t.length?-1:i!==e.length?1:0}function hb(e){return nE?e.metaKey:e.ctrlKey}var Lt=[],bS={},K0={},yA={};function SQ(e){Lt.includes(e)||Lt.push(e)}function ng(e){delete bS[e.pointerId];for(let t=0;t<Lt.length;t++)if(Lt[t].pointerId===e.pointerId){Lt.splice(t,1);break}}function bPe(){Lt.splice(0,Lt.length)}function AS(e){if(e.pointerType!=="touch")return;let t=bS[e.pointerId];t===void 0&&(t={x:0,y:0},bS[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function H2(e){let t=e.pointerId===Lt[0].pointerId?Lt[1]:Lt[0];return bS[t.pointerId]}function MQ(e){K0[e.key]=!0,yA[e.key]=yA[e.key]===void 0?1:yA[e.key]+1}function EQ(e){if(nE&&K0.Meta)for(let t in K0)K0[t]=!1;else K0[e.key]=!1;yA={}}function APe(e){e.addEventListener("pointerdown",SQ,!0),e.addEventListener("pointerdown",AS,!0),e.addEventListener("pointermove",AS,!0),e.addEventListener("pointerup",ng,!0),e.addEventListener("pointercancel",ng,!0),e.addEventListener("pointerleave",ng,!0),window.addEventListener("keydown",MQ,!0),window.addEventListener("keyup",EQ,!0)}function SPe(e){e.removeEventListener("pointerdown",SQ,!0),e.removeEventListener("pointerdown",AS,!0),e.removeEventListener("pointermove",AS,!0),e.removeEventListener("pointerup",ng,!0),e.removeEventListener("pointercancel",ng,!0),e.removeEventListener("pointerleave",ng,!0),window.removeEventListener("keydown",MQ,!0),window.removeEventListener("keyup",EQ,!0)}var CQ,MPe=new Promise(e=>{CQ=e}),NH=!1;async function EPe(){if(NH)return;let e="https://unpkg.com/@splinetool/navmesh-wasm@0.9.366/build",[t,i]=await Promise.all([y1(()=>import("./navmesh-0b92f809.js"),[]),fetch(`${e}/navmesh.wasm`).then(s=>s.arrayBuffer())]),n=t.default,r=await n({wasmBinary:i});CQ(r),NH=!0}var TQ,CPe=new Promise(e=>{TQ=e}),zH=!1;async function TPe(){if(zH)return;let e=await y1(()=>import("./physics-dee4de67.js"),[]);await e.init(),TQ(e),zH=!0}var zn=class{modifyById(e,t){let i=this;if(i[e]===void 0)throw new Error("not expected");{let n={...i,[e]:t};return Object.setPrototypeOf(n,zn.prototype),n}}add(e,t){var i;return((i=this.runOp({type:1,id:e,data:t}))==null?void 0:i.data)??this}runOp(e){let t=this;if(e.type===1){let i=t[e.id],n;i===void 0?n={type:2,id:e.id}:n={type:1,id:e.id,data:i};let{id:r,data:s}=e,o={...t,[r]:s};return Object.setPrototypeOf(o,zn.prototype),{data:o,actual:e,reverse:n}}else if(e.type===2){let{id:i}=e,n=t[i];if(n===void 0)return null;{let r={...t};return Object.setPrototypeOf(r,zn.prototype),delete r[i],{data:r,actual:e,reverse:{type:1,id:i,data:n}}}}return null}};function LO(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let i of t){let n=e[i];n&&typeof n=="object"&&LO(n)}return Object.freeze(e)}function PPe(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1;i+=1}return i!==t.length?-1:i!==e.length?1:0}var PQ=class extends Error{};function V2(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function uh(e,t,i){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let s=e;e=t,t=s}let n=[],r=1/(i+1);for(let s=0;s<i;s++){let o=e+(t-e)*(s+.75+Math.random()*.5)*r;n.push(o)}return n}function RO(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function DPe(){return typeof process<"u"}function DQ(e,t){for(let i of e)t(i.id,i.data)!==!0&&DQ(i.children,t)}function BQ(e,t){if(t(e.id,e.data)!==!0)for(let i of e.children)BQ(i,t)}var js=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,js.prototype)}deepFreeze(){let e=0;for(;e<this.length;)LO(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let i of e.children)this.fillCaches0(i,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let i=this.parent(e);if(i===t)return!0;e=i}return!1}isDescendantOf(e,t){for(;e;){let i=this.parent(e);if(i===t)return!0;e=i}return!1}data(e){var t;return(t=this.get(e))==null?void 0:t.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return e===null?this:(t=this.get(e))==null?void 0:t.children}traverseFrom(e,t){if(e===null)this.traverse(t);else{let i=this.get(e);i&&BQ(i,t)}}traverse(e){DQ(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let i=this.parent(e),n=this.childrenArray(i),r=n.findIndex(o=>o.id===e);if(r<0)throw new Error("not expected");let s=n[r];return n=[...n],n[r]={...s,data:t},this.modifyArrayBy(i,n)}}modifyArrayBy(e,t){let i=e,n=t;for(;i!==null;){let s=n,o=i;if(i=this.parent(i),i===void 0)throw new Error;n=this.childrenArray(i);let a=n.findIndex(l=>l.id===o);if(a<0)throw new Error;n=[...n],n[a]={...n[a],children:s}}Object.setPrototypeOf(n,js.prototype);let r=n;return r.fillCaches(),r}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec({id:e,children:t}){if(this.get(e)!==void 0)return!0;for(let i of t)if(this.checkDuplicatedIdRec(i))return!0;return!1}addOp(e){let{parent:t,fi:i,id:n,data:r,children:s}=e;if(t!==null&&this.get(t)===void 0||this.checkDuplicatedIdRec(e))return null;{let o=t,a=this.childrenArray(o),l={fi:i,id:n,data:r,children:s};return a=[...a,l],a.sort((c,h)=>c.fi-h.fi),e.localIndex=a.indexOf(l),{data:this.modifyArrayBy(o,a),actual:e,reverse:{type:8,id:n}}}}deleteOp(e){let{id:t}=e;if(this.get(t)===null)return null;{let i=this.parent(t);if(i===void 0)return null;let n=this.childrenArray(i),r=n.findIndex(o=>o.id===t);e.localIndex=r,n=[...n];let s=n.splice(r,1)[0];return{data:this.modifyArrayBy(i,n),actual:e,reverse:{type:7,...s,parent:i}}}}moveOp(e){let{parent:t,fi:i,id:n}=e;if(t!==null&&this.get(t)===void 0)return this.deleteOp({type:8,id:n});if(t!==null){let u=t;for(;u!==null;){if(u===void 0)throw new Error;if(u===n)throw new PQ("cyclic tree");u=this.parent(u)}}let r=this.parent(n);if(r===void 0)return null;let s=r,o=this.childrenArray(r),a=o.findIndex(u=>u.id===n);o=[...o];let l=o.splice(a,1)[0],c=this.modifyArrayBy(r,o);r=t,o=c.childrenArray(r);let h=l.fi;return l={...l,fi:i},o=[...o,l],o.sort((u,d)=>u.fi-d.fi),e.localIndex=o.indexOf(l),c=c.modifyArrayBy(r,o),{data:c,actual:e,reverse:{type:9,parent:s,fi:h,id:n}}}previous(e,t){if(t===null){let n=this.childrenArray(e);return n.length===0?null:n[n.length-1].id}let i=null;for(let n of this.childrenArray(e)){if(n.id===t)return i;i=n.id}return null}traverseSortNext(e){let t=this.parent(e);if(t!==void 0){let i=this.childrenArray(t),n=i.findIndex(r=>r.id===e)+1;if(n<i.length)return i[n].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(t!==void 0){let i=this.childrenArray(t),n=i.findIndex(r=>r.id===e)-1;return n>=0?this.traverseSortPrevious(i[n].id):t}}getAllSorted(e){let t=[];for(let i of e){let n=this.getWithSortKey(i.id);n!==void 0&&t.push({...i,...n})}t.sort((i,n)=>PPe(i.sortKey,n.sortKey));for(let i of t)delete i.sortKey;return t}getWithSortKey(e){var t=e;let i=[],n=this.get(t),r=n;if(n!==void 0){for(;t;)i.splice(0,0,n.fi),t=this.parent(t),t!==null&&(n=this.get(t));return{...r,sortKey:i}}}insertBeforeHelper(e,t,i){return this.insertAfterHelper(e,this.previous(e,t),i)}insertAfterHelper(e,t,i){let n=this.childrenArray(e);if(t===null){if(n.length===0)return uh(0,i,i);{let r=n[0].fi;return uh(r-i,r,i)}}else{let r=this.get(t);if(r===void 0||this.parent(t)!==e)throw new Error("illegal args");let s=n.find(o=>o.fi>r.fi);if(s===void 0){let o=n[n.length-1].fi;return uh(o,o+i,i)}else return uh(r.fi,s.fi,i)}}},SS;(e=>{function t(i,n){if(n.type!==0)return null;if(Array.isArray(i)){let r=n.props,s={},o=[...i],a=!1;if(r)for(let l of Object.keys(r)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");s[l]=o[c],o[c]=r[l],a=!0}return a?{data:o,actual:n,reverse:{type:0,props:s}}:null}else{let r=n.props,s={},o={...i},a=!1;if(r)for(let l of Object.keys(r)){s[l]=o[l];let c=r[l];c===void 0?delete o[l]:o[l]=c,a=!0}return a?{data:o,actual:n,reverse:{type:0,props:s}}:null}}e.runOp=t})(SS||(SS={}));var $t=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,$t.prototype)}deepFreeze(){let e=0;for(;e<this.length;)LO(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return(t=this.get(e))==null?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let i=this,n=i.findIndex(s=>s.id===e);if(n<0)throw new Error("not expected");let r=i[n];return i=[...i],i[n]={...r,data:t},this.modifyArrayBy(i)}}modifyArrayBy(e){Object.setPrototypeOf(e,$t.prototype);let t=e;return DPe()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:i,data:n}=e,r=this,s={fi:t,id:i,data:n};return r=[...r,s],r.sort((o,a)=>o.fi-a.fi),e.localIndex=r.indexOf(s),{data:this.modifyArrayBy(r),actual:e,reverse:{type:5,id:i}}}deleteOp(e){let{id:t}=e,i=this,n=i.findIndex(s=>s.id===t);if(n===-1)return null;e.localIndex=n,i=[...i];let r=i.splice(n,1)[0];return{data:this.modifyArrayBy(i),actual:e,reverse:{type:4,...r}}}moveOp(e){let{fi:t,id:i}=e,n=this;n=[...n];let r=n.findIndex(a=>a.id===i);if(r===-1)return null;let s=n[r].fi,o={...n[r],fi:t};return n[r]=o,n.sort((a,l)=>a.fi-l.fi),e.localIndex=n.indexOf(o),{data:this.modifyArrayBy(n),actual:e,reverse:{type:6,fi:s,id:i}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let i of this){if(i.id===e)return t;t=i.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let i=this;if(e===null){if(i.length===0)return uh(0,t,t);{let n=i[0].fi;return uh(n-t,n,t)}}else{let n=this.get(e);if(n===void 0)throw new Error("illegal args");let r=i.find(s=>s.fi>n.fi);if(r===void 0){let s=i[i.length-1].fi;return uh(s,s+t,t)}else return uh(n.fi,r.fi,t)}}};function kg(e){return e&&typeof e=="object"&&e instanceof Pr}var Pr=class{unusedFunOverridesTable(e){}runOp(e){let t=[],i=this,n=0,r={};for(;n<e.path.length;){if(t.push(i),i=i===void 0?void 0:i[e.path[n]],i!==void 0&&!kg(i))return null;n+=1}i=i?V2(i):new Pr;for(let[a,l]of Object.entries(e.props)){let c=i[a];r[a]=c,l===void 0?delete i[a]:i[a]=l}for(;n>0;){if(Object.keys(i).length===0){let a=t[n-1];a&&(i=V2(a),delete i[e.path[n-1]])}else{let a=t[n-1];if(a){let l=V2(a);l[e.path[n-1]]=i,i=l}else{let l=new Pr;l[e.path[n-1]]=i,i=l}}n-=1}let s=Object.setPrototypeOf(i,Pr.prototype),o={...e,props:r};return{data:s,actual:e,reverse:o}}},Af;(e=>{function t(r,s){return Ex(r,s)??r}e.apply=t;function i(r,s){return OO(r,s)}e.merge=i;function n(r,s){let o=0,a=s.path,l=r;for(;o<a.length&&l!==void 0;){if(l=jl.zoomOnce(l,a[o]),l===void 0)return s;if(!kg(l))return;o+=1}if(l===void 0)return s;if(kg(l))if(s.type===0){let c={...s.props};for(let h of Object.keys(l))delete c[h];return{...s,props:c}}else if(s.type===1||s.type===4||s.type===7){let c=IO([s],l);return c?(console.log(c),c):s}else return s}e.filterOp=n})(Af||(Af={}));function IO(e,t){if(t===void 0)return;let i=!1,n=e.map(r=>{let s=r.id,o=Ex(r.data,t[s]);if(i=i||o!==void 0,o===void 0&&(o=r.data),r.children){let a=IO(r.children,t);return a!==void 0?i=!0:a=r.children,{...r,id:s,data:o,children:a}}else return{...r,id:s,data:o}});if(i)return n}function BPe(e,t){if(t===void 0)return;let i=!1,n=e.map(r=>{let s=r.id,o=Ex(r.data,t[s]);return i=i||o!==void 0,o===void 0&&(o=r.data),{...r,id:s,data:o}});if(i)return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}function Ex(e,t){if(!kg(t))return t;if(e instanceof js){let i=IO(e,t);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}else{if(e instanceof $t)return BPe(e,t);if(Array.isArray(e)){let i=!1,n=e.map((r,s)=>{let o=Ex(r,t[s]);return i=i||o!==void 0,o===void 0&&(o=r),o});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else{if(e instanceof Pr)return OO(e,t);if(e&&typeof e=="object"){let i={},n=!1;for(let[r,s]of Object.entries(e)){let o=Ex(s,t[r]);n=n||o!==void 0,o===void 0&&(o=s),i[r]=o}return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}}}}function OO(e,t){if(e===void 0)return t;if(t===void 0)return e;if(!kg(t))return t;if(!kg(e))return Af.apply(e,t);let i=new Set;for(let r of Object.keys(e))i.add(r);for(let r of Object.keys(t))i.add(r);let n=new Pr;for(let r of i){let s=OO(e===void 0?void 0:e[r],t===void 0?void 0:t[r]);n[r]=s}return n}function LPe(e,t){let i={cur:[],result:[],len:0};return e=Cx(e,t,i)??e,[e,i.result]}function MS(e,t){return e===null?null:(e.cur[e.len]=t,e.len+=1,e)}function ES(e){e&&(e.len-=1)}function RPe(e){if(e===null)return null;e.result.push(e.cur.slice(0,e.len))}function LQ(e,t,i){let n=!1,r=e.map(s=>{let o=s.id,a=t[o];if(a!==void 0&&typeof a=="string"&&(n=!0,o=a,i!==null))throw new Error("not supported");let l=Cx(s.data,t,MS(i,o));ES(i),n=n||l!==void 0,l===void 0&&(l=s.data);let c=LQ(s.children,t,i);return c!==void 0?n=!0:c=s.children,{...s,id:o,data:l,children:c}});if(n)return r}function IPe(e,t,i){let n=!1,r=e.map(s=>{let o=s.id,a=t[o];if(a!==void 0&&typeof a=="string"&&(n=!0,o=a,i!==null))throw new Error("not supported");let l=Cx(s.data,t,MS(i,o));return ES(i),n=n||l!==void 0,l===void 0&&(l=s.data),{...s,id:o,data:l}});if(n)return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}function Cx(e,t,i){if(e instanceof js){let n=LQ(e,t,i);return n!==void 0&&Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}else{if(e instanceof $t)return IPe(e,t,i);if(Array.isArray(e)){let n=!1,r=e.map((s,o)=>{let a=Cx(s,t,MS(i,o));return ES(i),n=n||a!==void 0,a===void 0&&(a=s),a});return n?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}else if(e&&typeof e=="object"&&!RO(e)){let n={},r=!1;for(let[s,o]of Object.entries(e))if(s!=="name"&&s!=="text"){let a=t[s];if(typeof a=="string"){if(i!==null)throw new Error("not supported");r=!0,s=a}let l=Cx(o,t,MS(i,s));ES(i),r=r||l!==void 0,l===void 0&&(l=o),n[s]=l}else n[s]=o;return r?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else if(typeof e=="string"){let n=t[e];if(n!==void 0){if(e.length!==36)throw new Error("for now you should only call this method when the key is a uuid");RPe(i)}return n}else return}}var xB;(e=>{function t(i,n){let r=jl.zoom(n,i.path);if(typeof r=="object"){let s={};for(let o of Object.keys(i.props))s[o]=r[o];return{...i,props:s}}else return{...i,props:{}}}e.replaceProps=t})(xB||(xB={}));var fo;(e=>{function t(l,c){return{...l,path:l.path.slice(c)}}e.drop=t;function i(l,c){var h;return((h=n(l,c))==null?void 0:h.data)??l}e.applySimple=i;function n(l,c){var d,f;let h=c.path;for(var u=[];;){let p;if(l instanceof Pr&&c.type===0&&(p=l.runOp({...c,path:h.slice(u.length)}),p===null&&(p=void 0)),p===void 0&&u.length===h.length&&(l instanceof js||l instanceof $t||l instanceof zn?p=l.runOp(c):p=SS.runOp(l,c)),p!==void 0)if(p!==null){let v=p.data;for(let x=u.length-1;x>=0;x--){let w=h[x],b=u[x];if(b instanceof js){if(typeof w=="number")throw new Error("illegal arg");v=b.modifyById(w,v)}else if(b instanceof $t){if(typeof w=="number")throw new Error("illegal arg");v=b.modifyById(w,v)}else if(b instanceof zn){if(typeof w=="number")throw new Error("illegal arg");v=b.modifyById(w,v)}else if(b instanceof Pr){let M={...b,[w]:v};v=Object.setPrototypeOf(M,Pr.prototype)}else if(typeof b=="object")if(Array.isArray(b)){if(typeof w=="string"&&(w=parseInt(w),isNaN(w)))throw new Error("Invalid path");let M=v;v=[...b],v[w]=M}else v={...b,[w]:v};else return null}return{data:v,actual:{...p.actual,path:h},reverse:{...p.reverse,path:h}}}else return null;let g=h[u.length],m;if(l instanceof js){if(typeof g=="number")throw new Error("");m=(d=l.get(g))==null?void 0:d.data}else if(l instanceof $t){if(typeof g=="number")throw new Error("");m=(f=l.get(g))==null?void 0:f.data}else l!==null&&(m=l[g]);if(m!==void 0)u.push(l),l=m;else return null}}e.apply=n;function r(l,c){for(let h=0;h<l.length&&h<c.length;h++)if(l[h]!==c[h])return!0;return!1}e.pathDisjoint=r;function s(l,c){if(l.length!==c.length)return!1;for(let h=0;h<l.length;h++)if(l[h]!==c[h])return!1;return!0}e.pathEq=s;function o(l,c){return r(l.path,c.path)}e.commutative=o;function a(l,c){return l.type===0&&c.type===0&&s(l.path,c.path)?Object.keys(l.props).every(h=>c.props[h]!==void 0):!1}e.subsumed=a})(fo||(fo={}));var kH;(e=>{function t(){return[]}e.empty=t;function i(c,h){let u=[];for(let d of c){let[f,...p]=d.path;f===h&&u.push({...d,path:p})}return u}e.removePrefix=i;function n(c,h){return c.map(u=>({...u,path:[h,...u.path]}))}e.addPrefix=n;function r(c,h){return[...c,...h]}e.concat=r;function s(c,h){return[...c.filter(u=>!h.some(d=>fo.subsumed(u,d))),...h]}e.compress=s;function o(c,h){return c.every(u=>h.every(d=>fo.commutative(u,d)))}e.commutative=o;function a(c,h){for(let u of h){let d=l(c,u);d!==null&&(c=d.data)}return c}e.applyAll=a;function l(c,h){var u=c;let d=[],f=[];for(let p of h)try{if(p.type===3){let g=jl.zoom(u,[...p.path,p.id]),m=fo.apply(u,{...p,type:2});if(m!==null){u=m.data;let[v,x]=LPe(u,{[p.id]:g});u=v;for(let w of x){let b=w[w.length-1];w.splice(w.length-1,1),d.push({type:0,path:w,props:{[b]:g}}),f.push({type:0,path:w,props:{[b]:p.id}})}f.push(m.reverse),d.push(m.actual)}}else{let g=fo.apply(u,p);g!==null&&(d.push(g.actual),u=g.data,f.push(g.reverse))}}catch(g){if(g instanceof PQ)return null;throw g}return{data:u,actual:d,reverse:f.reverse()}}e.apply=l})(kH||(kH={}));var RQ=Symbol(),OPe=Symbol(),rE=Symbol(),M1=class{reportOp(e,t,i=[]){let n=this;if(t===null)return;n._current=t.data;let r=i;for(;!(n instanceof OQ);){let s=n._path,o=n._current;if(s!==""&&r.splice(0,0,s),n=n._parent,n===null)return;n.update(s,o)}n.push(r,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let i=t[rE];i&&i(),delete this._children[e]}}}},FPe=class extends M1{constructor(e,t,i){super(),this._parent=e,this._path=t,this._current=i}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,SS.runOp(this._current,e),e.path)}},NPe=class extends M1{constructor(e,t,i){super(),this._parent=e,this._path=t,this._current=i}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,zn.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},IQ={get(e,t){if(t===rE)return()=>{e._parent=null};if(t===RQ)return e._current;if(t===OPe)return e;let{_current:i,_children:n}=e;if(t==="push"&&Array.isArray(i))throw new Error("not supported to expand array");let r=n===void 0?void 0:n[t];if(r!==void 0)return r;let s=i[t],o=sE(e,t,s);return o!==s?(n===void 0&&(n={},e._children=n),n[t]=o,o):s},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let i=e._current,n=Reflect.getOwnPropertyDescriptor(i,t);return n&&{writable:!0,configurable:!0,enumerable:n.enumerable,value:i[t]}}},zPe={...IQ,set(e,t,i){let n={type:0,props:{[t]:Qr(i)??i}};return e.deleteChildren(t),e.runOp(n),!0},deleteProperty(e,t){let i={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(i),!0}},kPe={...IQ,set(e,t,i){return i===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:i})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}},FO=class extends M1{constructor(e,t,i){super(),this._children={},this._parent=e,this._path=t,this._current=i,this[rE]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,i)=>{e(t,this.data(t))})}data(e){var o;let{_current:t,_children:i}=this,n=i===void 0?void 0:i[e];if(n!==void 0)return n;let r=(o=t.get(e))==null?void 0:o.data,s=sE(this,e,r);return s!==r?(i===void 0&&(i={},this._children=i),i[e]=s,s):r}add(e,t,i,n,r){this.runOp({type:7,parent:e,fi:t,id:i,data:n,children:r})}move(e,t,i){this.runOp({type:9,parent:e,fi:t,id:i})}insertAfter(e,t,i){let n=this._current.insertAfterHelper(e,t,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.add(e,n[r],s.id,s.data,s.children)}}insertBefore(e,t,i){let n=this._current.insertBeforeHelper(e,t,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.add(e,n[r],s.id,s.data,s.children)}}moveAfter(e,t,i){let n=this._current.insertAfterHelper(e,t,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.move(e,n[r],s)}}moveBefore(e,t,i){let n=this._current.insertBeforeHelper(e,t,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.move(e,n[r],s)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},NO=class extends M1{constructor(e,t,i){super(),this._children={},this._parent=e,this._path=t,this._current=i,this[rE]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let i=0;i<t;i++){let n=this._current[i].id,r=this._current[i].fi;e(this.data(this._current[i].id),n,r)}}find(e){let t=this.length;for(let i=0;i<t;i++){let n=this._current[i].id;if(e(this.data(n),n))return this.get(n)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){var o;let{_current:t,_children:i}=this,n=i===void 0?void 0:i[e];if(n!==void 0)return n;let r=(o=t.get(e))==null?void 0:o.data,s=sE(this,e,r);return s!==r?(i===void 0&&(i={},this._children=i),i[e]=s,s):r}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,i){this.runOp({type:4,fi:e,id:t,data:i})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let i=this._current.insertAfterHelper(e,t.length);for(let n=0;n<t.length;n++){let r=t[n];this.add(i[n],r.id,r.data)}}insertBefore(e,t){let i=this._current.insertBeforeHelper(e,t.length);for(let n=0;n<t.length;n++){let r=t[n];this.add(i[n],r.id,r.data)}}moveAfter(e,t){let i=this._current.insertAfterHelper(e,t.length);for(let n=0;n<t.length;n++){let r=t[n];this.move(i[n],r)}}moveBefore(e,t){let i=this._current.insertBeforeHelper(e,t.length);for(let n=0;n<t.length;n++){let r=t[n];this.move(i[n],r)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function j2(e,t,i){if(e.length>0){let n=e[e.length-1];if(n.type===0&&t.type===0&&jl.equal(n.path,i)){Object.assign(n.props,t.props);return}}e.push({...t,path:i})}var OQ=class extends M1{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,i,n){j2(this.ts,t,e),j2(this.actual,i,e),j2(this.reverse,n,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function sE(e,t,i){return i instanceof js?new FO(e,t,i):i instanceof $t?new NO(e,t,i):i instanceof zn?new Proxy(new NPe(e,t,i),kPe):i!==null&&typeof i=="object"?RO(i)?i:new Proxy(new FPe(e,t,i),zPe):i}function FQ(e){let t=new OQ(e);return[sE(t,"",e),t]}function CS(e,t){let[i,n]=FQ(e);return t(i),n.result()}function Qr(e){return e instanceof FO||e instanceof NO?e._current:e!==null&&typeof e=="object"?e[RQ]:e}var jl;(e=>{function t(s,o){if(o.length===s.length)for(var a=0;a<s.length;){if(s[a]!==o[a])return!1;a+=1}else return!1;return!0}e.equal=t;function i(s,o,a){let l=r(a,s);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...o};return Object.keys(l).forEach(h=>{delete c[h]}),c}else return o}e.removeOverridden=i;function n(s,o){if((s instanceof js||s instanceof FO)&&typeof o=="string"||(s instanceof $t||s instanceof NO)&&typeof o=="string")return s.data(o);if(typeof o=="number"&&Array.isArray(s)||typeof o=="string"&&typeof s=="object"&&s!==null)return s[o]}e.zoomOnce=n;function r(s,o,a=0){for(;a<o.length&&s!==void 0;)s=n(s,o[a]),a+=1;return s}e.zoom=r})(jl||(jl={}));function UPe(e,t){let i=[];if(t.length===e.length)for(var n=0;n<e.length;){if(t[n]==="*")i.push(e[n]);else if(e[n]!==t[n])return null;n+=1}else return null;return i}function nh(e,t){let i=[];if(t.length<=e.length)for(var n=0;n<t.length;){if(t[n]==="*")i.push(e[n]);else if(e[n]!==t[n])return null;n+=1}else return null;return i}var NQ=class{},UH=class extends NQ{constructor(e){super(),this.id=e}},GH=class extends NQ{constructor(e){super(),this.data=e}},wB;try{wB=new TextDecoder}catch{}var dt,Eh,Ce=0,Is={},xi,hh,Xo=0,Rl=0,so,$c,vs=[],bi,HH={useRecords:!1,mapsAsObjects:!0},zQ=class{},kQ=new zQ;kQ.name="MessagePack 0xC1";var Ug=!1,TS=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(dt)return WQ(()=>(bB(),this?this.unpack(e,t):TS.prototype.unpack.call(HH,e,t)));Eh=t>-1?t:e.length,Ce=0,Rl=0,hh=null,so=null,dt=e;try{bi=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(i){throw dt=null,e instanceof Uint8Array?i:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof TS){if(Is=this,this.structures)return xi=this.structures,db();(!xi||xi.length>0)&&(xi=[])}else Is=HH,(!xi||xi.length>0)&&(xi=[]);return db()}unpackMultiple(e,t){let i,n=0;try{Ug=!0;let r=e.length,s=this?this.unpack(e,r):aE.unpack(e,r);if(t){for(t(s);Ce<r;)if(n=Ce,t(db())===!1)return}else{for(i=[s];Ce<r;)n=Ce,i.push(db());return i}}catch(r){throw r.lastPosition=n,r.values=i,r}finally{Ug=!1,bB()}}_mergeStructures(e,t){e=e||[];for(let i=0,n=e.length;i<n;i++){let r=e[i];r&&(r.isShared=!0,i>=32&&(r.highByte=i-32>>5))}e.sharedLength=e.length;for(let i in t||[])if(i>=0){let n=e[i],r=t[i];r&&(n&&((e.restoreStructures||(e.restoreStructures=[]))[i]=n),e[i]=r)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function db(){try{if(!Is.trusted&&!Ug){let t=xi.sharedLength||0;t<xi.length&&(xi.length=t)}let e=vn();if(Ce==Eh)xi.restoreStructures&&VH(),xi=null,dt=null,$c&&($c=null);else if(Ce>Eh){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!Ug)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw xi.restoreStructures&&VH(),bB(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function VH(){for(let e in xi.restoreStructures)xi[e]=xi.restoreStructures[e];xi.restoreStructures=null}function vn(){let e=dt[Ce++];if(e<160)if(e<128){if(e<64)return e;{let t=xi[e&63]||Is.getStructures&&UQ()[e&63];return t?(t.read||(t.read=zO(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,Is.mapsAsObjects){let t={};for(let i=0;i<e;i++)t[HQ()]=vn();return t}else{let t=new Map;for(let i=0;i<e;i++)t.set(vn(),vn());return t}else{e-=144;let t=new Array(e);for(let i=0;i<e;i++)t[i]=vn();return t}else if(e<192){let t=e-160;if(Rl>=Ce)return hh.slice(Ce-Xo,(Ce+=t)-Xo);if(Rl==0&&Eh<140){let i=t<16?kO(t):GQ(t);if(i!=null)return i}return _B(t)}else{let t;switch(e){case 192:return null;case 193:return so?(t=vn(),t>0?so[1].slice(so.position1,so.position1+=t):so[0].slice(so.position0,so.position0-=t)):kQ;case 194:return!1;case 195:return!0;case 196:return W2(dt[Ce++]);case 197:return t=bi.getUint16(Ce),Ce+=2,W2(t);case 198:return t=bi.getUint32(Ce),Ce+=4,W2(t);case 199:return Ed(dt[Ce++]);case 200:return t=bi.getUint16(Ce),Ce+=2,Ed(t);case 201:return t=bi.getUint32(Ce),Ce+=4,Ed(t);case 202:if(t=bi.getFloat32(Ce),Is.useFloat32>2){let i=UO[(dt[Ce]&127)<<1|dt[Ce+1]>>7];return Ce+=4,(i*t+(t>0?.5:-.5)>>0)/i}return Ce+=4,t;case 203:return t=bi.getFloat64(Ce),Ce+=8,t;case 204:return dt[Ce++];case 205:return t=bi.getUint16(Ce),Ce+=2,t;case 206:return t=bi.getUint32(Ce),Ce+=4,t;case 207:return Is.int64AsNumber?(t=bi.getUint32(Ce)*4294967296,t+=bi.getUint32(Ce+4)):t=bi.getBigUint64(Ce),Ce+=8,t;case 208:return bi.getInt8(Ce++);case 209:return t=bi.getInt16(Ce),Ce+=2,t;case 210:return t=bi.getInt32(Ce),Ce+=4,t;case 211:return Is.int64AsNumber?(t=bi.getInt32(Ce)*4294967296,t+=bi.getUint32(Ce+4)):t=bi.getBigInt64(Ce),Ce+=8,t;case 212:if(t=dt[Ce++],t==114)return qH(dt[Ce++]&63);{let i=vs[t];if(i)return i.read?(Ce++,i.read(vn())):i.noBuffer?(Ce++,i()):i(dt.subarray(Ce,++Ce));throw new Error("Unknown extension "+t)}case 213:return t=dt[Ce],t==114?(Ce++,qH(dt[Ce++]&63,dt[Ce++])):Ed(2);case 214:return Ed(4);case 215:return Ed(8);case 216:return Ed(16);case 217:return t=dt[Ce++],Rl>=Ce?hh.slice(Ce-Xo,(Ce+=t)-Xo):HPe(t);case 218:return t=bi.getUint16(Ce),Ce+=2,Rl>=Ce?hh.slice(Ce-Xo,(Ce+=t)-Xo):VPe(t);case 219:return t=bi.getUint32(Ce),Ce+=4,Rl>=Ce?hh.slice(Ce-Xo,(Ce+=t)-Xo):jPe(t);case 220:return t=bi.getUint16(Ce),Ce+=2,WH(t);case 221:return t=bi.getUint32(Ce),Ce+=4,WH(t);case 222:return t=bi.getUint16(Ce),Ce+=2,XH(t);case 223:return t=bi.getUint32(Ce),Ce+=4,XH(t);default:if(e>=224)return e-256;if(e===void 0){let i=new Error("Unexpected end of MessagePack data");throw i.incomplete=!0,i}throw new Error("Unknown MessagePack token "+e)}}}var GPe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function zO(e,t){function i(){if(i.count++>2){let r=e.read=new Function("r","return function(){return {"+e.map(s=>GPe.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(vn);return e.highByte===0&&(e.read=jH(t,e.read)),r()}let n={};for(let r=0,s=e.length;r<s;r++){let o=e[r];n[o]=vn()}return n}return i.count=0,e.highByte===0?jH(t,i):i}var jH=(e,t)=>function(){let i=dt[Ce++];if(i===0)return t();let n=e<32?-(e+(i<<5)):e+(i<<5),r=xi[n]||UQ()[n];if(!r)throw new Error("Record id is not defined for "+n);return r.read||(r.read=zO(r,e)),r.read()};function UQ(){let e=WQ(()=>(dt=null,Is.getStructures()));return xi=Is._mergeStructures(e,xi)}var _B=oE,HPe=oE,VPe=oE,jPe=oE;function oE(e){let t;if(e<16&&(t=kO(e)))return t;if(e>64&&wB)return wB.decode(dt.subarray(Ce,Ce+=e));let i=Ce+e,n=[];for(t="";Ce<i;){let r=dt[Ce++];if(!(r&128))n.push(r);else if((r&224)===192){let s=dt[Ce++]&63;n.push((r&31)<<6|s)}else if((r&240)===224){let s=dt[Ce++]&63,o=dt[Ce++]&63;n.push((r&31)<<12|s<<6|o)}else if((r&248)===240){let s=dt[Ce++]&63,o=dt[Ce++]&63,a=dt[Ce++]&63,l=(r&7)<<18|s<<12|o<<6|a;l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|l&1023),n.push(l)}else n.push(r);n.length>=4096&&(t+=pr.apply(String,n),n.length=0)}return n.length>0&&(t+=pr.apply(String,n)),t}function WH(e){let t=new Array(e);for(let i=0;i<e;i++)t[i]=vn();return t}function XH(e){if(Is.mapsAsObjects){let t={};for(let i=0;i<e;i++)t[HQ()]=vn();return t}else{let t=new Map;for(let i=0;i<e;i++)t.set(vn(),vn());return t}}var pr=String.fromCharCode;function GQ(e){let t=Ce,i=new Array(e);for(let n=0;n<e;n++){let r=dt[Ce++];if((r&128)>0){Ce=t;return}i[n]=r}return pr.apply(String,i)}function kO(e){if(e<4)if(e<2){if(e===0)return"";{let t=dt[Ce++];if((t&128)>1){Ce-=1;return}return pr(t)}}else{let t=dt[Ce++],i=dt[Ce++];if((t&128)>0||(i&128)>0){Ce-=2;return}if(e<3)return pr(t,i);let n=dt[Ce++];if((n&128)>0){Ce-=3;return}return pr(t,i,n)}else{let t=dt[Ce++],i=dt[Ce++],n=dt[Ce++],r=dt[Ce++];if((t&128)>0||(i&128)>0||(n&128)>0||(r&128)>0){Ce-=4;return}if(e<6){if(e===4)return pr(t,i,n,r);{let s=dt[Ce++];if((s&128)>0){Ce-=5;return}return pr(t,i,n,r,s)}}else if(e<8){let s=dt[Ce++],o=dt[Ce++];if((s&128)>0||(o&128)>0){Ce-=6;return}if(e<7)return pr(t,i,n,r,s,o);let a=dt[Ce++];if((a&128)>0){Ce-=7;return}return pr(t,i,n,r,s,o,a)}else{let s=dt[Ce++],o=dt[Ce++],a=dt[Ce++],l=dt[Ce++];if((s&128)>0||(o&128)>0||(a&128)>0||(l&128)>0){Ce-=8;return}if(e<10){if(e===8)return pr(t,i,n,r,s,o,a,l);{let c=dt[Ce++];if((c&128)>0){Ce-=9;return}return pr(t,i,n,r,s,o,a,l,c)}}else if(e<12){let c=dt[Ce++],h=dt[Ce++];if((c&128)>0||(h&128)>0){Ce-=10;return}if(e<11)return pr(t,i,n,r,s,o,a,l,c,h);let u=dt[Ce++];if((u&128)>0){Ce-=11;return}return pr(t,i,n,r,s,o,a,l,c,h,u)}else{let c=dt[Ce++],h=dt[Ce++],u=dt[Ce++],d=dt[Ce++];if((c&128)>0||(h&128)>0||(u&128)>0||(d&128)>0){Ce-=12;return}if(e<14){if(e===12)return pr(t,i,n,r,s,o,a,l,c,h,u,d);{let f=dt[Ce++];if((f&128)>0){Ce-=13;return}return pr(t,i,n,r,s,o,a,l,c,h,u,d,f)}}else{let f=dt[Ce++],p=dt[Ce++];if((f&128)>0||(p&128)>0){Ce-=14;return}if(e<15)return pr(t,i,n,r,s,o,a,l,c,h,u,d,f,p);let g=dt[Ce++];if((g&128)>0){Ce-=15;return}return pr(t,i,n,r,s,o,a,l,c,h,u,d,f,p,g)}}}}}function W2(e){return Is.copyBuffers?Uint8Array.prototype.slice.call(dt,Ce,Ce+=e):dt.subarray(Ce,Ce+=e)}function Ed(e){let t=dt[Ce++];if(vs[t])return vs[t](dt.subarray(Ce,Ce+=e));throw new Error("Unknown extension type "+t)}var YH=new Array(4096);function HQ(){let e=dt[Ce++];if(e>=160&&e<192){if(e=e-160,Rl>=Ce)return hh.slice(Ce-Xo,(Ce+=e)-Xo);if(!(Rl==0&&Eh<180))return _B(e)}else return Ce--,vn();let t=(e<<5^(e>1?bi.getUint16(Ce):e>0?dt[Ce]:0))&4095,i=YH[t],n=Ce,r=Ce+e-3,s,o=0;if(i&&i.bytes==e){for(;n<r;){if(s=bi.getUint32(n),s!=i[o++]){n=1879048192;break}n+=4}for(r+=3;n<r;)if(s=dt[n++],s!=i[o++]){n=1879048192;break}if(n===r)return Ce=n,i.string;r-=3,n=Ce}for(i=[],YH[t]=i,i.bytes=e;n<r;)s=bi.getUint32(n),i.push(s),n+=4;for(r+=3;n<r;)s=dt[n++],i.push(s);let a=e<16?kO(e):GQ(e);return a!=null?i.string=a:i.string=_B(e)}var qH=(e,t)=>{var i=vn();let n=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,i.highByte=t);let r=xi[e];return r&&r.isShared&&((xi.restoreStructures||(xi.restoreStructures=[]))[e]=r),xi[e]=i,i.read=zO(i,n),i.read()},VQ=typeof self=="object"?self:global;vs[0]=()=>{};vs[0].noBuffer=!0;vs[101]=()=>{let e=vn();return(VQ[e[0]]||Error)(e[1])};vs[105]=e=>{let t=bi.getUint32(Ce-4);$c||($c=new Map);let i=dt[Ce],n;i>=144&&i<160||i==220||i==221?n=[]:n={};let r={target:n};$c.set(t,r);let s=vn();return r.used?Object.assign(n,s):(r.target=s,s)};vs[112]=e=>{let t=bi.getUint32(Ce-4),i=$c.get(t);return i.used=!0,i.target};vs[115]=()=>new Set(vn());var jQ=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");vs[116]=e=>{let t=e[0],i=jQ[t];if(!i)throw new Error("Could not find typed array for code "+t);return new VQ[i](Uint8Array.prototype.slice.call(e,1).buffer)};vs[120]=()=>{let e=vn();return new RegExp(e[0],e[1])};vs[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],i=Ce;Ce+=t-4,so=[vn(),vn()],so.position0=0,so.position1=0;let n=Ce;Ce=i;try{return vn()}finally{Ce=n}};vs[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function WQ(e){let t=Eh,i=Ce,n=Xo,r=Rl,s=hh,o=$c,a=so,l=new Uint8Array(dt.slice(0,Eh)),c=xi,h=xi.slice(0,xi.length),u=Is,d=Ug,f=e();return Eh=t,Ce=i,Xo=n,Rl=r,hh=s,$c=o,so=a,dt=l,Ug=d,xi=c,xi.splice(0,xi.length,...h),Is=u,bi=new DataView(dt.buffer,dt.byteOffset,dt.byteLength),f}function bB(){dt=null,$c=null,xi=null}function WPe(e){e.unpack?vs[e.type]=e.unpack:vs[e.type]=e}var UO=new Array(147);for(let e=0;e<256;e++)UO[e]=+("1e"+Math.floor(45.15-e*.30103));var aE=new TS({useRecords:!1});aE.unpack;aE.unpackMultiple;aE.unpack;var XPe=new Float32Array(1);new Uint8Array(XPe.buffer,0,4);var xA;try{xA=new TextEncoder}catch{}var PS,GO,lE=typeof Buffer<"u",X2=lE?Buffer.allocUnsafeSlow:Uint8Array,XQ=lE?Buffer:Uint8Array,QH=lE?4294967296:2144337920,je,Sn,Ie=0,fl,pl=null,YPe=/[\u0080-\uFFFF]/,_0=Symbol("record-id"),YQ=class extends TS{constructor(e){super(e),this.offset=0;let t,i,n,r,s,o=0,a=XQ.prototype.utf8Write?function(A,T,S){return je.utf8Write(A,T,S)}:xA&&xA.encodeInto?function(A,T){return xA.encodeInto(A,je.subarray(T)).written}:!1,l=this;e||(e={});let c=e&&e.sequential,h=e.structures||e.saveStructures,u=e.maxSharedStructures;if(u==null&&(u=h?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=e.maxOwnStructures;d==null&&(d=h?32:64),c&&!e.saveStructures&&(this.structures=[]);let f=u>32||d+u>64,p=u+64,g=u+d+64;if(g>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let m=[],v=0,x=0;this.pack=this.encode=function(A,T){if(je||(je=new X2(8192),Sn=new DataView(je.buffer,0,8192),Ie=0),fl=je.length-10,fl-Ie<2048?(je=new X2(je.length),Sn=new DataView(je.buffer,0,je.length),fl=je.length-10,Ie=0):Ie=Ie+7&2147483640,t=Ie,s=l.structuredClone?new Map:null,l.bundleStrings?(pl=["",""],je[Ie++]=214,je[Ie++]=98,pl.position=Ie-t,Ie+=4):pl=null,i=l.structures,i){i.uninitialized&&(i=l._mergeStructures(l.getStructures()));let S=i.sharedLength||0;if(S>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let C=0;C<S;C++){let P=i[C];if(!P)continue;let B,k=i.transitions;for(let z=0,F=P.length;z<F;z++){let W=P[z];B=k[W],B||(B=k[W]=Object.create(null)),k=B}k[_0]=C+64}o=S}c||(i.nextId=S+64)}n&&(n=!1),r=i||[];try{if(w(A),pl){Sn.setUint32(pl.position+t,Ie-pl.position-t);let S=pl;pl=null,w(S[0]),w(S[1])}if(l.offset=Ie,s&&s.idsToInsert){Ie+=s.idsToInsert.length*6,Ie>fl&&M(Ie),l.offset=Ie;let S=QPe(je.subarray(t,Ie),s.idsToInsert);return s=null,S}return T&JPe?(je.start=t,je.end=Ie,je):je.subarray(t,Ie)}finally{if(i){if(x<10&&x++,v>1e4)i.transitions=null,x=0,v=0,m.length>0&&(m=[]);else if(m.length>0&&!c){for(let S=0,C=m.length;S<C;S++)m[S][_0]=0;m=[]}if(n&&l.saveStructures){let S=i.sharedLength||u;i.length>S&&(i=i.slice(0,S));let C=je.subarray(t,Ie);return l.saveStructures(i,o)===!1?(l._mergeStructures(l.getStructures()),l.pack(A)):(o=S,C)}}T&KPe&&(Ie=t)}};let w=A=>{Ie>fl&&(je=M(Ie));var T=typeof A,S;if(T==="string"){let C=A.length;if(pl&&C>=8&&C<4096){let k=YPe.test(A);pl[k?0:1]+=A,je[Ie++]=193,w(k?-C:C);return}let P;C<32?P=1:C<256?P=2:C<65536?P=3:P=5;let B=C*3;if(Ie+B>fl&&(je=M(Ie+B)),C<64||!a){let k,z,F,W=Ie+P;for(k=0;k<C;k++)z=A.charCodeAt(k),z<128?je[W++]=z:z<2048?(je[W++]=z>>6|192,je[W++]=z&63|128):(z&64512)===55296&&((F=A.charCodeAt(k+1))&64512)===56320?(z=65536+((z&1023)<<10)+(F&1023),k++,je[W++]=z>>18|240,je[W++]=z>>12&63|128,je[W++]=z>>6&63|128,je[W++]=z&63|128):(je[W++]=z>>12|224,je[W++]=z>>6&63|128,je[W++]=z&63|128);S=W-Ie-P}else S=a(A,Ie+P,B);S<32?je[Ie++]=160|S:S<256?(P<2&&je.copyWithin(Ie+2,Ie+1,Ie+1+S),je[Ie++]=217,je[Ie++]=S):S<65536?(P<3&&je.copyWithin(Ie+3,Ie+2,Ie+2+S),je[Ie++]=218,je[Ie++]=S>>8,je[Ie++]=S&255):(P<5&&je.copyWithin(Ie+5,Ie+3,Ie+3+S),je[Ie++]=219,Sn.setUint32(Ie,S),Ie+=4),Ie+=S}else if(T==="number")if(A>>>0===A)A<64?je[Ie++]=A:A<256?(je[Ie++]=204,je[Ie++]=A):A<65536?(je[Ie++]=205,je[Ie++]=A>>8,je[Ie++]=A&255):(je[Ie++]=206,Sn.setUint32(Ie,A),Ie+=4);else if(A>>0===A)A>=-32?je[Ie++]=256+A:A>=-128?(je[Ie++]=208,je[Ie++]=A+256):A>=-32768?(je[Ie++]=209,Sn.setInt16(Ie,A),Ie+=2):(je[Ie++]=210,Sn.setInt32(Ie,A),Ie+=4);else{let C;if((C=this.useFloat32)>0&&A<4294967296&&A>=-2147483648){je[Ie++]=202,Sn.setFloat32(Ie,A);let P;if(C<4||(P=A*UO[(je[Ie]&127)<<1|je[Ie+1]>>7])>>0===P){Ie+=4;return}else Ie--}je[Ie++]=203,Sn.setFloat64(Ie,A),Ie+=8}else if(T==="object")if(!A)je[Ie++]=192;else{if(s){let P=s.get(A);if(P){if(!P.id){let B=s.idsToInsert||(s.idsToInsert=[]);P.id=B.push(P)}je[Ie++]=214,je[Ie++]=112,Sn.setUint32(Ie,P.id),Ie+=4;return}else s.set(A,{offset:Ie-t})}let C=A.constructor;if(C===Object)b(A,!0);else if(C===Array){S=A.length,S<16?je[Ie++]=144|S:S<65536?(je[Ie++]=220,je[Ie++]=S>>8,je[Ie++]=S&255):(je[Ie++]=221,Sn.setUint32(Ie,S),Ie+=4);for(let P=0;P<S;P++)w(A[P])}else if(C===Map){S=A.size,S<16?je[Ie++]=128|S:S<65536?(je[Ie++]=222,je[Ie++]=S>>8,je[Ie++]=S&255):(je[Ie++]=223,Sn.setUint32(Ie,S),Ie+=4);for(let[P,B]of A)w(P),w(B)}else{for(let P=0,B=PS.length;P<B;P++){let k=GO[P];if(A instanceof k){let z=PS[P];if(z.write){z.type&&(je[Ie++]=212,je[Ie++]=z.type,je[Ie++]=0),w(z.write.call(this,A));return}let F=je,W=Sn,K=Ie;je=null;let Z;try{Z=z.pack.call(this,A,U=>(je=F,F=null,Ie+=U,Ie>fl&&M(Ie),{target:je,targetView:Sn,position:Ie-U}),w)}finally{F&&(je=F,Sn=W,Ie=K,fl=je.length-10)}Z&&(Z.length+Ie>fl&&M(Z.length+Ie),Ie=qPe(Z,je,Ie,z.type));return}}b(A,!A.hasOwnProperty)}}else if(T==="boolean")je[Ie++]=A?195:194;else if(T==="bigint"){if(A<BigInt(1)<<BigInt(63)&&A>=-(BigInt(1)<<BigInt(63)))je[Ie++]=211,Sn.setBigInt64(Ie,A);else if(A<BigInt(1)<<BigInt(64)&&A>0)je[Ie++]=207,Sn.setBigUint64(Ie,A);else if(this.largeBigIntToFloat)je[Ie++]=203,Sn.setFloat64(Ie,Number(A));else throw new RangeError(A+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");Ie+=8}else if(T==="undefined")this.encodeUndefinedAsNil?je[Ie++]=192:(je[Ie++]=212,je[Ie++]=0,je[Ie++]=0);else if(T==="function")w(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+T)},b=this.useRecords===!1?this.variableMapSize?A=>{let T=Object.keys(A),S=T.length;S<16?je[Ie++]=128|S:S<65536?(je[Ie++]=222,je[Ie++]=S>>8,je[Ie++]=S&255):(je[Ie++]=223,Sn.setUint32(Ie,S),Ie+=4);let C;for(let P=0;P<S;P++)w(C=T[P]),w(A[C])}:(A,T)=>{je[Ie++]=222;let S=Ie-t;Ie+=2;let C=0;for(let P in A)(T||A.hasOwnProperty(P))&&(w(P),w(A[P]),C++);je[S+++t]=C>>8,je[S+t]=C&255}:A=>{let T=Object.keys(A),S,C=r.transitions||(r.transitions=Object.create(null)),P=0;for(let k=0,z=T.length;k<z;k++){let F=T[k];S=C[F],S||(S=C[F]=Object.create(null),P++),C=S}let B=C[_0];if(B)B>=96&&f?(je[Ie++]=((B-=96)&31)+96,je[Ie++]=B>>5):je[Ie++]=B;else{B=r.nextId,B||(B=64),B<p&&this.shouldShareStructure&&!this.shouldShareStructure(T)?(B=r.nextOwnId,B<g||(B=p),r.nextOwnId=B+1):(B>=g&&(B=p),r.nextId=B+1);let k=T.highByte=B>=96&&f?B-96>>5:-1;C[_0]=B,r[B-64]=T,B<p?(T.isShared=!0,r.sharedLength=B-63,n=!0,k>=0?(je[Ie++]=(B&31)+96,je[Ie++]=k):je[Ie++]=B):(k>=0?(je[Ie++]=213,je[Ie++]=114,je[Ie++]=(B&31)+96,je[Ie++]=k):(je[Ie++]=212,je[Ie++]=114,je[Ie++]=B),P&&(v+=x*P),m.length>=d&&(m.shift()[_0]=0),m.push(C),w(T))}for(let k=0,z=T.length;k<z;k++)w(A[T[k]])},M=A=>{let T;if(A>16777216){if(A-t>QH)throw new Error("Packed buffer would be larger than maximum buffer size");T=Math.min(QH,Math.round(Math.max((A-t)*(A>67108864?1.25:2),4194304)/4096)*4096)}else T=(Math.max(A-t<<2,je.length-1)>>12)+1<<12;let S=new X2(T);return Sn=new DataView(S.buffer,0,T),je.copy?je.copy(S,0,t,A):S.set(je.slice(t,A)),Ie-=t,t=0,fl=S.length-10,je=S}}useBuffer(e){je=e,Sn=new DataView(je.buffer,je.byteOffset,je.byteLength),Ie=0}};GO=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,zQ];PS=[{pack(e,t,i){let n=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&n>=0&&n<4294967296){let{target:r,targetView:s,position:o}=t(6);r[o++]=214,r[o++]=255,s.setUint32(o,n)}else if(n>0&&n<17179869184){let{target:r,targetView:s,position:o}=t(10);r[o++]=215,r[o++]=255,s.setUint32(o,e.getMilliseconds()*4e6+(n/1e3/4294967296>>0)),s.setUint32(o+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return t(0),i(this.onInvalidDate());let{target:r,targetView:s,position:o}=t(3);r[o++]=212,r[o++]=255,r[o++]=255}else{let{target:r,targetView:s,position:o}=t(15);r[o++]=199,r[o++]=12,r[o++]=255,s.setUint32(o,e.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(n)))}}},{pack(e,t,i){let n=Array.from(e),{target:r,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=115,r[s++]=0),i(n)}},{pack(e,t,i){let{target:n,position:r}=t(this.structuredClone?3:0);this.structuredClone&&(n[r++]=212,n[r++]=101,n[r++]=0),i([e.name,e.message])}},{pack(e,t,i){let{target:n,position:r}=t(this.structuredClone?3:0);this.structuredClone&&(n[r++]=212,n[r++]=120,n[r++]=0),i([e.source,e.flags])}},{pack(e,t){this.structuredClone?JH(e,16,t):KH(lE?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let i=e.constructor;i!==XQ&&this.structuredClone?JH(e,jQ.indexOf(i.name),t):KH(e,t)}},{pack(e,t){let{target:i,position:n}=t(1);i[n]=193}}];function JH(e,t,i,n){let r=e.byteLength;if(r+1<256){var{target:s,position:o}=i(4+r);s[o++]=199,s[o++]=r+1}else if(r+1<65536){var{target:s,position:o}=i(5+r);s[o++]=200,s[o++]=r+1>>8,s[o++]=r+1&255}else{var{target:s,position:o,targetView:a}=i(7+r);s[o++]=201,a.setUint32(o,r+1),o+=4}s[o++]=116,s[o++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),o)}function KH(e,t){let i=e.byteLength;var n,r;if(i<256){var{target:n,position:r}=t(i+2);n[r++]=196,n[r++]=i}else if(i<65536){var{target:n,position:r}=t(i+3);n[r++]=197,n[r++]=i>>8,n[r++]=i&255}else{var{target:n,position:r,targetView:s}=t(i+5);n[r++]=198,s.setUint32(r,i),r+=4}n.set(e,r)}function qPe(e,t,i,n){let r=e.length;switch(r){case 1:t[i++]=212;break;case 2:t[i++]=213;break;case 4:t[i++]=214;break;case 8:t[i++]=215;break;case 16:t[i++]=216;break;default:r<256?(t[i++]=199,t[i++]=r):r<65536?(t[i++]=200,t[i++]=r>>8,t[i++]=r&255):(t[i++]=201,t[i++]=r>>24,t[i++]=r>>16&255,t[i++]=r>>8&255,t[i++]=r&255)}return t[i++]=n,t.set(e,i),i+=r,i}function QPe(e,t){let i,n=t.length*6,r=e.length-n;for(t.sort((s,o)=>s.offset>o.offset?1:-1);i=t.pop();){let s=i.offset,o=i.id;e.copyWithin(s+n,s,r),n-=6;let a=s+n;e[a++]=214,e[a++]=105,e[a++]=o>>24,e[a++]=o>>16&255,e[a++]=o>>8&255,e[a++]=o&255,r=s}return e}function mv(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");GO.unshift(e.Class),PS.unshift(e)}WPe(e)}var qQ=new YQ({useRecords:!1});qQ.pack;qQ.pack;var JPe=512,KPe=1024,ZH=new YQ({structuredClone:!0});mv({Class:zn.prototype.constructor,type:1,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,zn.prototype),e}});mv({Class:$t.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,$t.prototype),e}});mv({Class:js.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,js.prototype),e}});mv({Class:UH.prototype.constructor,type:4,write(e){return e.id},read(e){return new UH(e)}});mv({Class:GH.prototype.constructor,type:5,write(e){return e.data},read(e){return new GH(e)}});mv({Class:Pr.prototype.constructor,type:6,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Pr.prototype),e}});function ZPe(e){var t=0;if(e.length===0)return t;for(let i=0;i<e.length;i++){let n=e[i];t=(t<<5)-t+n,t=t&t}return t}function AB(e){if(RO(e))return e;if(Array.isArray(e))return e.map(AB);if(typeof e=="object"&&e!==null){let t={};for(let i of Object.keys(e).sort())t[i]=AB(e[i]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var SB;(e=>{function t(r){return ZH.pack(r)}e.serialize=t;function i(r){return ZH.unpack(r)}e.deserialize=i;function n(r){return ZPe(t(AB(r))).toString()}e.checksum=n})(SB||(SB={}));var Iu={LookAt:[],Follow:["Create"],DragDrop:["Transition","Audio","Create"],MouseHover:["Transition","Create","Destroy","SwitchCamera"],Scroll:["Transition","Create"],Start:["Transition","Audio","Video","Create","Destroy","SwitchCamera"],Conditional:["Transition","Audio","Video","Create","Destroy","SwitchCamera","Reset"],MouseDown:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],MouseUp:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],MousePress:["Transition","SwitchCamera","Audio","Video","Link","Create","Reset"],KeyDown:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],KeyUp:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],KeyPress:["Transition","SwitchCamera","Audio","Video","Link","Create","Reset"],GameControl:["Transition","Audio","Video","Create"],Collision:["Transition","Audio","Video","Create","Destroy","Reset"]},$H;(e=>{function t(n){return n.type==="MouseDown"||n.type==="MouseUp"||n.type==="MousePress"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="KeyPress"}e.is=t;function i(n){return n==="MouseDown"||n==="MouseUp"||n==="MousePress"?{type:n,mode:"Object",disabled:!1,toggle:!1,actions:new $t}:{type:n,disabled:!1,key:void 0,toggle:!1,actions:new $t}}e.defaultData=i})($H||($H={}));var DS;(e=>{function t(i){return{type:"Property",value:[i??null,"position","x"]}}e.propertyDefaultData=t,e.valueDefaultData={type:"Literal",value:0}})(DS||(DS={}));var MB;(e=>{function t(r){return{type:"Comparison",operator:"==",lOperand:DS.propertyDefaultData(r),rOperand:{...DS.valueDefaultData}}}e.comparisonDefaultData=t;function i(r){return{type:"Distance",toObject:r??null,fromObject:r??null,distance:200}}e.distanceDefaultData=i;function n(r,s){return{type:"State",object:r??null,state:s??null}}e.stateDefaultData=n})(MB||(MB={}));var eV;(e=>{function t(n){return n.type==="Conditional"}e.is=t;function i(n){return{type:"Conditional",disabled:!1,inActions:new $t,outActions:new $t,condition:MB.distanceDefaultData(n)}}e.defaultData=i})(eV||(eV={}));var tV;(e=>e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new $t,drop:new $t}})(tV||(tV={}));var EB;(e=>e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new $t})(EB||(EB={}));var CB;(e=>e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(CB||(CB={}));var iV;(e=>{function t(n){return n.type==="MouseHover"}e.is=t;function i(){return{type:"MouseHover",disabled:!1,actions:new $t}}e.defaultData=i})(iV||(iV={}));var nV;(e=>{function t(n){return n.type==="Scroll"}e.is=t;function i(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new $t}}e.defaultData=i})(nV||(nV={}));var rV;(e=>{function t(n){return n.type==="Start"}e.is=t;function i(){return{type:"Start",disabled:!1,actions:new $t}}e.defaultData=i})(rV||(rV={}));var sV;(e=>{function t(n){return n.type==="Collision"}e.is=t;function i(){return{type:"Collision",disabled:!1,toggle:!1,target:"character",actions:new $t}}e.defaultData=i})(sV||(sV={}));var km;(e=>{function t(n,r){return n[0]===r[0]&&n[1]===r[1]}e.isEqual=t;function i(n,r,s){return[n[0]+(r[0]-n[0])*s,n[1]+(r[1]-n[1])*s]}e.lerp=i})(km||(km={}));var Sf;(e=>{function t(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}e.isEqual=t;function i(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}e.add=i;function n(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}e.sub=n;function r(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}e.div=r;function s(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}e.mul=s;function o(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}e.dist=o;function a(l,c,h){return[l[0]+(c[0]-l[0])*h,l[1]+(c[1]-l[1])*h,l[2]+(c[2]-l[2])*h]}e.lerp=a})(Sf||(Sf={}));var BS;(e=>{function t(n,r){return n[0]===r[0]&&n[1]===r[1]&&n[2]===r[2]&&n[3]===r[3]}e.isEqual=t;function i(n,r,s){return[n[0]+(r[0]-n[0])*s,n[1]+(r[1]-n[1])*s,n[2]+(r[2]-n[2])*s,n[3]+(r[3]-n[3])*s]}e.lerp=i})(BS||(BS={}));var Gg;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(r,s){for(let o=0;o<16;o++)if(r[o]!==s[o])return!1;return!0}e.isEqual=t;function i(r){return r??e.identity}e.simplify=i;function n(r,s){let o=s.slice(0);for(var a=0,l=s.length;a<l;a+=3){let c=r[3]*s[a]+r[7]*s[a+1]+r[11]*s[a+2]+r[15];o[a]=(r[0]*s[a]+r[4]*s[a+1]+r[8]*s[a+2]+r[12])/c,o[a+1]=(r[1]*s[a]+r[5]*s[a+1]+r[9]*s[a+2]+r[13])/c,o[a+2]=(r[2]*s[a]+r[6]*s[a+1]+r[10]*s[a+2]+r[14])/c}return o}e.applyMatrix4=n})(Gg||(Gg={}));var Wr;(e=>{function t(l){return typeof l=="object"&&typeof l.r=="number"&&typeof l.g=="number"&&typeof l.b=="number"}e.isRGB=t,e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function i(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:1}}e.toRgb255a1=i;function n(l){return{r:l.r,g:l.g,b:l.b}}e.clone=n;function r(l){return l=Math.floor(l),{r:(l>>16&255)/255,g:(l>>8&255)/255,b:(l&255)/255}}e.fromHex=r;function s(l){return Math.round(l.r*255)*65536+Math.round(l.g*255)*256+Math.round(l.b*255)}e.toHex=s;function o(l,c){return l.r===c.r&&l.g===c.g&&l.b===c.b}e.equals=o;function a(l,c,h){return{r:l.r+(c.r-l.r)*h,g:l.g+(c.g-l.g)*h,b:l.b+(c.b-l.b)*h}}e.lerp=a})(Wr||(Wr={}));var ea;(e=>{e.white={...Wr.white,a:1},e.transparent={...Wr.white,a:0};function t(o){return{r:o[0],g:o[1],b:o[2],a:o[3]}}e.from0to1=t;function i(o,a){return{...Wr.fromHex(o),a}}e.fromHexAndA=i;function n(o){return{r:Math.round(o.r*255),g:Math.round(o.g*255),b:Math.round(o.b*255),a:o.a}}e.toRgb255a1=n;function r(o,a){return Wr.equals(o,a)&&o.a===a.a}e.equals=r;function s(o,a,l){return{r:o.r+(a.r-o.r)*l,g:o.g+(a.g-o.g)*l,b:o.b+(a.b-o.b)*l,a:o.a+(a.a-o.a)*l}}e.lerp=s})(ea||(ea={}));var TB;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(TB||(TB={}));var oV;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(oV||(oV={}));var aV;(e=>e.defaultData={control1:[.5,0],control2:[.5,1]})(aV||(aV={}));var Zu;(e=>(e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]))(Zu||(Zu={}));var Gf;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(i){return e.all.includes(i)}e.is=t})(Gf||(Gf={}));var Tx;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1,autoZoom:!1,autoZoomFrustumSize:790},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(i){return i.type==="PerspectiveCamera"?i.perspective.zoom:i.orthographic.zoom}e.getZoom=t})(Tx||(Tx={}));var dh;(e=>{function t(n,r=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(n[0],n[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[n[0]+n[0]*r,0,0]},grid:{count:[2,2,2],size:n.map(s=>s*(1+r)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}e.defaultData=t;function i(n,r){let s={...n};if(QQ.forEach(o=>{Object.assign(s,{[o]:r[o]??n[o]})}),s.radial={...n.radial},r.radial){let o=n.radial,a=r.radial;JQ.forEach(l=>{Object.assign(s.radial,{[l]:a[l]??o[l]})})}if(s.linear={...n.linear},r.linear){let o=n.linear,a=r.linear;KQ.forEach(l=>{Object.assign(s.linear,{[l]:a[l]??o[l]})})}if(s.grid={...n.grid},r.grid){let o=n.grid,a=r.grid;ZQ.forEach(l=>{Object.assign(s.grid,{[l]:a[l]??o[l]})})}if(s.toObject={...n.toObject},r.toObject){let o=n.toObject,a=r.toObject;$Q.forEach(l=>{Object.assign(s.toObject,{[l]:a[l]??o[l]})})}if(s.randomnessObject={...n.randomnessObject},r.randomnessObject){let o=n.randomnessObject,a=r.randomnessObject;eJ.forEach(l=>{Object.assign(s.randomnessObject,{[l]:a[l]??o[l]})})}return s}e.merge=i})(dh||(dh={}));var PB;(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];function i(n,r){let s=[];n.count!==void 0&&s.push({type:0,path:r,props:{count:n.count}});for(let o of t){let a=n[o];a&&Object.keys(a).length>0&&s.push({type:0,path:[...r,o],props:a})}return s}e.toOps=i})(PB||(PB={}));var QQ=["count"],JQ=["radius","start","end","position","scale","rotation"],KQ=["position","scale","rotation"],ZQ=["count","size"],$Q=["count","position","scale","rotation"],eJ=["strength","scale","rotation","position","movement","seed","freqScale"],Px;(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focalLength:2,focusDistance:2,bokehScale:2},noise:{...t,blendFunction:16}}})(Px||(Px={}));var DB;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(i){return e.all.includes(i)}e.is=t})(DB||(DB={}));var BB;(e=>{function t(n){return i(n)}e.defaultData=t;function i(n){if(n==="PointLight")return{type:n,color:ea.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,depth:1e5};if(n==="SpotLight")return{type:n,color:ea.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,shadowResolution:1024,shadowRadius:1};if(n==="DirectionalLight")return{type:n,color:ea.white,intensity:1,shadows:!0,size:2e3,depth:1e5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(BB||(BB={}));var LB;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(i,n){return i.castShadow===n.castShadow&&i.receiveShadow===n.receiveShadow}e.equals=t})(LB||(LB={}));var RB;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(i,n){return i.flatShading===n.flatShading&&i.side===n.side&&i.wireframe===n.wireframe}e.equals=t})(RB||(RB={}));var IB;(e=>e.defaultData={...RB.defaultData,...LB.defaultData})(IB||(IB={}));var LS;(e=>(e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7))(LS||(LS={}));var lV;(e=>{function t(i){return i==="texture"||i==="video"||i==="color"||i==="depth"||i==="normal"||i==="gradient"||i==="noise"||i==="fresnel"||i==="rainbow"||i==="toon"||i==="outline"||i==="transmission"||i==="matcap"||i==="displace"||i==="pattern"||i==="light"}e.is=t})(lV||(lV={}));function $Pe(e){return e.type!=="displace"}var cV;(e=>{function t(i){return i==="phong"||i==="toon"||i==="lambert"||i==="physical"}e.is=t})(cV||(cV={}));var tJ=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],eDe=["wrapping","image","video"],Qo;(e=>{function t(s,o){let{texture:a,...l}=o;if(Object.assign(s,l),a){let c=s.texture;c&&Object.assign(c,a)}}e.patch=t;function i(s,o){return s==="light"&&o?n(o):r(s)}e.defaultData=i;function n(s){let o={mode:0,isMask:!1,visible:!0};switch(s){case"phong":return{...o,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...o,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...o,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...o,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function r(s){let o={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...o,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{...o,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:LS.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!1};case"color":return{...o,type:"color",color:Wr.fromHex(5526619)};case"depth":return{...o,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...o,type:"normal",cnormal:[1,1,1]};case"gradient":return{...o,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...o,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...Wr.fromHex(6710886),a:1},colorB:{...Wr.fromHex(6710886),a:1},colorC:{...Wr.fromHex(16777215),a:1},colorD:{...Wr.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...o,type:"fresnel",color:ea.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...o,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...o,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:ea.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...o,type:"outline",outlineColor:ea.fromHexAndA(0,1),contourColor:ea.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...o,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{...o,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...o,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...Wr.fromHex(0),a:1},colorB:{...Wr.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(Qo||(Qo={}));var yo;(e=>{function t(c){return!c.layers.some(h=>h.data.type==="texture"&&h.data.projection!==0||h.data.type==="depth"&&!h.data.isWorldSpace||h.data.type==="noise"||h.data.type==="displace")}e.isMergable=t;function i(c){let h="";return c.layers.forEach(u=>{Object.entries(u.data).forEach(([d,f])=>{h+=`${d}${f}`,Array.isArray(f)?f.forEach(p=>h+=`${p}`):typeof f=="object"?Object.values(f).forEach(p=>{typeof p=="number"?h+=`${p.toFixed(4)}`:h+=`${p}`}):h+=`${f}`})}),h}e.getHash=i;function n(){return{layers:new $t}}e.defaultEmptyData=n;function r(c="layer1",h="layer2"){return o("phong",c,h)}e.defaultData=r;function s(c,h){return{...c,name:h}}e.withName=s;function o(c,h="layer1",u="layer2"){let d=new $t;return d.push({fi:0,data:Qo.defaultData("light",c),id:h}),d.push({fi:1,data:Qo.defaultData("color"),id:u}),{layers:d}}e.defaultTwoLayerData=o;function a(c,h="phong",u="layer1",d="layer2"){let f=Qo.defaultData("texture");Object.assign(f.texture,{image:c});let p=new $t;return p.push({fi:0,data:f,id:u}),p.push({fi:1,data:Qo.defaultData("light",h),id:d}),{layers:p}}e.defaultTwoLayerTextureData=a;function l(c,h="phong",u="layer1",d="layer2"){let f=Qo.defaultData("video");Object.assign(f.texture,{video:c});let p=new $t;return p.push({fi:0,data:f,id:u}),p.push({fi:1,data:Qo.defaultData("light",h),id:d}),{layers:p}}e.defaultTwoLayerVideoTextureData=l})(yo||(yo={}));var RS;(e=>{function t(){return{points:new $t,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(RS||(RS={}));var IS;(e=>{function t(){return{points:new $t,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}e.defaultData=t})(IS||(IS={}));var iJ={type:"Ellipse",width:100,height:100,spikes:64,angle:360,innerRadius:0},OB;(e=>{function t(i,n){let r={...i};return rJ.forEach(s=>{Object.assign(r,{[s]:n[s]??i[s]})}),r}e.merge=t})(OB||(OB={}));var nJ={shape:iJ,depth:1,offset:0,bevel:0,bevelSides:1,angle:0,twist:0,startScale:1,endScale:1},rJ=["depth","offset","angle","twist","startScale","endScale"],OS;(e=>{function t(n){return n==="PolygonGeometry"||n==="RectangleGeometry"||n==="StarGeometry"||n==="TriangleGeometry"||n==="EllipseGeometry"}e.is2DParametricMesh=t;function i(n){return n==="PolygonGeometry"||n==="PolygonGeometry"||n==="RectangleGeometry"||n==="StarGeometry"||n==="TriangleGeometry"||n==="EllipseGeometry"||n==="PathGeometry"||n==="VectorGeometry"||n==="ConeGeometry"||n==="CubeGeometry"||n==="CylinderGeometry"||n==="DodecahedronGeometry"||n==="HelixGeometry"||n==="IcosahedronGeometry"||n==="LatheGeometry"||n==="PyramidGeometry"||n==="SphereGeometry"||n==="PlaneGeometry"||n==="BackdropGeometry"||n==="TorusGeometry"||n==="TorusKnotGeometry"||n==="BooleanGeometry"||n==="TextGeometry"}e.isParametricMesh=i})(OS||(OS={}));var FB;(e=>{function t(i,n){let r={...i};return Object.assign(r,n),r.type==="PathGeometry"&&"extrusion"in n&&n.extrusion&&(r.extrusion={...i.extrusion},Object.assign(r.extrusion,OB.merge(r.extrusion,n.extrusion))),r}e.merge=t})(FB||(FB={}));var rg;(e=>{function t(i){if(i==="RectangleGeometry")return{width:320,height:320,type:i,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="PathGeometry")return{type:i,width:1,height:1,depth:1,path:IS.defaultData(),extrusion:nJ};if(i==="VectorGeometry")return{width:1,height:1,type:i,subdivisions:12,shape:RS.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="BooleanGeometry")return{type:i,operation:2,width:0,height:0,depth:0,phongAngle:35};if(i==="TextGeometry")return{type:i,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:"",textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI};throw new Error("not implemented")}e.defaultData=t})(rg||(rg={}));var uV=["width","height","depth"],hV;(e=>{function t(n){return n==="Component"||n==="Instance"}e.isComponentRelated=t;function i(n){return n==="Empty"||n==="Instance"}e.isEmptyOrComponent=i})(hV||(hV={}));var Hg;(e=>{e.identity={...TB.identity,hiddenMatrix:Gg.identity};function t(r){return{position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix}}e.fromObject=t;function i(r,s){return{position:(s==null?void 0:s.position)||r.position,rotation:(s==null?void 0:s.rotation)||r.rotation,scale:(s==null?void 0:s.scale)||r.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||r.hiddenMatrix}}e.merge=i;function n(r,s){return dPe({position:Sf.isEqual(r.position,s.position)?void 0:s.position,rotation:Sf.isEqual(r.rotation,s.rotation)?void 0:s.rotation,scale:Sf.isEqual(r.scale,s.scale)?null:s.scale,hiddenMatrix:Gg.isEqual(r.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}e.diff=n})(Hg||(Hg={}));var dV;(e=>e.defaultData={fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(dV||(dV={}));var ra;(e=>e.defaultData={states:new $t,events:new $t,visible:!0,raycastLock:!1,collision:"visibility",physics:null,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...Hg.identity,cloner:null})(ra||(ra={}));var fV;(e=>e.defaultData={type:"Empty",...ra.defaultData})(fV||(fV={}));var pV;(e=>e.defaultData={type:"Component",...ra.defaultData})(pV||(pV={}));var sg;(e=>e.defaultData={type:"Mesh",...ra.defaultData,...IB.defaultData})(sg||(sg={}));var FS;(e=>e.defaultData={...ra.defaultData,...Hg.identity,...Tx.defaultData})(FS||(FS={}));var NB;(e=>{function t(i){return{...ra.defaultData,...BB.defaultData(i)}}e.defaultData=t})(NB||(NB={}));var NS;(e=>{function t(n,r,s=0){for(;s<r.length;){let o=n?n[r[s]]:void 0;if(r.length===s+1)return o;if(o)n=o.descendants,s+=1;else return}}e.resolveWithDes=t;function i(n,r,s=0){let o=t(n,r,s);if(o){let a=Object.keys(o);if(a.length===1&&a[0]==="descendants")return}return o}e.resolve=i})(NS||(NS={}));var Vg;(e=>{e.rootOverrideProps=["physics"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"];function t(n,r){return{...ra.defaultData,...r,component:n,overrides:new Pr,physics:void 0,type:"Instance"}}e.ofComponent=t;function i(n){let r=Hg.fromObject(n.data);return t(n.id,r)}e.fromComponentData=i})(Vg||(Vg={}));var zB;(e=>(e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:Gg.identity,name:"Play Camera",visible:!0,raycastLock:!1,collision:"visibility",physics:null,states:new $t,events:new $t,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...Tx.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...ra.defaultData,...sg.defaultData,geometry:rg.defaultData("RectangleGeometry"),material:yo.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...ra.defaultData,...sg.defaultData,geometry:rg.defaultData("BooleanGeometry"),material:yo.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...ra.defaultData,...sg.defaultData,geometry:rg.defaultData("TextGeometry"),material:yo.defaultTwoLayerData("phong","layer1","layer2")}))(zB||(zB={}));var of;(e=>{function t(s,o){let a={name:o};return s.type==="Mesh"?(a.geometry={},"material"in s&&(a.material={layers:new Pr}),"materials"in s&&(a.materials=s.materials.map(l=>({layers:new Pr})))):Gf.is(s.type)&&(a.perspective={},a.orthographic={}),a}e.newEmpty=t;function i(s,o){if(o===void 0)return s;let a={...s};return"material"in a&&"material"in o&&o.material&&(a.material=CS(a.material,l=>{if(typeof l!="string")for(let[c,h]of Object.entries(o.material.layers)){let u=l.layers.data(c);u&&Qo.patch(u,h)}}).data),a.materials&&o.materials&&(a.materials=CS(a.materials,l=>{var c,h;for(let u=0;u<a.materials.length;u++){let d=o.materials[u];if(typeof d!="string")for(let[f,p]of Object.entries(d.layers)){let g=(h=(c=l[u])==null?void 0:c.layers)==null?void 0:h.data(f);g&&Qo.patch(g,p)}}}).data),a}function n(s,o){let a,l=[],c={orthographic:0,perspective:0,geometry:0};function h(u,d){for(let[f,p]of Object.entries(d.layers)){let{texture:g,...m}=p;if(g!==void 0&&Object.keys(g).length>0){let v={path:[...u,"layers",f,"texture"],props:g,type:0};l.push(v)}if(Object.keys(m).length>0){let v={path:[...u,"layers",f],props:m,type:0};l.push(v)}}}for(let[u,d]of Object.entries(o))if(u!=="name")if(u==="cloner")l.push(...PB.toOps(d,["cloner"]));else if(u==="pathSnapping")l.push({path:[u],props:{slide:d.slide,offset:d.offset},type:0});else if(u==="material")h(["material"],d);else if(u==="materials")for(let[f,p]of Object.entries(d))h(["materials",f],p);else if(c[u]===0){if(u==="geometry"&&d.extrusion!==void 0){let f={path:[u,"extrusion"],props:d.extrusion,type:0};l.push(f),d={...d},delete d.extrusion}if(Object.keys(d).length>0){let f={path:[u],props:d,type:0};l.push(f)}}else a===void 0&&(a={path:[],props:{},type:0},l.push(a)),a.props[u]=d;return l}e.toOps=n;function r(s,o){var l,c,h,u,d,f;if(o===void 0)return s;let a={...s};if(Object.assign(a,Hg.merge(a,o)),Object.assign(a,{pathSnapping:Object.assign({},a.pathSnapping,{slide:((l=o.pathSnapping)==null?void 0:l.slide)??((c=a.pathSnapping)==null?void 0:c.slide)??0,offset:((h=o.pathSnapping)==null?void 0:h.offset)??((u=a.pathSnapping)==null?void 0:u.offset)??0})}),Gf.is(s.type)){a.orthographic={...a.orthographic},a.perspective={...a.perspective};let p=o;((d=p.orthographic)==null?void 0:d.zoom)!==void 0&&(a.orthographic.zoom=p.orthographic.zoom),((f=p.perspective)==null?void 0:f.zoom)!==void 0&&(a.perspective.zoom=p.perspective.zoom),p.isUpVectorFlipped!==void 0&&(a.isUpVectorFlipped=p.isUpVectorFlipped),p.targetOffset!==void 0&&(a.targetOffset=p.targetOffset)}else if(s.type==="Mesh")"geometry"in o&&Object.assign(a,{geometry:FB.merge(a.geometry,o.geometry)}),(o.material||o.materials)&&(a=i(a,o)),a.cloner&&"cloner"in o&&Object.assign(a,{cloner:dh.merge(a.cloner,o.cloner)});else if(s.type==="Empty")a.cloner&&"cloner"in o&&Object.assign(a,{cloner:dh.merge(a.cloner,o.cloner)});else if(DB.is(s.type)){let p=o;p.intensity!==void 0&&(a.intensity=p.intensity),p.color!==void 0&&(typeof p.color=="string"?a.color=p.color:a.color=Wr.clone(p.color))}return a}e.patch=r})(of||(of={}));var zS;(e=>e.defaultData={enabled:!1,useBackgroundColor:!1,color:Wr.white,near:.1,far:2e3})(zS||(zS={}));var kS;(e=>e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0,autoZoom:!1})(kS||(kS={}));var jg;(e=>e.defaultData={orbitControls:kS.defaultData,playCamera:null,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,joystickSizeAndXYOffset:Array(12).fill(0).map((t,i)=>{let n=0,r=0;return i<5?r=-30:i<10&&(r=30),i===0||i===10||i===5?n=30:(i===4||i===11||i===9)&&(n=-30),[120,[n,r],"show"]}),gameControlObject:null,hdTransmission:!1})(jg||(jg={}));var kB;(e=>e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(kB||(kB={}));var UB;(e=>e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(UB||(UB={}));var Dx;(e=>(e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...kB.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:UB.defaultData}),e.generateSeed=()=>Math.round(Math.random()*1e5)))(Dx||(Dx={}));var ao;(e=>e.defaultData={ambientLight:{enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75,depth:100,groundColor:{r:.5098039215686274,g:.5098039215686274,b:.5098039215686274},softShadows:!0,softShadowQuality:"low",occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}},usePhysics:!1,gravity:-10,pixelsPerMeter:200,skinWidthRelative:.02,stepThreshRelative:.3,slopeThresh:65})(ao||(ao={}));var mV;(e=>{e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function t(r={withLight:!0,withSquare:!0}){let s=new js,o=zB.defaultMeshObject;return r.withLight===!0&&s.push({fi:-1,data:{...NB.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7},id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),r.withSquare===!0&&s.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:o,children:[]}),s}e.defaultData={backgroundColor:ea.fromHexAndA(2960946,1),postprocessing:Px.defaultData,fog:zS.defaultData,objects:t(),environment:ao.defaultData,publish:jg.defaultData,styles:Dx.defaultData()},e.emptyData=function(r){return{backgroundColor:ea.fromHexAndA(2960946,1),postprocessing:Px.defaultData,fog:zS.defaultData,objects:r?t(r):new js,environment:ao.defaultData,publish:jg.defaultData,styles:Dx.defaultData()}};function i(r){return{...e.defaultData,objects:Uf(r,js.prototype)}}e.withObjs=i;function n(r,s){return i([{id:r,data:s,children:[],fi:0}])}e.withObj=n})(mV||(mV={}));var US;(e=>e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII="})(US||(US={}));var GB;(e=>{function t(){let r={};return r["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Uf(r,zn.prototype)}e.defaultColors=t;function i(r){let s={};return r!=null&&r.withAITexture&&(s["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...US.emptyImage,name:"AI generated image"}),Uf(s,zn.prototype)}e.defaultImages=i;function n(){return{materials:new zn,images:new zn,videos:new zn,colors:new zn,audios:new zn,fonts:new zn,penumbraSize:[2,2,2]}}e.emptyData=n})(GB||(GB={}));var GS;(e=>(e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",speedTranslate:1e3,speedRotate:100,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new $t,move:new $t,jump:new $t},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:ea.fromHexAndA(3728051,1)}}))(GS||(GS={}));function gV(e){e.layers.forEach(t=>{if(t.type==="depth"&&t.colorA!==void 0){let i=t.colorA,n=t.colorB,r=[[i.r,i.g,i.b,i.a],[n.r,n.g,n.b,n.a]],s=[0,1];for(let a=2;a<10;a++)r.push(r[1]),s.push(1);let o={...Mx(Qr(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:r,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,o)}else if(t.type==="depth"&&t.gradientType===1&&(t.near<0||t.far<0)){let i={...Qr(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,i)}})}function Um(e,t){Object.values(e.shared.materials).forEach(i=>t(i))}function Gm(e,t){e.scene.objects.traverse((i,n)=>{"materials"in n?n.materials.forEach(r=>{typeof r!="string"&&t(r)}):"material"in n&&typeof n.material!="string"&&t(n.material)})}function tDe(e){Object.assign(e.scene.publish,{orbitControls:{...kS.defaultData,...Qr(e.scene.publish.orbitControls)}})}function iDe(e){Object.assign(e.scene.publish.settings,{video:{...jg.defaultData.settings.video,...Qr(e.scene.publish.settings.video)}})}function nDe(e){function t(i){if(i.layers){for(let n of Object.values(i.layers))if(n){for(let[r,s]of Object.entries(n))if((tJ.includes(r)||typeof s=="boolean")&&delete n[r],r==="texture")for(let[o,a]of Object.entries(s))(eDe.includes(o)||typeof a=="boolean")&&delete s[o]}}}e.scene.objects.traverse((i,n)=>{n.states.forEach(r=>{let s=r;s.material?t(s.material):s.materials&&s.materials.forEach(o=>{t(o)})})})}function rDe(e){e.scene.publish.withBackground=!0}function sDe(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function oDe(e){e.scene.objects.traverse((t,i)=>{let n=i.cloner;n&&(n.radial.scale=n.radial.scale.map(r=>r+1),n.linear.scale=n.linear.scale.map(r=>r+1))})}function aDe(e){e.scene.objects.traverse((t,i)=>{let n=i.geometry;n&&(n.type==="DodecahedronGeometry"||n.type==="IcosahedronGeometry")&&(n.detail=Math.round(n.detail))})}function lDe(e){e.scene.objects.traverse((t,i)=>{let n=e.scene.objects.unproxy().parent(t);if(n){let r=Qr(e.scene.objects.data(n));r&&r.type==="Mesh"&&r.geometry.type==="BooleanGeometry"&&i.type==="Mesh"&&(i.visible=Qr(i).booleanExclude!==!0)}})}function cDe(e){e.scene.objects.traverse((t,i)=>{if(i.type==="Mesh"){let n=i;i.geometry.type==="NonParametricGeometry"?n.material!==void 0&&delete n.material:n.materials!==void 0&&delete n.materials}})}function uDe(e){function t(n){Object.setPrototypeOf(n,Pr.prototype),n.texture&&Object.setPrototypeOf(n.texture,Pr.prototype)}function i(n){Object.setPrototypeOf(n,Pr.prototype);for(let r in n)t(n[r])}e.scene.objects.traverse((n,r)=>{r.states.forEach(s=>{let o=s;if(o.material){let a=Qr(o.material).layers;i(a),o.material.layers=a}if(o.materials)for(let a=0;a<o.materials.length;a++){let l=o.materials[a],c=Qr(l).layers;i(c),l.layers=c}})})}function vV(e){e.layers===void 0&&Object.assign(e,yo.defaultTwoLayerData("lambert"))}function Y2(e){!e.layers||e.layers.forEach(t=>{if(t.type==="depth"&&t.colors.length===10){let i=[...t.colors];i.push(t.colors[9]);let n=[...t.steps];n.push(t.steps[9]);let r={...Qr(t),colors:i,steps:n};Object.assign(t,r)}})}function hDe(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&(i.geometry.type==="BooleanGeometry"||i.geometry.type==="SubdivGeometry")&&(i.geometry.phongAngle=35)})}function yV(e){e.scene.objects.traverse((t,i)=>{"materials"in i?i.materials.forEach(n=>{typeof n!="string"&&Y2(n)}):"material"in i&&typeof i.material!="string"&&Y2(i.material)}),Object.values(e.shared.materials).forEach(t=>Y2(t))}function dDe(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((t,i)=>{(i.type==="DirectionalLight"||i.type==="SpotLight")&&(i.shadowResolution=1024,i.shadowRadius=1,i.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}function fDe(e){e.shared.audios=Uf({},zn.prototype)}function pDe(e){e.shared.videos=Uf({},zn.prototype)}function mDe(e){let t=e.shared.materials;Object.entries(t).forEach(([i,n])=>{if(!n.layers){let r={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[i]:r})}})}function gDe(e){Object.entries(Qr(e.shared.images)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(Qr(e.shared.audios)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.audios[t]})}function vDe(e){e.scene.publish.settings.web.preload=!1}function xV(e){e.layers&&e.layers.forEach(t=>{t.type==="depth"&&t.num!==void 0&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)})}function wV(e){e.layers&&e.layers.forEach(t=>{$Pe(t)&&t.isMask===void 0&&(t.isMask=!1),(t.type==="texture"||t.type==="video")&&t.blending===void 0&&(t.blending=0),(t.type==="noise"||t.type==="displace"&&t.displacementType==="noise")&&(t.voronoiStyle===void 0&&(t.voronoiStyle=0),t.highCut===void 0&&(t.highCut=1),t.lowCut===void 0&&(t.lowCut=0),t.smoothness===void 0&&(t.smoothness=.3),t.seed===void 0&&(t.seed=0),t.quality===void 0&&(t.quality=1))})}function yDe(e){e.shared.fonts=Uf({},zn.prototype)}function xDe(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function wDe(e){let t=[];e.scene.objects.traverse((i,n)=>{let r=n;if(r.type==="TextFrame"){let s=yo.defaultTwoLayerData("phong"),o=typeof r.color=="string"?e.shared.colors[r.color]:r.color;s.layers[1].data.color={r:o.r,g:o.g,b:o.b},s.layers[1].data.alpha=r.alpha;let a=xDe(r.font);e.shared.fonts[a]===void 0&&(e.shared.fonts[a]={name:a});let l={name:r.name,...ra.defaultData,...sg.defaultData,flatShading:!1,wireframe:!1,geometry:{...rg.defaultData("TextGeometry"),width:r.width,height:r.height,font:a,depth:0,horizontalAlign:r.horizontalAlign,verticalAlign:r.verticalAlign,fontSize:r.fontSize*1.40625,lineHeight:r.lineHeight/1.40625,letterSpacing:r.letterSpacing-1,text:r.text,textTransform:r.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:Qr(r.states),events:Qr(r.events),visible:r.visible,raycastLock:r.raycastLock,position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix},c=Qr(e.scene.objects).parent(i);e.scene.objects.insertAfter(c??null,i,[{id:i+"new",data:l,children:[]}]),t.push(i)}}),t.forEach(i=>{e.scene.objects.delete(i)})}function _De(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((i,n)=>{n.events.forEach(r=>{if(t[Number(r.type)])if(Object.assign(r,{type:t[Number(r.type)]}),r.type==="Audio"&&"audioEvent"in r&&(Object.assign(r,{playAudio:r.audioEvent}),delete r.audioEvent),r.type==="GameControl")Object.assign(r,{gameActions:{idle:new $t,move:new $t,jump:new $t}});else{let s=new $t;Object.assign(r,{actions:s}),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="KeyDown"||r.type==="KeyUp")&&"url"in r&&s.push({fi:0,id:si.generateUUID(),data:{type:"Link",url:r.url,delay:0}}),"targets"in r&&(r.targets.forEach((o,a,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},h={easing:o.easing,duration:o.duration};o.easing===6?Object.assign(h,Mx(o,"mass","stiffness","damping","velocity")):o.easing===5&&Object.assign(h,{control1:{...o.control1},control2:{...o.control2}});let u={repeat:o.repeat?-1:0,delay:o.delay,delayDirection:o.delayDirection,direction:o.cycle&&o.rewind?"pingpong-rewind":o.cycle?"pingpong":"normal"},d={state:o.state,...u,...h},f={allowSlerp:!0,type:"Transition",object:o.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new $t({fi:0,id:si.generateUUID(),data:c},{fi:1,id:si.generateUUID(),data:d})};s.push({fi:l,id:a,data:f})}),delete r.targets)}})})}function bDe(e){e.scene.objects.traverse((t,i)=>{function n(r,s){var l;let o=new $t,a=[];if(i.events.forEach((c,h,u)=>{if(c.type==="Audio"&&c.trigger===s){let d;a.push(h),c.interaction==="play"?d={...Mx(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(d={...Mx(c,"interaction","delay","object","playAudio"),type:"Audio"}),d&&o.push({fi:u,id:h,data:d})}}),a.forEach(c=>i.events.delete(c)),o.length){let c=(l=i.events.find(h=>h.type===r))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,o):i.events.insertBefore(null,[{id:si.generateUUID(),data:{type:r,actions:o}}])}}n("Start","start"),n("MouseDown","mouseDown"),n("MouseUp","mouseUp"),n("KeyDown","keyDown"),n("KeyUp","keyUp")})}function _V(e){var i;let t=(i=e.layers.find(n=>n.type==="light"))==null?void 0:i.data;if((t==null?void 0:t.category)==="basic"){let n=Qo.defaultData("light","phong"),r=t;Object.assign(r,n),r.visible=!1}}function bV(e){Um(e,_V),Gm(e,_V)}function ADe(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(i.geometry.scaleBaked||(i.geometry.scaleBaked=[1,1,1]))})}function SDe(e){e.scene.objects.traverse((t,i)=>{(i.type==="Empty"||i.type==="Mesh")&&i.cloner&&!i.cloner.randomnessObject&&!i.cloner.toObject&&!i.cloner.randomness&&(i.cloner={...i.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function MDe(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&i.geometry.type==="NonParametricGeometry"&&!("material"in i)&&!("materials"in i)&&(i.material=yo.defaultTwoLayerData("phong"))})}function EDe(e){e.scene.publish.orbitControls.autoZoom===void 0&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((t,i)=>{(i.type==="OrthographicCamera"||i.type==="PerspectiveCamera")&&(i.orthographic.autoZoom===void 0&&(i.orthographic.autoZoom=!1),i.orthographic.autoZoomFrustumSize===void 0&&(i.orthographic.autoZoomFrustumSize=790))})}function CDe(e){e.scene.objects.traverse((t,i)=>{i.pathSnapping===void 0&&(i.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),i.pathSnapping.offset===void 0&&(i.pathSnapping.offset=0)})}function TDe(e){e.scene.publish.mouseEventTarget===void 0&&(e.scene.publish.mouseEventTarget="canvas"),e.scene.publish.settings.web.hint===void 0&&(e.scene.publish.settings.web.hint=!1)}function PDe(e){let{video:t}=e.scene.publish.settings;t.format==="gif"&&t.fps>48&&(t.fps=15)}function DDe(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&(n.resetYPosition=Math.abs(n.resetYPosition-i.position[1]))})})}function BDe(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((i,n)=>{t&&n.physics===null?n.collision=!1:n.collision="visibility"})}function LDe(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&(n.navmesh=GS.defaultDataThirdPerson.navmesh)})})}function RDe(e){e.scene.styles||(e.scene.styles=Dx.defaultData())}function AV(e){e.layers.forEach(t=>{t.type==="light"&&t.category!=="toon"&&t.occlusion===void 0&&(t.occlusion=!0)})}function IDe(e){e.scene.environment.ambientLight.occlusion===void 0&&(e.scene.environment.ambientLight.occlusion=!1),e.scene.environment.ambientLight.aoFullRes===void 0&&(e.scene.environment.ambientLight.aoFullRes=!1),e.scene.environment.ambientLight.radius===void 0&&(e.scene.environment.ambientLight.radius=256),e.scene.environment.ambientLight.bias===void 0&&(e.scene.environment.ambientLight.bias=.5),e.scene.environment.ambientLight.aoColor===void 0&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Gm(e,AV),Um(e,AV)}var SV=41;function ODe(e){let t=e.schema??0;t!==SV&&(console.warn("updating from ",t,"to ",SV),t<1&&(Gm(e,gV),Um(e,gV),e.schema=1),t<2&&(tDe(e),e.schema=2),t<3&&(nDe(e),e.schema=3),t<4&&(rDe(e),e.schema=4),t<5&&(sDe(e),e.schema=5),t<6&&(oDe(e),e.schema=6),t<7&&(aDe(e),e.schema=7),t<8&&(e.schema=8),t<9&&(yV(e),e.schema=9),t<10&&(hDe(e),e.schema=10),t<11&&(dDe(e),e.schema=11),t<12&&(yV(e),e.schema=12),t<13&&(fDe(e),e.schema=13),t<14&&(mDe(e),e.schema=14),t<15&&(gDe(e),e.schema=15),t<16&&(vDe(e),e.schema=16),t<17&&(Gm(e,xV),Um(e,xV),e.schema=17),t<18&&(Gm(e,vV),Um(e,vV),e.schema=18),t<19&&(iDe(e),e.schema=19),t<20&&(yDe(e),wDe(e),e.schema=20),t<21&&(_De(e),bDe(e),e.schema=21),t<22&&(bV(e),e.schema=22),t<23&&(ADe(e),e.schema=23),t<24&&(SDe(e),e.schema=24),(t<25||e.shared.videos===void 0)&&(pDe(e),t<25&&(e.schema=25)),t<26&&(lDe(e),e.schema=26),t<27&&(cDe(e),e.schema=27),t<28&&(bV(e),e.schema=28),t<29&&(uDe(e),e.schema=29),t<30&&(MDe(e),e.schema=30),t<31&&(EDe(e),e.schema=31),t<33&&(CDe(e),e.schema=33),t<34&&(TDe(e),e.schema=34),t<35&&(PDe(e),e.schema=35),t<36&&(DDe(e),e.schema=36),t<37&&(BDe(e),e.schema=37),t<38&&(Gm(e,wV),Um(e,wV),e.schema=38),t<39&&(LDe(e),e.schema=39),t<40&&(RDe(e),e.schema=40),t<41&&(IDe(e),e.schema=41))}function af(e,t=!1){let i=e[0].index!==null,n=new Set(Object.keys(e[0].attributes)),r=new Set(Object.keys(e[0].morphAttributes)),s={},o={},a=e[0].morphTargetsRelative,l=new Ot,c=0;for(let h=0;h<e.length;++h){let u=e[h],d=0;if(i!==(u.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let f in u.attributes){if(!n.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;s[f]===void 0&&(s[f]=[]),s[f].push(u.attributes[f]),d++}if(d!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(a!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let f in u.morphAttributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;o[f]===void 0&&(o[f]=[]),o[f].push(u.morphAttributes[f])}if(t){let f;if(i)f=u.index.count;else if(u.attributes.position!==void 0)f=u.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,f,h),c+=f}}if(i){let h=0,u=[];for(let d=0;d<e.length;++d){let f=e[d].index;for(let p=0;p<f.count;++p)u.push(f.getX(p)+h);h+=e[d].attributes.position.count}l.setIndex(u)}for(let h in s){let u=MV(s[h]);if(!u)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" attribute."),null;l.setAttribute(h,u)}for(let h in o){let u=o[h][0].length;if(u===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[h]=[];for(let d=0;d<u;++d){let f=[];for(let g=0;g<o[h].length;++g)f.push(o[h][g][d]);let p=MV(f);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;l.morphAttributes[h].push(p)}}return l}function MV(e){let t,i,n,r=0;for(let a=0;a<e.length;++a){let l=e[a];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(i===void 0&&(i=l.itemSize),i!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=l.normalized),n!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=l.array.length}let s=new t(r),o=0;for(let a=0;a<e.length;++a)s.set(e[a].array,o),o+=e[a].array.length;return new zt(s,i,n)}var FDe=Math.pow(2,-24),fb=class{constructor(){}};function Il(e,t,i){return i.min.x=t[e],i.min.y=t[e+1],i.min.z=t[e+2],i.max.x=t[e+3],i.max.y=t[e+4],i.max.z=t[e+5],i}function EV(e){let t=-1,i=-1/0;for(let n=0;n<3;n++){let r=e[n+3]-e[n];r>i&&(i=r,t=n)}return t}function CV(e,t){t.set(e)}function TV(e,t,i){let n,r;for(let s=0;s<3;s++){let o=s+3;n=e[s],r=t[s],i[s]=n<r?n:r,n=e[o],r=t[o],i[o]=n>r?n:r}}function pb(e,t,i){for(let n=0;n<3;n++){let r=t[e+2*n],s=t[e+2*n+1],o=r-s,a=r+s;o<i[n]&&(i[n]=o),a>i[n+3]&&(i[n+3]=a)}}function b0(e){let t=e[3]-e[0],i=e[4]-e[1],n=e[5]-e[2];return 2*(t*i+i*n+n*t)}function NDe(e,t){if(!e.index){let i=e.attributes.position.count,n=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,r;i>65535?r=new Uint32Array(new n(4*i)):r=new Uint16Array(new n(2*i)),e.setIndex(new zt(r,1));for(let s=0;s<i;s++)r[s]=s}}function zDe(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],i=new Set;for(let r of e.groups)i.add(r.start),i.add(r.start+r.count);let n=Array.from(i.values()).sort((r,s)=>r-s);for(let r=0;r<n.length-1;r++){let s=n[r],o=n[r+1];t.push({offset:s/3,count:(o-s)/3})}return t}function q2(e,t,i,n,r=null){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,h=-1/0,u=1/0,d=1/0,f=1/0,p=-1/0,g=-1/0,m=-1/0,v=r!==null;for(let x=t*6,w=(t+i)*6;x<w;x+=6){let b=e[x+0],M=e[x+1],A=b-M,T=b+M;A<s&&(s=A),T>l&&(l=T),v&&b<u&&(u=b),v&&b>p&&(p=b);let S=e[x+2],C=e[x+3],P=S-C,B=S+C;P<o&&(o=P),B>c&&(c=B),v&&S<d&&(d=S),v&&S>g&&(g=S);let k=e[x+4],z=e[x+5],F=k-z,W=k+z;F<a&&(a=F),W>h&&(h=W),v&&k<f&&(f=k),v&&k>m&&(m=k)}n[0]=s,n[1]=o,n[2]=a,n[3]=l,n[4]=c,n[5]=h,v&&(r[0]=u,r[1]=d,r[2]=f,r[3]=p,r[4]=g,r[5]=m)}function kDe(e,t,i,n){let r=1/0,s=1/0,o=1/0,a=-1/0,l=-1/0,c=-1/0;for(let h=t*6,u=(t+i)*6;h<u;h+=6){let d=e[h+0];d<r&&(r=d),d>a&&(a=d);let f=e[h+2];f<s&&(s=f),f>l&&(l=f);let p=e[h+4];p<o&&(o=p),p>c&&(c=p)}n[0]=r,n[1]=s,n[2]=o,n[3]=a,n[4]=l,n[5]=c}function UDe(e,t,i,n,r){let s=i,o=i+n-1,a=r.pos,l=r.axis*2;for(;;){for(;s<=o&&t[s*6+l]<a;)s++;for(;s<=o&&t[o*6+l]>=a;)o--;if(s<o){for(let c=0;c<3;c++){let h=e[s*3+c];e[s*3+c]=e[o*3+c],e[o*3+c]=h;let u=t[s*6+c*2+0];t[s*6+c*2+0]=t[o*6+c*2+0],t[o*6+c*2+0]=u;let d=t[s*6+c*2+1];t[s*6+c*2+1]=t[o*6+c*2+1],t[o*6+c*2+1]=d}s++,o--}else return s}}var Tc=32,GDe=(e,t)=>e.candidate-t.candidate,Ou=new Array(Tc).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),mb=new Float32Array(6);function HDe(e,t,i,n,r,s){let o=-1,a=0;if(s===0)o=EV(t),o!==-1&&(a=(t[o]+t[o+3])/2);else if(s===1)o=EV(e),o!==-1&&(a=VDe(i,n,r,o));else if(s===2){let l=b0(e),c=1.25*r,h=n*6,u=(n+r)*6;for(let d=0;d<3;d++){let f=t[d],p=(t[d+3]-f)/Tc;if(r<Tc/4){let g=[...Ou];g.length=r;let m=0;for(let x=h;x<u;x+=6,m++){let w=g[m];w.candidate=i[x+2*d],w.count=0;let{bounds:b,leftCacheBounds:M,rightCacheBounds:A}=w;for(let T=0;T<3;T++)A[T]=1/0,A[T+3]=-1/0,M[T]=1/0,M[T+3]=-1/0,b[T]=1/0,b[T+3]=-1/0;pb(x,i,b)}g.sort(GDe);let v=r;for(let x=0;x<v;x++){let w=g[x];for(;x+1<v&&g[x+1].candidate===w.candidate;)g.splice(x+1,1),v--}for(let x=h;x<u;x+=6){let w=i[x+2*d];for(let b=0;b<v;b++){let M=g[b];w>=M.candidate?pb(x,i,M.rightCacheBounds):(pb(x,i,M.leftCacheBounds),M.count++)}}for(let x=0;x<v;x++){let w=g[x],b=w.count,M=r-w.count,A=w.leftCacheBounds,T=w.rightCacheBounds,S=0;b!==0&&(S=b0(A)/l);let C=0;M!==0&&(C=b0(T)/l);let P=1+1.25*(S*b+C*M);P<c&&(o=d,c=P,a=w.candidate)}}else{for(let v=0;v<Tc;v++){let x=Ou[v];x.count=0,x.candidate=f+p+v*p;let w=x.bounds;for(let b=0;b<3;b++)w[b]=1/0,w[b+3]=-1/0}for(let v=h;v<u;v+=6){let x=~~((i[v+2*d]-f)/p);x>=Tc&&(x=Tc-1);let w=Ou[x];w.count++,pb(v,i,w.bounds)}let g=Ou[Tc-1];CV(g.bounds,g.rightCacheBounds);for(let v=Tc-2;v>=0;v--){let x=Ou[v],w=Ou[v+1];TV(x.bounds,w.rightCacheBounds,x.rightCacheBounds)}let m=0;for(let v=0;v<Tc-1;v++){let x=Ou[v],w=x.count,b=x.bounds,M=Ou[v+1].rightCacheBounds;w!==0&&(m===0?CV(b,mb):TV(b,mb,mb)),m+=w;let A=0,T=0;m!==0&&(A=b0(mb)/l);let S=r-m;S!==0&&(T=b0(M)/l);let C=1+1.25*(A*m+T*S);C<c&&(o=d,c=C,a=x.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:o,pos:a}}function VDe(e,t,i,n){let r=0;for(let s=t,o=t+i;s<o;s++)r+=e[s*6+n*2];return r/i}function jDe(e,t){let i=e.attributes.position,n=i.array,r=e.index.array,s=r.length/3,o=new Float32Array(s*6),a=i.offset||0,l=3;i.isInterleavedBufferAttribute&&(l=i.data.stride);for(let c=0;c<s;c++){let h=c*3,u=c*6,d=r[h+0]*l+a,f=r[h+1]*l+a,p=r[h+2]*l+a;for(let g=0;g<3;g++){let m=n[d+g],v=n[f+g],x=n[p+g],w=m;v<w&&(w=v),x<w&&(w=x);let b=m;v>b&&(b=v),x>b&&(b=x);let M=(b-w)/2,A=g*2;o[u+A+0]=w+M,o[u+A+1]=M+(Math.abs(w)+M)*FDe,w<t[g]&&(t[g]=w),b>t[g+3]&&(t[g+3]=b)}}return o}function WDe(e,t){function i(v){d&&d(v/f)}function n(v,x,w,b=null,M=0){if(!p&&M>=l&&(p=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),w<=h||M>=l)return i(x+w),v.offset=x,v.count=w,v;let A=HDe(v.boundingData,b,o,x,w,u);if(A.axis===-1)return i(x+w),v.offset=x,v.count=w,v;let T=UDe(a,o,x,w,A);if(T===x||T===x+w)i(x+w),v.offset=x,v.count=w;else{v.splitAxis=A.axis;let S=new fb,C=x,P=T-x;v.left=S,S.boundingData=new Float32Array(6),q2(o,C,P,S.boundingData,s),n(S,C,P,s,M+1);let B=new fb,k=T,z=w-P;v.right=B,B.boundingData=new Float32Array(6),q2(o,k,z,B.boundingData,s),n(B,k,z,s,M+1)}return v}NDe(e,t);let r=new Float32Array(6),s=new Float32Array(6),o=jDe(e,r),a=e.index.array,l=t.maxDepth,c=t.verbose,h=t.maxLeafTris,u=t.strategy,d=t.onProgress,f=e.index.count/3,p=!1,g=[],m=zDe(e);if(m.length===1){let v=m[0],x=new fb;x.boundingData=r,kDe(o,v.offset,v.count,s),n(x,v.offset,v.count,s),g.push(x)}else for(let v of m){let x=new fb;x.boundingData=new Float32Array(6),q2(o,v.offset,v.count,x.boundingData,s),n(x,v.offset,v.count,s),g.push(x)}return g}function XDe(e,t){let i=WDe(e,t),n,r,s,o=[],a=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let h=0;h<i.length;h++){let u=i[h],d=l(u),f=new a(32*d);n=new Float32Array(f),r=new Uint32Array(f),s=new Uint16Array(f),c(0,u),o.push(f)}return o;function l(h){return h.count?1:1+l(h.left)+l(h.right)}function c(h,u){let d=h/4,f=h/2,p=!!u.count,g=u.boundingData;for(let m=0;m<6;m++)n[d+m]=g[m];if(p){let m=u.offset,v=u.count;return r[d+6]=m,s[f+14]=v,s[f+15]=65535,h+32}else{let m=u.left,v=u.right,x=u.splitAxis,w;if(w=c(h+32,m),w/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return r[d+6]=w/4,w=c(w,v),r[d+7]=x,w}}}var lu=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,i){let n=1/0,r=-1/0;for(let s=0,o=t.length;s<o;s++){let a=t[s][i];n=a<n?a:n,r=a>r?a:r}this.min=n,this.max=r}setFromPoints(t,i){let n=1/0,r=-1/0;for(let s=0,o=i.length;s<o;s++){let a=i[s],l=t.dot(a);n=l<n?l:n,r=l>r?l:r}this.min=n,this.max=r}isSeparated(t){return this.min>t.max||t.min>this.max}};lu.prototype.setFromBox=function(){let e=new I;return function(t,i){let n=i.min,r=i.max,s=1/0,o=-1/0;for(let a=0;a<=1;a++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){e.x=n.x*a+r.x*(1-a),e.y=n.y*l+r.y*(1-l),e.z=n.z*c+r.z*(1-c);let h=t.dot(e);s=Math.min(h,s),o=Math.max(h,o)}this.min=s,this.max=o}}();var YDe=function(){let e=new I,t=new I,i=new I;return function(n,r,s){let o=n.start,a=e,l=r.start,c=t;i.subVectors(o,l),e.subVectors(n.end,r.start),t.subVectors(r.end,r.start);let h=i.dot(c),u=c.dot(a),d=c.dot(c),f=i.dot(a),p=a.dot(a)*d-u*u,g,m;p!==0?g=(h*u-f*d)/p:g=0,m=(h+g*u)/d,s.x=g,s.y=m}}(),HO=function(){let e=new ge,t=new I,i=new I;return function(n,r,s,o){YDe(n,r,e);let a=e.x,l=e.y;if(a>=0&&a<=1&&l>=0&&l<=1){n.at(a,s),r.at(l,o);return}else if(a>=0&&a<=1){l<0?r.at(0,o):r.at(1,o),n.closestPointToPoint(o,!0,s);return}else if(l>=0&&l<=1){a<0?n.at(0,s):n.at(1,s),r.closestPointToPoint(s,!0,o);return}else{let c;a<0?c=n.start:c=n.end;let h;l<0?h=r.start:h=r.end;let u=t,d=i;if(n.closestPointToPoint(h,!0,t),r.closestPointToPoint(c,!0,i),u.distanceToSquared(h)<=d.distanceToSquared(c)){s.copy(u),o.copy(h);return}else{s.copy(c),o.copy(d);return}}}}(),qDe=function(){let e=new I,t=new I,i=new oo,n=new na;return function(r,s){let{radius:o,center:a}=r,{a:l,b:c,c:h}=s;if(n.start=l,n.end=c,n.closestPointToPoint(a,!0,e).distanceTo(a)<=o||(n.start=l,n.end=h,n.closestPointToPoint(a,!0,e).distanceTo(a)<=o)||(n.start=c,n.end=h,n.closestPointToPoint(a,!0,e).distanceTo(a)<=o))return!0;let u=s.getPlane(i);if(Math.abs(u.distanceToPoint(a))<=o){let d=u.projectPoint(a,t);if(s.containsPoint(d))return!0}return!1}}(),QDe=1e-15;function Kp(e){return Math.abs(e)<QDe}var cu=class extends Rs{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new I),this.satBounds=new Array(4).fill().map(()=>new lu),this.points=[this.a,this.b,this.c],this.sphere=new ua,this.plane=new oo,this.needsUpdate=!0}intersectsSphere(t){return qDe(t,this)}update(){let t=this.a,i=this.b,n=this.c,r=this.points,s=this.satAxes,o=this.satBounds,a=s[0],l=o[0];this.getNormal(a),l.setFromPoints(a,r);let c=s[1],h=o[1];c.subVectors(t,i),h.setFromPoints(c,r);let u=s[2],d=o[2];u.subVectors(i,n),d.setFromPoints(u,r);let f=s[3],p=o[3];f.subVectors(n,t),p.setFromPoints(f,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,t),this.needsUpdate=!1}};cu.prototype.closestPointToSegment=function(){let e=new I,t=new I,i=new na;return function(n,r=null,s=null){let{start:o,end:a}=n,l=this.points,c,h=1/0;for(let u=0;u<3;u++){let d=(u+1)%3;i.start.copy(l[u]),i.end.copy(l[d]),HO(i,n,e,t),c=e.distanceToSquared(t),c<h&&(h=c,r&&r.copy(e),s&&s.copy(t))}return this.closestPointToPoint(o,e),c=o.distanceToSquared(e),c<h&&(h=c,r&&r.copy(e),s&&s.copy(o)),this.closestPointToPoint(a,e),c=a.distanceToSquared(e),c<h&&(h=c,r&&r.copy(e),s&&s.copy(a)),Math.sqrt(h)}}();cu.prototype.intersectsTriangle=function(){let e=new cu,t=new Array(3),i=new Array(3),n=new lu,r=new lu,s=new I,o=new I,a=new I,l=new I,c=new na,h=new na,u=new na;return function(d,f=null){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(e.copy(d),e.update(),d=e);let p=this.plane,g=d.plane;if(Math.abs(p.normal.dot(g.normal))>1-1e-10){let m=this.satBounds,v=this.satAxes;i[0]=d.a,i[1]=d.b,i[2]=d.c;for(let b=0;b<4;b++){let M=m[b],A=v[b];if(n.setFromPoints(A,i),M.isSeparated(n))return!1}let x=d.satBounds,w=d.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let b=0;b<4;b++){let M=x[b],A=w[b];if(n.setFromPoints(A,t),M.isSeparated(n))return!1}for(let b=0;b<4;b++){let M=v[b];for(let A=0;A<4;A++){let T=w[A];if(s.crossVectors(M,T),n.setFromPoints(s,t),r.setFromPoints(s,i),n.isSeparated(r))return!1}}return f&&(console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),f.start.set(0,0,0),f.end.set(0,0,0)),!0}else{let m=this.points,v=!1,x=0;for(let k=0;k<3;k++){let z=m[k],F=m[(k+1)%3];c.start.copy(z),c.end.copy(F),c.delta(o);let W=v?h.start:h.end,K=Kp(g.distanceToPoint(z));if(Kp(g.normal.dot(o))&&K){h.copy(c),x=2;break}if((g.intersectLine(c,W)||K)&&!Kp(W.distanceTo(F))){if(x++,v)break;v=!0}}if(x===1&&this.containsPoint(h.start))return f&&(f.start.copy(h.start),f.end.copy(h.start)),!0;if(x!==2)return!1;let w=d.points,b=!1,M=0;for(let k=0;k<3;k++){let z=w[k],F=w[(k+1)%3];c.start.copy(z),c.end.copy(F),c.delta(a);let W=b?u.start:u.end,K=Kp(p.distanceToPoint(z));if(Kp(p.normal.dot(a))&&K){u.copy(c),M=2;break}if((p.intersectLine(c,W)||K)&&!Kp(W.distanceTo(F))){if(M++,b)break;b=!0}}if(M===1&&this.containsPoint(u.start))return f&&(f.start.copy(u.start),f.end.copy(u.start)),!0;if(M!==2)return!1;if(h.delta(o),u.delta(a),o.dot(a)<0){let k=u.start;u.start=u.end,u.end=k}let A=h.start.dot(o),T=h.end.dot(o),S=u.start.dot(o),C=u.end.dot(o),P=T<S,B=A<C;return A!==C&&S!==T&&P===B?!1:(f&&(l.subVectors(h.start,u.start),l.dot(o)>0?f.start.copy(h.start):f.start.copy(u.start),l.subVectors(h.end,u.end),l.dot(o)<0?f.end.copy(h.end):f.end.copy(u.end)),!0)}}}();cu.prototype.distanceToPoint=function(){let e=new I;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();cu.prototype.distanceToTriangle=function(){let e=new I,t=new I,i=["a","b","c"],n=new na,r=new na;return function(s,o=null,a=null){let l=o||a?n:null;if(this.intersectsTriangle(s,l))return(o||a)&&(o&&l.getCenter(o),a&&l.getCenter(a)),0;let c=1/0;for(let h=0;h<3;h++){let u,d=i[h],f=s[d];this.closestPointToPoint(f,e),u=f.distanceToSquared(e),u<c&&(c=u,o&&o.copy(e),a&&a.copy(f));let p=this[d];s.closestPointToPoint(p,e),u=p.distanceToSquared(e),u<c&&(c=u,o&&o.copy(p),a&&a.copy(e))}for(let h=0;h<3;h++){let u=i[h],d=i[(h+1)%3];n.set(this[u],this[d]);for(let f=0;f<3;f++){let p=i[f],g=i[(f+1)%3];r.set(s[p],s[g]),HO(n,r,e,t);let m=e.distanceToSquared(t);m<c&&(c=m,o&&o.copy(e),a&&a.copy(t))}}return Math.sqrt(c)}}();var Zl=class extends Vn{constructor(...e){super(...e),this.isOrientedBox=!0,this.matrix=new Je,this.invMatrix=new Je,this.points=new Array(8).fill().map(()=>new I),this.satAxes=new Array(3).fill().map(()=>new I),this.satBounds=new Array(3).fill().map(()=>new lu),this.alignedSatBounds=new Array(3).fill().map(()=>new lu),this.needsUpdate=!1}set(e,t,i){super.set(e,t),this.matrix.copy(i),this.needsUpdate=!0}copy(e){super.copy(e),this.matrix.copy(e.matrix),this.needsUpdate=!0}};Zl.prototype.update=function(){return function(){let e=this.matrix,t=this.min,i=this.max,n=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let h=0;h<=1;h++){let u=1*l|2*c|4*h,d=n[u];d.x=l?i.x:t.x,d.y=c?i.y:t.y,d.z=h?i.z:t.z,d.applyMatrix4(e)}let r=this.satBounds,s=this.satAxes,o=n[0];for(let l=0;l<3;l++){let c=s[l],h=r[l],u=1<<l,d=n[u];c.subVectors(o,d),h.setFromPoints(c,n)}let a=this.alignedSatBounds;a[0].setFromPointsField(n,"x"),a[1].setFromPointsField(n,"y"),a[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Zl.prototype.intersectsBox=function(){let e=new lu;return function(t){this.needsUpdate&&this.update();let i=t.min,n=t.max,r=this.satBounds,s=this.satAxes,o=this.alignedSatBounds;if(e.min=i.x,e.max=n.x,o[0].isSeparated(e)||(e.min=i.y,e.max=n.y,o[1].isSeparated(e))||(e.min=i.z,e.max=n.z,o[2].isSeparated(e)))return!1;for(let a=0;a<3;a++){let l=s[a],c=r[a];if(e.setFromBox(l,t),c.isSeparated(e))return!1}return!0}}();Zl.prototype.intersectsTriangle=function(){let e=new cu,t=new Array(3),i=new lu,n=new lu,r=new I;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);let o=this.satBounds,a=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let u=0;u<3;u++){let d=o[u],f=a[u];if(i.setFromPoints(f,t),d.isSeparated(i))return!1}let l=s.satBounds,c=s.satAxes,h=this.points;for(let u=0;u<3;u++){let d=l[u],f=c[u];if(i.setFromPoints(f,h),d.isSeparated(i))return!1}for(let u=0;u<3;u++){let d=a[u];for(let f=0;f<4;f++){let p=c[f];if(r.crossVectors(d,p),i.setFromPoints(r,t),n.setFromPoints(r,h),i.isSeparated(n))return!1}}return!0}}();Zl.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();Zl.prototype.distanceToPoint=function(){let e=new I;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();Zl.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new na),i=new Array(12).fill().map(()=>new na),n=new I,r=new I;return function(s,o=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(a||l)&&(s.getCenter(r),this.closestPointToPoint(r,n),s.closestPointToPoint(n,r),a&&a.copy(n),l&&l.copy(r)),0;let c=o*o,h=s.min,u=s.max,d=this.points,f=1/0;for(let g=0;g<8;g++){let m=d[g];r.copy(m).clamp(h,u);let v=m.distanceToSquared(r);if(v<f&&(f=v,a&&a.copy(m),l&&l.copy(r),v<c))return Math.sqrt(v)}let p=0;for(let g=0;g<3;g++)for(let m=0;m<=1;m++)for(let v=0;v<=1;v++){let x=(g+1)%3,w=(g+2)%3,b=m<<x|v<<w,M=1<<g|m<<x|v<<w,A=d[b],T=d[M];t[p].set(A,T);let S=e[g],C=e[x],P=e[w],B=i[p],k=B.start,z=B.end;k[S]=h[S],k[C]=m?h[C]:u[C],k[P]=v?h[P]:u[C],z[S]=u[S],z[C]=m?h[C]:u[C],z[P]=v?h[P]:u[C],p++}for(let g=0;g<=1;g++)for(let m=0;m<=1;m++)for(let v=0;v<=1;v++){r.x=g?u.x:h.x,r.y=m?u.y:h.y,r.z=v?u.z:h.z,this.closestPointToPoint(r,n);let x=r.distanceToSquared(n);if(x<f&&(f=x,a&&a.copy(n),l&&l.copy(r),x<c))return Math.sqrt(x)}for(let g=0;g<12;g++){let m=t[g];for(let v=0;v<12;v++){let x=i[v];HO(m,x,n,r);let w=n.distanceToSquared(r);if(w<f&&(f=w,a&&a.copy(n),l&&l.copy(r),w<c))return Math.sqrt(w)}}return Math.sqrt(f)}}();var gb=new I,vb=new I,yb=new I,PV=new ge,DV=new ge,BV=new ge,LV=new I;function JDe(e,t,i,n,r,s){let o;return s===gr?o=e.intersectTriangle(n,i,t,!0,r):o=e.intersectTriangle(t,i,n,s!==uo,r),o===null?null:{distance:e.origin.distanceTo(r),point:r.clone()}}function KDe(e,t,i,n,r,s,o){gb.fromBufferAttribute(t,n),vb.fromBufferAttribute(t,r),yb.fromBufferAttribute(t,s);let a=JDe(e,gb,vb,yb,LV,o);if(a){i&&(PV.fromBufferAttribute(i,n),DV.fromBufferAttribute(i,r),BV.fromBufferAttribute(i,s),a.uv=Rs.getUV(LV,gb,vb,yb,PV,DV,BV,new ge));let l={a:n,b:r,c:s,normal:new I,materialIndex:0};Rs.getNormal(gb,vb,yb,l.normal),a.face=l,a.faceIndex=n}return a}function sJ(e,t,i,n,r){let s=n*3,o=e.index.getX(s),a=e.index.getX(s+1),l=e.index.getX(s+2),c=KDe(i,e.attributes.position,e.attributes.uv,o,a,l,t);return c?(c.faceIndex=n,r&&r.push(c),c):null}function ZDe(e,t,i,n,r,s){for(let o=n,a=n+r;o<a;o++)sJ(e,t,i,o,s)}function $De(e,t,i,n,r){let s=1/0,o=null;for(let a=n,l=n+r;a<l;a++){let c=sJ(e,t,i,a);c&&c.distance<s&&(o=c,s=c.distance)}return o}function oJ(e,t,i){return e===null||(e.point.applyMatrix4(t.matrixWorld),e.distance=e.point.distanceTo(i.ray.origin),e.object=t,e.distance<i.near||e.distance>i.far)?null:e}function Dl(e,t,i,n){let r=e.a,s=e.b,o=e.c,a=t,l=t+1,c=t+2;i&&(a=i.getX(t),l=i.getX(t+1),c=i.getX(t+2)),r.x=n.getX(a),r.y=n.getY(a),r.z=n.getZ(a),s.x=n.getX(l),s.y=n.getY(l),s.z=n.getZ(l),o.x=n.getX(c),o.y=n.getY(c),o.z=n.getZ(c)}function RV(e,t,i,n,r,s,o){let a=i.index,l=i.attributes.position;for(let c=e,h=t+e;c<h;c++)if(Dl(o,c*3,a,l),o.needsUpdate=!0,n(o,c,r,s))return!0;return!1}var aJ=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function rh(e,t){return t[e+15]===65535}function og(e,t){return t[e+6]}function Bx(e,t){return t[e+14]}function Lx(e){return e+8}function Rx(e,t){return t[e+6]}function e3e(e,t){return t[e+7]}var Hm=new Vn,HS=new I,t3e=["x","y","z"];function HB(e,t,i,n,r){let s=e*2,o=gv,a=Ch,l=Th;if(rh(s,a)){let c=og(e,l),h=Bx(s,a);ZDe(t,i,n,c,h,r)}else{let c=Lx(e);VS(c,o,n,HS)&&HB(c,t,i,n,r);let h=Rx(e,l);VS(h,o,n,HS)&&HB(h,t,i,n,r)}}function VB(e,t,i,n){let r=e*2,s=gv,o=Ch,a=Th;if(rh(r,o)){let l=og(e,a),c=Bx(r,o);return $De(t,i,n,l,c)}else{let l=e3e(e,a),c=t3e[l],h=n.direction[c]>=0,u,d;h?(u=Lx(e),d=Rx(e,a)):(u=Rx(e,a),d=Lx(e));let f=VS(u,s,n,HS)?VB(u,t,i,n):null;if(f){let g=f.point[c];if(h?g<=s[d+l]:g>=s[d+l+3])return f}let p=VS(d,s,n,HS)?VB(d,t,i,n):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}var i3e=function(){let e,t,i=[],n=new aJ(()=>new Vn);return function(...s){e=n.getPrimitive(),t=n.getPrimitive(),i.push(e,t);let o=r(...s);n.releasePrimitive(e),n.releasePrimitive(t),i.pop(),i.pop();let a=i.length;return a>0&&(t=i[a-1],e=i[a-2]),o};function r(s,o,a,l,c=null,h=0,u=0){function d(x){let w=x*2,b=Ch,M=Th;for(;!rh(w,b);)x=Lx(x),w=x*2;return og(x,M)}function f(x){let w=x*2,b=Ch,M=Th;for(;!rh(w,b);)x=Rx(x,M),w=x*2;return og(x,M)+Bx(w,b)}let p=s*2,g=gv,m=Ch,v=Th;if(rh(p,m)){let x=og(s,v),w=Bx(p,m);return Il(s,g,e),l(x,w,!1,u,h+s,e)}else{let x=Lx(s),w=Rx(s,v),b=x,M=w,A,T,S,C;if(c&&(S=e,C=t,Il(b,g,S),Il(M,g,C),A=c(S),T=c(C),T<A)){b=w,M=x;let K=A;A=T,T=K,S=C}S||(S=e,Il(b,g,S));let P=rh(b*2,m),B=a(S,P,A,u+1,h+b),k;if(B===2){let K=d(b),Z=f(b)-K;k=l(K,Z,!0,u+1,h+b,S)}else k=B&&r(b,o,a,l,c,h,u+1);if(k)return!0;C=t,Il(M,g,C);let z=rh(M*2,m),F=a(C,z,T,u+1,h+M),W;if(F===2){let K=d(M),Z=f(M)-K;W=l(K,Z,!0,u+1,h+M,C)}else W=F&&r(M,o,a,l,c,h,u+1);return!!W}}}(),n3e=function(){let e=new cu,t=new cu,i=new Je,n=new Zl,r=new Zl;return function s(o,a,l,c,h=null){let u=o*2,d=gv,f=Ch,p=Th;if(h===null&&(l.boundingBox||l.computeBoundingBox(),n.set(l.boundingBox.min,l.boundingBox.max,c),h=n),rh(u,f)){let g=a,m=g.index,v=g.attributes.position,x=l.index,w=l.attributes.position,b=og(o,p),M=Bx(u,f);if(i.copy(c).invert(),l.boundsTree)return Il(o,d,r),r.matrix.copy(i),r.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:A=>r.intersectsBox(A),intersectsTriangle:A=>{A.a.applyMatrix4(c),A.b.applyMatrix4(c),A.c.applyMatrix4(c),A.needsUpdate=!0;for(let T=b*3,S=(M+b)*3;T<S;T+=3)if(Dl(t,T,m,v),t.needsUpdate=!0,A.intersectsTriangle(t))return!0;return!1}});for(let A=b*3,T=M+b*3;A<T;A+=3){Dl(e,A,m,v),e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.needsUpdate=!0;for(let S=0,C=x.count;S<C;S+=3)if(Dl(t,S,x,w),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}else{let g=o+8,m=p[o+6];return Il(g,d,Hm),!!(h.intersectsBox(Hm)&&s(g,a,l,c,h)||(Il(m,d,Hm),h.intersectsBox(Hm)&&s(m,a,l,c,h)))}}}();function VS(e,t,i,n){return Il(e,t,Hm),i.intersectBox(Hm,n)}var jB=[],wA,gv,Ch,Th;function Z0(e){wA&&jB.push(wA),wA=e,gv=new Float32Array(e),Ch=new Uint16Array(e),Th=new Uint32Array(e)}function xb(){wA=null,gv=null,Ch=null,Th=null,jB.length&&Z0(jB.pop())}var Q2=Symbol("skip tree generation"),J2=new Vn,K2=new Vn,Zp=new Je,Cd=new Zl,A0=new Zl,S0=new I,wb=new I,r3e=new I,s3e=new I,o3e=new I,IV=new Vn,ml=new aJ(()=>new cu),Dr=class{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),Dr.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let i=e.geometry,n=e._roots,r=i.getIndex(),s;return t.cloneBuffers?s={roots:n.map(o=>o.slice()),index:r.array.slice()}:s={roots:n,index:r.array},s}static deserialize(e,t,i={}){if(typeof i=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),Dr.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});i={setIndex:!0,...i};let{index:n,roots:r}=e,s=new Dr(t,{...i,[Q2]:!0});if(s._roots=r,i.setIndex){let o=t.getIndex();if(o===null){let a=new zt(e.index,1,!1);t.setIndex(a)}else o.array!==n&&(o.array.set(n),o.needsUpdate=!0)}return s}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[Q2]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[Q2]||(this._roots=XDe(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Vn))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,i=t.index.array,n=t.attributes.position,r=n.array,s=n.offset||0,o=3;n.isInterleavedBufferAttribute&&(o=n.data.stride);let a,l,c,h,u=0,d=this._roots;for(let p=0,g=d.length;p<g;p++)a=d[p],l=new Uint32Array(a),c=new Uint16Array(a),h=new Float32Array(a),f(0,u),u+=a.byteLength;function f(p,g,m=!1){let v=p*2;if(c[v+15]===65535){let x=l[p+6],w=c[v+14],b=1/0,M=1/0,A=1/0,T=-1/0,S=-1/0,C=-1/0;for(let P=3*x,B=3*(x+w);P<B;P++){let k=i[P]*o+s,z=r[k+0],F=r[k+1],W=r[k+2];z<b&&(b=z),z>T&&(T=z),F<M&&(M=F),F>S&&(S=F),W<A&&(A=W),W>C&&(C=W)}return h[p+0]!==b||h[p+1]!==M||h[p+2]!==A||h[p+3]!==T||h[p+4]!==S||h[p+5]!==C?(h[p+0]=b,h[p+1]=M,h[p+2]=A,h[p+3]=T,h[p+4]=S,h[p+5]=C,!0):!1}else{let x=p+8,w=l[p+6],b=x+g,M=w+g,A=m,T=!1,S=!1;e?A||(T=e.has(b),S=e.has(M),A=!T&&!S):(T=!0,S=!0);let C=A||T,P=A||S,B=!1;C&&(B=f(x,g,A));let k=!1;P&&(k=f(w,g,A));let z=B||k;if(z)for(let F=0;F<3;F++){let W=x+F,K=w+F,Z=h[W],U=h[W+3],X=h[K],V=h[K+3];h[p+F]=Z<X?Z:X,h[p+F+3]=U>V?U:V}return z}}}traverse(e,t=0){let i=this._roots[t],n=new Uint32Array(i),r=new Uint16Array(i);s(0);function s(o,a=0){let l=o*2,c=r[l+15]===65535;if(c){let h=n[o+6],u=r[l+14];e(a,c,new Float32Array(i,o*4,6),h,u)}else{let h=o+8,u=n[o+6],d=n[o+7];e(a,c,new Float32Array(i,o*4,6),d)||(s(h,a+1),s(u,a+1))}}}raycast(e,t=Ka){let i=this._roots,n=this.geometry,r=[],s=t.isMaterial,o=Array.isArray(t),a=n.groups,l=s?t.side:t;for(let c=0,h=i.length;c<h;c++){let u=o?t[a[c].materialIndex].side:l,d=r.length;if(Z0(i[c]),HB(0,n,u,e,r),xb(),o){let f=a[c].materialIndex;for(let p=d,g=r.length;p<g;p++)r[p].face.materialIndex=f}}return r}raycastFirst(e,t=Ka){let i=this._roots,n=this.geometry,r=t.isMaterial,s=Array.isArray(t),o=null,a=n.groups,l=r?t.side:t;for(let c=0,h=i.length;c<h;c++){let u=s?t[a[c].materialIndex].side:l;Z0(i[c]);let d=VB(0,n,u,e);xb(),d!=null&&(o==null||d.distance<o.distance)&&(o=d,s&&(d.face.materialIndex=a[c].materialIndex))}return o}intersectsGeometry(e,t){let i=this.geometry,n=!1;for(let r of this._roots)if(Z0(r),n=n3e(0,i,e,t),xb(),n)break;return n}shapecast(e,t,i){let n=this.geometry;if(e instanceof Function){if(t){let u=t;t=(d,f,p,g)=>{let m=f*3;return u(d,m,m+1,m+2,p,g)}}e={boundsTraverseOrder:i,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let r=ml.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:o,intersectsRange:a,intersectsTriangle:l}=e;if(a&&l){let u=a;a=(d,f,p,g,m)=>u(d,f,p,g,m)?!0:RV(d,f,n,l,p,g,r)}else a||(l?a=(u,d,f,p)=>RV(u,d,n,l,f,p,r):a=(u,d,f)=>f);let c=!1,h=0;for(let u of this._roots){if(Z0(u),c=i3e(0,n,o,a,s,h),xb(),c)break;h+=u.byteLength}return ml.releasePrimitive(r),c}bvhcast(e,t,i){let{intersectsRanges:n,intersectsTriangles:r}=i,s=this.geometry.index,o=this.geometry.attributes.position,a=e.geometry.index,l=e.geometry.attributes.position;Zp.copy(t).invert();let c=ml.getPrimitive(),h=ml.getPrimitive();if(r){let d=function(f,p,g,m,v,x,w,b){for(let M=g,A=g+m;M<A;M++){Dl(h,M*3,a,l),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let T=f,S=f+p;T<S;T++)if(Dl(c,T*3,s,o),c.needsUpdate=!0,r(c,h,T,M,v,x,w,b))return!0}return!1};if(n){let f=n;n=function(p,g,m,v,x,w,b,M){return f(p,g,m,v,x,w,b,M)?!0:d(p,g,m,v,x,w,b,M)}}else n=d}e.getBoundingBox(K2),K2.applyMatrix4(t);let u=this.shapecast({intersectsBounds:d=>K2.intersectsBox(d),intersectsRange:(d,f,p,g,m,v)=>(J2.copy(v),J2.applyMatrix4(Zp),e.shapecast({intersectsBounds:x=>J2.intersectsBox(x),intersectsRange:(x,w,b,M,A)=>n(d,f,x,w,g,m,M,A)}))});return ml.releasePrimitive(c),ml.releasePrimitive(h),u}intersectsBox(e,t){return Cd.set(e.min,e.max,t),Cd.needsUpdate=!0,this.shapecast({intersectsBounds:i=>Cd.intersectsBox(i),intersectsTriangle:i=>Cd.intersectsTriangle(i)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,i={},n={},r=0,s=1/0){e.boundingBox||e.computeBoundingBox(),Cd.set(e.boundingBox.min,e.boundingBox.max,t),Cd.needsUpdate=!0;let o=this.geometry,a=o.attributes.position,l=o.index,c=e.attributes.position,h=e.index,u=ml.getPrimitive(),d=ml.getPrimitive(),f=wb,p=r3e,g=null,m=null;n&&(g=s3e,m=o3e);let v=1/0,x=null,w=null;return Zp.copy(t).invert(),A0.matrix.copy(Zp),this.shapecast({boundsTraverseOrder:b=>Cd.distanceToBox(b),intersectsBounds:(b,M,A)=>A<v&&A<s?(M&&(A0.min.copy(b.min),A0.max.copy(b.max),A0.needsUpdate=!0),!0):!1,intersectsRange:(b,M)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:A=>A0.distanceToBox(A),intersectsBounds:(A,T,S)=>S<v&&S<s,intersectsRange:(A,T)=>{for(let S=A*3,C=(A+T)*3;S<C;S+=3){Dl(d,S,h,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let P=b*3,B=(b+M)*3;P<B;P+=3){Dl(u,P,l,a),u.needsUpdate=!0;let k=u.distanceToTriangle(d,f,g);if(k<v&&(p.copy(f),m&&m.copy(g),v=k,x=P/3,w=S/3),k<r)return!0}}}});{let A=h?h.count:c.count;for(let T=0,S=A;T<S;T+=3){Dl(d,T,h,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let C=b*3,P=(b+M)*3;C<P;C+=3){Dl(u,C,l,a),u.needsUpdate=!0;let B=u.distanceToTriangle(d,f,g);if(B<v&&(p.copy(f),m&&m.copy(g),v=B,x=C/3,w=T/3),B<r)return!0}}}}}),ml.releasePrimitive(u),ml.releasePrimitive(d),v===1/0?null:(i.point?i.point.copy(p):i.point=p.clone(),i.distance=v,i.faceIndex=x,n&&(n.point?n.point.copy(m):n.point=m.clone(),n.point.applyMatrix4(Zp),p.applyMatrix4(Zp),n.distance=p.sub(n.point).length(),n.faceIndex=w),i)}closestPointToPoint(e,t={},i=0,n=1/0){let r=i*i,s=n*n,o=1/0,a=null;if(this.shapecast({boundsTraverseOrder:c=>(S0.copy(e).clamp(c.min,c.max),S0.distanceToSquared(e)),intersectsBounds:(c,h,u)=>u<o&&u<s,intersectsTriangle:(c,h)=>{c.closestPointToPoint(e,S0);let u=e.distanceToSquared(S0);return u<o&&(wb.copy(S0),o=u,a=h),u<r}}),o===1/0)return null;let l=Math.sqrt(o);return t.point?t.point.copy(wb):t.point=wb.clone(),t.distance=l,t.faceIndex=a,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{Il(0,new Float32Array(t),IV),e.union(IV)}),e}},OV=Dr.prototype.raycast;Dr.prototype.raycast=function(...e){if(e[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycast" has changed. See docs for new signature.');let[t,i,n,r]=e;return OV.call(this,n,t.material).forEach(s=>{s=oJ(s,t,i),s&&r.push(s)}),r}else return OV.apply(this,e)};var FV=Dr.prototype.raycastFirst;Dr.prototype.raycastFirst=function(...e){if(e[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycastFirst" has changed. See docs for new signature.');let[t,i,n]=e;return oJ(FV.call(this,n,t.material),t,i)}else return FV.apply(this,e)};var NV=Dr.prototype.closestPointToPoint;Dr.prototype.closestPointToPoint=function(...e){if(e[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "closestPointToPoint" has changed. See docs for new signature.'),e.unshift();let t=e[1],i={};return e[1]=i,NV.apply(this,e),t&&t.copy(i.point),i.distance}else return NV.apply(this,e)};var zV=Dr.prototype.closestPointToGeometry;Dr.prototype.closestPointToGeometry=function(...e){let t=e[2],i=e[3];if(t&&t.isVector3||i&&i.isVector3){console.warn('MeshBVH: The function signature and results frame for "closestPointToGeometry" has changed. See docs for new signature.');let n={},r={},s=e[1];return e[2]=n,e[3]=r,zV.apply(this,e),t&&t.copy(n.point),i&&i.copy(r.point).applyMatrix4(s),n.distance}else return zV.apply(this,e)};var kV=Dr.prototype.refit;Dr.prototype.refit=function(...e){let t=e[0],i=e[1];if(i&&(i instanceof Set||Array.isArray(i))){console.warn('MeshBVH: The function signature for "refit" has changed. See docs for new signature.');let n=new Set;i.forEach(r=>n.add(r)),t&&t.forEach(r=>n.add(r)),kV.call(this,n)}else kV.apply(this,e)};["intersectsGeometry","shapecast","intersectsBox","intersectsSphere"].forEach(e=>{let t=Dr.prototype[e];Dr.prototype[e]=function(...i){return(i[0]===null||i[0].isMesh)&&(i.shift(),console.warn(`MeshBVH: The function signature for "${e}" has changed and no longer takes Mesh. See docs for new signature.`)),t.apply(this,i)}});var M0=x1(Zge()),a3e=.5*(Math.sqrt(3)-1),E0=(3-Math.sqrt(3))/6,l3e=1/3,gl=1/6,Ty=e=>Math.floor(e)|0,UV=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),Z2=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function $2(e=Math.random){let t=lJ(e),i=new Float64Array(t).map(r=>UV[r%12*2]),n=new Float64Array(t).map(r=>UV[r%12*2+1]);return function(r,s){let o=0,a=0,l=0,c=(r+s)*a3e,h=Ty(r+c),u=Ty(s+c),d=(h+u)*E0,f=h-d,p=u-d,g=r-f,m=s-p,v,x;g>m?(v=1,x=0):(v=0,x=1);let w=g-v+E0,b=m-x+E0,M=g-1+2*E0,A=m-1+2*E0,T=h&255,S=u&255,C=.5-g*g-m*m;if(C>=0){let k=T+t[S],z=i[k],F=n[k];C*=C,o=C*C*(z*g+F*m)}let P=.5-w*w-b*b;if(P>=0){let k=T+v+t[S+x],z=i[k],F=n[k];P*=P,a=P*P*(z*w+F*b)}let B=.5-M*M-A*A;if(B>=0){let k=T+1+t[S+1],z=i[k],F=n[k];B*=B,l=B*B*(z*M+F*A)}return 70*(o+a+l)}}function c3e(e=Math.random){let t=lJ(e),i=new Float64Array(t).map(s=>Z2[s%12*3]),n=new Float64Array(t).map(s=>Z2[s%12*3+1]),r=new Float64Array(t).map(s=>Z2[s%12*3+2]);return function(s,o,a){let l,c,h,u,d=(s+o+a)*l3e,f=Ty(s+d),p=Ty(o+d),g=Ty(a+d),m=(f+p+g)*gl,v=f-m,x=p-m,w=g-m,b=s-v,M=o-x,A=a-w,T,S,C,P,B,k;b>=M?M>=A?(T=1,S=0,C=0,P=1,B=1,k=0):b>=A?(T=1,S=0,C=0,P=1,B=0,k=1):(T=0,S=0,C=1,P=1,B=0,k=1):M<A?(T=0,S=0,C=1,P=0,B=1,k=1):b<A?(T=0,S=1,C=0,P=0,B=1,k=1):(T=0,S=1,C=0,P=1,B=1,k=0);let z=b-T+gl,F=M-S+gl,W=A-C+gl,K=b-P+2*gl,Z=M-B+2*gl,U=A-k+2*gl,X=b-1+3*gl,V=M-1+3*gl,q=A-1+3*gl,H=f&255,Q=p&255,J=g&255,le=.6-b*b-M*M-A*A;if(le<0)l=0;else{let me=H+t[Q+t[J]];le*=le,l=le*le*(i[me]*b+n[me]*M+r[me]*A)}let j=.6-z*z-F*F-W*W;if(j<0)c=0;else{let me=H+T+t[Q+S+t[J+C]];j*=j,c=j*j*(i[me]*z+n[me]*F+r[me]*W)}let ve=.6-K*K-Z*Z-U*U;if(ve<0)h=0;else{let me=H+P+t[Q+B+t[J+k]];ve*=ve,h=ve*ve*(i[me]*K+n[me]*Z+r[me]*U)}let pe=.6-X*X-V*V-q*q;if(pe<0)u=0;else{let me=H+1+t[Q+1+t[J+1]];pe*=pe,u=pe*pe*(i[me]*X+n[me]*V+r[me]*q)}return 32*(l+c+h+u)}}function lJ(e){let t=new Uint8Array(512);for(let i=0;i<512/2;i++)t[i]=i;for(let i=0;i<512/2-1;i++){let n=i+~~(e()*(256-i)),r=t[i];t[i]=t[n],t[n]=r}for(let i=256;i<512;i++)t[i]=t[i-256];return t}var Ea=new Rs,u3e=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let r=1;Ea.a.fromBufferAttribute(e,n),Ea.b.fromBufferAttribute(e,n+1),Ea.c.fromBufferAttribute(e,n+2),r*=Ea.getArea(),t[n/3]=r}this.distribution=new Float32Array(e.count/3);let i=0;for(let n=0;n<t.length;n++)i+=t[n],this.distribution[n]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let i=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*i);return this.sampleFace(n,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,i=0,n=t.length-1,r=-1;for(;i<=n;){let s=Math.ceil((i+n)/2);if(s===0||t[s-1]<=e&&t[s]>e){r=s;break}else e<t[s]?n=s-1:i=s+1}return r}sampleFace(e,t,i){let n=this.randomFunction(),r=this.randomFunction();return n+r>1&&(n=1-n,r=1-r),Ea.a.fromBufferAttribute(this.positionAttribute,e*3),Ea.b.fromBufferAttribute(this.positionAttribute,e*3+1),Ea.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(Ea.a,n).addScaledVector(Ea.b,r).addScaledVector(Ea.c,1-(n+r)),Ea.getNormal(i),this}},h3e=x1(iq()),d3e=new Je,f3e=new Je,p3e=new Je,jS;(e=>{function t(i){return i&&i.__isSPEObject}e.is=t})(jS||(jS={}));var VO=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new Je,this.copyPreviousMatrix=!0,this.hiddenMatrix=new Je,this.matrixWorldRigid=new Je,this.shearScale=new Je,this.shearScaleInv=new Je}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof Ii&&(t=t.uuid);let i=this;for(;i.parent;){if(i.parent.uuid===t)return!0;i=i.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let i of this.children)i.updateMatrixWorld(t)}updateWorldMatrix(t,i){let n=this.parent;if(t&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),i)for(let r of this.children)r.updateWorldMatrix(!1,!0)}traverseObject(t,i=0){if(t(this,i)!==!0)for(let n of this.children)jS.is(n)&&n.traverseObject(t,i+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,i=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:n,v:r,q:s}=(0,h3e.SVD)(i),o=d3e.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),a=f3e.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),l=p3e.copy(a).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(a),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(o,l).copyPosition(this.matrixWorld),s.every(c=>Math.abs(s[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,i){this.updateWorldMatrix(!0,!1);let n=new Je().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),n.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof Je?t.hiddenMatrix.premultiply(n):t.applyMatrix4(n),t.updateWorldMatrix(!1,!1),this.add(t),i!==void 0&&(this.children.pop(),this.children.splice(i,0,t)),this}copy(t,i=!1){return super.copy(t,i),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,i,n,r,s,o){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},m3e=class extends VO(Ii){},g3e=e=>e.type==="Mesh",fs=class extends m3e{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){let i=this.children[e];(i==null?void 0:i.object)!==t&&(i&&this.remove(i),i=new fs(t),this.add(i),this.children.splice(e,0,this.children.pop()),i.matrixWorldNeedsUpdate=!0,i.matrixAutoUpdate=!1,i.matrix=t.matrix,i.hiddenMatrix=t.hiddenMatrix),i.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((e=this.object.dataPatched.cloner)==null?void 0:e.hideBase)===!0}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return g3e(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Wd=new I,Xd=new I,ag=new Je,cJ=[new I(-1,1,1),new I(-1,-1,1),new I(1,-1,1),new I(1,1,1),new I(-1,1,-1),new I(-1,-1,-1),new I(1,-1,-1),new I(1,1,-1)],v3e=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],y3e=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],GV=(e,t,i)=>{e.updateEntityBoxSize(Wd,Xd),ag.copy(t).multiply(e.matrixWorld),Xd.x===0&&Xd.y===0&&Xd.z===0?i.push(new I(Wd.x,Wd.y,Wd.z).applyMatrix4(ag)):cJ.forEach(n=>{i.push(n.clone().multiply(Xd).add(Wd).applyMatrix4(ag))})},HV=class extends Vn{constructor(){super(...arguments),this.matrix=new Je,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let i=new Je().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,i,t)}expandByObjectSize(e,t,i=!1){let n=[];return i===!0?e.traverseEntity(r=>{if(r.visible||r.cloner&&r.data.visible){if(!("geometry"in r)){n.push(new I);return}GV(r,t,n)}}):GV(e,t,n),this.setFromPoints(n)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4(ag.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(Xd).multiplyScalar(.5),this.getCenter(Wd),ag.copy(this.matrix).setPosition(Wd),this.vertices=cJ.map(e=>e.clone().multiply(Xd).applyMatrix4(ag))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=v3e.map(([e,t])=>new na(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new I))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=y3e.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}},fh={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},x3e=class extends Cq{constructor(){super()}getPoints(e=12){let t=[],i,n=this.getCurveLengths(),r=n[n.length-1]/n.length;for(let s=0,o=this.curves;s<o.length;s++){let a=o[s],l=s===0?n[s]:n[s]-n[s-1],c=Math.ceil(e*l/r),h=a.getPoints(c);for(let u=0;u<h.length;u++){let d=h[u];i&&i.equals(d)||(t.push(d),i=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}},WB=.001;function XB(e,t,i){return t.clone().sub(e).cross(t.clone().sub(i)).length()<=WB}function eP(e,t){let i=new I(...e.position),n=new I(...e.controlNext.position),r=new I(...t.controlPrevious.position),s=new I(...t.position);return XB(i,n,s)&&XB(i,r,s)}function uJ(e){let t=e.points.map(h=>new I(...h.data.position)),i=[e.points[0]],n=new I(...i[0].data.position);for(let h=0;h<e.points.length-1;h++)XB(n,t[h],t[h+1])||(i.push(e.points[h]),n=t[h]);i.push(e.points[e.points.length-1]);let r=e.isClosed,s=i.length-(r?0:1),o=i.length,a=[];for(let h=0;h<o;h++){let u=i[h].data,d=new I(...u.position),f=new I(...u.controlPrevious.position),p=new I(...u.controlNext.position),g={position:d,baseRoundness:u.roundness,controlPrevious:f,controlNext:p};if(u.roundness===0||!e.isClosed&&(h===0||h===o-1)){a[h]={...g,removedLength:0};continue}let m=r&&h==0?o-1:h-1,v=r&&h==o-1?0:h+1,x=i[m].data,w=i[v].data,b=new I(...x.position),M=new I(...w.position),A=b.clone().sub(d).normalize(),T=M.clone().sub(d).normalize();Object.assign(g,{prevDir:A,nextDir:T});let S=eP(x,u),C=eP(u,w);if(!S||!C)a[h]={...g,removedLength:0};else{let P=A.clone().add(T).normalize(),B=P.clone().cross(A).length()/A.dot(P);a[h]={...g,tan:B,removedLength:u.roundness/B}}}for(let h=0;h<s;h++){let u=h,d=r&&h===o-1?0:h+1,f=a[u],p=a[d];if(f.removedLength!==0||p.removedLength!==0){let g=f.position.distanceTo(p.position);f.removedLength=Math.min(f.removedLength,g/2),p.removedLength=Math.min(p.removedLength,g/2)}}let l=[];for(let h=0;h<s;h++){let u=h,d=r&&h===o-1?0:h+1,f=a[u],p=a[d],g=null;if(!eP(i[u].data,i[d].data))f.position.distanceTo(p.position)>WB&&(g=new mA(f.position,f.controlNext,p.controlPrevious,p.position));else{let m=f.position.clone(),v=p.position.clone();(f.removedLength!==0||p.removedLength!==0)&&(f.nextDir&&m.add(f.nextDir.clone().setLength(f.removedLength)),p.prevDir&&v.add(p.prevDir.clone().setLength(p.removedLength))),m.distanceTo(v)>WB&&(g=new mA(m,m.clone().lerp(v,.3),v.clone().lerp(m,.3),v))}l[2*h+1]=g}for(let h=0;h<o;h++){let u=a[h];if(u.removedLength===0){l[2*h]=null;continue}let d=u.position,f=u.prevDir.clone().multiplyScalar(u.removedLength).add(d),p=u.nextDir.clone().multiplyScalar(u.removedLength).add(d),g=u.tan*u.removedLength,m=u.prevDir.clone().add(u.nextDir).normalize(),v=f.clone().lerp(p,.5),x=f.distanceTo(p)/2,w=m.clone().multiplyScalar(Math.sqrt(Math.pow(g,2)-Math.pow(x,2))).add(v),b=m.clone().multiplyScalar(-g).add(w),M=d.distanceTo(b)/d.distanceTo(v),A=u.prevDir.clone().multiplyScalar(M*d.distanceTo(f)).add(d),T=A.clone().lerp(b,2),S=f.clone().lerp(A,4/3),C=p.clone().lerp(T,4/3);l[2*h]=new mA(f,S,C,p)}let c=new x3e;return l.forEach(h=>{h&&c.add(h)}),c}var Ei;(e=>{function t(i){return i&&i.__isEntity}e.is=t})(Ei||(Ei={}));var sh=e=>Ei.is(e),w3e={type:"completeState",isfromEntity:!0},hJ=e=>class extends VO(e){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new HV,this._recursiveBBox=new HV,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let i=this.children[t];if(Ei.is(i))return i}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let t=this;for(;t.data.type!=="Instance";){let i=t.parent;if(Ei.is(i))t=i;else return}return t}forInstancesRec(t){this.instances.forEach(i=>{i.disposed||t(i),i.forInstancesRec(t)})}super_Entity(t,i){typeof t=="string"&&(this.uuid=t),this.identity=t,this.data=i,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,i,n=!1){if(!(this.data.states.length===0&&!n)){for(let r of this.data.states)of.toOps(this.data,r.data).forEach(s=>{let o=xB.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(o,this.data,i)});if(t!==null){let r=this.data.states.data(t);r&&(this.dataPatched=of.patch(this.data,r),of.toOps(this.data,r).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,i)}))}n&&this.updateTransformState(this.dataPatched),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,i){t.setScalar(0),i.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{sh(t)&&t.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(t=>{t.resetBBoxNeedsUpdateSelf()})}find(t){let i;return this.traverseEntity(n=>{n.uuid===t&&(i=n)}),i}traverseSortNextHelper(){let t=this.parent;if(t){let i=t.children,n=i.indexOf(this)+1;if(Ei.is(i[n]))return i[n];if(Ei.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&Ei.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let i=this;for(;t>0&&i!==null;)i=i.parent,t-=1;return i}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let i=this.parent;for(;i;){if(t===i)return!0;i=i.parent}return!1}countToAccestor(t){let i=0,n=this;for(;n!==t;){if(n===null)return-1;n=n.parent,i+=1}return i}forEachEntity(t){for(let i of this.children)sh(i)&&t(i)}traverseEntityAncestors(t){this.traverseAncestors(i=>{Ei.is(i)&&t(i)})}traverseEntity(t,i=0){if(t(this,i)!==!0)for(let n of this.children)sh(n)&&n.traverseEntity(t,i+1)}traverseVisibleEntity(t){t(this);for(let i of this.children)sh(i)&&i.visible&&i.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}copy(t,i=!1){return super.copy(t,i),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some(t=>sh(t))}isAncestorOf(t){if(this.uuid===t)return!1;let i=!1;return this.traverseEntity(n=>{n.uuid===t&&(i=!0)}),i}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let i={position:this.position.toArray(),rotation:[this.rotation.x,this.rotation.y,this.rotation.z],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return yB(i,t)}updateTransformState(t){let i=!1;return t.position&&(this.position.fromArray(t.position),i=!0),t.rotation&&(this.rotation.fromArray(t.rotation),i=!0),t.scale&&(i=!0,this.scale.fromArray(t.scale)),t.hiddenMatrix!==void 0&&(i=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??Gg.identity)),i&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),i}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)Ei.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(t=>{Ei.is(t)&&t.disposeRecursively()})}toState(t=[]){let i={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return yB(i,t)}updateByOp(t,i,n,r){let s=this.data;this.data=i;let o=t,a=nh(t.path,["states","*"]);if(a!==null){if(t.type===0){let[l]=a;if((this==null?void 0:this.stateSelection)===l){let c={...t.props};if(Object.values(t.props).some(h=>h===void 0)){let h=this.data;if(h!==void 0){let u=jl.zoom(h,t.path.slice(2));if(u)for(let d in t.props)t.props[d]===void 0&&d in u&&(c[d]=u[d])}}o={...t,props:c,path:t.path.slice(2)}}}}else if(t.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(t.props.name!==void 0&&l.name){let{name:h,...u}=l;l=u}if(t.props.material!==void 0&&"material"in l){let{material:h,...u}=l;l=u}let c=jl.removeOverridden(t.path,t.props,l);o={...t,props:c}}}if(this.updateByPatchedOpBase(o,of.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),n),nh(t.path,["overrides"])){let l=[],c=[...t.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(t.type===0)for(let h of Object.keys(t.props)){l[l.length-1]=h;let u=n.scene.findInstance([this.uuid,...l]);u&&(u.overrideData=t.props[h],u.updateState(Af.apply(u.component.data,u.overrideData),n))}}else{let h=n.scene.findInstance([this.uuid,...l]);if(h){let u=jl.zoom(h.component.data,c);if(t={...t,path:c},t.type===0){let d=t.props;if(u)for(let[f,p]of Object.entries(t.props))p===void 0&&(d===t.props&&(d={...t.props}),d[f]=u[f]);t={...t,props:d}}h.overrideData=NS.resolve(i.overrides,l),h.updateByOp(t,fo.applySimple(h.data,t),n,!1)}}}else if(this.instances.length>0){let l;if(t.path.length===0&&t.type===0){let c;for(let h of Vg.rootOverrideProps)h in t.props&&(c===void 0&&(c={}),c[h]=t.props[h]);c&&(l={...t,props:c})}else for(let c of Vg.rootOverrideProps)if(nh(t.path,[c])){l=t;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let h=Af.filterOp(c.overrideData,l);h&&c.updateByOp(h,fo.applySimple(c.data,h),n,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let h=Af.filterOp(c.overrideData,t);if(h){let u;s===c.data&&t===h?u=i:u=fo.applySimple(c.data,h),c.updateByOp(h,u,n,!0)}}})}}updateByPatchedOpBase(t,i,n){if(this.dataPatched=i,t.path.length===0&&t.type===0)t.props.type!==void 0&&!Gf.is(t.props.type)&&fh.changeEntityProptotype(this,i,n);else if(t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&"type"in t.props){fh.changeEntityProptotype(this,i,n);for(let r of this.children)Ei.is(r)&&r.updateVisible()}this.updateByPatchedOp(t,i,n)}updateByPatchedOp(t,i,n){if(t.path.length===0&&t.type===0&&this.updateState(t.props,n),nh(t.path,["pathSnapping"])!==null&&this.updatePathSnapping(i.pathSnapping),nh(t.path,["cloner"])!==null){let r=fo.drop(t,1);r.path.length===0&&r.type===0&&r.props.disabled===!0?this.setFromClonerState(null,n):this.cloner?this.cloner.updateState(i.cloner,n.scene):(this.setFromClonerState(i.cloner,n),this.expandCloner(n.scene)),this.updateVisible()}}updatePathSnapping(t){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){var p,g,m,v,x;let i=((p=this._updatedPathSnapping)==null?void 0:p.pathId)??this.dataPatched.pathSnapping.pathId,n=((g=this._updatedPathSnapping)==null?void 0:g.slide)??this.dataPatched.pathSnapping.slide??0,r=((m=this._updatedPathSnapping)==null?void 0:m.offset)??this.dataPatched.pathSnapping.offset,s=((v=this._updatedPathSnapping)==null?void 0:v.orientation)??this.dataPatched.pathSnapping.orientation;if(i===null)return;let o=t.find(i);if(!o||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let a=o.data,l=uJ(a.geometry.path),c=(n+r)%1;n+r===1&&c===0&&(c=1);let h=l.getPointAt(c),u=this.parent?(x=this.parent)==null?void 0:x.matrixWorld:new Je;o.updateMatrixWorld();let d=new Je().multiplyMatrices(u.clone().invert(),o.matrixWorld);h.applyMatrix4(d);let f={position:h.toArray(),rotation:a.rotation};if(s==="tangential"){let w=new Je().extractRotation(o.matrixWorld),b=l.getTangentAt(c).applyMatrix4(w).add(h),M=new Je().lookAt(h,b,new I(0,1,0)),A=new Er().setFromRotationMatrix(M);f={...f,rotation:[A.x,A.y,A.z]}}this.updateTransformState(f),this.traverseEntity(w=>{w._cameraType&&w.dispatchEvent(w3e)})}updateVisible(){var t;this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((t=this.dataPatched.cloner)==null?void 0:t.hideBase)!==!0)}updateState_Entity(t,i){t.name!==void 0&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.visible!==void 0&&(this.updateVisible(),this.resetBBoxNeedsUpdate()),"cloner"in t&&t.cloner!==void 0&&(this.setFromClonerState(t.cloner,i),this.updateVisible()),this.updateTransformState(t)}get attachedSurfaceCloners(){return this.children.filter(t=>t instanceof fh.Cloner&&t.parameters.type==="toObject")}setFromClonerState(t,i){this.disposed||(t===null||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new fh.Cloner(this,t),i.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,i.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}},dJ=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters),n=i.width/2,r=i.radiusTop??n,s=i.radiusBottom??n;return r===s?(r=n,s=n):r>s?(r=n,s=s*n/r):(r=r*n/s,s=n),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),radiusTop:r,radiusBottom:s})}}static build(e){let{width:t,depth:i,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,radiusTop:c,radiusBottom:h,cornerRadius:u,cornerSegments:d,hollow:f}=e.parameters,p;return u||f?p=new fJ(c,h,n,r,s,o,a,l*Math.PI/180,u,u,d,f):p=new aO(c,h,n,r,s,o,a,l*Math.PI/180),p.scale(1,1,i/t),Object.assign(p,{userData:{...e,type:"CylinderGeometry"}})}};function Fu(e,t,i){i.x=e.x*t.x,i.y=e.y,i.z=e.x*t.y}function VV(e){return new ge(e.y,-e.x)}var fJ=class extends Ot{constructor(e,t,i,n,r,s,o,a,l,c,h,u,d=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,i=i||1,n=Math.floor(n)||8,r=Math.floor(r)||1,s=s!==void 0?s:!1,o=o!==void 0?o:0,a=a!==void 0?a:Math.PI*2,s&&(l=0,c=0);let f=[],p=[],g=[],m=[],v=0,x=i/2,w=new I,b=new I;d&&e==0&&(e=l),d&&t==0&&(t=c);let M=new ge(e,x),A=new ge(t,-x),T=null,S=null,C=null,P=null,B=M.clone().sub(A),k=0,z=0,F=0;u>0&&(k=Math.min(e,t)*(1-u),z=e-k,F=t-k);let W=M.clone();W.x-=k;let K=Math.PI-B.angle(),Z=B.angle(),U=Math.tan(Z/2),X=Math.tan(K/2),V=U+X,q=u?V:X,H=u?V:U;if(l=Math.min(l,(e-z)/q,B.length()/V),c=Math.min(c,(t-F)/H,B.length()/V),l>0){let pe=l/U;T=M.clone().sub(new ge(pe,l)),u&&(C=T.clone(),C.x-=k-V*l),M.sub(B.clone().setLength(pe))}if(c>0){let pe=c/X;S=A.clone().sub(new ge(pe,-c)),A.add(B.clone().setLength(pe)),u&&(P=S.clone(),P.x-=k-V*c,W.sub(B.clone().setLength(pe)))}B=M.clone().sub(A);let Q=B.length()<.5,J=[];for(let pe=0;pe<=n;pe++){let me=[],de=pe/n,Se=de*a+o,ce=new ge(Math.sin(Se),Math.cos(Se));P&&S?(le(me,de,ce,K,c,P,-1,!0),le(me,de,ce,Z,c,S,-1,!1)):S?(j(me,ce,S.x,0,-1),le(me,de,ce,Z,c,S,-1,!1)):s||j(me,ce,t,F,-1);let se=VV(B).normalize();if(Fu(se,ce,w),!Q)for(let be=0;be<=r;be++){let Ee=be/r,Le=B.clone().multiplyScalar(Ee).add(A);Fu(Le,ce,b),p.push(b.x,b.y,b.z),g.push(w.x,w.y,w.z),m.push(de,.5+b.y/i),me.push(v++)}if(C&&T?(le(me,de,ce,K,l,T,1,!1),le(me,de,ce,Z,l,C,1,!0)):T?(le(me,de,ce,K,l,T,1,!1),j(me,ce,T.x,0,1)):s||j(me,ce,e,z,1),u&&!Q){let be=VV(B).multiplyScalar(-1).normalize();Fu(be,ce,w);for(let Ee=0;Ee<=r;Ee++){let Le=Ee/r,ze=B.clone().multiplyScalar(-Le).add(W);Fu(ze,ce,b),p.push(b.x,b.y,b.z),g.push(w.x,w.y,w.z),m.push(de,.5+b.y/i),me.push(v++)}}u&&!s&&me.push(me[0]),J.push(me)}for(let pe=0;pe<J.length-1;pe++)for(let me=0;me<J[0].length-1;me++){if(s&&u&&me==r)continue;let de=J[pe][me],Se=J[pe+1][me],ce=J[pe+1][me+1],se=J[pe][me+1],be=p[ce*3+0],Ee=p[ce*3+2];f.push(de,Se,se),(be!=0||Ee!=0)&&f.push(Se,ce,se)}a<Math.PI*2&&(ve(-1,J[0],o),ve(1,J[J.length-1],o+a)),this.setIndex(f),this.setAttribute("position",new gt(p,3)),this.setAttribute("normal",new gt(g,3)),this.setAttribute("uv",new gt(m,2));function le(pe,me,de,Se,ce,se,be,Ee){for(let Le=0;Le<h+1;Le++){let ze=Le/h,Oe=be<0?ze:1-ze;Ee&&(Oe-=1),Oe*=Se;let Ge=new ge(Math.sin(Oe),Math.cos(Oe)*be),tt=Ge.clone().multiplyScalar(ce).add(se);Fu(tt,de,b),p.push(b.x,b.y,b.z),Fu(Ge,de,w),g.push(w.x,w.y,w.z),m.push(me,.5+b.y/i),pe.push(v++)}}function j(pe,me,de,Se,ce){let se=new I,be=new ge,Ee=[de,Se];ce<0&&Ee.reverse();for(let Le of Ee)be.set(Le,x*ce),Fu(be,me,se),p.push(se.x,se.y,se.z),g.push(0,ce,0),m.push(.5,.5),pe.push(v++)}function ve(pe,me,de){let Se=new ge(Math.sin(de),Math.cos(de)),ce=new ge(-Math.cos(de),Math.sin(de)),se=new I,be=pe<0?(ze,Oe,Ge)=>f.push(ze,Oe,Ge):(ze,Oe,Ge)=>f.push(ze,Ge,Oe),Ee=new ge((e+t+z+F)/4,0);Fu(Ee,Se,se),p.push(se.x,se.y,se.z),g.push(ce.x,0,ce.y),m.push(.5,.5);let Le=v++;for(let ze of me){let Oe=p.slice(ze*3,ze*3+3);p.push(...Oe),g.push(ce.x,0,ce.y);let Ge=m.slice(ze*2,ze*2+2);m.push(...Ge),v++}for(let ze=Le+1;ze<v-1;ze++)be(Le,ze,ze+1);be(Le,v-1,Le+1)}}},_3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,depth:i,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:h,cornerSegments:u}=e.parameters,d;return c>0||h>0||l<360?d=new fJ(0,t/2,n,r,s,o,a,l*Math.PI/180,c,h,u,0,!0):d=new Pq(t/2,n,r,s,o),d.scale(1,1,i/t),Object.assign(d,{userData:{...e,type:"ConeGeometry"}})}},b3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:n,widthSegments:r,heightSegments:s,depthSegments:o,cornerRadius:a,cornerSegments:l}=e.parameters,c;return a==0?c=new Jl(t,i,n,r,s,o):c=new A3e(t,i,n,r,s,o,a,l),Object.assign(c,{userData:{...e,type:"CubeGeometry"}})}},tP=Math.PI/2,A3e=class extends Ot{constructor(e=1,t=1,i=1,n=1,r=1,s=1,o=0,a=4){super(),this.type="BoxGeometry";let l=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s),a=Math.floor(a),o=Math.min(o,e/2,t/2,i/2);let c=[],h=[],u=[],d=[],f=0,p=0;g("z","y","x",-1,-1,i,t,e,s,r,0),g("z","y","x",1,-1,i,t,-e,s,r,1),g("x","z","y",1,1,e,i,t,n,s,2),g("x","z","y",1,-1,e,i,-t,n,s,3),g("x","y","z",1,-1,e,t,i,n,r,4),g("x","y","z",-1,-1,e,t,-i,n,r,5),o>0&&(m("z","y","x",-1,-1,1,i,t,e,s,0),m("z","y","x",1,-1,-1,i,t,e,s,1),m("z","y","x",-1,1,-1,i,t,e,s,1),m("z","y","x",1,1,1,i,t,e,s,0),m("x","y","z",-1,-1,-1,e,t,i,n,0),m("x","y","z",1,-1,1,e,t,i,n,1),m("x","y","z",-1,1,1,e,t,i,n,0),m("x","y","z",1,1,-1,e,t,i,n,1),m("y","x","z",-1,-1,1,t,e,i,r,0),m("y","x","z",1,-1,-1,t,e,i,r,1),m("y","x","z",1,1,1,t,e,i,r,1),m("y","x","z",-1,1,-1,t,e,i,r,0),v(1,1,1),v(-1,1,1),v(1,-1,1),v(-1,-1,1),v(1,1,-1),v(-1,1,-1),v(1,-1,-1),v(-1,-1,-1)),this.setIndex(c),this.setAttribute("position",new gt(h,3)),this.setAttribute("normal",new gt(u,3)),this.setAttribute("uv",new gt(d,2));function g(x,w,b,M,A,T,S,C,P,B,k){let z=(T-2*o)/P,F=(S-2*o)/B,W=T/2-o,K=S/2-o,Z=C/2,U=P+1,X=B+1,V=0,q=0,H=new I;for(let Q=0;Q<X;Q++){let J=Q*F-K;for(let le=0;le<U;le++){let j=le*z-W;H[x]=j*M,H[w]=J*A,H[b]=Z,h.push(H.x,H.y,H.z),H[x]=0,H[w]=0,H[b]=C>0?1:-1,u.push(H.x,H.y,H.z),d.push(le/P),d.push(1-Q/B),V+=1}}for(let Q=0;Q<B;Q++)for(let J=0;J<P;J++){let le=f+J+U*Q,j=f+J+U*(Q+1),ve=f+(J+1)+U*(Q+1),pe=f+(J+1)+U*Q;c.push(le,j,pe),c.push(j,ve,pe),q+=6}l.addGroup(p,q,k),p+=q,f+=V}function m(x,w,b,M,A,T,S,C,P,B,k){let z=(S-2*o)/B,F=S/2-o,W=C/2-o,K=P/2,Z=B+1,U=0,X=0,V=new I,q=new I;for(let H=0;H<a+1;H++){let Q=H/a*tP,J=Math.sin(Q)*o,le=(1-Math.cos(Q))*o,j=Math.sin(Q),ve=Math.cos(Q);V[w]=(W+J)*A,V[b]=(K-le)*T,q[x]=0,q[w]=j*Math.sign(V[w]),q[b]=ve*Math.sign(V[b]);for(let pe=0;pe<Z;pe++){let me=pe*z-F;V[x]=me*M,h.push(V.x,V.y,V.z),u.push(q.x,q.y,q.z),d.push(pe/B),d.push(0),U+=1}}for(let H=0;H<a;H++)for(let Q=0;Q<B;Q++){let J=f+Q+Z*H,le=f+Q+Z*(H+1),j=f+(Q+1)+Z*(H+1),ve=f+(Q+1)+Z*H;c.push(J,le,ve),c.push(le,j,ve),X+=6}l.addGroup(p,X,k),p+=X,f+=U}function v(x,w,b){let M=new I,A=new I(e/2,t/2,i/2);A.subScalar(o);let T=[],S=x*w*b>0?(P,B,k)=>c.push(P,B,k):(P,B,k)=>c.push(P,k,B);for(let P=0;P<=a;P++){let B=[],k=tP*(1-P/a),z=Math.cos(k),F=Math.sin(k),W=0;for(let K=0;K<=P;K++){let Z=Math.cos(W),U=Math.sin(W);M.x=z*Z,M.y=F,M.z=z*U;let X=A.clone().addScaledVector(M,o);h.push(x*X.x,w*X.y,b*X.z),u.push(x*M.x,w*M.y,b*M.z),d.push(0,0),B.push(f++),W+=tP/P}T.push(B)}let C=T.length-1;for(let P=0;P<C;P++){let B=T[P],k=T[P+1],z=B.length-1;S(B[0],k[1],k[0]);for(let F=1;F<=z;F++)S(B[F-1],B[F],k[F]),S(B[F],k[F+1],k[F])}}}},jO=class extends Ot{constructor(e=[],t=[],i="",n=1,r=.2,s=4){super(),this.type="PolyhedronGeometryRound";let o=[],a=[],l=[];c(),h(),this.setAttribute("position",new gt(o,3)),this.setAttribute("normal",new gt(l,3)),this.setAttribute("uv",new gt(a,2));return;function c(){var Z;r=Math.min(1-1e-5,r),r==0&&(s=0);let u={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[i],d=new I,f=d.clone(),p=new Rs,g=r*n,m=n-g,v=s+1,x=new I,w=(U,X)=>x.subVectors(U,X).normalize(),b=(U,X)=>Array(U).fill(void 0).map(X),M=b(e.length/3,(U,X)=>new I().fromArray(e,X*3).setLength(n)),A=[],T=1e6;for(let U=0;U<M.length;U++){let X=M[U],V=[],q,H,Q,J=1e10,le=-1;for(;(le=t.indexOf(U,le+1))!=-1;){let me=le-le%3;q=t[me+(le+1)%3],H=t[me+(le+2)%3],Q=X.distanceToSquared(M[q]),J=Math.min(J,Q),V.push([q,H,Q])}J+=1e-6;let j=[],ve=0,pe=V.length;for(let me=0;me<pe;me++){[q,H,Q]=V[ve];let de=((Z=A[q])==null?void 0:Z.includes(U))==!0;Q<=J&&j.push(q+ +de*T),ve=V.findIndex(Se=>Se[0]==H)}A.push(j)}let S=[];{let U=0,X=0,V,q,H=u==3;for(let Q=0;Q<=s;Q++){V=Q*(Q+1)/2,q=(Q+1)*(Q+2)/2;for(let J=0;J<s-Q;J++)[U,X]=[V+J+Q+2,q+J+Q+3],S.push(V,q,...H?[X,V]:[U,q],X,U),[V,q]=[U,X];S.push(V,q,V+s+2)}}let C=d.clone(),P=d.clone(),B=d.clone(),k=d.clone(),z=d.clone(),F=[],W=b(M.length,()=>b(u,()=>d.clone()));for(let U=0;U<M.length;U++){d.copy(M[U]).normalize(),C.copy(d).multiplyScalar(m);let X=A[U];for(let j=0;j<X.length;j++){let ve=X[j],pe=X[(j+1)%u];p.setFromPointsAndIndices(M,U,ve%T,pe%T),p.b.sub(p.a).setLength(1e10).add(p.a),p.c.sub(p.a).setLength(1e10).add(p.a),p.closestPointToPoint(C,W[U][j])}let V=[],q=[],H=[],Q=new I;s==0&&[...W[U]].reduce((j,ve)=>j.add(ve),Q).multiplyScalar(1/u);for(let j=0;j<u;j++){let ve=[],pe=(j-1+u)%u,me=W[U][pe],de=W[U][j];d.copy(me).sub(C),f.copy(de).sub(C);let Se=C.angleTo(d),ce=d.angleTo(f),se=Math.cos(Se)*g;s==0?P.copy(Q):P.copy(C).setLength(m+se),q.push(se);let be=[P,me,de];for(let Ee=0;Ee<2;Ee++){let Le=be[Ee],ze=be[Ee+1];k.subVectors(Le,C),z.subVectors(ze,C),B.crossVectors(k,z).normalize();for(let Oe=0;Oe<v;Oe++){let Ge=[Se,ce][Ee]*Oe/v;d.copy(k).applyAxisAngle(B,Ge).add(C),V.push(d.clone()),Ee&&(w(d,C),ve.push([Oe==0?Le:d.clone(),x.clone()]))}Ee&&(w(ze,C),ve.push([ze,x.clone()]))}H.push(ve)}F.push(H);let J=2*v,le=2;for(let j=0;j<u;j++){let ve=J*j,pe=J*((j+1)%u),me=[V[ve]];for(let Se=1;Se<v;Se++){k=V[ve+Se],z=V[pe+Se],me.push(k);for(let ce=1,se=Se-le+1;ce<=se;ce++)d.lerpVectors(k,z,ce/(se+1)),d.sub(C).setLength(q[j]).add(C),me.push(d.clone());me.push(z)}for(let Se=0;Se<v;Se++)me.push(V[Se+v+ve]);me.push(V[pe+v]);let de=S.map(Se=>me[Se]);o.push(...de.map(Se=>[Se.x,Se.y,Se.z]).flat()),l.push(...de.map(Se=>(w(Se,C),[x.x,x.y,x.z])).flat())}}let K=[];for(let U=0;U<A.length;U++)for(let X=0;X<u;X++){let V=A[U][X];if(V<T){let q=A[V].findIndex(J=>J%T==U),H=F[U][X],Q=F[V][q];for(let J=0;J<v;J++){let le=H[J],j=Q[v-J],ve=H[J+1],pe=Q[v-(J+1)];[le,j,ve,ve,j,pe].forEach(me=>{o.push(me[0].x,me[0].y,me[0].z),l.push(me[1].x,me[1].y,me[1].z)})}K.push(H[0][0],Q[v][0],H[v][0],Q[0][0])}}for(;K.length;){let U,X,V,q;[U,X]=K.splice(0,2);let H=[U];for(;U!=X;)H.push(X),V=K.indexOf(X),q=V%2,X=K.splice(V-q,2)[1-q];x.subVectors(H[0],H[1]).cross(d.subVectors(H[0],H[2])).normalize();let Q=x.dot(H[0])<0;Q&&x.negate();for(let J=1;J<=H.length-2;J++)[H[J+ +Q],H[J+1-+Q],H[0]].forEach(le=>{o.push(le.x,le.y,le.z),l.push(x.x,x.y,x.z)})}}function h(){let u=new I;for(let A=0;A<o.length;A+=3){u.x=o[A+0],u.y=o[A+1],u.z=o[A+2];let T=b(u)/2/Math.PI+.5,S=M(u)/Math.PI+.5;a.push(T,1-S)}let d=new I,f=new I,p=new I,g=new I,m=new ge,v=new ge,x=new ge,w=(A,T,S,C)=>{C<0&&A.x===1&&(a[T]=A.x-1),S.x===0&&S.z===0&&(a[T]=C/2/Math.PI+.5)};for(let A=0,T=0;A<o.length;A+=9,T+=6){d.set(o[A+0],o[A+1],o[A+2]),f.set(o[A+3],o[A+4],o[A+5]),p.set(o[A+6],o[A+7],o[A+8]),m.set(a[T+0],a[T+1]),v.set(a[T+2],a[T+3]),x.set(a[T+4],a[T+5]),g.copy(d).add(f).add(p).divideScalar(3);let S=b(g);w(m,T+0,d,S),w(v,T+2,f,S),w(x,T+4,p,S)}for(let A=0;A<a.length;A+=6){let T=a[A+0],S=a[A+2],C=a[A+4],P=Math.max(T,S,C),B=Math.min(T,S,C);P>.9&&B<.1&&(T<.2&&(a[A+0]+=1),S<.2&&(a[A+2]+=1),C<.2&&(a[A+4]+=1))}function b(A){return Math.atan2(A.z,-A.x)}function M(A){return Math.atan2(-A.y,Math.sqrt(A.x*A.x+A.z*A.z))}}}static fromJSON(e){return new jO(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},S3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:n,detail:r,corner:s,cornerSides:o}=e.parameters,a=r===0&&s!==0?new pJ(t*.5,s,o):new Dq(t*.5,r);return a.scale(1,i/t,n/t),Object.assign(a,{userData:{...e,type:"DodecahedronGeometry"}})}},pJ=class extends jO{constructor(e=1,t=.2,i=4){let n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a="DodecahedronGeometry";super(s,o,a,e,t,i),this.type=a}static fromJSON(e){return new pJ(e.radius,e.corner,e.cornerSides)}},C0=1e-12,WO=class{constructor(e){this.position=new ge,this.startPosition=new ge,this.uuid=si.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new WO(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},YB=class extends WO{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new YB(this.parent).copy(this)}},lg=class extends WO{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new YB(this),new YB(this))}static create(e,t){let i=new lg(e,new ge(...t.position));return i.controls[0].position.set(...t.controlPrevious.position),i.controls[1].position.set(...t.controlNext.position),i.roundness=t.roundness,i.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,i}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let i=0,n=this.controls.length;i<n;i++){let r=this.controls[i];this.position.distanceTo(r.position)<=t?r.position.copy(this.position):r.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new lg(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var i,n;let e=(i=this.curveBefore)==null?void 0:i.getTangentAt(1),t=(n=this.curveAfter)==null?void 0:n.getTangentAt(0);return[e,t]}computeNormals(e=new ge,t=new ge){let[i,n]=this.computeTangents();return i&&n&&(jV(i,e),jV(n,t)),[e,t]}computeTangent(e=new ge){let[t,i]=this.computeTangents();return t&&i&&e.copy(t).add(i).normalize(),e}computeNormal(e=new ge){let[t,i]=this.computeNormals();return e.copy(t).add(i).normalize(),e}};function jV(e,t=new ge){let i=e.length();return t.set(-e.y/i,e.x/i)}var XO=e=>e,vv=new ge,cE=new ge,M3e=new ge,E3e=new ge,C3e=new ge,T3e=new ge,mJ=new I,gJ=new I;function P3e(e){let t=new ge;t.addVectors(e.v0,vv.subVectors(e.v1,e.v0).multiplyScalar(2/3));let i=new ge;return i.addVectors(e.v2,cE.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new ka(e.v0,t,i,e.v2)}function $0(e,t,i=Number.EPSILON){return Math.abs(e-t)<i}function D3e(e,t,i=Number.EPSILON){return e.distanceTo(t)<i}function B3e(e,t,i=Number.EPSILON){return e.distanceTo(t)<i}function vJ(e,t,i){let n=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),r=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)),s=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2));return Math.acos((r*r+n*n-s*s)/(2*r*n))}function L3e(e,t,i){return XV(e,t)&&XV(t,i)&&qB(e.position,t.position,i.position)}function qB(e,t,i){return vv.copy(t).sub(e).cross(cE.copy(i).sub(e))===0}function R3e(e,t,i,n,r){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),o=(e.y+t.y)/2,a=(e.x+t.x)/2,l=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(e.y-t.y)/s,c=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return n.set(a+l,o+c),r.set(a-l,o-c),[n,r]}function I3e(e,t,i){let n=e.distanceTo(i),r=t.distanceTo(i);return n<r?t:e}function O3e(e,t,i,n,r,s){let o=t.x-e.x,a=t.y-e.y,l=i.x-e.x,c=i.y-e.y,h=Math.sqrt((o+l)*(o+l)+(a+c)*(a+c)),u;return vJ(t,e,i)>Math.PI&&(h*=-1),$0(c,a)?u=(a+c)*(n/h-.5)*8/3/(o-l):u=(o+l)*(n/h-.5)*8/3/(c-a),r.set(t.x-u*a,t.y+u*o),s.set(i.x+u*c,i.y-u*l),[r,s]}function WV(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function XV(e,t){return qB(e.position,e.controls[1].position,t.position)&&qB(e.position,t.controls[0].position,t.position)}function F3e(e,t,i,n,r=.5){let s=vv.subVectors(t,e).multiplyScalar(r).add(e),o=cE.subVectors(i,t).multiplyScalar(r).add(t),a=M3e.subVectors(n,i).multiplyScalar(r).add(i),l=s,c=E3e.subVectors(o,s).multiplyScalar(r).add(s),h=C3e.subVectors(a,o).multiplyScalar(r).add(o),u=a,d=T3e.subVectors(h,c).multiplyScalar(r).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,d.x,d.y,h.x,h.y,u.x,u.y,n.x,n.y]}function N3e(e,t,i=12,n=!0){let r=gJ.set(0,0,0),s,o=0;for(let a=0;a<t.length;a++){let l=XO(t[a]),c=vv,h=Mf(l,i);for(let u=0;u<=h;u++)if(l instanceof ka||l instanceof kh||l instanceof qa){if(l.getPoint(u/h,c),r.set(c.x,c.y,0),s!==void 0&&B3e(s,r))continue;s===void 0&&(s=mJ),s.copy(r),e.setXYZ(o,r.x,r.y,r.z),o++}}return n&&o>1&&!(e.getX(o-1)===e.getX(0)&&e.getY(o-1)===e.getY(0)&&e.getZ(o-1)===e.getZ(0))&&(e.setXYZ(o,e.getX(0),e.getY(0),e.getZ(0)),o++),e}function z3e(e,t,i,n=12,r=!0){let s=gJ.set(0,0,0),o=0,a=[];for(let l=0;l<t.length;l++){if(i[l]===!1)continue;let c,h=XO(t[l]),u=vv,d=Mf(h,n);a.push(d);for(let f=0;f<=d;f++)if(h instanceof ka||h instanceof kh||h instanceof qa){if(h.getPoint(f/d,u),s.set(u.x,u.y,0),c==null?void 0:c.equals(s))continue;c===void 0?c=mJ:(e.setXYZ(o,c.x,c.y,c.z),o++,e.setXYZ(o,s.x,s.y,s.z),o++),c.copy(s)}}return r&&o>1&&!(e.getX(o-1)===e.getX(0)&&e.getY(o-1)===e.getY(0)&&e.getZ(o-1)===e.getZ(0))&&(e.setXYZ(o,e.getX(0),e.getY(0),e.getZ(0)),o++),a}function YV(e,t=12,i=!1){let n=[];for(let r=0,s=e.length;r<s;r++){let o=e[r],a=0;if(i&&o.roundedCurveCorner!==void 0){let l=Mf(o.roundedCurveCorner,t)*.5;r>0&&(n[r-1]+=l),a+=l}o.curveAfter!==void 0&&(a+=Mf(o.curveAfter,t)),n.push(a)}return e.length>0&&i&&e[0].roundedCurveCorner!==void 0&&(n[e.length-1]+=Mf(e[0].roundedCurveCorner,t)*.5),n}function Mf(e,t=12){return e&&e instanceof qM?t*2:e&&(e instanceof qa||e instanceof Eq)?1:e&&e instanceof oO?t*e.points.length:t}function k3e(e,t,i=12,n=!0){let r,s=0;for(let o=0;o<t.length;o++){let a=XO(t[o]),l=Mf(a,i),c=vv;for(let h=0;h<=l;h++)if(a instanceof ka||a instanceof kh||a instanceof qa){if(a.getPoint(h/l,c),r!==void 0&&D3e(r,c,C0))continue;r===void 0&&(r=cE),r.copy(c),e.push(c.x,c.y),s++}}return $0(e[0],e[e.length-2],C0)&&$0(e[1],e[e.length-1],C0)&&(e.pop(),e.pop()),n&&s>1&&!($0(e[s-1],e[1],C0)&&$0(e[s-2],e[0],C0))&&(e.push(e[0],e[1]),s++),e}var iP=new ge,U3e=new ge,G3e=new ge,H3e=new ge,V3e=new ge,j3e=new ge,yn=class extends mS{constructor(e=100,t=100){super(),this.points=[],this.shapeHoles=[],this.plane=new oo(new I(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=si.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,i){let n=new yn;return n.isClosed=e.isClosed,n.points=e.points.map(r=>lg.create(r.id,r.data)),typeof e.roundness=="number"&&(n.roundness=e.roundness),n.shapeHoles=e.shapeHoles.map(r=>yn.createFromState(r)),t!==void 0&&i!==void 0&&n.applySize(t,i),n.update(),n}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,i=this.points.length;t<i;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(t=>this.getPointIndexById(t)).filter(t=>t>=0)}getPointIndexById(e){let t=this.points.length,i=this.points.findIndex(n=>n.uuid===e);if(i<0){let n=t;for(let r=0,s=this.shapeHoles.length;r<s;r++){let o=this.shapeHoles[r],a=o.points.length,l=o.getPointIndexById(e);if(l<0)n+=a;else return l+n}}return i}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let i=0,n=this.shapeHoles.length;i<n;i++){let r=this.shapeHoles[i],s=e-t;if(s<=r.points.length-1)return r.points[s];t+=r.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let i=0,n=this.shapeHoles.length;i<n;i++){let r=this.shapeHoles[i],s=r.points.indexOf(e);if(s>=0)return t+s;t+=r.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(t=>t.points));return[...this.points,...e]}applySize(e,t){e===0&&(e=.001),t===0&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let i=iP.set(e,t);for(let n=0,r=this.points.length;n<r;n++){let s=this.points[n];s.position.multiply(i),s.controls[0].position.multiply(i),s.controls[1].position.multiply(i)}for(let n=0,r=this.shapeHoles.length;n<r;n++)this.shapeHoles[n].applyScale(e,t);this._update()}createPoint(e,t=0,i=si.generateUUID()){let n;e instanceof ge?n=e:n=new ge(e,t);let r=new lg(i,n);return r.roundness=this.roundness,r}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,i=this.points.length;t<i;t++){let n=this.points[t];if(n.uuid===e)return n}for(let t=0,i=this.shapeHoles.length;t<i;t++){let n=this.shapeHoles[t].getPointByUuid(e);if(n)return n}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(i=>i.uuid===e);t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e,t=12,i=!1){this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t);let n=i?this.roundedCurveDivisions:this.curveDivisions;return N3e(e,i?this.roundedCurves:this.curves,t,this.autoClose),n.reduce((r,s)=>r+s,0)+1}computeCurveDivisions(e=12){return this.curveDivisions=YV(this.points,e,!1),this.roundedCurveDivisions=YV(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t,i=12){return z3e(e,this.curves,t,i,this.autoClose).reduce((n,r)=>n+r,0)*2}extractShapePointsToFlatArray(e,t=12){return this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t),k3e(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e,t=!1){let i=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let n=t?this.roundedCurveDivisions:this.curveDivisions,r=0;t&&this.points[0].roundedCurveCorner!==void 0&&(r=Mf(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=e-r;s<0&&(s+=n.reduce((o,a)=>o+a,0));for(let o=0,a=n.length;o<a;o++){let l=n[o];if(s<i+l)return[o,(s-i+1)/l];i+=l}return[0,1]}getCurveT(e,t,i){let n=this.points[e],r=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,o=s[e];if(WV(n,r)){let l=n.position.distanceTo(r.position);return n.position.distanceTo(iP.set(i.x,i.y))/l}let a=0;for(let l=0;l<e;l++)a+=s[l];return(t-a)/o}dispose(){}_applyCurveForPoint(e,t){WV(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let i=this.curves[this.curves.length-1];e.curveBefore=i,t.curveAfter=i;let n=i.clone();e.roundedCurveBefore=n,t.roundedCurveAfter=n,e.roundedCurveCorner=void 0,this.roundedCurves.push(n)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,i=this.points.length;t<i;t++){let n=this.points[t];if(t===0)this.moveTo(n.position.x,n.position.y);else{let r=this.points[t-1];this._applyCurveForPoint(n,r)}}let e=this.getLastPoint();if(e!=null&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let t=this.points[0],i=this.points[this.points.length-1];this._applyCurveForPoint(t,i)}if(this.points.length>2){let t=0;for(let i=0,n=this.points.length;i<n;i++){let r=this.points[i],s=this.points[i-1]??this.points[this.points.length-1],o=this.points[i+1]??this.points[0],a=r.roundness,l=s&&o&&L3e(s,r,o);if(!r.controlsMoved()&&a>0&&!l){let c=r.curveBefore,h=r.curveAfter;if(c===void 0||h===void 0)continue;let u=r.roundedCurveBefore,d=r.roundedCurveAfter,f=c.getLength(),p=h.getLength(),g=Math.min(a,f*.499),m=Math.min(a,p*.499),v=Math.min(g,m),x=1-v/f,w=v/p,b=c.getPointAt(x,iP),M=h.getPointAt(w,U3e);this._subSplitCurve(c,u,x,b,void 0),this._subSplitCurve(h,d,w,void 0,M);let A;if(this.useCubicForRoundedCorners){let T=vJ(b,r.position,M)/2,S=Math.tan(T)*b.distanceTo(r.position),[C,P]=R3e(b,M,S,G3e,H3e),B=I3e(C,P,r.position),[k,z]=O3e(B,b,M,S,V3e,j3e);A=new ka(b.clone(),k.clone(),z.clone(),M.clone())}else A=new kh(b.clone(),r.position.clone(),M.clone());r.roundedCurveCorner=A,this.roundedCurves.splice(i+t,0,A),t++}}}}_subSplitCurve(e,t,i,n,r){if(e instanceof qa)n!==void 0&&t.v2.copy(n),r!==void 0&&t.v1.copy(r);else{let s=e,o=t,a=s.getUtoTmapping(i,0),l=F3e(s.v0,s.v1,s.v2,s.v3,a);return n!==void 0&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),r!==void 0&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return t}clone(){let e=new yn(this._width,this._height);return e.points=this.points.map(t=>t.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(t=>t.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var i;this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let n=0;n<t;n++){let r=n*7,s=e.points[r+0],o=e.points[r+1],a=e.points[r+2],l=e.points[r+3],c=e.points[r+4],h=e.points[r+5],u=e.points[r+6],d=new lg(si.generateUUID(),new ge(s,o));d.controls[0].position.set(a,l),d.controls[1].position.set(c,h),d.roundness=u,this.points.push(d)}return this.shapeHoles=(i=e.shapeHoles)!=null&&i.length?e.shapeHoles.map(n=>{let r=new yn;return r.fromJSON(n),r}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e){let t=(n,r)=>{r instanceof ka&&r.v3.equals(n.position)&&n.controls[0].position.copy(r.v2)},i=n=>{let r=[],s,o;for(s=0,o=n.length;s<o;s++)n[s]instanceof kh&&(n[s]=P3e(n[s]));for(s=0,o=n.length;s<o;s++){let c=n[s],h=s>0?n[s-1]:null,u;c instanceof ka?(u=this.createPoint(c.v0),u.controls[1].position.copy(c.v1)):c instanceof qa&&(u=this.createPoint(c.v1)),u!==void 0&&(h!==null&&t(u,h),r.push(u))}let a=n[n.length-1],l=!1;return a instanceof ka?a.v3.equals(r[0].position)&&(r[0].controls[0].position.copy(a.v2),l=!0):a instanceof qa&&a.v2.equals(r[0].position)&&(l=!0),this.isClosed=l,r};return this.points=i(e.curves),e instanceof mS&&(this.shapeHoles=e.holes.map(n=>{let r=new yn;return r.fromShape(n),r})),this.update(),this}updatePoint(e,t){let i=this.getPointByUuid(e);i&&(t.position!==void 0&&i.position.fromArray(t.position),t.roundness!==void 0&&(i.roundness=t.roundness),t.areControlsDirectionsMirrored!==void 0&&(i.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var n;let i=(n=this.getPointByUuid(e))==null?void 0:n.controls[0];i&&(t.position&&i.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var n;let i=(n=this.getPointByUuid(e))==null?void 0:n.controls[1];i&&(t.position&&i.position.fromArray(t.position),this.needsUpdate=!0)}},QB=Math.PI*2;function nP({x:e,y:t},i,n,r,s){return{x:e*i+r,y:t*n+s}}function W3e(e,t){let i=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),n=Math.cos(e),r=Math.sin(e),s=Math.cos(e+t),o=Math.sin(e+t);return[{x:n-r*i,y:r+n*i},{x:s+o*i,y:o-s*i},{x:s,y:o}]}function qV(e,t,i,n){let r=e*n-t*i<0?-1:1,s=Math.min(1,Math.max(-1,e*i+t*n));return r*Math.acos(s)}function X3e(e,t,i,n,r,s,o,a,l,c){let h=Math.pow(r,2),u=Math.pow(s,2),d=Math.pow(o,2),f=Math.pow(a,2),p=h*u-h*f-u*d;p<0&&(p=0),p/=h*f+u*d,p=Math.sqrt(p)*(l===c?-1:1);let g=p*r/s*a,m=p*-s/r*o,v=g+(e+i)/2,x=m+(t+n)/2,w=(o-g)/r,b=(a-m)/s,M=(-o-g)/r,A=(-a-m)/s,T=qV(1,0,w,b),S=qV(w,b,M,A);return!c&&S>0&&(S-=QB),c&&S<0&&(S+=QB),{centerx:v,centery:x,ang1:T,ang2:S}}function Y3e({px:e,py:t,cx:i,cy:n,rx:r,ry:s,largeArcFlag:o,sweepFlag:a}){let l=[];if(r===0||s===0)return[];let c=(e-i)/2,h=(t-n)/2;if(c===0&&h===0)return[];r=Math.abs(r),s=Math.abs(s);let u=Math.pow(c,2)/Math.pow(r,2)+Math.pow(h,2)/Math.pow(s,2);u>1&&(r*=Math.sqrt(u),s*=Math.sqrt(u));let d=X3e(e,t,i,n,r,s,c,h,o,a),{ang1:f,ang2:p}=d,{centerx:g,centery:m}=d,v=Math.abs(p)/(QB/4);Math.abs(1-v)<1e-7&&(v=1);let x=Math.max(Math.ceil(v),1);p/=x;for(let w=0;w<x;w++)l.push(W3e(f,p)),f+=p;return l.map(w=>{let{x:b,y:M}=nP(w[0],r,s,g,m),{x:A,y:T}=nP(w[1],r,s,g,m),{x:S,y:C}=nP(w[2],r,s,g,m);return{x1:b,y1:M,x2:A,y2:T,x:S,y:C}})}var Ti;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Ti||(Ti={}));var Un;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Un||(Un={}));function Rt(e,t){if(!e)throw t||"Assertion Failed!"}var Mt=function(){function e(){}return e.vertEq=function(t,i){return t.s===i.s&&t.t===i.t},e.vertLeq=function(t,i){return t.s<i.s||t.s===i.s&&t.t<=i.t},e.transLeq=function(t,i){return t.t<i.t||t.t===i.t&&t.s<=i.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,i){return Math.abs(t.s-i.s)+Math.abs(t.t-i.t)},e.edgeEval=function(t,i,n){Rt(e.vertLeq(t,i)&&e.vertLeq(i,n));var r=i.s-t.s,s=n.s-i.s;return r+s>0?r<s?i.t-t.t+(t.t-n.t)*(r/(r+s)):i.t-n.t+(n.t-t.t)*(s/(r+s)):0},e.edgeSign=function(t,i,n){Rt(e.vertLeq(t,i)&&e.vertLeq(i,n));var r=i.s-t.s,s=n.s-i.s;return r+s>0?(i.t-n.t)*r+(i.t-t.t)*s:0},e.transEval=function(t,i,n){Rt(e.transLeq(t,i)&&e.transLeq(i,n));var r=i.t-t.t,s=n.t-i.t;return r+s>0?r<s?i.s-t.s+(t.s-n.s)*(r/(r+s)):i.s-n.s+(n.s-t.s)*(s/(r+s)):0},e.transSign=function(t,i,n){Rt(e.transLeq(t,i)&&e.transLeq(i,n));var r=i.t-t.t,s=n.t-i.t;return r+s>0?(i.s-n.s)*r+(i.s-t.s)*s:0},e.vertCCW=function(t,i,n){return t.s*(i.t-n.t)+i.s*(n.t-t.t)+n.s*(t.t-i.t)>=0},e.interpolate=function(t,i,n,r){return t=t<0?0:t,n=n<0?0:n,t<=n?n===0?(i+r)/2:i+(r-i)*(t/(t+n)):r+(i-r)*(n/(t+n))},e.intersect=function(t,i,n,r,s){var o,a,l;e.vertLeq(t,i)||(l=t,t=i,i=l),e.vertLeq(n,r)||(l=n,n=r,r=l),e.vertLeq(t,n)||(l=t,t=n,n=l,l=i,i=r,r=l),e.vertLeq(n,i)?e.vertLeq(i,r)?(o=e.edgeEval(t,n,i),a=e.edgeEval(n,i,r),o+a<0&&(o=-o,a=-a),s.s=e.interpolate(o,n.s,a,i.s)):(o=e.edgeSign(t,n,i),a=-e.edgeSign(t,r,i),o+a<0&&(o=-o,a=-a),s.s=e.interpolate(o,n.s,a,r.s)):s.s=(n.s+i.s)/2,e.transLeq(t,i)||(l=t,t=i,i=l),e.transLeq(n,r)||(l=n,n=r,r=l),e.transLeq(t,n)||(l=t,t=n,n=l,l=i,i=r,r=l),e.transLeq(n,i)?e.transLeq(i,r)?(o=e.transEval(t,n,i),a=e.transEval(n,i,r),o+a<0&&(o=-o,a=-a),s.t=e.interpolate(o,n.t,a,i.t)):(o=e.transSign(t,n,i),a=-e.transSign(t,r,i),o+a<0&&(o=-o,a=-a),s.t=e.interpolate(o,n.t,a,r.t)):s.t=(n.t+i.t)/2},e}(),T0=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),_b=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),fm=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),QV=function(){function e(){var t=new fm,i=new T0,n=new _b(0),r=new _b(1);t.next=t.prev=t,t.anEdge=null,i.next=i.prev=i,n.next=n,n.Sym=r,r.next=r,r.Sym=n,this.vHead=t,this.fHead=i,this.eHead=n,this.eHeadSym=r}return e.prototype.makeEdge_=function(t){var i=new _b(0),n=new _b(1);t.Sym.side<t.side&&(t=t.Sym);var r=t.Sym.next;return n.next=r,r.Sym.next=i,i.next=t,t.Sym.next=n,i.Sym=n,i.Onext=i,i.Lnext=n,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,n.Sym=i,n.Onext=n,n.Lnext=i,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,i},e.prototype.splice_=function(t,i){var n=t.Onext,r=i.Onext;n.Sym.Lnext=i,r.Sym.Lnext=t,t.Onext=r,i.Onext=n},e.prototype.makeVertex_=function(t,i,n){var r=t;Rt(r,"Vertex can't be null!");var s=n.prev;r.prev=s,s.next=r,r.next=n,n.prev=r,r.anEdge=i;var o=i;do o.Org=r,o=o.Onext;while(o!==i)},e.prototype.makeFace_=function(t,i,n){var r=t;Rt(r,"Face can't be null");var s=n.prev;r.prev=s,s.next=r,r.next=n,n.prev=r,r.anEdge=i,r.trail=null,r.marked=!1,r.inside=n.inside;var o=i;do o.Lface=r,o=o.Lnext;while(o!==i)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var i=t.next,n=t.Sym.next;i.Sym.next=n,n.Sym.next=i},e.prototype.killVertex_=function(t,i){var n=t.anEdge,r=n;do r.Org=i,r=r.Onext;while(r!==n);var s=t.prev,o=t.next;o.prev=s,s.next=o},e.prototype.killFace_=function(t,i){var n=t.anEdge,r=n;do r.Lface=i,r=r.Lnext;while(r!==n);var s=t.prev,o=t.next;o.prev=s,s.next=o},e.prototype.makeEdge=function(){var t=new fm,i=new fm,n=new T0,r=this.makeEdge_(this.eHead);return this.makeVertex_(t,r,this.vHead),this.makeVertex_(i,r.Sym,this.vHead),this.makeFace_(n,r,this.fHead),r},e.prototype.splice=function(t,i){var n=!1,r=!1;if(t!==i){if(i.Org!==t.Org&&(r=!0,this.killVertex_(i.Org,t.Org)),i.Lface!==t.Lface&&(n=!0,this.killFace_(i.Lface,t.Lface)),this.splice_(i,t),!r){var s=new fm;this.makeVertex_(s,i,t.Org),t.Org.anEdge=t}if(!n){var o=new T0;this.makeFace_(o,i,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var i=t.Sym,n=!1;if(t.Lface!==t.Rface&&(n=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!n){var r=new T0;this.makeFace_(r,t,t.Lface)}i.Onext===i?(this.killVertex_(i.Org,null),this.killFace_(i.Lface,null)):(t.Lface.anEdge=i.Oprev,i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var i=this.makeEdge_(t),n=i.Sym;this.splice_(i,t.Lnext),i.Org=t.Dst;var r=new fm;return this.makeVertex_(r,n,i.Org),i.Lface=n.Lface=t.Lface,i},e.prototype.splitEdge=function(t){var i=this.addEdgeVertex(t),n=i.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,n),t.Dst=n.Org,n.Dst.anEdge=n.Sym,n.Rface=t.Rface,n.winding=t.winding,n.Sym.winding=t.Sym.winding,n.idx=t.idx,n.Sym.idx=t.Sym.idx,n},e.prototype.connect=function(t,i){var n=!1,r=this.makeEdge_(t),s=r.Sym;if(i.Lface!==t.Lface&&(n=!0,this.killFace_(i.Lface,t.Lface)),this.splice_(r,t.Lnext),this.splice_(s,i),r.Org=t.Dst,s.Org=i.Org,r.Lface=s.Lface=t.Lface,t.Lface.anEdge=s,!n){var o=new T0;this.makeFace_(o,r,t.Lface)}return r},e.prototype.zapFace=function(t){var i=t.anEdge,n,r,s,o,a;r=i.Lnext;do n=r,r=n.Lnext,n.Lface=null,n.Rface===null&&(n.Onext===n?this.killVertex_(n.Org,null):(n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),s=n.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(n));while(n!=i);o=t.prev,a=t.next,a.prev=o,o.next=a},e.prototype.countFaceVerts_=function(t){var i=t.anEdge,n=0;do n++,i=i.Lnext;while(i!==t.anEdge);return n},e.prototype.mergeConvexFaces=function(t){var i,n,r,s,o,a,l;for(i=this.fHead.next;i!==this.fHead;i=i.next)if(i.inside)for(n=i.anEdge,o=n.Org;r=n.Lnext,s=n.Sym,s&&s.Lface&&s.Lface.inside&&(a=this.countFaceVerts_(i),l=this.countFaceVerts_(s.Lface),a+l-2<=t&&Mt.vertCCW(n.Lprev.Org,n.Org,s.Lnext.Lnext.Org)&&Mt.vertCCW(s.Lprev.Org,s.Org,n.Lnext.Lnext.Org)&&(r=s.Lnext,this.delete(s),n=null,s=null)),!(n&&n.Lnext.Org===o);)n=r;return!0},e.prototype.check=function(){var t=this.fHead,i=this.vHead,n=this.eHead,r,s,o,a,l,c;for(s=t,s=t;(r=s.next)!==t;s=r){Rt(r.prev===s),l=r.anEdge;do Rt(l.Sym!==l),Rt(l.Sym.Sym===l),Rt(l.Lnext.Onext.Sym===l),Rt(l.Onext.Sym.Lnext===l),Rt(l.Lface===r),l=l.Lnext;while(l!==r.anEdge)}for(Rt(r.prev===s&&r.anEdge===null),a=i,a=i;(o=a.next)!==i;a=o){Rt(o.prev===a),l=o.anEdge;do Rt(l.Sym!==l),Rt(l.Sym.Sym===l),Rt(l.Lnext.Onext.Sym===l),Rt(l.Onext.Sym.Lnext===l),Rt(l.Org===o),l=l.Onext;while(l!==o.anEdge)}for(Rt(o.prev===a&&o.anEdge===null),c=n,c=n;(l=c.next)!==n;c=l)Rt(l.Sym.next===c.Sym),Rt(l.Sym!==l),Rt(l.Sym.Sym===l),Rt(l.Org!==null),Rt(l.Dst!==null),Rt(l.Lnext.Onext.Sym===l),Rt(l.Onext.Sym.Lnext===l);Rt(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),JV=function(){function e(){this.handle=null}return e}(),KV=function(){function e(){this.key=null,this.node=0}return e}(),q3e=function(){function e(t,i){this.leq=i,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var n=0;n<t+1;n++)this.nodes[n]=new JV,this.handles[n]=new KV;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var i=this.nodes,n=this.handles,r,s,o;for(r=i[t].handle;;){if(o=t<<1,o<this.size&&this.leq(n[i[o+1].handle].key,n[i[o].handle].key)&&++o,Rt(o<=this.max),s=i[o].handle,o>this.size||this.leq(n[r].key,n[s].key)){i[t].handle=r,n[r].node=t;break}i[t].handle=s,n[s].node=t,t=o}},e.prototype.floatUp_=function(t){var i=this.nodes,n=this.handles,r,s,o;for(r=i[t].handle;;){if(o=t>>1,s=i[o].handle,o===0||this.leq(n[s].key,n[r].key)){i[t].handle=r,n[r].node=t;break}i[t].handle=s,n[s].node=t,t=o}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var i,n;if(i=++this.size,i*2>this.max){this.max*=2;var r,s;for(s=this.nodes.length,this.nodes.length=this.max+1,r=s;r<this.nodes.length;r++)this.nodes[r]=new JV;for(s=this.handles.length,this.handles.length=this.max+1,r=s;r<this.handles.length;r++)this.handles[r]=new KV}return this.freeList===0?n=i:(n=this.freeList,this.freeList=this.handles[n].node),this.nodes[i].handle=n,this.handles[n].node=i,this.handles[n].key=t,this.initialized&&this.floatUp_(i),n},e.prototype.extractMin=function(){var t=this.nodes,i=this.handles,n=t[1].handle,r=i[n].key;return this.size>0&&(t[1].handle=t[this.size].handle,i[t[1].handle].node=1,i[n].key=null,i[n].node=this.freeList,this.freeList=n,--this.size,this.size>0&&this.floatDown_(1)),r},e.prototype.delete=function(t){var i=this.nodes,n=this.handles,r;Rt(t>=1&&t<=this.max&&n[t].key!==null),r=n[t].node,i[r].handle=i[this.size].handle,n[i[r].handle].node=r,--this.size,r<=this.size&&(r<=1||this.leq(n[i[r>>1].handle].key,n[i[r].handle].key)?this.floatDown_(r):this.floatUp_(r)),n[t].key=null,n[t].node=this.freeList,this.freeList=t},e}(),rP=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),ZV=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),Q3e=function(){function e(t,i){this.frame=t,this.leq=i,this.head=new ZV,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var i=this.head;do i=i.next;while(i.key!==null&&!this.leq(this.frame,t,i.key));return i},e.prototype.insertBefore=function(t,i){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,i));var n=new ZV;return n.key=i,n.next=t.next,t.next.prev=n,n.prev=t,t.next=n,n},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),J3e=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,i){t.winding+=i.winding,t.Sym.winding+=i.Sym.winding},e.edgeLeq=function(t,i,n){var r=t.event,s=i.eUp,o=n.eUp;if(s.Dst===r)return o.Dst===r?Mt.vertLeq(s.Org,o.Org)?Mt.edgeSign(o.Dst,s.Org,o.Org)<=0:Mt.edgeSign(s.Dst,o.Org,s.Org)>=0:Mt.edgeSign(o.Dst,r,o.Org)<=0;if(o.Dst===r)return Mt.edgeSign(s.Dst,r,s.Org)>=0;var a=Mt.edgeEval(s.Dst,r,s.Org),l=Mt.edgeEval(o.Dst,r,o.Org);return a>=l},e.deleteRegion=function(t,i){i.fixUpperEdge&&Rt(i.eUp.winding===0),i.eUp.activeRegion=null,t.dict.delete(i.nodeUp)},e.fixUpperEdge=function(t,i,n){Rt(i.fixUpperEdge),t.mesh.delete(i.eUp),i.fixUpperEdge=!1,i.eUp=n,n.activeRegion=i},e.topLeftRegion=function(t,i){var n=i.eUp.Org,r;do i=e.regionAbove(i);while(i.eUp.Org===n);if(i.fixUpperEdge){if(r=t.mesh.connect(e.regionBelow(i).eUp.Sym,i.eUp.Lnext),r===null)return null;e.fixUpperEdge(t,i,r),i=e.regionAbove(i)}return i},e.topRightRegion=function(t){var i=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===i);return t},e.addRegionBelow=function(t,i,n){var r=new rP;return r.eUp=n,r.nodeUp=t.dict.insertBefore(i.nodeUp,r),r.fixUpperEdge=!1,r.sentinel=!1,r.dirty=!1,n.activeRegion=r,r},e.isWindingInside=function(t,i){switch(t.windingRule){case Ti.ODD:return(i&1)!==0;case Ti.NONZERO:return i!==0;case Ti.POSITIVE:return i>0;case Ti.NEGATIVE:return i<0;case Ti.ABS_GEQ_TWO:return i>=2||i<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,i){i.windingNumber=e.regionAbove(i).windingNumber+i.eUp.winding,i.inside=e.isWindingInside(t,i.windingNumber)},e.finishRegion=function(t,i){var n=i.eUp,r=n.Lface;r.inside=i.inside,r.anEdge=n,e.deleteRegion(t,i)},e.finishLeftRegions=function(t,i,n){for(var r,s=null,o=i,a=i.eUp;o!==n;){if(o.fixUpperEdge=!1,s=e.regionBelow(o),r=s.eUp,r.Org!=a.Org){if(!s.fixUpperEdge){e.finishRegion(t,o);break}r=t.mesh.connect(a.Lprev,r.Sym),e.fixUpperEdge(t,s,r)}a.Onext!==r&&(t.mesh.splice(r.Oprev,r),t.mesh.splice(a,r)),e.finishRegion(t,o),a=s.eUp,o=s}return a},e.addRightEdges=function(t,i,n,r,s,o){var a,l,c,h,u=!0;c=n;do Rt(Mt.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,i,c.Sym),c=c.Onext;while(c!==r);for(s===null&&(s=e.regionBelow(i).eUp.Rprev),l=i,h=s;a=e.regionBelow(l),c=a.eUp.Sym,c.Org===h.Org;)c.Onext!==h&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(h.Oprev,c)),a.windingNumber=l.windingNumber-c.winding,a.inside=e.isWindingInside(t,a.windingNumber),l.dirty=!0,!u&&e.checkForRightSplice(t,l)&&(e.addWinding(c,h),e.deleteRegion(t,l),t.mesh.delete(h)),u=!1,l=a,h=c;l.dirty=!0,Rt(l.windingNumber-c.winding===a.windingNumber),o&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,i,n){t.mesh.splice(i,n)},e.vertexWeights=function(t,i,n){var r=Mt.vertL1dist(i,t),s=Mt.vertL1dist(n,t),o=.5*s/(r+s),a=.5*r/(r+s);t.coords[0]+=o*i.coords[0]+a*n.coords[0],t.coords[1]+=o*i.coords[1]+a*n.coords[1],t.coords[2]+=o*i.coords[2]+a*n.coords[2]},e.getIntersectData=function(t,i,n,r,s,o){i.coords[0]=i.coords[1]=i.coords[2]=0,i.idx=-1,e.vertexWeights(i,n,r),e.vertexWeights(i,s,o)},e.checkForRightSplice=function(t,i){var n=e.regionBelow(i),r=i.eUp,s=n.eUp;if(Mt.vertLeq(r.Org,s.Org)){if(Mt.edgeSign(s.Dst,r.Org,s.Org)>0)return!1;Mt.vertEq(r.Org,s.Org)?r.Org!==s.Org&&(t.pq.delete(r.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,r)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(r,s.Oprev),i.dirty=n.dirty=!0)}else{if(Mt.edgeSign(r.Dst,s.Org,r.Org)<0)return!1;e.regionAbove(i).dirty=i.dirty=!0,t.mesh.splitEdge(r.Sym),t.mesh.splice(s.Oprev,r)}return!0},e.checkForLeftSplice=function(t,i){var n=e.regionBelow(i),r=i.eUp,s=n.eUp,o;if(Rt(!Mt.vertEq(r.Dst,s.Dst)),Mt.vertLeq(r.Dst,s.Dst)){if(Mt.edgeSign(r.Dst,s.Dst,r.Org)<0)return!1;e.regionAbove(i).dirty=i.dirty=!0,o=t.mesh.splitEdge(r),t.mesh.splice(s.Sym,o),o.Lface.inside=i.inside}else{if(Mt.edgeSign(s.Dst,r.Dst,s.Org)>0)return!1;i.dirty=n.dirty=!0,o=t.mesh.splitEdge(s),t.mesh.splice(r.Lnext,s.Sym),o.Rface.inside=i.inside}return!0},e.checkForIntersect=function(t,i){var n=e.regionBelow(i),r=i.eUp,s=n.eUp,o=r.Org,a=s.Org,l=r.Dst,c=s.Dst,h,u,d=new fm,f,p;if(Rt(!Mt.vertEq(c,l)),Rt(Mt.edgeSign(l,t.event,o)<=0),Rt(Mt.edgeSign(c,t.event,a)>=0),Rt(o!==t.event&&a!==t.event),Rt(!i.fixUpperEdge&&!n.fixUpperEdge),o===a||(h=Math.min(o.t,l.t),u=Math.max(a.t,c.t),h>u))return!1;if(Mt.vertLeq(o,a)){if(Mt.edgeSign(c,o,a)>0)return!1}else if(Mt.edgeSign(l,a,o)<0)return!1;return e.debugEvent(t),Mt.intersect(l,o,c,a,d),Rt(Math.min(o.t,l.t)<=d.t),Rt(d.t<=Math.max(a.t,c.t)),Rt(Math.min(c.s,l.s)<=d.s),Rt(d.s<=Math.max(a.s,o.s)),Mt.vertLeq(d,t.event)&&(d.s=t.event.s,d.t=t.event.t),f=Mt.vertLeq(o,a)?o:a,Mt.vertLeq(f,d)&&(d.s=f.s,d.t=f.t),Mt.vertEq(d,o)||Mt.vertEq(d,a)?(e.checkForRightSplice(t,i),!1):!Mt.vertEq(l,t.event)&&Mt.edgeSign(l,t.event,d)>=0||!Mt.vertEq(c,t.event)&&Mt.edgeSign(c,t.event,d)<=0?c===t.event?(t.mesh.splitEdge(r.Sym),t.mesh.splice(s.Sym,r),i=e.topLeftRegion(t,i),r=e.regionBelow(i).eUp,e.finishLeftRegions(t,e.regionBelow(i),n),e.addRightEdges(t,i,r.Oprev,r,r,!0),!0):l===t.event?(t.mesh.splitEdge(s.Sym),t.mesh.splice(r.Lnext,s.Oprev),n=i,i=e.topRightRegion(i),p=e.regionBelow(i).eUp.Rprev,n.eUp=s.Oprev,s=e.finishLeftRegions(t,n,null),e.addRightEdges(t,i,s.Onext,r.Rprev,p,!0),!0):(Mt.edgeSign(l,t.event,d)>=0&&(e.regionAbove(i).dirty=i.dirty=!0,t.mesh.splitEdge(r.Sym),r.Org.s=t.event.s,r.Org.t=t.event.t),Mt.edgeSign(c,t.event,d)<=0&&(i.dirty=n.dirty=!0,t.mesh.splitEdge(s.Sym),s.Org.s=t.event.s,s.Org.t=t.event.t),!1):(t.mesh.splitEdge(r.Sym),t.mesh.splitEdge(s.Sym),t.mesh.splice(s.Oprev,r),r.Org.s=d.s,r.Org.t=d.t,r.Org.pqHandle=t.pq.insert(r.Org),e.getIntersectData(t,r.Org,o,l,a,c),e.regionAbove(i).dirty=i.dirty=n.dirty=!0,!1)},e.walkDirtyRegions=function(t,i){for(var n=e.regionBelow(i),r,s;;){for(;n.dirty;)i=n,n=e.regionBelow(n);if(!i.dirty&&(n=i,i=e.regionAbove(i),i===null||!i.dirty))return;if(i.dirty=!1,r=i.eUp,s=n.eUp,r.Dst!==s.Dst&&e.checkForLeftSplice(t,i)&&(n.fixUpperEdge?(e.deleteRegion(t,n),t.mesh.delete(s),n=e.regionBelow(i),s=n.eUp):i.fixUpperEdge&&(e.deleteRegion(t,i),t.mesh.delete(r),i=e.regionAbove(n),r=i.eUp)),r.Org!==s.Org)if(r.Dst!==s.Dst&&!i.fixUpperEdge&&!n.fixUpperEdge&&(r.Dst===t.event||s.Dst===t.event)){if(e.checkForIntersect(t,i))return}else e.checkForRightSplice(t,i);r.Org===s.Org&&r.Dst===s.Dst&&(e.addWinding(s,r),e.deleteRegion(t,i),t.mesh.delete(r),i=e.regionAbove(n))}},e.connectRightVertex=function(t,i,n){var r,s=n.Onext,o=e.regionBelow(i),a=i.eUp,l=o.eUp,c=!1;if(a.Dst!==l.Dst&&e.checkForIntersect(t,i),Mt.vertEq(a.Org,t.event)&&(t.mesh.splice(s.Oprev,a),i=e.topLeftRegion(t,i),s=e.regionBelow(i).eUp,e.finishLeftRegions(t,e.regionBelow(i),o),c=!0),Mt.vertEq(l.Org,t.event)&&(t.mesh.splice(n,l.Oprev),n=e.finishLeftRegions(t,o,null),c=!0),c){e.addRightEdges(t,i,n.Onext,s,s,!0);return}Mt.vertLeq(l.Org,a.Org)?r=l.Oprev:r=a,r=t.mesh.connect(n.Lprev,r),e.addRightEdges(t,i,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,i)},e.connectLeftDegenerate=function(t,i,n){var r,s,o,a,l;if(r=i.eUp,Mt.vertEq(r.Org,n)){Rt(!1),e.spliceMergeVertices(t,r,n.anEdge);return}if(!Mt.vertEq(r.Dst,n)){t.mesh.splitEdge(r.Sym),i.fixUpperEdge&&(t.mesh.delete(r.Onext),i.fixUpperEdge=!1),t.mesh.splice(n.anEdge,r),e.sweepEvent(t,n);return}Rt(!1),i=e.topRightRegion(i),l=e.regionBelow(i),o=l.eUp.Sym,s=a=o.Onext,l.fixUpperEdge&&(Rt(s!==o),e.deleteRegion(t,l),t.mesh.delete(o),o=s.Oprev),t.mesh.splice(n.anEdge,o),Mt.edgeGoesLeft(s)||(s=null),e.addRightEdges(t,i,o.Onext,a,s,!0)},e.connectLeftVertex=function(t,i){var n,r,s,o,a,l,c=new rP;if(c.eUp=i.anEdge.Sym,n=t.dict.search(c).key,r=e.regionBelow(n),!!r){if(o=n.eUp,a=r.eUp,Mt.edgeSign(o.Dst,i,o.Org)===0){e.connectLeftDegenerate(t,n,i);return}if(s=Mt.vertLeq(a.Dst,o.Dst)?n:r,n.inside||s.fixUpperEdge){if(s===n)l=t.mesh.connect(i.anEdge.Sym,o.Lnext);else{var h=t.mesh.connect(a.Dnext,i.anEdge);l=h.Sym}s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,n,l)),e.sweepEvent(t,i)}else e.addRightEdges(t,n,i.anEdge,i.anEdge,null,!0)}},e.sweepEvent=function(t,i){t.event=i,e.debugEvent(t);for(var n=i.anEdge;n.activeRegion===null;)if(n=n.Onext,n===i.anEdge){e.connectLeftVertex(t,i);return}var r=e.topLeftRegion(t,n.activeRegion);Rt(r!==null);var s=e.regionBelow(r),o=s.eUp,a=e.finishLeftRegions(t,s,null);a.Onext===o?e.connectRightVertex(t,r,a):e.addRightEdges(t,r,a.Onext,o,o,!0)},e.addSentinel=function(t,i,n,r){var s=new rP,o=t.mesh.makeEdge();o.Org.s=n,o.Org.t=r,o.Dst.s=i,o.Dst.t=r,t.event=o.Dst,s.eUp=o,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=t.dict.insert(s)},e.initEdgeDict=function(t){t.dict=new Q3e(t,e.edgeLeq);var i=t.bmax[0]-t.bmin[0],n=t.bmax[1]-t.bmin[1],r=t.bmin[0]-i,s=t.bmax[0]+i,o=t.bmin[1]-n,a=t.bmax[1]+n;e.addSentinel(t,r,s,o),e.addSentinel(t,r,s,a)},e.doneEdgeDict=function(t){for(var i,n=0;(i=t.dict.min().key)!==null;)i.sentinel||(Rt(i.fixUpperEdge),Rt(++n===1)),Rt(i.windingNumber===0),e.deleteRegion(t,i)},e.removeDegenerateEdges=function(t){var i,n,r,s=t.mesh.eHead;for(i=s.next;i!==s;i=n)n=i.next,r=i.Lnext,Mt.vertEq(i.Org,i.Dst)&&i.Lnext.Lnext!==i&&(e.spliceMergeVertices(t,r,i),t.mesh.delete(i),i=r,r=i.Lnext),r.Lnext===i&&(r!==i&&((r===n||r===n.Sym)&&(n=n.next),t.mesh.delete(r)),(i===n||i===n.Sym)&&(n=n.next),t.mesh.delete(i))},e.initPriorityQ=function(t){var i,n,r,s=0;for(r=t.mesh.vHead,n=r.next;n!==r;n=n.next)s++;for(s+=8,i=t.pq=new q3e(s,Mt.vertLeq),r=t.mesh.vHead,n=r.next;n!==r;n=n.next)n.pqHandle=i.insert(n);return n!==r?!1:(i.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,i){var n,r,s;for(n=i.fHead.next;n!==i.fHead;n=r)r=n.next,s=n.anEdge,Rt(s.Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,i){i===void 0&&(i=!0);var n,r;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(n=t.pq.extractMin())!==null;){for(;r=t.pq.min(),!(r===null||!Mt.vertEq(r,n));)r=t.pq.extractMin(),e.spliceMergeVertices(t,n.anEdge,r.anEdge);e.sweepEvent(t,n)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(i&&t.mesh.check(),!0):!1},e}(),K3e=function(){function e(){this.mesh=new QV,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Ti.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]},e.prototype.normalize_=function(t){var i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!i)throw"Zero-size vector!";i=Math.sqrt(i),t[0]/=i,t[1]/=i,t[2]/=i},e.prototype.longAxis_=function(t){var i=0;return Math.abs(t[1])>Math.abs(t[0])&&(i=1),Math.abs(t[2])>Math.abs(t[i])&&(i=2),i},e.prototype.computeNormal_=function(t){var i,n,r,s,o,a,l=[0,0,0],c=[0,0,0],h=[0,0,0],u=[0,0,0],d=[0,0,0],f=[null,null,null],p=[null,null,null],g=this.mesh.vHead;i=g.next;for(var m=0;m<3;++m)s=i.coords[m],c[m]=s,p[m]=i,l[m]=s,f[m]=i;for(i=g.next;i!==g;i=i.next)for(var v=0;v<3;++v)s=i.coords[v],s<c[v]&&(c[v]=s,p[v]=i),s>l[v]&&(l[v]=s,f[v]=i);var x=0;if(l[1]-c[1]>l[0]-c[0]&&(x=1),l[2]-c[2]>l[x]-c[x]&&(x=2),c[x]>=l[x]){t[0]=0,t[1]=0,t[2]=1;return}for(a=0,n=p[x],r=f[x],h[0]=n.coords[0]-r.coords[0],h[1]=n.coords[1]-r.coords[1],h[2]=n.coords[2]-r.coords[2],i=g.next;i!==g;i=i.next)u[0]=i.coords[0]-r.coords[0],u[1]=i.coords[1]-r.coords[1],u[2]=i.coords[2]-r.coords[2],d[0]=h[1]*u[2]-h[2]*u[1],d[1]=h[2]*u[0]-h[0]*u[2],d[2]=h[0]*u[1]-h[1]*u[0],o=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],o>a&&(a=o,t[0]=d[0],t[1]=d[1],t[2]=d[2]);a<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(h)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,i,n=this.mesh.vHead,r,s=0,o=t.next;o!==t;o=o.next)if(r=o.anEdge,!(r.winding<=0))do s+=(r.Org.s-r.Dst.s)*(r.Org.t+r.Dst.t),r=r.Lnext;while(r!==o.anEdge);if(s<0){for(i=n.next;i!==n;i=i.next)i.t=-i.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,i=[0,0,0],n,r,s=!1;i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],!i[0]&&!i[1]&&!i[2]&&(this.computeNormal_(i),s=!0),n=this.sUnit,r=this.tUnit;var o=this.longAxis_(i);n[o]=0,n[(o+1)%3]=1,n[(o+2)%3]=0,r[o]=0,r[(o+1)%3]=0,r[(o+2)%3]=i[o]>0?1:-1;for(var a=t.next;a!==t;a=a.next)a.s=this.dot_(a.coords,n),a.t=this.dot_(a.coords,r);s&&this.checkOrientation_();for(var l=!0,c=t.next;c!==t;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},e.prototype.addWinding_=function(t,i){t.winding+=i.winding,t.Sym.winding+=i.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,i){var n,r;if(n=i.anEdge,!(n.Lnext!==n&&n.Lnext.Lnext!==n))throw"Mono region invalid";for(;Mt.vertLeq(n.Dst,n.Org);n=n.Lprev);for(;Mt.vertLeq(n.Org,n.Dst);n=n.Lnext);r=n.Lprev;for(var s=void 0;n.Lnext!==r;)if(Mt.vertLeq(n.Dst,r.Org)){for(;r.Lnext!==n&&(Mt.edgeGoesLeft(r.Lnext)||Mt.edgeSign(r.Org,r.Dst,r.Lnext.Dst)<=0);)s=t.connect(r.Lnext,r),r=s.Sym;r=r.Lprev}else{for(;r.Lnext!==n&&(Mt.edgeGoesRight(n.Lprev)||Mt.edgeSign(n.Dst,n.Org,n.Lprev.Org)>=0);)s=t.connect(n,n.Lprev),n=s.Sym;n=n.Lnext}if(r.Lnext===n)throw"Mono region invalid";for(;r.Lnext.Lnext!==n;)s=t.connect(r.Lnext,r),r=s.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var i,n=t.fHead.next;n!==t.fHead;n=i)if(i=n.next,n.inside&&!this.tessellateMonoRegion_(t,n))return!1;return!0},e.prototype.discardExterior_=function(t){for(var i,n=t.fHead.next;n!==t.fHead;n=i)i=n.next,n.inside||t.zapFace(n)},e.prototype.setWindingNumber_=function(t,i,n){for(var r,s=t.eHead.next;s!==t.eHead;s=r)r=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?i:-i:n?t.delete(s):s.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,i,n,r){var s,o=0,a=0,l;n>3&&t.mergeConvexFaces(n);for(var c=t.vHead.next;c!==t.vHead;c=c.next)c.n=-1;for(var h=t.fHead.next;h!==t.fHead;h=h.next)if(h.n=-1,!!h.inside){s=h.anEdge,l=0;do{var c=s.Org;c.n===-1&&(c.n=a,a++),l++,s=s.Lnext}while(s!==h.anEdge);if(l>n)throw"Face vertex greater that support polygon";h.n=o,++o}this.elementCount=o,i===Un.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*n,this.vertexCount=a,this.vertices=[],this.vertices.length=a*r,this.vertexIndices=[],this.vertexIndices.length=a;for(var c=t.vHead.next;c!==t.vHead;c=c.next)if(c.n!==-1){var u=c.n*r;this.vertices[u+0]=c.coords[0],this.vertices[u+1]=c.coords[1],r>2&&(this.vertices[u+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var d=0,h=t.fHead.next;h!==t.fHead;h=h.next)if(h.inside){s=h.anEdge,l=0;do{var c=s.Org;this.elements[d++]=c.n,l++,s=s.Lnext}while(s!==h.anEdge);for(var f=l;f<n;++f)this.elements[d++]=-1;if(i===Un.CONNECTED_POLYGONS){s=h.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==h.anEdge);for(var p=l;p<n;++p)this.elements[d++]=-1}}},e.prototype.outputContours_=function(t,i){var n,r,s=0,o=0;this.vertexCount=0,this.elementCount=0;for(var a=t.fHead.next;a!==t.fHead;a=a.next)if(a.inside){r=n=a.anEdge;do this.vertexCount++,n=n.Lnext;while(n!==r);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*i,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,h=0;s=0;for(var a=t.fHead.next;a!==t.fHead;a=a.next)if(a.inside){o=0,r=n=a.anEdge;do this.vertices[l++]=n.Org.coords[0],this.vertices[l++]=n.Org.coords[1],i>2&&(this.vertices[l++]=n.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(n):n.Org.idx,o++,n=n.Lnext;while(n!==r);this.elements[h++]=s,this.elements[h++]=o,s+=o}},e.prototype.addContour=function(t,i){this.mesh===null&&(this.mesh=new QV),t<2&&(t=2),t>3&&(t=3);for(var n=null,r=0;r<i.length;r+=t)n===null?(n=this.mesh.makeEdge(),this.mesh.splice(n,n.Sym)):(this.mesh.splitEdge(n),n=n.Lnext),n.Org.coords[0]=i[r+0],n.Org.coords[1]=i[r+1],t>2?n.Org.coords[2]=i[r+2]:n.Org.coords[2]=0,n.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(n),n.winding=1,n.Sym.winding=-1},e.prototype.tesselate=function(t,i,n,r,s,o){if(t===void 0&&(t=Ti.ODD),i===void 0&&(i=Un.POLYGONS),o===void 0&&(o=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=t,r<2&&(r=2),r>3&&(r=3),!this.mesh)return!1;this.projectPolygon_(),J3e.computeInterior(this,o);var a=this.mesh;return i===Un.BOUNDARY_CONTOURS?this.setWindingNumber_(a,1,!0):this.tessellateInterior_(a),o&&a.check(),i===Un.BOUNDARY_CONTOURS?this.outputContours_(a,r):this.outputPolymesh_(a,i,n,r),!0},e}();function ph(e){var t=e.windingRule,i=t===void 0?Ti.ODD:t,n=e.elementType,r=n===void 0?Un.POLYGONS:n,s=e.polySize,o=s===void 0?3:s,a=e.vertexSize,l=a===void 0?2:a,c=e.normal,h=c===void 0?[0,0,1]:c,u=e.contours,d=u===void 0?[]:u,f=e.strict,p=f===void 0?!0:f,g=e.debug,m=g===void 0?!1:g;if(!d&&p)throw new Error("Contours can't be empty");if(d){var v=new K3e;e.edgeCreateCallback&&(v.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(v.vertexIdCallback=e.vertexIdCallback);for(var x=0;x<d.length;x++)v.addContour(l||2,d[x]);return v.tesselate(i,r,o,l,h,p),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:m?v.mesh:void 0}}}Ti.ODD;Ti.NONZERO;Ti.POSITIVE;Ti.NEGATIVE;Ti.ABS_GEQ_TWO;Un.POLYGONS;Un.CONNECTED_POLYGONS;Un.BOUNDARY_CONTOURS;var JB=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let i=e*JB.eSize;this.buffer=new ArrayBuffer(i);let n=Float32Array.BYTES_PER_ELEMENT,r=0;this.positions=new Float32Array(this.buffer,r*n,3*e),r+=3*e,this.normals=new Float32Array(this.buffer,r*n,3*e),r+=3*e,this.uvs=new Float32Array(this.buffer,r*n,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity} → ${e}`);let i=e*JB.eSize,n=new ArrayBuffer(i),r=Float32Array.BYTES_PER_ELEMENT,s=0,o=new Float32Array(n,s*r,3*e);s+=3*e;let a=new Float32Array(n,s*r,3*e);s+=3*e;let l=new Float32Array(n,s*r,2*e);o.set(this.positions.slice(0,this.size*3)),a.set(this.normals.slice(0,this.size*3)),l.set(this.uvs.slice(0,this.size*2)),this.buffer=n,this.positions=o,this.normals=a,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let n=this.capacity;for(;t>n;)n*=2;this.realloc(n)}let i=this.size;return this.size=t,i}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},yJ=JB;yJ.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var YO={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},xJ={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},wJ={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},sP=(e,t)=>([i,n])=>(n<i&&(n+=t),(e>=i?e:e+t)<=n),_J=class extends Ot{constructor(e,t,i=0,n=12,r=3,s=Ti.ODD){super(),this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._bevel=i,this._curveSegments=n,this._bevelSegmentsInput=r,i<=0?(this._bevelSize=0,this._bevelSegments=0):(this._bevelSize=Math.min(i,t/2-1e-12),this._bevelSegments=Math.floor(r));let o=this._shape.extractShapePointsToFlatArray([],n),a=this._shape.shapeHoles.map(M=>{let A=M.extractShapePointsToFlatArray([],n),T=[];for(let S=A.length-1;S>=1;S-=2){let C=A[S-1],P=A[S-0];T.push(C,P)}return T}),l;try{l=ph({windingRule:s,elementType:Un.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{l=YO}let c;try{c=ph({windingRule:Ti.ODD,elementType:Un.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...a]})}catch{c=xJ}if(!l)throw new Error("error generating geometry");let h=l.elementCount;if(c){l.elementCount+=c.elementCount;for(let M=0;M<c.elements.length;M++){let A=c.elements[M],T=M%2===0?l.vertexCount:0;l.elements.push(A+T)}for(let M=0;M<c.vertexIndices.length;M++){let A=c.vertexIndices[M],T=l.vertexCount;l.vertexIndices.push(A+T)}for(let M=0;M<c.vertices.length;M++){let A=c.vertices[M];l.vertices.push(A)}}let u=1/0,d=-1/0,f=1/0,p=-1/0;for(let M=0,A=l.vertexCount;M<A;M++){let T=M*2,S=l.vertices[T+0],C=l.vertices[T+1];S<u&&(u=S),S>d&&(d=S),C<f&&(f=C),C>p&&(p=C)}this._minX=u,this._minY=f,this._width=d-u,this._height=p-f,this._buffer=new yJ(this._computeBufferEstimatedSize(l));let g=[],m=[];for(let M=l.elementCount-1;M>=0;M--){let A=M>=h,T=M*2,S=l.elements[T+0],C=l.elements[T+1],P=S+C,B={start:S,count:C,normals:[],continuous:[],concave:[]},k=S,z=P-1,F=S+1,W=this._shape.roundedCurves.length;do{let X=k-S,V=l.vertices[z*2+0],q=l.vertices[z*2+1],H=l.vertices[k*2+0],Q=l.vertices[k*2+1],J=l.vertices[F*2+0],le=l.vertices[F*2+1],j=H-V,ve=Q-q,pe=Math.sqrt(j*j+ve*ve);j/=pe,ve/=pe;let me=H-J,de=Q-le,Se=Math.sqrt(me*me+de*de);me/=Se,de/=Se,B.normals[X*2+0]=-de,B.normals[X*2+1]=me,B.concave[X]=j*de-ve*me>0;let ce=l.vertexIndices[k];if(Array.isArray(ce))B.continuous[X]=!1;else{let[se,be]=this._shape.getCurveIndexFromVertexId(ce-1,!0);if(be>0&&be<1)B.continuous[X]=!0;else{let Ee=be===1?se+1:se-1;Ee=(Ee+W)%W;let Le=be===1?0:1,ze=this._shape.roundedCurves[se].getTangent(be),Oe=this._shape.roundedCurves[Ee].getTangent(Le);B.continuous[X]=ze.dot(Oe)>.95}}A&&(B.normals[X*2+0]*=-1,B.normals[X*2+1]*=-1),[z,k,F]=[k,F,F+1],F>=P&&(F-=C)}while(F!==S+1);let K=[];K.push({bevelI:0,angle:0,size:0,boundary:{vertices:l.vertices.slice(S*2,P*2),vertexCount:C,vertexIndices:new Array(C).fill(!0).map((X,V)=>[V,V]),elements:[0,C],elementCount:1,mesh:null},reverseMap:[],insetPoints:l.vertices.slice(S*2,P*2)});for(let X=1;X<=this._bevelSegments;X++){let V=X/this._bevelSegments*Math.PI/2,q=(1-Math.cos(V))*this._bevelSize,H=[],Q=[],J=0;for(let j=0;j<C;j++){let ve=j*2,pe=(j-1+C)%C*2,me=l.vertices[B.start*2+ve+0],de=l.vertices[B.start*2+ve+1],Se=-B.normals[pe+0]*q,ce=-B.normals[pe+1]*q,se=-B.normals[ve+0]*q,be=-B.normals[ve+1]*q;if(B.concave[j]||!B.concave[j]&&A){let Ee=Math.atan2(ce,Se),Le=Math.atan2(be,se);Le>Ee&&(Le-=Math.PI*2);let ze=Le-Ee;if(B.continuous[j]||A){let Oe=Ee+ze/2,Ge=Math.cos(Oe)*q,tt=Math.sin(Oe)*q;H[2*J+0]=me+Ge*(A?-1:1),H[2*J+1]=de+tt*(A?-1:1),Q[J]=j,J++}else{let Oe=Math.max(1,Math.floor(n/4*Math.abs(ze)/Math.PI));for(let Ge=0;Ge<=Oe;Ge++){let tt=Ee+ze*(Ge/Oe),ot=Math.cos(tt)*q,N=Math.sin(tt)*q;H[2*J+0]=me+ot,H[2*J+1]=de+N,Q[J]=j,J++}}}else H[2*J+0]=me+Se,H[2*J+1]=de+ce,Q[J]=j,J++,H[2*J+0]=me,H[2*J+1]=de,Q[J]=j,J++,H[2*J+0]=me+se,H[2*J+1]=de+be,Q[J]=j,J++}let le=ph({windingRule:Ti.POSITIVE,elementType:Un.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[H],edgeCreateCallback:j=>{let ve=j.Org.idx,pe=Q[ve],me=Q[(ve+1)%Q.length];j.idx=[pe,me],j.Sym.idx=[me,pe]},vertexIdCallback:j=>{let ve=j.Lprev.idx;return[ve?ve[1]:0,j.idx?j.idx[0]:0]}});if(!le)throw console.log("Error"),new Error(`error generating bevel geometry for ${X}'th loop`);if(!le.vertexCount)break;for(let j=0;j<le.vertexIndices.length;j++){let[ve,pe]=le.vertexIndices[j];if(ve===pe)continue;let me=pe;pe<ve&&(me+=C);for(let de=ve;de<me;de++){let Se=de%C,ce=(de+1)%C;if(!B.continuous[Se]||!B.continuous[ce]){le.vertexIndices[j]=[ve,Se],le.vertexIndices.splice(j+1,0,[ce,pe]),le.vertices.splice((j+1)*2,0,le.vertices[j*2],le.vertices[j*2+1]);break}}}K.push({bevelI:X,angle:V,size:q,boundary:le,reverseMap:Q,insetPoints:H})}let Z=(X,V,q)=>{let H=0,Q=X.boundary.vertexIndices.length;for(;H<Q&&q(X.boundary.vertexIndices[V]);)V=(V+1)%Q,H++;return H},U=g.length;for(let X=1;X<K.length;X++){let V=K[X-1],q=K[X],H=V.boundary.vertexIndices.length,Q=q.boundary.vertexIndices.length;if(!H||!Q)break;let J=B.concave.length,le=0,j=sP(le,C);for(;!V.boundary.vertexIndices.filter(j).length||!q.boundary.vertexIndices.filter(j).length;)le++,j=sP(le,C);let ve=V.boundary.vertexIndices.findIndex(j),pe=q.boundary.vertexIndices.findIndex(j);do ve=(ve+1)%H;while(j(V.boundary.vertexIndices[ve]));do pe=(pe+1)%Q;while(j(q.boundary.vertexIndices[pe]));le=(le+1)%C;let me=le,de=this._buildBevelVert(B,V,(ve-1+H)%H),Se=this._buildBevelVert(B,q,(pe-1+Q)%Q),ce=de,se=Se,be,Ee,Le=!1;do{j=sP(le,C);let ze=Z(V,ve,j),Oe=Z(q,pe,j),Ge=Le;if(Le=!1,ze&&!Oe){for(let tt=0;tt<ze;tt++)be=this._buildBevelVert(B,V,(ve+tt)%H,tt/(ze-1)),g.push(ce.topN,be.topP,se.topN),g.push(be.bottomP,ce.bottomN,se.bottomN),ce=be;Le=!0}else if(!ze&&Oe)for(let tt=0;tt<Oe;tt++)Ee=this._buildBevelVert(B,q,(pe+tt)%Q,tt/(Oe-1)),g.push(se.topN,ce.topP,Ee.topP),g.push(ce.bottomP,se.bottomN,Ee.bottomP),se=Ee;else if(ze&&Oe)if(be=this._buildBevelVert(B,V,ve,0),Ee=this._buildBevelVert(B,q,pe,0),Ge?(g.push(ce.topN,Ee.topP,se.topN),g.push(ce.topN,be.topP,Ee.topP),g.push(Ee.bottomP,ce.bottomN,se.bottomN),g.push(Ee.bottomP,be.bottomP,ce.bottomN)):(g.push(se.topN,ce.topN,be.topP),g.push(se.topN,be.topP,Ee.topP),g.push(be.bottomP,ce.bottomN,se.bottomN),g.push(be.bottomP,se.bottomN,Ee.bottomP)),ce=be,se=Ee,ze===Oe)for(let tt=1;tt<ze;tt++)be=this._buildBevelVert(B,V,(ve+tt)%H,tt/(ze-1)),Ee=this._buildBevelVert(B,q,(pe+tt)%Q,tt/(Oe-1)),g.push(ce.topN,be.topP,se.topN),g.push(se.topN,be.topP,Ee.topP),g.push(be.bottomP,ce.bottomN,se.bottomN),g.push(be.bottomP,se.bottomN,Ee.bottomP),ce=be,se=Ee;else if(ze>Oe){let tt=ze/Oe,ot=0;for(let N=1;N<ze;N++)be=this._buildBevelVert(B,V,(ve+N)%H,N/(ze-1)),g.push(ce.topN,be.topP,se.topN),g.push(be.bottomP,ce.bottomN,se.bottomN),ce=be,N>(ot+1)*tt&&(ot++,Ee=this._buildBevelVert(B,q,(pe+ot)%Q,ot/(Oe-1)),g.push(se.topN,be.topP,Ee.topP),g.push(be.bottomP,se.bottomN,Ee.bottomP),se=Ee)}else{let tt=Oe/ze,ot=0;for(let N=1;N<Oe;N++)Ee=this._buildBevelVert(B,q,(pe+N)%Q,N/(Oe-1)),g.push(se.topN,be.topP,Ee.topP),g.push(be.bottomP,se.bottomN,Ee.bottomP),se=Ee,N>(ot+1)*tt&&(ot++,be=this._buildBevelVert(B,V,(ve+ot)%H,ot/(ze-1)),g.push(ce.topN,be.topP,se.topN),g.push(be.bottomP,ce.bottomN,se.bottomN),ce=be)}ve=(ve+ze)%H,pe=(pe+Oe)%Q,le=(le+1)%J}while(le!==me)}if(this._buildWall(K,B,g),A){let X=[];for(let V=g.length-1;V>=U+2;V-=3){let q=g[V-2],H=g[V-1],Q=g[V-0];X.push(Q,H,q)}g.splice(U,g.length-U,...X)}if(A){let X=[];for(let V=K[K.length-1].boundary.vertices.length-1;V>=1;V-=2){let q=K[K.length-1].boundary.vertices[V-1],H=K[K.length-1].boundary.vertices[V-0];X.push(q,H)}m.push(X)}if(!A){let X=K[K.length-1],V;try{V=ph({windingRule:K.length>1?Ti.POSITIVE:Ti.ODD,elementType:Un.POLYGONS,vertexSize:2,strict:!0,contours:[X.insetPoints,...m]})}catch{V=wJ}if(!V)throw new Error("Error generating geometry for surface");a.length===0&&Object.assign(this,{capStartIndex:g.length});for(let q=0;q<V.elementCount*3;q+=3){let H=this._buildSurfaceVert(V,V.elements[q+0]),Q=this._buildSurfaceVert(V,V.elements[q+1]),J=this._buildSurfaceVert(V,V.elements[q+2]);g.push(H.top,Q.top,J.top),g.push(J.bottom,Q.bottom,H.bottom)}}this.vertexCache={}}this._buffer.shrink();let v=new zt(Uint32Array.from(g),1),x=new zt(this._buffer.positions,3),w=new zt(this._buffer.normals,3),b=new zt(this._buffer.uvs,2);x.needsUpdate=!0,w.needsUpdate=!0,b.needsUpdate=!0,v.needsUpdate=!0,this.setAttribute("position",x),this.setAttribute("normal",w),this.setAttribute("uv",b),this.setIndex(v)}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,i){let n=e[0];for(let r=0,s=n.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(t,n,r),a=this._buildBevelVert(t,n,(r+1)%s);i.push(a.topP,o.topN,o.bottomN),i.push(a.topP,o.bottomN,a.bottomP)}}_buildSurfaceVert(e,t){let i=t.toString();if(i in this.vertexCache)return this.vertexCache[i];let n=e.vertices[t*2+0],r=e.vertices[t*2+1],s=(n-this._minX)/this._width,o=(r-this._minY)/this._height,a=this._buffer.get(2),l=a*3,c=a*2,h={top:a+0,bottom:a+1};return this._buffer.positions[l+0]=n,this._buffer.positions[l+1]=r,this._buffer.positions[l+2]=this._depth,this._buffer.normals[l+0]=0,this._buffer.normals[l+1]=0,this._buffer.normals[l+2]=1,this._buffer.uvs[c+0]=s,this._buffer.uvs[c+1]=o,this._buffer.positions[l+3]=n,this._buffer.positions[l+4]=r,this._buffer.positions[l+5]=0,this._buffer.normals[l+3]=0,this._buffer.normals[l+4]=0,this._buffer.normals[l+5]=-1,this._buffer.uvs[c+2]=s,this._buffer.uvs[c+3]=o,this.vertexCache[i]=h,h}_buildBevelVert(e,t,i,n=1){let r=`${t.bevelI}:${i}`;if(r in this.vertexCache)return this.vertexCache[r];let[s,o]=t.boundary.vertexIndices[i],a,l,c,h;s!==o?(l=s,a=o,h=!1,c=e.continuous[l]&&e.continuous[a]):(a=s,l=(a-1+e.count)%e.count,h=e.concave[a]&&t.bevelI>0,c=e.continuous[a]||h);let u=Math.cos(t.angle),d=Math.sin(t.angle),f=i*2,p=a*2,g=l*2,m=t.boundary.vertices[f+0],v=t.boundary.vertices[f+1],x=(1-d)*this._bevelSize,w=(m-this._minX)/this._width,b=(v-this._minY)/this._height,M=e.normals[p+0],A=e.normals[p+1],T=e.normals[g+0],S=e.normals[g+1];if(h){let z=T-M,F=S-A;M=M+z*(1-n),A=A+F*(1-n);let W=Math.sqrt(M*M+A*A);M/=W,A/=W}let C=this._buffer.get(c?2:4),P=C*3,B=C*2,k={i,fi:a,topP:C+0,topN:C+0,bottomP:C+1,bottomN:C+1};return this._buffer.positions[P+0]=m,this._buffer.positions[P+1]=v,this._buffer.positions[P+2]=this._depth-x,this._buffer.normals[P+0]=M*u,this._buffer.normals[P+1]=A*u,this._buffer.normals[P+2]=d,this._buffer.uvs[B+0]=w,this._buffer.uvs[B+1]=b,this._buffer.positions[P+3]=m,this._buffer.positions[P+4]=v,this._buffer.positions[P+5]=x,this._buffer.normals[P+3]=M*u,this._buffer.normals[P+4]=A*u,this._buffer.normals[P+5]=-d,this._buffer.uvs[B+2]=b,this._buffer.uvs[B+3]=w,c||(C+=2,P+=6,B+=4,k.topP=C+0,k.bottomP=C+1,this._buffer.positions[P+0]=m,this._buffer.positions[P+1]=v,this._buffer.positions[P+2]=this._depth-x,this._buffer.normals[P+0]=T*u,this._buffer.normals[P+1]=S*u,this._buffer.normals[P+2]=d,this._buffer.uvs[B+0]=w,this._buffer.uvs[B+1]=b,this._buffer.positions[P+3]=m,this._buffer.positions[P+4]=v,this._buffer.positions[P+5]=x,this._buffer.normals[P+3]=T*u,this._buffer.normals[P+4]=S*u,this._buffer.normals[P+5]=-d,this._buffer.uvs[B+2]=b,this._buffer.uvs[B+3]=w),this.vertexCache[r]=k,k}clone(){let e=new _J(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=iE(this.userData),e}},bJ=class extends Ot{constructor(e,t=12,i={}){super(),this.type="ShapeGeometry",this.windingRule=Ti.ODD,this.elementType=Un.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:Ti.ODD,elementType:Un.POLYGONS,polySize:3,vertexSize:2,strict:!0},i);let n=this._shape.extractShapePointsToFlatArray([],this._curveSegments),r=this._shape.shapeHoles.map(d=>d.extractShapePointsToFlatArray([],this._curveSegments)),s,o=!0,a=!0,l,c;for(let d=0,f=n.length/2;d<f;d++){let p=d*2,g=n[p+0],m=n[p+1];if(l!==void 0&&g!==l&&(o=!1),c!==void 0&&m!==c&&(a=!1),l=g,c=m,!o&&!a)break}if(!o&&!a)try{s=ph({contours:[n,...r],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=YO}let h=(s==null?void 0:s.vertexCount)??1,u=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new zt(new Float32Array(h*3),3),this._normalAttribute=new zt(new Float32Array(h*3),3),this._uvAttribute=new zt(new Float32Array(h*2),2),this._indexAttribute=new zt(new Uint32Array(u*3),1),s){let d=1/0,f=-1/0,p=1/0,g=-1/0;for(let x=0,w=h;x<w;x++){let b=x*2,M=s.vertices[b+0],A=s.vertices[b+1];M<d&&(d=M),M>f&&(f=M),A<p&&(p=A),A>g&&(g=A)}let m=f-d,v=g-p;for(let x=0,w=h;x<w;x++){let b=x*2,M=s.vertices[b+0],A=s.vertices[b+1],T=(M-d)/m,S=(A-p)/v;this._positionAttribute.setXYZ(x,M,A,0),this._normalAttribute.setXYZ(x,0,0,1),this._uvAttribute.setXY(x,T,S)}for(let x=0,w=u;x<w;x++){let b=x*3,M=s.elements[b+0],A=s.elements[b+1],T=s.elements[b+2];this._indexAttribute.setX(b+0,M),this._indexAttribute.setX(b+1,A),this._indexAttribute.setX(b+2,T)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let e=new bJ(this._shape,this._curveSegments);return e.userData=iE(this.userData),e}},AJ=class extends _J{constructor(e,t,i=0,n=12,r=3,s=Ti.ODD){super(e,t,i,n,r,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,i){let n=e[0];for(let r=0,s=n.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(t,n,r),a=this._buildBevelVert(t,n,(r+1)%s);i.push(a.topP,o.topN,o.bottomN),i.push(a.topP,o.bottomN,a.bottomP)}}clone(){let e=new AJ(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=iE(this.userData),e}},tp=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var c,h;let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Ti.ODD},e.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),o=e.shape??(t==null?void 0:t.shape),a=(o==null?void 0:o.roundness)??i.roundness;o!==void 0&&(o instanceof yn?(o.width!==n||o.height!==r)&&o.applySize(n,r):o=new yn(n,r).fromJSON(o),((c=e.parameters)==null?void 0:c.roundness)!==void 0&&((h=e.parameters)==null?void 0:h.roundness)>0&&o.update());let l=o??new yn(n,r);return{parameters:Object.assign(i,{width:n,height:r,depth:s,roundness:a}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:i,extrudeBevelSegments:n,subdivisions:r,roundness:s,windingRule:o}=e.parameters;e.shape.roundness=s;let a;return t<=0?a=new bJ(e.shape,r,{windingRule:o}):a=new AJ(e.shape,t,i,r,n,o),Object.assign(a,{userData:{...e,type:"VectorGeometry"}})}},SJ=Math.PI*2,qO=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof yn?e.shape:new yn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,spikes:n,angle:r,innerRadius:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=e.parameters,c=e.shape,h=t*.5,u=i*.5,d=Z3e(c,h,u,r*Math.PI/180,n,s);c.isClosed=!0,c.update();let f=tp.create({shape:c,parameters:{subdivisions:d,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(f,{userData:{...e,type:"EllipseGeometry"}})}};function Z3e(e,t,i,n,r,s){if(n>=SJ)return r>30||r%4===0?(eBe(e,t,i,s),Math.round(r/4)):$V(e,n,r,t,i,s);n=Math.max(n,.001);let o={x:0,y:i},a=n+Math.PI*.5,l={x:Math.cos(a)*t,y:Math.sin(a)*i},c=Y3e({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:t,ry:i,largeArcFlag:n>Math.PI,sweepFlag:!0});return r>30||r%c.length===0?$3e(e,o.x,o.y,c,r,t,i,s):$V(e,n,r,t,i,s)}function $3e(e,t,i,n,r,s,o,a){let l=Math.round(r/n.length);e.addPoint(cg(t,i));for(let c=0,h=n.length;c<h;c++){let u=n[c],d=e.points[c],f=cg(u.x,u.y);d.controls[1].position.set(u.x1,u.y1),f.controls[0].position.set(u.x2,u.y2),e.addPoint(f)}return a>0?MJ(e,s,o,a):e.addPoint(cg(0,0)),l}function $V(e,t,i,n,r,s){let o=-t/i;for(let a=0;a<=i;a++){let l=o*a,c=Math.sin(l)*n,h=Math.cos(l)*r;e.addPoint(cg(c,h))}return t<SJ?s>0?MJ(e,n,r,s):e.addPoint(cg(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&EJ(e,n,r,s)),1}function eBe(e,t,i,n=0,r=0,s=0){let o=.5522847498,a=t*o,l=i*o;e.addPoint(bb(r-t,s,r-t,s-l,r-t,s+l)),e.addPoint(bb(r,s+i,r-a,s+i,r+a,s+i)),e.addPoint(bb(r+t,s,r+t,s+l,r+t,s-l)),e.addPoint(bb(r,s-i,r+a,s-i,r-a,s-i)),n>0&&EJ(e,t,i,n)}function cg(e,t){return new lg(si.generateUUID(),new ge(e,t))}function bb(e,t,i,n,r,s){let o=cg(e,t);return o.controls[0].position.set(i,n),o.controls[1].position.set(r,s),o}function MJ(e,t,i,n){CJ(e,t,i,n).forEach(r=>e.addPoint(r))}function EJ(e,t,i,n){let r=CJ(e,t,i,n),s=new yn;r.forEach(o=>s.addPoint(o)),s.isClosed=!0,e.shapeHoles.push(s)}function CJ(e,t,i,n){let r=n*t/100,s=r*(Math.abs(i)/Math.abs(t)),o=new ge(r/t,s/i),a=e.points.map(l=>{let c=l.clone();return c.uuid=si.generateUUID(),c}).reverse();return a.forEach(l=>{l.position.multiply(o);let c=l.controls[0].position.clone().multiply(o),h=l.controls[1].position.clone().multiply(o);l.controls[0].position.copy(h),l.controls[1].position.copy(c)}),a}var tBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),n=Math.abs(i.width),r=Math.abs(i.height??n),s=Math.abs(i.depth??n),o=Math.abs(Math.min(n,s))/2;return{parameters:Object.assign(i,{width:n,height:r,depth:s,radius:o,segments:Math.round(i.segments),pathSegments:Math.round(i.pathSegments),cornerSegments:Math.round(i.cornerSegments)})}}static build(e){let{width:t,height:i,depth:n,radius:r,revolutions:s,segments:o,pathRadius:a,pathType:l,pathSegments:c,cornerRadius:h,cornerSegments:u}=e.parameters,d=new TJ(!1,t,i,n,r,s,o,a,l,c,h,u);return Object.assign(d,{userData:{...e,type:"HelixGeometry"}})}},oP=new ig([0,0,0],1),TJ=class extends Ot{constructor(e=!0,t=1,i=1,n=1,r=1,s=1,o=1,a=1,l=1,c=1,h=1,u=1){if(super(),s===0)return;let d=e&&s===1;d&&(u=0),h>100&&(h=100),h===0&&(u=0);let f=()=>new I,p=new I,g=f(),m=f(),v=f(),x,w,b,M,A,T,S,C,P=f(),B=f(),k=f(),z=f(),F=f(),W=f(),K=f(),Z=f(),U=i-2*a+.001,X=U/s,V=Math.ceil(o*s),q=V+1,H=U/V,Q=-U/2,J=c+1,le=2*Math.PI/c,j=Math.PI/2/u,ve=.01,pe=Math.min((1-h/100)*a,a-ve),me=a-pe,de=0,Se=2,ce=u*Se+Se,se=J*ce/Se,be=se+J*q,Ee=J*(q+ce),[Le,ze,Oe]=[3,3,2].map(ue=>Array(Ee*ue).fill(0)),Ge=[],tt=r-a;function ot(ue,He){let ne=Math.PI/2;T=He*H,C=2*Math.PI*(T%X)/X+ne,T+=Q,S=Math.sin(C)*tt,A=Math.cos(C)*tt,e?ue.set(A,S,T):ue.set(A,T,S)}ot(p,-1e-10),ot(g,0),P.copy(p),ot(p,1);let N=p.distanceTo(g),R=d?0:me+pe,ie=N*V+2*R,xe=pe,Me=ie-R;for(let ue=0;ue<=V;ue++){ot(m,ue),Z.subVectors(m,P).normalize(),P.copy(m),W.copy(m).setComponent(+e+1,0).normalize(),K.crossVectors(Z,W).normalize();let He=ue===0,ne=ue===V,we=He?3*Math.PI/2:j,Re=He?xe:Me,Ne=He?J:be,$e=He?0:Ee-J,xt=Z.clone().multiplyScalar(He?-me:me).add(m),kt=Z.clone().multiplyScalar(He?-1:1).normalize();for(let Y=0;Y<J;Y++){let oe=Y*le;if(B.addVectors(p.copy(W).multiplyScalar(a*Math.cos(oe)),g.copy(K).multiplyScalar(a*Math.sin(oe))),k.copy(B).normalize(),He||ne){d||(de=$e+Y,[0,1,2].forEach(ye=>{Le[de*3+ye]=xt.getComponent(ye),ze[de*3+ye]=kt.getComponent(ye)}),Oe[de*2]=+ne,Oe[de*2+1]=Y/c),g.copy(k).multiplyScalar(pe),v.addVectors(m,g);for(let ye=0;ye<u;ye++){let Fe=ye*j+we;z.addVectors(p.copy(Z).multiplyScalar(me*Math.sin(Fe)),g.copy(k).multiplyScalar(me*Math.cos(Fe))),F.copy(z).normalize(),g.addVectors(v,z),z.normalize(),de=Ne+ye*J+Y,[0,1,2].forEach(pt=>{Le[de*3+pt]=g.getComponent(pt),ze[de*3+pt]=F.getComponent(pt)});let Xe=+He+Math.sin(Fe);Oe[de*2]=(Re+me*Xe)/ie,Oe[de*2+1]=Y/c}}g.addVectors(m,B),de=se+ue*J+Y,[0,1,2].forEach(ye=>{Le[de*3+ye]=g.getComponent(ye),ze[de*3+ye]=k.getComponent(ye)}),Oe[de*2]=(R+ue*N)/ie,Oe[de*2+1]=Y/c}}let Te=q+2*u+Se,[qe,De]=[+d,Te-1];for(let ue=qe;ue<=De-1;ue++){let He=d&&ue===De-1;for(let ne=0;ne<J-1;ne++)x=ue*J+ne,w=x+1,b=(He?ne:x)+J,M=(He?ne+1:w)+J,ue===0?Ge.push(w,M,b):ue===Te-2?Ge.push(x,w,b):Ge.push(x,w,b,w,M,b)}this.setIndex(Ge),this.setAttribute("position",new gt(Le,3)),this.setAttribute("normal",new gt(ze,3)),this.setAttribute("uv",new gt(Oe,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e=this.userData.parameters,t=Math.ceil(e.tubularSegments),i=e.radialSegments+1,n=Array.from(this.getIndex().array),r,s,o,a,l=6*(t-1)*e.radialSegments,c=t,h=c===t;for(let u=0;u<e.radialSegments;u++)r=c*i+u,s=r+1,o=(h?u:r)+i,a=(h?u+1:s)+i,n[l++]=r,n[l++]=s,n[l++]=o,n[l++]=s,n[l++]=a,n[l++]=o;return n.length=l,oP.array=n,oP.count=n.length,oP}},iBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:n,detail:r,corner:s,cornerSides:o}=e.parameters,a=r===0&&s!==0?new PJ(t*.5,s,o):new Oq(t*.5,r);return a.scale(1,i/t,n/t),Object.assign(a,{userData:{...e,type:"IcosahedronGeometry"}})}},PJ=class extends jO{constructor(e=1,t=.2,i=4){let n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],o="IcosahedronGeometry";super(r,s,o,e,t,i),this.type=o}static fromJSON(e){return new PJ(e.radius,e.corner,e.cornerSides)}},nBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n;(((n=e.parameters)==null?void 0:n.points)??[]).forEach(r=>{Array.isArray(r)&&(r.x=r[0],r.y=r[1])});let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{points:t,segments:i,verticalSegments:n}=e.parameters,r=new mS;r.moveTo(t[0].x,t[0].y),r.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new Tq(r.extractPoints(n).shape,i);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...e,type:"LatheGeometry"}})}},vl=new Je,aP=new Ii,Ab=new I,WS=class extends _s{constructor(){super(),this.uuid=si.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new Cr().getNormalMatrix(e);for(let i=0,n=this.vertices.length;i<n;i++)this.vertices[i].applyMatrix4(e);for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i];r.normal.applyMatrix3(t).normalize();for(let s=0,o=r.vertexNormals.length;s<o;s++)r.vertexNormals[s].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return vl.makeRotationX(e),this.applyMatrix4(vl),this}rotateY(e){return vl.makeRotationY(e),this.applyMatrix4(vl),this}rotateZ(e){return vl.makeRotationZ(e),this.applyMatrix4(vl),this}translate(e,t,i){return vl.makeTranslation(e,t,i),this.applyMatrix4(vl),this}scale(e,t,i){return vl.makeScale(e,t,i),this.applyMatrix4(vl),this}lookAt(e){return aP.lookAt(e),aP.updateMatrix(),this.applyMatrix4(aP.matrix),this}fromBufferGeometry(e){let t=this,i=e.index!==null?e.index:void 0,n=e.attributes;if(n.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let r=n.position,s=n.normal,o=n.color,a=n.uv,l=n.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let u=0;u<r.count;u++)t.vertices.push(new I().fromBufferAttribute(r,u)),o!==void 0&&t.colors.push(new Pt().fromBufferAttribute(o,u));function c(u,d,f,p){let g=o===void 0?[]:[t.colors[u].clone(),t.colors[d].clone(),t.colors[f].clone()],m=s===void 0?[]:[new I().fromBufferAttribute(s,u),new I().fromBufferAttribute(s,d),new I().fromBufferAttribute(s,f)],v=new KB(u,d,f,m,g,p);t.faces.push(v),a!==void 0&&t.faceVertexUvs[0].push([new ge().fromBufferAttribute(a,u),new ge().fromBufferAttribute(a,d),new ge().fromBufferAttribute(a,f)]),l!==void 0&&t.faceVertexUvs[1].push([new ge().fromBufferAttribute(l,u),new ge().fromBufferAttribute(l,d),new ge().fromBufferAttribute(l,f)])}let h=e.groups;if(h.length>0)for(let u=0;u<h.length;u++){let d=h[u],f=d.start,p=d.count;for(let g=f,m=f+p;g<m;g+=3)i!==void 0?c(i.getX(g),i.getX(g+1),i.getX(g+2),d.materialIndex):c(g,g+1,g+2,d.materialIndex)}else if(i!==void 0)for(let u=0;u<i.count;u+=3)c(i.getX(u),i.getX(u+1),i.getX(u+2));else for(let u=0;u<r.count;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ab).negate(),this.translate(Ab.x,Ab.y,Ab.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,i=t===0?1:1/t,n=new Je;return n.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix4(n),this}computeFaceNormals(){let e=new I,t=new I;for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i],s=this.vertices[r.a],o=this.vertices[r.b],a=this.vertices[r.c];e.subVectors(a,o),t.subVectors(s,o),e.cross(t),e.normalize(),r.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let i=0,n=this.vertices.length;i<n;i++)t[i]=new I;if(e){let i=new I,n=new I;for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c];i.subVectors(c,l),n.subVectors(a,l),i.cross(n),t[o.a].add(i),t[o.b].add(i),t[o.c].add(i)}}else{this.computeFaceNormals();for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i];t[r.a].add(r.normal),t[r.b].add(r.normal),t[r.c].add(r.normal)}}for(let i=0,n=this.vertices.length;i<n;i++)t[i].normalize();for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i],s=r.vertexNormals;s.length===3?(s[0].copy(t[r.a]),s[1].copy(t[r.b]),s[2].copy(t[r.c])):(s[0]=t[r.a].clone(),s[1]=t[r.b].clone(),s[2]=t[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let i=this.faces[e],n=i.vertexNormals;n.length===3?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,i=this.faces.length;t<i;t++){let n=this.faces[t];n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]);for(let r=0,s=n.vertexNormals.length;r<s;r++)n.__originalVertexNormals[r]?n.__originalVertexNormals[r].copy(n.vertexNormals[r]):n.__originalVertexNormals[r]=n.vertexNormals[r].clone()}let e=new WS;e.faces=this.faces;for(let t=0,i=this.morphTargets.length;t<i;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let r=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(let o=0,a=this.faces.length;o<a;o++){let l=new I,c={a:new I,b:new I,c:new I};r.push(l),s.push(c)}}let n=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=n.faceNormals[r],l=n.vertexNormals[r];a.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}}for(let t=0,i=this.faces.length;t<i;t++){let n=this.faces[t];n.normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Vn),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ua),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,i=0){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}let n,r=this.vertices.length,s=this.vertices,o=e.vertices,a=this.faces,l=e.faces,c=this.colors,h=e.colors;t!==void 0&&(n=new Cr().getNormalMatrix(t));for(let u=0,d=o.length;u<d;u++){let f=o[u].clone();t!==void 0&&f.applyMatrix4(t),s.push(f)}for(let u=0,d=h.length;u<d;u++)c.push(h[u].clone());for(let u=0,d=l.length;u<d;u++){let f=l[u],p,g,m=f.vertexNormals,v=f.vertexColors,x=new KB(f.a+r,f.b+r,f.c+r);x.normal.copy(f.normal),n!==void 0&&x.normal.applyMatrix3(n).normalize();for(let w=0,b=m.length;w<b;w++)p=m[w].clone(),n!==void 0&&p.applyMatrix3(n).normalize(),x.vertexNormals.push(p);x.color.copy(f.color);for(let w=0,b=v.length;w<b;w++)g=v[w],x.vertexColors.push(g.clone());x.materialIndex=f.materialIndex+i,a.push(x)}for(let u=0,d=e.faceVertexUvs.length;u<d;u++){let f=e.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,g=f.length;p<g;p++){let m=f[p],v=[];for(let x=0,w=m.length;x<w;x++)v.push(m[x].clone());this.faceVertexUvs[u].push(v)}}}mergeMesh(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)}mergeVertices(e=4){let t={},i=[],n=[],r=Math.pow(10,e);for(let a=0,l=this.vertices.length;a<l;a++){let c=this.vertices[a],h=Math.round(c.x*r)+"_"+Math.round(c.y*r)+"_"+Math.round(c.z*r);t[h]===void 0?(t[h]=a,i.push(this.vertices[a]),n[a]=i.length-1):n[a]=n[t[h]]}let s=[];for(let a=0,l=this.faces.length;a<l;a++){let c=this.faces[a];c.a=n[c.a],c.b=n[c.b],c.c=n[c.c];let h=[c.a,c.b,c.c];for(let u=0;u<3;u++)if(h[u]===h[(u+1)%3]){s.push(a);break}}for(let a=s.length-1;a>=0;a--){let l=s[a];this.faces.splice(l,1);for(let c=0,h=this.faceVertexUvs.length;c<h;c++)this.faceVertexUvs[c].splice(l,1)}let o=this.vertices.length-i.length;return this.vertices=i,o}setFromPoints(e){this.vertices=[];for(let t=0,i=e.length;t<i;t++){let n=e[t];this.vertices.push(new I(n.x,n.y,n.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let a=0;a<t;a++)e[a]._id=a;function i(a,l){return a.materialIndex-l.materialIndex}e.sort(i);let n=this.faceVertexUvs[0],r=this.faceVertexUvs[1],s,o;n&&n.length===t&&(s=[]),r&&r.length===t&&(o=[]);for(let a=0;a<t;a++){let l=e[a]._id;s&&s.push(n[l]),o&&o.push(r[l])}s&&(this.faceVertexUvs[0]=s),o&&(this.faceVertexUvs[1]=o)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let f=this.parameters;for(let p in f)f[p]!==void 0&&(e[p]=f[p]);return e}let t=[];for(let f=0;f<this.vertices.length;f++){let p=this.vertices[f];t.push(p.x,p.y,p.z)}let i=[],n=[],r={},s=[],o={},a=[],l={};for(let f=0;f<this.faces.length;f++){let p=this.faces[f],g=!0,m=!1,v=this.faceVertexUvs[0][f]!==void 0,x=p.normal.length()>0,w=p.vertexNormals.length>0,b=p.color.r!==1||p.color.g!==1||p.color.b!==1,M=p.vertexColors.length>0,A=0;if(A=c(A,0,0),A=c(A,1,g),A=c(A,2,m),A=c(A,3,v),A=c(A,4,x),A=c(A,5,w),A=c(A,6,b),A=c(A,7,M),i.push(A),i.push(p.a,p.b,p.c),i.push(p.materialIndex),v){let T=this.faceVertexUvs[0][f];i.push(d(T[0]),d(T[1]),d(T[2]))}if(x&&i.push(h(p.normal)),w){let T=p.vertexNormals;i.push(h(T[0]),h(T[1]),h(T[2]))}if(b&&i.push(u(p.color)),M){let T=p.vertexColors;i.push(u(T[0]),u(T[1]),u(T[2]))}}function c(f,p,g){return g?f|1<<p:f&~(1<<p)}function h(f){let p=f.x.toString()+f.y.toString()+f.z.toString();return r[p]!==void 0||(r[p]=n.length/3,n.push(f.x,f.y,f.z)),r[p]}function u(f){let p=f.r.toString()+f.g.toString()+f.b.toString();return o[p]!==void 0||(o[p]=s.length,s.push(f.getHex())),o[p]}function d(f){let p=f.x.toString()+f.y.toString();return l[p]!==void 0||(l[p]=a.length/2,a.push(f.x,f.y)),l[p]}return e.data={},e.data.vertices=t,e.data.normals=n,s.length>0&&(e.data.colors=s),a.length>0&&(e.data.uvs=[a]),e.data.faces=i,e}clone(){return new WS().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let u=0,d=t.length;u<d;u++)this.vertices.push(t[u].clone());let i=e.colors;for(let u=0,d=i.length;u<d;u++)this.colors.push(i[u].clone());let n=e.faces;for(let u=0,d=n.length;u<d;u++)this.faces.push(n[u].clone());for(let u=0,d=e.faceVertexUvs.length;u<d;u++){let f=e.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,g=f.length;p<g;p++){let m=f[p],v=[];for(let x=0,w=m.length;x<w;x++){let b=m[x];v.push(b.clone())}this.faceVertexUvs[u].push(v)}}let r=e.morphTargets;for(let u=0,d=r.length;u<d;u++){let f={};if(f.name=r[u].name,r[u].vertices!==void 0){f.vertices=[];for(let p=0,g=r[u].vertices.length;p<g;p++)f.vertices.push(r[u].vertices[p].clone())}if(r[u].normals!==void 0){f.normals=[];for(let p=0,g=r[u].normals.length;p<g;p++)f.normals.push(r[u].normals[p].clone())}this.morphTargets.push(f)}let s=e.morphNormals;for(let u=0,d=s.length;u<d;u++){let f={};if(s[u].vertexNormals!==void 0){f.vertexNormals=[];for(let p=0,g=s[u].vertexNormals.length;p<g;p++){let m=s[u].vertexNormals[p],v={};v.a=m.a.clone(),v.b=m.b.clone(),v.c=m.c.clone(),f.vertexNormals.push(v)}}if(s[u].faceNormals!==void 0){f.faceNormals=[];for(let p=0,g=s[u].faceNormals.length;p<g;p++)f.faceNormals.push(s[u].faceNormals[p].clone())}this.morphNormals.push(f)}let o=e.skinWeights;for(let u=0,d=o.length;u<d;u++)this.skinWeights.push(o[u].clone());let a=e.skinIndices;for(let u=0,d=a.length;u<d;u++)this.skinIndices.push(a[u].clone());let l=e.lineDistances;for(let u=0,d=l.length;u<d;u++)this.lineDistances.push(l[u]);let c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());let h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new rBe().fromGeometry(this),t=new Ot,i=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",Sb.call(new zt(i,3),e.vertices)),e.normals.length>0){let n=new Float32Array(e.normals.length*3);t.setAttribute("normal",Sb.call(new zt(n,3),e.normals))}if(e.colors.length>0){let n=new Float32Array(e.colors.length*3);t.setAttribute("color",e6.call(new zt(n,3),e.colors))}if(e.uvs.length>0){let n=new Float32Array(e.uvs.length*2);t.setAttribute("uv",t6.call(new zt(n,2),e.uvs))}if(e.uvs2.length>0){let n=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",t6.call(new zt(n,2),e.uvs2))}t.groups=e.groups;for(let n in e.morphTargets){let r=[],s=e.morphTargets[n];for(let o=0,a=s.length;o<a;o++){let l=s[o],c=new gt(l.data.length*3,3);c.name=l.name,r.push(Sb.call(c,l.data))}t.morphAttributes[n]=r}if(e.skinIndices.length>0){let n=new gt(e.skinIndices.length*4,4);t.setAttribute("skinIndex",i6.call(n,e.skinIndices))}if(e.skinWeights.length>0){let n=new gt(e.skinWeights.length*4,4);t.setAttribute("skinWeight",i6.call(n,e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new Ot,i=e.geometry;if(e.isPoints||e.isLine){let n=new gt(i.vertices.length*3,3),r=new gt(i.colors.length*3,3);if(t.setAttribute("position",Sb.call(n,i.vertices)),t.setAttribute("color",e6.call(r,i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){let s=new gt(i.lineDistances.length,1);t.setAttribute("lineDistance",sBe.call(s,i.lineDistances))}i.boundingSphere!==null&&(t.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(t.boundingBox=i.boundingBox.clone())}else e.isMesh&&(t=i.toBufferGeometry());return t}};WS.prototype.isGeometry=!0;var rBe=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],i,n,r,s=e.faces;for(n=0;n<s.length;n++){let o=s[n];o.materialIndex!==r&&(r=o.materialIndex,i!==void 0&&(i.count=n*3-i.start,t.push(i)),i={start:n*3,materialIndex:r})}i!==void 0&&(i.count=n*3-i.start,t.push(i)),this.groups=t}fromGeometry(e){let t=e.faces,i=e.vertices,n=e.faceVertexUvs,r=n[0]&&n[0].length>0,s=n[1]&&n[1].length>0,o=e.morphTargets,a=o.length,l;if(a>0){l=[];for(let m=0;m<a;m++)l[m]={name:o[m].name,data:[]};this.morphTargets.position=l}let c=e.morphNormals,h=c.length,u;if(h>0){u=[];for(let m=0;m<h;m++)u[m]={name:c[m].name,data:[]};this.morphTargets.normal=u}let d=e.skinIndices,f=e.skinWeights,p=d.length===i.length,g=f.length===i.length;i.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let m=0;m<t.length;m++){let v=t[m];this.vertices.push(i[v.a],i[v.b],i[v.c]);let x=v.vertexNormals;if(x.length===3)this.normals.push(x[0],x[1],x[2]);else{let b=v.normal;this.normals.push(b,b,b)}let w=v.vertexColors;if(w.length===3)this.colors.push(w[0],w[1],w[2]);else{let b=v.color;this.colors.push(b,b,b)}if(r===!0){let b=n[0][m];b!==void 0?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new ge,new ge,new ge))}if(s===!0){let b=n[1][m];b!==void 0?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",m),this.uvs2.push(new ge,new ge,new ge))}for(let b=0;b<a;b++){let M=o[b].vertices;l[b].data.push(M[v.a],M[v.b],M[v.c])}for(let b=0;b<h;b++){let M=c[b].vertexNormals[m];u[b].data.push(M.a,M.b,M.c)}p&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},KB=class{constructor(e,t,i,n,r,s=0){this.a=e,this.b=t,this.c=i,this.normal=n&&n.isVector3?n:new I,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new Pt,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function sBe(e){return this.array.set(e),this}function e6(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),s=new Pt),t[i++]=s.r,t[i++]=s.g,t[i++]=s.b}return this}function t6(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),s=new ge),t[i++]=s.x,t[i++]=s.y}return this}function Sb(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),s=new I),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z}return this}function i6(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),s=new Kt),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z,t[i++]=s.w}return this}var oBe=["a","b","c"];function aBe(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function lP(e,t,i){let n=Math.min(e,t),r=Math.max(e,t),s=n+"_"+r;return i.get(s)}function cP(e,t,i,n,r,s){let o=Math.min(e,t),a=Math.max(e,t),l=o+"_"+a,c;if(n.has(l))c=n.get(l);else{let h=i[o],u=i[a];c={a:h,b:u,newEdge:null,faces:[]},n.set(l,c)}c.faces.push(r),s[e].edges.push(c),s[t].edges.push(c)}function lBe(e,t,i,n){let r,s,o;for(r=0,s=e.length;r<s;r++)i[r]={edges:[]};for(r=0,s=t.length;r<s;r++)o=t[r],cP(o.a,o.b,e,n,o,i),cP(o.b,o.c,e,n,o,i),cP(o.c,o.a,e,n,o,i)}function Mb(e,t,i,n,r){e.push(new KB(t,i,n,void 0,void 0,r))}function $p(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function Eb(e,t,i,n){e.push([t.clone(),i.clone(),n.clone()])}var cBe=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof Ot?e=new WS().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new I,i,n,r,s,o,a=e.vertices,l=e.faces,c=e.faceVertexUvs[0],h=c!==void 0&&c.length>0,u=[],d=new Map;lBe(a,l,u,d);let f=[],p,g,m,v,x,w,b;for(let ve of Array.from(d.keys())){for(g=d.get(ve),m=new I,x=3/8,w=1/8,b=g.faces.length,b!=2&&(x=.5,w=0,b!=1),m.addVectors(g.a,g.b).multiplyScalar(x),t.set(0,0,0),s=0;s<b;s++){for(v=g.faces[s],o=0;o<3&&(p=a[aBe(v,oBe[o])],!(p!==g.a&&p!==g.b));o++);p&&t.add(p)}t.multiplyScalar(w),m.add(t),g.newEdge=f.length,f.push(m)}let M,A,T,S,C,P,B,k=[];for(n=0,r=a.length;n<r;n++){for(P=a[n],C=u[n].edges,i=C.length,i==3?M=3/16:i>3&&(M=3/(8*i)),A=1-i*Number(M),T=M,i<=2&&(i==2?(A=3/4,T=1/8):i==1||i==0),B=P.clone().multiplyScalar(A),t.set(0,0,0),s=0;s<i;s++)S=C[s],p=S.a!==P?S.a:S.b,t.add(p);t.multiplyScalar(Number(T)),B.add(t),k.push(B)}let z=k.concat(f),F=k.length,W,K,Z,U=[],X=[],V,q,H,Q,J=new ge,le=new ge,j=new ge;for(n=0,r=l.length;n<r;n++)v=l[n],W=Number(lP(v.a,v.b,d).newEdge)+F,K=Number(lP(v.b,v.c,d).newEdge)+F,Z=Number(lP(v.c,v.a,d).newEdge)+F,Mb(U,W,K,Z,v.materialIndex),Mb(U,v.a,W,Z,v.materialIndex),Mb(U,v.b,K,W,v.materialIndex),Mb(U,v.c,Z,K,v.materialIndex),h&&(V=c[n],q=V[0],H=V[1],Q=V[2],J.set($p(q.x,H.x),$p(q.y,H.y)),le.set($p(H.x,Q.x),$p(H.y,Q.y)),j.set($p(q.x,Q.x),$p(q.y,Q.y)),Eb(X,J,le,j),Eb(X,q,J,j),Eb(X,H,le,J),Eb(X,Q,j,le));e.vertices=z,e.faces=U,h&&(e.faceVertexUvs[0]=X)}},Yn=new I,uBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=e.geometry??(t==null?void 0:t.geometry)??new Ot().copy(new Jl(100,100,100)),n;t===void 0?(i.computeBoundingBox(),i.boundingBox.getSize(Yn),n={width:Yn.x,height:Yn.y,depth:Yn.z,subdivisions:0}):n=t.parameters;let r={...n,...e.parameters};return{parameters:{width:Math.abs(r.width),height:Math.abs(r.height),depth:Math.abs(r.depth),subdivisions:Math.abs(r.subdivisions)},geometry:i}}static build(e){let{width:t,height:i,depth:n,subdivisions:r}=e.parameters,s=e.geometry??new Ot().copy(new Jl(100,100,100)),o=s.userData.parameters;o===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(Yn)):Yn.set(o.width,o.height,o.depth),(t!==Yn.x||i!==Yn.y||n!==Yn.z)&&s.scale(Yn.x===0?1:t/Yn.x,Yn.y===0?1:i/Yn.y,Yn.z===0?1:n/Yn.z);let a=s.originalGeometry;try{r>0?(a===void 0||(o==null?void 0:o.subdivisions)!==r)&&(a===void 0&&(a=s),s=new cBe(r).modify(a).toBufferGeometry()):(a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return a!==void 0&&Object.assign(s,{originalGeometry:a}),delete e.geometry,Object.assign(s,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,i){new zq(i).load(e,n=>{let r=this.normalizeInputs({geometry:n});n.boundingBox.getSize(Yn);let s=100/Yn.x;Object.assign(r.parameters,{width:100,height:Yn.y*s,depth:Yn.z*s}),t(this.build(r))})}},DJ=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof yn?e.shape:new yn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,spikes:n,cornerRadius:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}=e.parameters,l=e.shape,c=t*.5,h=i*.5,u=0,d=0,f=2*Math.PI/n;for(let g=0;g<n;g++){let m=f*g,v=u+Math.sin(m)*c,x=d+Math.cos(m)*h;l.addPoint(l.createPoint(v,x))}l.isClosed=!0;for(let g=0,m=l.points.length;g<m;g++)l.points[g].roundness=r;l.roundness=r,l.update();let p=tp.create({shape:l,parameters:{roundness:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}});return Object.assign(p,{userData:{...e,type:"PolygonGeometry"}})}},hBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:n,radialSegments:r,heightSegments:s,openEnded:o,cornerRadius:a,cornerSegments:l}=e.parameters,c=new fBe(t*.5,i,r,s,o,a,l);return c.scale(1,1,n/t),Object.assign(c,{userData:{...e,type:"PyramidGeometry"}})}};function P0(e,t,i){i.x=e.x*t.x,i.y=e.y,i.z=e.x*t.y}function uP(e,t,i,n,r,s){let o=t.clone().sub(e),a=i.clone().sub(e),l=o.angleTo(a);if(o.normalize(),a.normalize(),n===r){let c=o.add(a).normalize();s.copy(e).addScaledVector(c,n/Math.sin(l/2))}else{let c=o.angleTo(a);s.copy(e),s.addScaledVector(o,r/Math.sin(c)),s.addScaledVector(a,n/Math.sin(c))}}function dBe(e,t,i){let n=e.clone().sub(t),r=i.clone().sub(t);return n.projectOnVector(r),n.add(t)}var fBe=class extends Ot{constructor(e=.5,t=1,i=4,n=1,r=!1,s=0,o=4){super(),i=Math.floor(Math.max(3,i)),n=Math.floor(n),o=Math.floor(o);let a=[],l=[],c=[],h=[],u=0,d=t/2,f=Math.PI/i,p=e*Math.cos(Math.PI/i),g=2*Math.PI/i,m=(i-2)*Math.PI/i,v=Math.PI-m,x=new I(0,-d,0),w=new I(0,d,0),b=new ge(e,-d),M=new ge(p,-d),A=new ge(0,w.y).sub(M),T=new ge(0,w.y).sub(b),S=new ge(A.y,-A.x).normalize(),C=new ge(T.y,-T.x).normalize(),P=e*Math.cos(Math.PI/i)*Math.tan((Math.PI-A.angle())/2)-1e-8;s=Math.min(s,P);let B;{let Z=new I(S.x,S.y,0),U=new I(Math.cos(g)*Z.x,Z.y,Math.sin(g)*Z.x);B=Z.angleTo(U)}let k=s/Math.tan((Math.PI-A.angle())/2),z=s/Math.tan((Math.PI-B)/2),F=new I;if(!r){l.push(x.x,x.y,x.z),c.push(0,-1,0),h.push(0,0);let Z=u++,U=[],X=b.clone(),V=k/Math.cos(Math.PI/i);X.x-=V;for(let q=0;q<i;q++){let H=q/i*Math.PI*2+f,Q=new ge(Math.sin(H),Math.cos(H));P0(X,Q,F),l.push(F.x,F.y,F.z),c.push(0,-1,0),h.push(0,0),U.push(u++)}for(let q=0;q<U.length;q++)a.push(U[q],Z,U[(q+1)%U.length])}{let Z=new I,U=new I,X=new I,V=new I,q=new I,H=new I;for(let Q=0;Q<i;Q++){let J=Q/i*Math.PI*2+f,le=(Q+.5)/i*Math.PI*2+f,j=(Q+1)/i*Math.PI*2+f,ve=new ge(Math.sin(J),Math.cos(J)),pe=new ge(Math.sin(le),Math.cos(le)),me=new ge(Math.sin(j),Math.cos(j));P0(b,ve,U),P0(b,me,X),P0(S,pe,Z),uP(w,U,X,z,z,V),l.push(V.x,V.y,V.z),uP(U,w,X,z,k,q),l.push(q.x,q.y,q.z),uP(X,U,w,k,z,H),l.push(H.x,H.y,H.z),c.push(Z.x,Z.y,Z.z),c.push(Z.x,Z.y,Z.z),c.push(Z.x,Z.y,Z.z),h.push(0,0),h.push(0,0),h.push(0,0);let de=u++,Se=u++,ce=u++;if(a.push(de,Se,ce),s>0){{let Ee=U.clone().add(X).multiplyScalar(.5),Le=w.clone().sub(Ee).normalize(),ze=x.clone().sub(Ee).normalize().add(Le).normalize().multiplyScalar(-1),Oe=H.clone().sub(q);W(Ee,Oe,ze,A.angle())}let se,be;{let Ee=new I;P0(C,me,Ee);let Le=H.clone().add(V).multiplyScalar(.5);Le=dBe(Le,X,w);let ze=H.clone().sub(V);[se,be]=W(Le,ze,Ee,B,V.y)}{let Ee=se,Le=Ee.clone().setY(0).normalize(),ze=new I(0,-1,0),Oe=Le.clone().cross(ze);K(Ee,Le,ze,Oe)}{let Ee=A.angle(),Le=Math.PI-Ee,ze=w.clone();ze.y-=s/Math.sin(Ee-Math.PI/2);let Oe=new I,Ge=[];for(let ot=0;ot<o;ot++){let N=[],R=Math.PI/2-Le*ot/o,ie=Math.cos(R),xe=Math.sin(R),Me=le;for(let Te=0;Te<=ot;Te++){let qe=Math.cos(Me),De=Math.sin(Me);Z.x=ie*De,Z.y=xe,Z.z=ie*qe,Oe.copy(ze).addScaledVector(Z,s),l.push(Oe.x,Oe.y,Oe.z),c.push(Z.x,Z.y,Z.z),h.push(0,0),N.push(u++),Me+=Math.PI*2/ot/i}Ge.push(N)}be.reverse(),Ge.push(be);let tt=Ge.length-1;for(let ot=0;ot<tt;ot++){let N=Ge[ot],R=Ge[ot+1],ie=N.length-1;a.push(R[1],N[0],R[0]);for(let xe=1;xe<=ie;xe++)a.push(N[xe],N[xe-1],R[xe]),a.push(R[xe+1],N[xe],R[xe])}}}}}this.setIndex(a),this.setAttribute("position",new gt(l,3)),this.setAttribute("normal",new gt(c,3)),this.setAttribute("uv",new gt(h,2));function W(Z,U,X,V,q){let H=-V/2,Q=(Math.PI-V)/2,J=U.clone().normalize().cross(X);Z.addScaledVector(X,-s/Math.sin(Q));let le=new I,j=new I,ve=1,pe=u,me=[];for(let de=0;de<=o;de++){let Se=H+de/o*V;j.set(0,0,0),j.addScaledVector(J,Math.sin(Se)),j.addScaledVector(X,Math.cos(Se));for(let ce=0;ce<=ve;ce++){let se=ce/ve-.5;if(le.copy(Z),le.addScaledVector(U,se),le.addScaledVector(j,s),q!=null){let be=Math.max(0,le.y-q);le.addScaledVector(U,-be/U.y)}l.push(le.x,le.y,le.z),c.push(j.x,j.y,j.z),h.push(0,0),ce===0&&me.push(u),u++}}for(let de=0;de<o;de++)for(let Se=0;Se<ve;Se++){let ce=pe+Se+(ve+1)*de,se=ce+(ve+1),be=se+1,Ee=ce+1;a.push(ce,se,Ee),a.push(se,be,Ee)}return[Z.clone().addScaledVector(U,.5),me]}function K(Z,U,X,V){let q=Math.PI/2,H=T.angle()-q,Q=[],J=new I,le=new I;for(let ve=0;ve<=o;ve++){let pe=[],me=ve/o;for(let de=0;de<=ve;de++){let Se=((ve?de/ve:0)-.5)*v,ce=Math.cos(Se),se=Math.sin(Se),be=Math.atan(Math.tan(H)*ce),Ee=(q+be)*me,Le=Math.cos(Ee),ze=Math.sin(Ee);J.set(0,0,0),J.addScaledVector(U,ze*ce),J.addScaledVector(X,Le),J.addScaledVector(V,ze*se),le.copy(Z).addScaledVector(J,s),l.push(le.x,le.y,le.z),c.push(J.x,J.y,J.z),h.push(0,0),pe.push(u++)}Q.push(pe)}let j=Q.length-1;for(let ve=0;ve<j;ve++){let pe=Q[ve],me=Q[ve+1],de=pe.length-1;a.push(pe[0],me[1],me[0]);for(let Se=1;Se<=de;Se++)a.push(pe[Se-1],pe[Se],me[Se]),a.push(pe[Se],me[Se+1],me[Se])}}}},BJ=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),n=Object.assign((t==null?void 0:t.ui)??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof yn?e.shape:new yn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)}),ui:n}}static build(e){let t=e.shape,{width:i,height:n,cornerRadius:r,cornerType:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=e.parameters,c={x:i*.5,y:n*.5},h={x:-c.x,y:-c.y},u={x:c.x,y:c.y};function d(b,M,A){return M>i&&A>n?Math.min(b*i/M,b*n/A):M>i?b*i/M:A>n?b*n/A:b}let f=[];f[0]=r[0]===0?0:d(r[0],r[0]+r[3],r[0]+r[1]),f[1]=r[1]===0?0:d(r[1],r[1]+r[2],r[1]+r[0]),f[2]=r[2]===0?0:d(r[2],r[2]+r[1],r[2]+r[3]),f[3]=r[3]===0?0:d(r[3],r[3]+r[0],r[3]+r[2]);let p=h.x,g=u.x,m=u.y,v=h.y;t.addPoint(t.createPoint(p,m)),t.addPoint(t.createPoint(g,m)),t.addPoint(t.createPoint(g,v)),t.addPoint(t.createPoint(p,v)),t.isClosed=!0;let x=!0;for(let b=0,M=t.points.length;b<M;b++)t.points[b].roundness=f[b],b>0&&f[b]!==f[b-1]&&(x=!1);x&&(t.roundness=f[0]),t.useCubicForRoundedCorners=s!==1,t.update();let w=tp.create({shape:t,parameters:{depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(w,{userData:{...e,type:"RectangleGeometry"}})}},pBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t=100,height:i=t,depth:n=t,widthSegments:r=64,heightSegments:s=64,phiStart:o,phiLength:a,thetaStart:l,thetaLength:c}=e.parameters,h=new cO(.5*t,r,s,o,a,l,c);return h.scale(1,i/t,n/t),Object.assign(h,{userData:{...e,type:"SphereGeometry"}})}},mBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:0})}}static build(e){let{width:t=100,height:i=t,widthSegments:n=8,heightSegments:r=8}=e.parameters,s=new XM(t,i,n,r);return s.scale(1,1,1),Object.assign(s,{userData:{...e,type:"PlaneGeometry"}})}},gBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:n,angle:r,cornerRadius:s,cornerSegments:o}=e.parameters,a=new vBe(t,i,n,r,s,o);return Object.assign(a,{userData:{...e,type:"BackdropGeometry"}})}},vBe=class extends Ot{constructor(e=1,t=1,i=1,n=90,r=10,s=24){super(),this.type="BackdropGeometry";let o=[],a=[],l=[],c=.001;r==0&&(s=1),s=Math.max(1,Math.floor(s)),r=Math.min(r,100),n=Math.min(180-c,n),n*=Math.PI/180;let h=[],u=Math.PI/2,d=(ve=0,pe=0,me=0)=>new I(ve,pe,me),f=d(),p=d(),[g,m,v]=[t/2,e/2,i/2],x=-m,w=+m,[b,M,A]=[d(x,-g,+v),d(x,-g,-v),d(x,+g,-v)],T=(ve,pe=!1)=>Math.sin(ve-Math.PI/(1+ +pe)),S=(ve,pe=!1)=>Math.cos(ve-Math.PI/(1+ +pe));A.y=Math.sin(n)*t-g;let C=Math.cos(n)*t-v,P=b.z-c;n<=u?(A.z=Math.min(C,P),A.z==P&&(A.y-=(C-P)/Math.tan(u-n))):M.z=Math.min(M.z-C-v,b.z-c),f.subVectors(b,M),p.subVectors(A,M);let B=Math.min(f.length(),p.length())*r/100,k=B*Math.tan(n/2),z=B/Math.cos(n/2),F=f.clone().normalize().add(p.normalize()).setLength(z).add(M);f.set(0,T(n,!0),S(n,!0)),h.push([A,f.clone()]);let W=(Math.PI-n)/s;for(let ve=0;ve<=s;ve++){let pe=u+n+ve*W;f.set(0,Math.sin(pe)*k,Math.cos(pe)*k),f.add(F),p.set(0,T(pe),S(pe)),h.push([f.clone(),p.clone()])}h.push([b,d(0,1,0)]);let K=Math.sin(W/2)*k*2,Z=h.length-1,U=h[0][0].distanceTo(h[1][0]),X=h[Z-1][0].distanceTo(h[Z][0]),V=U+K*s+X;h[0].push(1);for(let ve=0;ve<=s;ve++)h[ve+1].push(1-(U+ve*K)/V);h[Z].push(0);let[q,H,Q]=h[0],J,le,j;for(let ve=1;ve<h.length;ve++)[J,le,j]=h[ve],o.push(x,q.y,q.z,x,J.y,J.z,w,q.y,q.z,w,q.y,q.z,x,J.y,J.z,w,J.y,J.z),a.push(0,H.y,H.z,0,le.y,le.z,0,H.y,H.z,0,H.y,H.z,0,le.y,le.z,0,le.y,le.z),l.push(0,Q,0,j,1,Q,1,Q,0,j,1,j),[q,H,Q]=[J,le,j];this.setAttribute("position",new gt(o,3)),this.setAttribute("normal",new gt(a,3)),this.setAttribute("uv",new gt(l,2))}},LJ=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof yn?e.shape:new yn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,innerRadiusPercent:n,spikes:r,cornerRadius:s,angle:o,depth:a,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,h=e.shape,u=t*.5,d=i*.5,f=0,p=0,g=o*Math.PI/360/r,m=Math.PI/2*3*-1,v=u*n/100,x=d*n/100;if(r===3&&n===50){g=2*Math.PI/r;for(let b=0;b<r;b++){let M=g*b,A=f+Math.sin(M)*u,T=p+Math.cos(M)*d;h.addPoint(h.createPoint(A,T))}}else for(let b=0;b<r;b++){let M=f+Math.cos(m)*u,A=p+Math.sin(m)*d;h.addPoint(h.createPoint(M,A)),m+=g,M=f+Math.cos(m)*v,A=p+Math.sin(m)*x,h.addPoint(h.createPoint(M,A)),m+=g}h.isClosed=!0;for(let b=0,M=h.points.length;b<M;b++)h.points[b].roundness=s;h.roundness=s,h.update();let w=tp.create({shape:h,parameters:{roundness:s,depth:a,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(w,{userData:{...e,type:"StarGeometry"}})}},yBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i}=e.parameters,n=new XM(t,i);return Object.assign(n,{userData:{...e,type:"TextFrameGeometry"}})}},xBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:Math.PI*2,cornerRadius:30,cornerSegments:8},e.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.round(Math.abs(i.depth??i.width*.25));return{parameters:Object.assign(i,{width:n,height:r,depth:s})}}static build(e){let{width:t,height:i,depth:n,radialSegments:r,tubularSegments:s,arc:o,cornerRadius:a,cornerSegments:l}=e.parameters,c=wBe(t,i,n,t*.5,o,s,0,0,r,a,l);return c.scale(1,i/t,1),Object.assign(c,{userData:{...e,type:"TorusGeometry"}})}};function wBe(e,t,i,n,r,s,o,a,l,c,h){return[t,i]=[i,t],o=t/2,r/=2*Math.PI,r==1&&(c=0),new TJ(!0,e,t,i,n,r,s,o,a,l,c,h)}var _Be=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),tube:i.tube??i.width*.125})}}static build(e){let{width:t,tube:i,tubularSegments:n,radialSegments:r,p:s,q:o}=e.parameters,a=t*.5;a!==i&&(a-=i);let l=new Fq(a,i,n,r,s,o);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},bBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof yn?e.shape:new yn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width*(i.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t=100,height:i,cornerRadius:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,isRect:a}=e.parameters,l=e.shape,c=t*.5,h=i*.5;a?(l.addPoint(l.createPoint(-c,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))):(l.addPoint(l.createPoint(0,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))),l.isClosed=!0;for(let d=0,f=l.points.length;d<f;d++)l.points[d].roundness=n;l.roundness=n,l.update();let u=tp.create({shape:l,parameters:{roundness:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o}});return Object.assign(u,{userData:{...e,type:"TriangleGeometry"}})}};function ABe(e,t){let i=2*Math.PI;return(e%i+i)%i===(t%i+i)%i}function SBe(e,t,i){let n=[new I,new I,new I],r=[new I,new I,new I];return e.extractBasis(n[0],n[1],n[2]),t.extractBasis(r[0],r[1],r[2]),n.forEach((s,o)=>{let a=r[o],l=si.lerp(s.length(),a.length(),i);s.lerp(a,i).setLength(l)}),new Je().makeBasis(n[0],n[1],n[2])}var MBe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),o=(t==null?void 0:t.shapeData)??qO.create({parameters:iJ}).userData.shape;return{path:e.path??IS.defaultData(),parameters:Object.assign(i,{width:n,height:r,depth:s,extrusion:{...nJ,...i.extrusion}}),shapeData:o}}static build(e){if(e.path.points.length>=2){let t=new EBe(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}else return Object.assign(new Ot,{userData:{...e,type:"PathGeometry"}})}},EBe=class extends Ot{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&e.depth===1)||!ABe(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:i,offset:n}=this.inputs.parameters.extrusion,r=this.inputs.path.isClosed?e.length:e.length-1,s=Math.floor(n*r),o=this.inputs.path.isClosed?Math.ceil((i+n)*r):Math.ceil(Math.min(1,i+n)*r),a=Math.min(Math.max(2,o-s+1),r+2),l=[],c=[];for(let P=0;P<a;P++){let B=this.inputs.path.isClosed?(P+s)%e.length:Math.min(P+s,e.length-1);l.push(e[B].clone()),c.push(t[B].clone())}let h=(P,B,k)=>{l[P]=l[P].clone().lerp(l[B],k),c[P]=SBe(c[P],c[B],k)},u=0,d=n*r%1;(!this.inputs.path.isClosed||i<=1)&&(d||n===0)&&(u=d,h(0,1,u));let f=0,p=(n+i)*r%1;if((this.inputs.path.isClosed&&i<=1||!this.inputs.path.isClosed&&n+i<1)&&p&&(f=p,h(l.length-1,l.length-2,1-f)),i===0){let P=l.length-1;l[P].copy(l[0]),c[P].copy(c[0])}this._applyPathModifiers(c,u,f);let{regions:g,infos:m,vertices:v}=this._computeShapePoints(5),x=0,w=0;m.sort((P,B)=>P.start-B.start),m.forEach(P=>{P.verticesStart=x,P.verticesCount=P.continuous.reduce((B,k,z)=>B+(z===0||!k?2:1),0),w+=P.verticesCount,x=w});let b=w*a,M,A=0;if(this._isOpenEnded()){try{M=ph({windingRule:Ti.ODD,elementType:Un.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:g})}catch{M=wJ}A=M.vertexCount}let T=b+2*A,S={positions:new Float32Array(T*3),normals:new Float32Array(T*3),uvs:new Float32Array(T*2)},C=[];m.forEach(P=>{this._extrudeRegion(P,v,c,l,S,C,this._isGeometryClosed()&&!this._isOpenEnded())}),M&&(this._closeEnd(M,b,C,S,c[0],l[0],!1),this._closeEnd(M,b+A,C,S,c[c.length-1],l[l.length-1],!0)),this.setAttribute("position",new zt(S.positions,3)),this.setAttribute("normal",new zt(S.normals,3)),this.setAttribute("uv",new zt(S.uvs,2)),this.setIndex(C)}_extractPathPoints(){let e=uJ(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(i=>{t[t.length-1].distanceToSquared(i)>.001&&t.push(i)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],i=e.length,n=this.inputs.path.isClosed,r=new I,s=new I,o=new I,a=new I,l=new I(0,1,0);for(let p=0;p<i;p++){let g=e[p],m;p===0?m=n?e[e.length-2]:g.clone().multiplyScalar(2).sub(e[1]):m=e[p-1];let v;p===i-1?v=n?e[1]:g.clone().multiplyScalar(2).sub(e[p-1]):v=e[p+1];let x=g.clone().sub(m).normalize(),w=v.clone().sub(g).normalize(),b=x.clone().add(w).normalize();o.copy(b),p===0&&(b.equals(l)||b.clone().negate().equals(l))&&l.set(0,0,1);let M=l.clone().cross(b).normalize(),A=b.clone().cross(M).normalize();l.copy(A),a.copy(M),p===0&&(r.copy(A),s.copy(b));let T=new Je().makeBasis(M,A,b);t.push(T)}let c=n?s:o,h=n?r:new I(0,1,0),u=c.clone().cross(a).normalize(),d=Math.acos(h.dot(u));if(isNaN(d))return t;let f=h.clone().cross(u);c.dot(f)>0&&(d*=-1);for(let p=1;p<t.length;p++){let g=new Je().makeRotationZ(d*p/t.length);t[p].multiply(g)}return t}_applyPathModifiers(e,t,i){let n=e.length,{angle:r,twist:s,startScale:o,endScale:a}=this.inputs.parameters.extrusion,l=new Je,c=new Je;return e.forEach((h,u)=>{let d=u===0?0:u===n-1?1:(u-t)/(n-(i===0?0:1)-(t+(1-i)));l.makeRotationZ(si.lerp(r,r+s,d));let f=si.lerp(o,a,d);c.makeScale(f,f,f),h.multiply(l).multiply(c)}),e}_computeShapePoints(e=12,t=Ti.ODD){let i=this.inputs.shapeData,n=i.extractShapePointsToFlatArray([],e),r=i.shapeHoles.map(c=>{let h=c.extractShapePointsToFlatArray([],e),u=[];for(let d=h.length-1;d>=1;d-=2){let f=h[d-1],p=h[d-0];u.push(f,p)}return u}),s;try{s=ph({windingRule:t,elementType:Un.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[n]})}catch{s=YO}let o;try{o=ph({windingRule:Ti.ODD,elementType:Un.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...r]})}catch{o=xJ}if(!s)throw new Error("error generating geometry");let a=s.elementCount;if(o){s.elementCount+=o.elementCount;for(let c=0;c<o.elements.length;c++){let h=o.elements[c],u=c%2===0?s.vertexCount:0;s.elements.push(h+u)}for(let c=0;c<o.vertexIndices.length;c++){let h=o.vertexIndices[c],u=s.vertexCount;s.vertexIndices.push(h+u)}for(let c=0;c<o.vertices.length;c++){let h=o.vertices[c];s.vertices.push(h)}}for(let c=0,h=s.vertexCount;c<h;c++){let u=c*2;s.vertices[u+0],s.vertices[u+1]}let l=[];for(let c=s.elementCount-1;c>=0;c--){let h=c>=a,u=c*2,d=s.elements[u+0],f=s.elements[u+1],p=d+f,g={start:d,count:f,normals:[],isHole:h,continuous:[],verticesStart:0,verticesCount:0};l.push(g);let m=d,v=p-1,x=d+1,w=i.roundedCurves.length;do{let b=m-d;s.vertices[v*2+0],s.vertices[v*2+1];let M=s.vertices[m*2+0],A=s.vertices[m*2+1],T=s.vertices[x*2+0],S=s.vertices[x*2+1],C=M-T,P=A-S,B=Math.sqrt(C*C+P*P);C/=B,P/=B,g.normals[b*2+0]=-P,g.normals[b*2+1]=C;let k=s.vertexIndices[m];if(Array.isArray(k))g.continuous[b]=!1;else{let[z,F]=i.getCurveIndexFromVertexId(k-1,!0);if(F>0&&F<1)g.continuous[b]=!0;else{let W=F===1?z+1:z-1;W=(W+w)%w;let K=F===1?0:1,Z=i.roundedCurves[z].getTangent(F),U=i.roundedCurves[W].getTangent(K);g.continuous[b]=Z.dot(U)>.95}}h&&(g.normals[b*2+0]*=-1,g.normals[b*2+1]*=-1),[v,m,x]=[m,x,x+1],x>=p&&(x-=f)}while(x!==d+1)}return{regions:[n,...r],infos:l,vertices:s.vertices}}_insertVertex(e,t,i,n,r){let s=t*2,o=t*3;e.positions[o+0]=i.x,e.positions[o+1]=i.y,e.positions[o+2]=i.z,e.normals[o+0]=n.x,e.normals[o+1]=n.y,e.normals[o+2]=n.z,e.uvs[s+0]=r.x,e.uvs[s+1]=r.y}_extrudeRegion(e,t,i,n,r,s,o){let a=new I,l=new I,c=new I,h=new I,u=new ge;i.forEach((f,p)=>{let g=n[p],m=e.verticesStart*i.length+e.verticesCount*p;for(let v=0;v<e.count;v++){let x=(e.start+v)*2;if(a.set(t[x+0],t[x+1],0),c.copy(a).applyMatrix4(f).add(g),e.continuous[v])h.set(e.normals[v*2+0],e.normals[v*2+1],0);else{let w=v==0?(e.start+e.count-1)*2:x-2;l.set(t[w+0],t[w+1],0),h.copy(a).sub(l),h.set(-h.y,h.x,0),e.isHole||h.negate()}if(h.applyMatrix4(f).normalize(),u.set(v===0?1:v/e.count,p/(i.length-1)),this._insertVertex(r,m,c,h,u),m++,!e.continuous[v]||v===0){if(v===0)h.set(e.normals[v*2+0],e.normals[v*2+1],0),u.set(0,p/(i.length-1));else{let w=v===e.count-1?e.start*2:x+2;l.set(t[w+0],t[w+1],0),h.copy(l).sub(a),h.set(-h.y,h.x,0),e.isHole||h.negate()}h.applyMatrix4(f).normalize(),this._insertVertex(r,m,c,h,u),m++}}});let d=i.length-1;for(let f=0;f<d;f++){let p=e.verticesStart*i.length+e.verticesCount*f,g=e.verticesStart*i.length+e.verticesCount*(f+1),m=0;for(let v=0;v<e.count;v++){(!e.continuous[v]||v===0)&&m++;let x=v===e.count-1?0:m+1,w=p+m,b=p+x,M=g+x,A=g+m;e.isHole?s.push(w,M,b,w,A,M):s.push(w,b,M,w,M,A),m++}}}_closeEnd(e,t,i,n,r,s,o){let a=e.vertexCount,l=new I(0,0,o?-1:1).applyMatrix4(r),c=new I,h=new ge;for(let d=0;d<a;d++){let f=2*d;c.set(e.vertices[f+0],e.vertices[f+1],0).applyMatrix4(r).add(s),this._insertVertex(n,t+d,c,l,h)}let u=e.elements;for(let d=0;d<e.elementCount;d++){let f=3*d,p=u[f+0]+t,g=u[f+(o?1:2)]+t,m=u[f+(o?2:1)]+t;i.push(p,g,m)}}};function RJ(){let e=new Ot;return e.setAttribute("position",new zt(new Float32Array([]),3)),e.setIndex(new zt(new Uint16Array([]),1)),e}var CBe=RJ().attributes,TBe=12,PBe=1,IJ=class extends Ot{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,CBe),this.userData={parameters:e,type:"TextGeometry"};let i=t.getFont(e.font);i!=null&&i.isLoaded?(this.font=i,this.update(e)):this.updateFont(e.font,t).then(()=>{this.update(e),t==null||t.requestRender()})}async updateFont(e,t){let i=t.getFont(e);i&&(this.font=i,await i.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!(t!=null&&t.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:i,height:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,text:a,textTransform:l}=e,c=l===2?a.toUpperCase():l===3?a.toLowerCase():a,h=DBe(e,t,c),{shapes:u,charWidths:d,charCoords:f}=t.generateShapes(h,e),p=i*.5,g=n*.5,m=u.map(w=>new yn().fromShape(w));this.vectorShapes=m;let v=m.map(w=>tp.create({shape:w,parameters:{depth:r,extrudeBevelSegments:o,extrudeBevelSize:s,windingRule:r<=0?Ti.NONZERO:Ti.ODD,subdivisions:this.isLowResolution&&r>0?PBe:TBe}})),x=v.length?af(v):RJ();x.translate(-p,g,0),this.dispose(),this.wrappedText=h,this.charCoords=f,this.charWidths=d,this.deleteAttribute("extrudeNormal"),Object.entries(x.attributes).forEach(([w,b])=>{this.setAttribute(w,b)}),this.setIndex(x.index),this.computeBoundingSphere()}clone(){let e=Uf(new Ot,IJ.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach(([t,i])=>{this.setAttribute(t,i)}),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:e})}get text(){return this.userData.parameters.text??""}};function DBe(e,t,i){i=i??e.text;let n=[""],r="";for(let s of i)r+=s,s===" "||s===`
`?(n[n.length-1]+=r,r="",s===`
`&&n.push("")):t.getTextWidth(n[n.length-1]+r,e)>e.width&&(n[n.length-1].length&&n.push(""),t.getTextWidth(n[n.length-1]+r,e)>e.width&&(r.length===1?(n[n.length-1]+=r,r=""):(n[n.length-1]+=r.slice(0,-1),r=r[r.length-1],n.push(""))));return n[n.length-1]+=r,n}var OJ,QO=new Promise(e=>{OJ=e}),n6=!1;async function BBe(){if(n6)return;let e="https://unpkg.com/@splinetool/modelling-wasm@0.9.366/build",[t,i]=await Promise.all([y1(()=>import("./process-10f79362.js"),[]),fetch(`${e}/process.wasm`).then(s=>s.arrayBuffer())]),n=t.default,r=await n({wasmBinary:i});OJ(r),n6=!0}function XS(e,t,i){let n={parameters:e,type:e.type};if(e.type==="PathGeometry")n.path=e.path;else if(e.type==="VectorGeometry"){let s=yn.createFromState(e.shape,e.width,e.height);n.shape=s}else if(e.type==="NonParametricGeometry")e.data.groups&&e.data.groups.forEach(s=>s.materialIndex=Math.max(s.materialIndex??0,0)),n.geometry=new zq().parse(e);else{if(e.type==="SubdivGeometry")return new cs(e,i);if(e.type==="TextGeometry")return new IJ(e,t)}let r;try{r=c6(n)}catch(s){console.error(s)}if(!r){let s=yn.createFromState(RS.defaultData(),100,100);n.shape=s,r=c6(n)}return r}var LBe=new Je;function ZB(e,t,i,n){let r=e.position.array,s=e.normal.array,o=LBe.makeScale(t,i,n).invert().elements,a,l,c;for(var h=0,u=r.length;h<u;h+=3)r[h]*=t,r[h+1]*=i,r[h+2]*=n,a=s[h],l=s[h+1],c=s[h+2],s[h]=o[0]*a+o[4]*l+o[8]*c,s[h+1]=o[1]*a+o[5]*l+o[9]*c,s[h+2]=o[2]*a+o[6]*l+o[10]*c;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var Cb=new Vn,em=new I,Ct;QO.then(e=>{Ct=e});var r6=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),s6=new Uint32Array([0,1,2,3]),o6=new Uint8Array([4]),cs=class extends Ot{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let i=this.data.scaleBaked,n=Sf.div(t,i);this.subdividedGeometry&&ZB(this.subdividedGeometry.attributes,...n),this.originalGeometry&&ZB(this.originalGeometry.attributes,...n),this.data=e;let r=this.userData.parameters;this.userData.parameters={width:r.width*n[0],height:r.height*n[1],depth:r.depth*n[2]},this.originalGeometry.boundingSphere.center.multiply(em.fromArray(n));let s=em.set(r.width,r.height,r.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,i;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:i}=cs.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new Jl(100,100,100),i=0}this.subdivPointer=i,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let n=this.subdividedGeometry??this.originalGeometry;Object.assign(this,n),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(cs.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new ua,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,i=e.boundingSphere.center;Cb.setFromBufferAttribute(t),Cb.getCenter(i),e.boundingSphere.radius=i.distanceTo(Cb.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Cb.getSize(em);let n={width:em.x,height:em.y,depth:em.z};return this.userData.parameters=n,n}static build(e,t,i,n){let r,s,o,a=(e==null?void 0:e.phongAngle)??35;i===!1&&(a=-1),t&&(Ct.free_bvh(t),Ct.free_subdivision_surface(t));try{r=cs.allocate(e,n)}catch(l){console.error(l,e),r=cs.allocate({positionWASM:r6,indexWASM:s6,verticesPerFaceWASM:o6},n)}if(Ct.set_destination_refinement_level(r,0),s=cs.buildLevel(r,!0,a),e.subdivisions>0)try{Ct.set_destination_refinement_level(r,e.subdivisions),o=cs.buildLevel(r,!1,a)}catch{try{Ct.set_destination_refinement_level(r,e.subdivisions-1),o=cs.buildLevel(r,!1,a)}catch{o=null}}else o=null;return{subdivPointer:r,originalGeometry:s,subdividedGeometry:o}}static primitiveToQuads(e,t,i){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let n=e.shape!==void 0?t.geometry:XS(e,i,!1),r;e.type==="TorusGeometry"&&e.arc===Math.PI*2?r=n.getClosedTorusIndicesForBooleanOrSubdiv():r=n.getIndex();let s,o,a,l;({positions:s,triIndices:l}=uE(n.getAttribute("position"),r));let c;if(e.type==="CylinderGeometry"&&e.cornerRadius===0&&e.hollow===0&&e.openEnded===!1){let h=e.radialSegments*e.heightSegments*3*2,u=h+e.radialSegments*3;c=[h,u]}return{indices:o,verticesPerFace:a}=FJ(s,l,n,c),{positions:s,indices:o,verticesPerFace:a}}static allocate(e,t){var w;let i,n,r,s=[],o=[];e.positionWASM&&e.positionWASM.length>0?(i=e.positionWASM,n=e.indexWASM,r=e.verticesPerFaceWASM):(i=r6,n=s6,r=o6);let a=i.length,l=n.length,c=r.length,h=i.length+s.length+o.length,u=n.length+r.length,d=h*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,f=h*Float32Array.BYTES_PER_ELEMENT,p=Ct._malloc(d),g=new Float32Array(Ct.HEAPF32.buffer,p,h),m=new Uint32Array(Ct.HEAPU32.buffer,p+f,u);g.set(i,0),g.set(s,i.length),g.set(o,i.length+s.length),m.set(n,0),m.set(r,n.length);let v;(w=e==null?void 0:e.scaleBaked)!=null&&w.some(b=>b!==1)&&(v=new Je().makeScale(...e.scaleBaked)),t&&(v?v.premultiply(t):v=t);let x=v?Ct.alloc_subdivision_surface2(p,a,p+f,l,p+f+n.length*Uint32Array.BYTES_PER_ELEMENT,c,v.elements):Ct.alloc_subdivision_surface(p,a,p+f,l,p+f+n.length*Uint32Array.BYTES_PER_ELEMENT,c);return Ct._free(p),x}static buildLevel(e,t,i,n,r){let s=r?Ct.get_mesh_data2(e,t?Ct.Level.CONTROL:Ct.Level.REFINED,i,r.elements):Ct.get_mesh_data(e,t?Ct.Level.CONTROL:Ct.Level.REFINED,i),o=8,a=Ct.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(4,4+4),c=0,h=Ct.HEAPU32[a[c]>>2],u=Ct.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let d=Ct.HEAPU32[a[c]>>2],f=Ct.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let p=Ct.HEAPU32[a[c]>>2],g=Ct.HEAPU32.subarray(p>>2,(p>>2)+l[c]);c++;let m=Ct.HEAPU32[a[c]>>2],v=Ct.HEAPU32.subarray(m>>2,(m>>2)+l[c]);if(c++,n===void 0){let x=new Ot;if(x.setIndex(new ig(v,1)),x.setAttribute("position",new gt(u,3)),x.setAttribute("normal",new gt(f,3)),t){x.setAttribute("faceMap",new ig(g,1));let w=new Float32Array(f.length/3*4).fill(0);x.setAttribute("color",new zt(w,4))}return Ct.free_mesh_data(s),x.userData.type="SubdivGeometry",x}n.getAttribute("position").copyArray(u),n.getAttribute("normal").copyArray(f),n.attributes.position.needsUpdate=!0,n.attributes.normal.needsUpdate=!0,Ct.free_mesh_data(s)}static freeSubdivPointer(e){Ct.free_bvh(e),Ct.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,i){let n=Ct.get_wireframe_data_for_base_level(e),r=4,s=Ct.HEAPU32.subarray(n>>2,(n>>2)+r),o=s.subarray(2,2+2),a=0,l=Ct.HEAPU32[s[a]>>2],c=Ct.HEAPF32.subarray(l>>2,(l>>2)+o[a]);a++;let h=Ct.HEAPU32[s[a]>>2],u=Ct.HEAPU32.subarray(h>>2,(h>>2)+o[a]);if(t===void 0){let d=new Ot;d.setAttribute("position",new gt(c,3));let f=new Float32Array(c.length);for(let p=0,g=c.length;p<g;)f[p++]=i.r,f[p++]=i.g,f[p++]=i.b;return d.setAttribute("color",new zt(f,3)),d.setIndex(new ig(u,1)),Ct.free_wireframe_data_for_base_level(n),d}t.getAttribute("position").copyArray(c),t.attributes.position.needsUpdate=!0,Ct.free_wireframe_data_for_base_level(n)}static updateCollabMesh(e,t,i){let n=t===0;n||Ct.set_destination_refinement_level(e,t);let r=i?Ct.get_topological_data2(e,n?Ct.Level.CONTROL:Ct.Level.REFINED,i.elements):Ct.get_topological_data(e,n?Ct.Level.CONTROL:Ct.Level.REFINED),s=6,o=Ct.HEAPU32.subarray(r>>2,(r>>2)+s),a=o.subarray(3,3+3),l=0,c=Ct.HEAPU32[o[l]>>2],h=new Float32Array(Ct.HEAPF32.subarray(c>>2,(c>>2)+a[l]));l++;let u=Ct.HEAPU32[o[l]>>2],d=new Uint32Array(Ct.HEAPU32.subarray(u>>2,(u>>2)+a[l]));l++;let f=Ct.HEAPU32[o[l]>>2],p=new Uint8Array(Ct.HEAPU32.subarray(f>>2,(f>>2)+a[l]));return Ct.free_topological_data(r),{positions:h,indices:d,verticesPerFace:p}}},a6=["getX","getY","getZ"];function uE(e,t){let i={},n=t?t.count:e.count,r=0,s=[],o=[],a=1e4;for(let c=0;c<n;c++){let h=t?t.getX(c):c,u="";for(let d=0;d<3;d++)u+=`${~~(e[a6[d]](h)*a)},`;if(u in i)s.push(i[u]);else{for(let d=0;d<3;d++)o.push(e[a6[d]](h));i[u]=r,s.push(r),r++}}let l=[];for(let c=0;c<s.length;c+=3)s[c]===s[c+1]||s[c]===s[c+2]||s[c+1]===s[c+2]||l.push(s[c],s[c+1],s[c+2]);return{positions:o,triIndices:l}}var Tb=new I,hP=new I,dP=new I,fP=new I;function FJ(e,t,i,n){let r=[],s=[];if(i.userData.shape!==void 0&&i.userData.parameters.depth===0&&i.userData.shape.shapeHoles.length===0){let o=i.userData.shape.extractShapePointsToFlatArray([]),a=i.userData.parameters.spikes;if(i.userData.type==="EllipseGeometry"&&a<=24&&a%4===0&&i.userData.parameters.angle>=360){let h=o.length/2/a;o=o.filter((u,d)=>Math.floor(d/2)%h===0)}let l=0;for(let h=0;h<o.length;h+=2)l+=(o[h]-o[(h===0?o.length:h)-2])*(o[h+1]+o[(h===0?o.length:h)-1]);e.length=0;let c=0;if(l<0)for(let h=0;h<o.length;h+=2)e.push(o[h],o[h+1],0),r.push(c++);else for(let h=o.length-2;h>=0;h-=2)e.push(o[h],o[h+1],0),r.push(c++);return s.push(c),{indices:r,verticesPerFace:s}}for(let o=0,a=i.capStartIndex??t.length;o<a;)if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){Tb.set(e[t[o]*3],e[t[o]*3+1],e[t[o]*3+2]),hP.set(e[t[o+1]*3],e[t[o+1]*3+1],e[t[o+1]*3+2]),dP.set(e[t[o+4]*3],e[t[o+4]*3+1],e[t[o+4]*3+2]),fP.set(e[t[o+5]*3],e[t[o+5]*3+1],e[t[o+5]*3+2]),hP.sub(Tb).normalize(),dP.sub(Tb).normalize(),fP.sub(Tb).normalize();let l=hP.cross(dP).dot(fP);Math.abs(l)>.005||n&&n.some((c,h)=>h%2===1?!1:o>=n[h]&&o<n[h+1])?(r.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3):(r.push(t[o],t[o+1],t[o+4],t[o+5]),s.push(4),o+=6)}else r.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3;if(i.capStartIndex!==void 0){let o=[],a=[],l=0,c=new Float32Array([i.userData.parameters.depth])[0];for(let h=0,u=0;h<e.length;h+=3,u++)e[h+2]===0&&(o.push(u),l++),e[h+2]===c&&a.push(u);if(i.userData.parameters.extrudeBevelSize===0){let h=a[0];a[0]=a[1],a[1]=h}o.reverse(),r.push(...o,...a),s.push(l,l)}return{indices:r,verticesPerFace:s}}var $u={};Jge($u,{calcBoolean:()=>NBe,calcBooleanTopological:()=>FBe,freeMeshSet:()=>UBe,getMeshSet:()=>zBe,transformMeshSet:()=>kBe});var NJ,RBe=new Promise(e=>{NJ=e}),l6=!1;async function IBe(){if(l6)return;let e="https://unpkg.com/@splinetool/boolean-wasm@0.9.366/build",[t,i]=await Promise.all([y1(()=>import("./boolean-63aef768.js"),[]),fetch(`${e}/boolean.wasm`).then(s=>s.arrayBuffer())]),n=t.default,r=await n({wasmBinary:i});NJ(r),l6=!0}var li,ug;RBe.then(e=>li=e);function OBe(e,t,i){let n,r;e.userData.parameters.type==="TorusGeometry"&&e.userData.parameters.arc===Math.PI*2?r=e.getClosedTorusIndicesForBooleanOrSubdiv():r=e.getIndex();let{positions:s,triIndices:o}=uE(e.getAttribute("position"),r),a;if(t&&i){let{indices:l,verticesPerFace:c}=FJ(s,o,e);a=c.length,n=[];for(let h=0,u=0;h<a;h++){n.push(c[h]);for(let d=0;d<c[h];d++)n.push(l[u++])}}else{let l=o.length;n=Array(l+l/3),a=0;for(let c=0,h=0;h<n.length;)n[h++]=3,a++,n[h++]=o[c++],n[h++]=o[c++],n[h++]=o[c++]}return{positions:s,faceIndices:n,nFaces:a}}function zJ(e){let t=e.length,i=t*Uint32Array.BYTES_PER_ELEMENT,n=t*Float32Array.BYTES_PER_ELEMENT,r=Number.isInteger(e[0])?i:n,s=li._malloc(r);return(Number.isInteger(e[0])?new Uint32Array(li.HEAPU32.buffer,s,t):new Float32Array(li.HEAPF32.buffer,s,t)).set(e,0),s}function kJ(e){switch(e){case 0:return li.OP.UNION;case 1:return li.OP.INTERSECTION;case 2:return li.OP.A_MINUS_B;case 3:return li.OP.B_MINUS_A;case 4:return li.OP.SYMMETRIC_DIFFERENCE;case 5:return li.OP.ALL;default:throw new Error("Unknown boolean operation "+e)}}function FBe(e,t){ug===void 0&&(ug=li.init_csg());let i=zJ(e),n=li.csg_calc_topological(ug,i,e.length,kJ(t));li._free(i);let r=6,s=li.HEAPU32.subarray(n>>2,(n>>2)+r),o=s.subarray(3,3+3),a=0,l=li.HEAPU32[s[a]>>2],c=new Float32Array(li.HEAPF32.subarray(l>>2,(l>>2)+o[a]));a++;let h=li.HEAPU32[s[a]>>2],u=new Uint32Array(li.HEAPU32.subarray(h>>2,(h>>2)+o[a]));a++;let d=li.HEAPU32[s[a]>>2],f=new Uint8Array(li.HEAPU32.subarray(d>>2,(d>>2)+o[a]));return li.free_mesh_data(n),{positions:c,indices:u,verticesPerFace:f}}function NBe(e,t,i,n){ug===void 0&&(ug=li.init_csg());let r=zJ(e),s=li.csg_calc(ug,r,e.length,n,kJ(t));li._free(r);let o=5,a=li.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(2,2+3),c=0,h=li.HEAPU32[a[c]>>2],u=li.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let d=li.HEAPU32[a[c]>>2],f=li.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let p=l[c];i.setAttribute("position",new gt(u,3)),i.setAttribute("normal",new gt(f,3));let g=li.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return i.boundingSphere===null&&(i.boundingSphere=new ua),i.boundingSphere.center.set(g[0],g[1],g[2]),i.boundingSphere.radius=(g[3]**2+g[4]**2+g[5]**2)**.5,i.userData.parameters={width:g[3]*2,height:g[4]*2,depth:g[5]*2},li.free_mesh_data(s),p}function zBe(e,t,i){if(li===void 0)return-1;let n,r,s;if(t&&e.userData.positions!==void 0){let g=e.userData;s=g.verticesPerFace.length,n=g.positions,r=Array(g.verticesPerFace.reduce((m,v)=>m+v,0)+s);for(let m=0,v=0,x=0;m<g.verticesPerFace.length;m++){r[x++]=g.verticesPerFace[m];for(let w=0;w<g.verticesPerFace[m];w++)r[x++]=g.indices[v++]}}else({positions:n,faceIndices:r,nFaces:s}=OBe(e,t,i));let o=n.length,a=r.length,l=n.length,c=r.length,h=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,u=l*Float32Array.BYTES_PER_ELEMENT,d=li._malloc(h),f=new Float32Array(li.HEAPF32.buffer,d,l),p=new Uint32Array(li.HEAPU32.buffer,d+u,c);return f.set(n,0),p.set(r,0),li.get_csg_mesh(d,o,d+u,a,s)}function kBe(e,t){li.transform_csg_mesh(e,t.elements)}function UBe(e){li.free_csg_mesh(e)}var GBe={ConeGeometry:_3e,CubeGeometry:b3e,CylinderGeometry:dJ,DodecahedronGeometry:S3e,EllipseGeometry:qO,HelixGeometry:tBe,IcosahedronGeometry:iBe,LatheGeometry:nBe,NonParametricGeometry:uBe,PolygonGeometry:DJ,PyramidGeometry:hBe,RectangleGeometry:BJ,SphereGeometry:pBe,PlaneGeometry:mBe,BackdropGeometry:gBe,StarGeometry:LJ,TextFrameGeometry:yBe,TorusGeometry:xBe,TorusKnotGeometry:_Be,TriangleGeometry:bBe,PathGeometry:MBe,VectorGeometry:tp},c6=e=>GBe[e.type].create(e);function D0(e){return e!==null&&"booleanOp"in e}var UJ=class extends hJ(Ns){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new Je}updateVisible(){super.updateVisible(),this.visible=!D0(this.parent)&&this.visible,D0(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&($u.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),D0(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof UJ&&(e.freeBooleanPointer(),D0(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e){let t=super.updateTransformState(e);return t&&D0(this.parent)&&this.invalidateDownstreamBooleanData(!0),t}},Pb=new Vn;function JO(e,t=0,i=e.count,n,r){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,h=-1/0;for(let u=t;u<i;u++){let d=e.getX(u),f=e.getY(u),p=e.getZ(u);d<s&&(s=d),f<o&&(o=f),p<a&&(a=p),d>l&&(l=d),f>c&&(c=f),p>h&&(h=p)}Pb.min.set(s,o,a),Pb.max.set(l,c,h),Pb.getCenter(n),Pb.getSize(r).multiplyScalar(.5)}var HBe=new Ot,VBe=new ov,Ys=class extends UJ{constructor(e,t){super(HBe,VBe),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");i!==void 0?JO(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},u6=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},$h=class{constructor(e){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=si.generateUUID(),this.type=e,this.name=""}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,i){return i=i??{},this.analyze(e,i),this.flow(e,t,i)}flow(e,t,i){i=i??{},e.addFlow(i.slot,i.cache,i.context);let n={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),n}build(e,t,i){t=t??this.getType(e,t);let n=e.getNodeData(i??this);return e.analyzing&&this.appendDepsNode(e,n,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,i)}updateFrame(e){}generateReadonly(e,t,i,n,r,s){return""}generate(e,t,i,n,r){return""}parse(e,t,i,n){}appendDepsNode(e,t,i){t.deps=(t.deps||0)+1;let n=e.getTypeLength(i);(n>(t.outputMax||0)||this.getType(e,i))&&(t.outputMax=n,t.output=i)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}getHash(){let e="{",t,i;for(t in this)i=this[t],i instanceof $h&&(e+='"'+t+'":'+i.getHash()+",");if(this.hashProperties)for(let n=0;n<this.hashProperties.length;n++)t=this.hashProperties[n],i=this[t],e+='"'+t+'":"'+String(i)+'",';return e+='"id":"'+this.uuid+'"}',e}},jBe=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,i){i=i!==void 0?i:!0,this.keywords[e]={callback:t,cache:i}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},Os=new jBe,Bi=class extends $h{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,i,n){if(t=t??this.getType(e),this.getShared(e,t)){let r=this.getUnique(e,t);r&&this.uuid===void 0&&(this.uuid=si.generateUUID()),i=e.getUUID(i??this.getUUID(),!r);let s=e.getNodeData(i),o=s.output||this.getType(e);if(e.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,i)):super.build(e,t,i);if(r)return s.name=s.name||super.build(e,t,i),s.name;if(!this.getLabel()&&(!this.getShared(e,o)||e.context.ignoreCache||s.deps===1))return super.build(e,t,i);i=this.getUUID(!1);let a=this.getTemp(e,i);if(a)return e.format(a,o,t);{a=super.generate(e,t,i,s.output,n);let l=this.generate(e,o,i);return e.addNodeCode(a+" = "+l+";"),e.format(a,o,t)}}return super.build(e,t,i)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let i=e.getVars()[t];return i?i.name:void 0}generate(e,t,i,n,r){return this.getShared(e,t)||console.error("TempNode is not shared"),i=i??this.uuid,e.getTempVar(i,n??this.getType(e),r,this.getLabel()).name}},qs=class extends Bi{constructor(e,t){t=t??{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,i,n,r,s){i=e.getUUID(i??this.getUUID()),n=n??this.getType(e);let o=e.getNodeData(i);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,i,n,r,s):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(n,this,r,s,this.getLabel())),e.format(o.vertex.name,n,t)):(o.fragment||(o.fragment=e.createFragmentUniform(n,this,r,s,this.getLabel())),e.format(o.fragment.name,n,t))}},jr=class extends qs{constructor(e=0,t){super("v2"),this.nodeType="Vector2",this.value=e instanceof ge?e:new ge(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,i,n,r,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",n,t)}},Vo=class extends qs{constructor(t=0,i,n){super("v3"),this.nodeType="Vector3",this.value=t instanceof I?t:new I(t,i,n)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}get z(){return this.value.z}set z(t){this.value.z=t}generateReadonly(t,i,n,r,s,o){return t.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",r,i)}},Ws=class extends Pt{constructor(e,t,i,n){super(e,t,i),this.isColorA=!0,this.a=n}setRGBA(e,t,i,n){super.setRGB(e,t,i),this.a=n}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(e,t="srgb"){let i;if(e==="transparent")return this.setRGBA(0,0,0,0),this;if(i=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let n,r=i[1],s=i[2];switch(r){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="rgba"?parseFloat(n[4]):1,super.setStyle(e,t);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="hsla"?parseFloat(n[4]):1,super.setStyle(e,t);break}}return super.setStyle(e,t)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},Lc=class extends qs{constructor(t){super("v4"),this.nodeType="Vector4",this.value=t instanceof Ws?t:new Ws(t.r,t.g,t.b,t.a)}generateReadonly(t,i,n,r,s,o){return t.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",r,i)}},WBe=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,h6=/[a-z_0-9]+/gi,it=class extends Bi{constructor(e,t,i,n,r){super(r),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=r===void 0,this.isInterface=!1,this.parse(e,t,i,n)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,i,n,r){let s,o=0,a=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)e.include(this.includes[c],this);for(let c in this.extensions)e.extensions[c]=!0;let l=[];for(;s=h6.exec(this.src);)l.push(s);for(let c=0;c<l.length;c++){let h=l[c],u=h[0],d=this.isMethod?!this.getInputByName(u):!0,f=u;if(this.keywords[u]||this.useKeywords&&d&&Os.containsKeyword(u)){let p=this.keywords[u];if(!p){let g=Os.getKeywordData(u);g.cache&&(p=e.keywords[u]),p=p||Os.getKeyword(u,e),g.cache&&(e.keywords[u]=p)}f=p.build(e)}u!==f&&a[h.index+o-1]!=="."&&(a=a.substring(0,h.index+o)+f+a.substring(h.index+u.length+o),o+=f.length-u.length),this.getIncludeByName(f)===void 0&&Os.contains(f)&&e.include(Os.get(f))}return t==="source"?a:this.isMethod?(this.isInterface||e.include(this,void 0,a),this.name):e.format("( "+a+" )",this.getType(e),t)}parse(e,t,i,n){if(this.src=e||"",this.includes=t??[],this.extensions=i??{},this.keywords=n??{},this.isMethod){let r=WBe.exec(this.src);if(this.inputs=[],r&&r.length==4){this.type=r[1],this.name=r[2];let s=r[3].match(h6);if(s){let o=0;for(;o<s.length;){let a=s[o++],l;a==="in"||a==="out"||a==="inout"?l=s[o++]:(l=a,a="");let c=s[o++];this.inputs.push({name:c,type:l,qualifier:a})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},XBe=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,GJ=class extends Bi{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||GJ.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,i,n,r){this.src=e||"";let s,o,a="",l=XBe.exec(e);this.useDefine=r??this.src.charAt(0)==="#",l&&l.length>1?(o=l[1],s=l[2],a=l[3]):(s=this.src,o="f"),this.name=s,this.type=o,this.value=a}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,i,n,r){return e.format(this.name,this.getType(e),t)}},Mi=GJ;Mi.PI="PI",Mi.PI2="PI2",Mi.RECIPROCAL_PI="RECIPROCAL_PI",Mi.RECIPROCAL_PI2="RECIPROCAL_PI2",Mi.LOG2="LOG2",Mi.EPSILON="EPSILON";var YBe=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),qBe=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),HJ=class extends Bi{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,i,n,r){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=YBe.exec(e);if(t){let i=t[2],n;for(;n=qBe.exec(i);)this.inputs.push({type:n[1],name:n[2]});this.name=t[1]}else this.name="";this.type=this.name}},KO=class extends Bi{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let i=this.index>0?this.index+1:"",n=e.isShader("vertex")?"uv"+i:"vUv"+i;return e.format(n,this.getType(e),t)}};Os.addKeyword("uv",function(){return new KO});Os.addKeyword("uv2",function(){return new KO(1)});var pm=class extends Bi{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??pm.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case Ql:return["Linear"];case Vt:return["sRGB"];default:return[]}}generate(e,t){var o;let i=this.input.build(e,"v4"),n=this.getType(e),r=pm.Nodes[this.method],s=e.include(r);if(s===pm.LINEAR_TO_LINEAR)return e.format(i,n,t);if(((o=r.inputs)==null?void 0:o.length)===2){let a=this.factor.build(e,"f");return e.format(s+"( "+i+", "+a+" )",n,t)}else return e.format(s+"( "+i+" )",n,t)}fromEncoding(e){let t=pm.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=pm.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},Fl=pm;Fl.Nodes={LinearToLinear:new it(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new it(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new it(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},Fl.LINEAR_TO_LINEAR="LinearToLinear",Fl.SRGB_TO_LINEAR="sRGBToLinear",Fl.LINEAR_TO_SRGB="LinearTosRGB";var Hi=class extends it{constructor(e="",t,i,n,r){super(e,r,n,i,t),this.nodeType="Expression"}},zc=class extends qs{constructor(t=new tr,i,n,r){super("v4",{shared:!0}),this.nodeType="Texture",this.value=t,this.uv=i??new KO,this.bias=n,this.project=r!==void 0?r:!1}getTexture(t,i){return super.generate(t,i,this.value.uuid,"t")}generate(t,i){if(i==="sampler2D")return this.getTexture(t,i);let n=this.getTexture(t,i),r=this.uv.build(t,this.project?"v4":"v2"),s=this.bias?this.bias.build(t,"f"):void 0;s===void 0&&t.context.bias&&(s=t.context.bias.setTexture(this).build(t,"f"));let o,a;this.project?o="texture2DProj":o=s?"tex2DBias":"tex2D",s?a=o+"( "+n+", "+r+", "+s+" )":a=o+"( "+n+", "+r+" )";let l={include:t.isShader("vertex"),ignoreCache:!0},c=this.getType(t);return t.addContext(l),this.colorSpace=this.colorSpace??new Fl(new Hi("",c)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(t,c),t.removeContext(),t.format(a,c,i)}},ft=class extends qs{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,i,n,r,s){return e.format(this.value+(this.value%1?"":".0"),n,t)}},d6=class extends Bi{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,i,n,r){n=this.getType(e);let s=this.value,o=s.build(e,t)+"( ",a=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let c=s.inputs[l],h=this.inputs[l]||this.inputs[c.name];a.push(h.build(e,e.getTypeByFormat(c.type)))}o+=a.join(", ")+" )"}return e.format(o,n,t)}},VJ=class extends Bi{constructor(e,t,i=VJ.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=i}getType(e){let t=this.a.getType(e),i=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(i)>e.getTypeLength(t)?i:t}generate(e,t){let i=this.getType(e);this.type=i;let n=this.a.build(e,i),r=this.b.build(e,i);return e.format("( "+n+" "+this.op+" "+r+" )",i,t)}},Ps=VJ;Ps.ADD="+",Ps.SUB="-",Ps.MUL="*",Ps.DIV="/";var Si=class extends Bi{constructor(e,t=Si.ABS,i,n){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:n=t,typeof i!="string"?this.c=i:n=i,this.method=n,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case Si.MIX:case Si.CLAMP:case Si.REFRACT:case Si.SMOOTHSTEP:case Si.FACEFORWARD:return 3;case Si.MIN:case Si.MAX:case Si.MOD:case Si.STEP:case Si.REFLECT:case Si.DISTANCE:case Si.DOT:case Si.CROSS:case Si.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),i=this.b?e.getTypeLength(this.b.getType(e)):0,n=this.c?e.getTypeLength(this.c.getType(e)):0;return t>i&&t>n?this.a.getType(e):i>n?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case Si.LENGTH:case Si.DISTANCE:case Si.DOT:return"f";case Si.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let i,n,r,s=this.a?e.getTypeLength(this.a.getType(e)):0,o=this.b?e.getTypeLength(this.b.getType(e)):0,a=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case Si.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case Si.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case Si.CROSS:i=this.a.build(e,"v3"),n=this.b.build(e,"v3");break;case Si.STEP:i=this.a.build(e,s===1?"f":l),n=this.b.build(e,l);break;case Si.MIN:case Si.MAX:case Si.MOD:i=this.a.build(e,l),n=this.b.build(e,o===1?"f":l);break;case Si.REFRACT:i=this.a.build(e,l),n=this.b.build(e,l),r=this.c.build(e,"f");break;case Si.MIX:i=this.a.build(e,l),n=this.b.build(e,l),r=this.c.build(e,a===1?"f":l);break;default:i=this.a.build(e,l),this.b&&(n=this.b.build(e,l)),this.c&&(r=this.c.build(e,l));break}let h=[];h.push(i),n&&h.push(n),r&&h.push(r);let u=this.getNumInputs(e);if(h.length!==u)throw Error(`Arguments not match used in "${this.method}". Require ${u}, currently ${h.length}.`);return e.format(this.method+"( "+h.join(", ")+" )",c,t)}},Ut=Si;Ut.RAD="radians",Ut.DEG="degrees",Ut.EXP="exp",Ut.EXP2="exp2",Ut.LOG="log",Ut.LOG2="log2",Ut.SQRT="sqrt",Ut.INV_SQRT="inversesqrt",Ut.FLOOR="floor",Ut.CEIL="ceil",Ut.NORMALIZE="normalize",Ut.FRACT="fract",Ut.SATURATE="saturate",Ut.SIN="sin",Ut.COS="cos",Ut.TAN="tan",Ut.ASIN="asin",Ut.ACOS="acos",Ut.ARCTAN="atan",Ut.ABS="abs",Ut.SIGN="sign",Ut.LENGTH="length",Ut.NEGATE="negate",Ut.INVERT="invert",Ut.MIN="min",Ut.MAX="max",Ut.MOD="mod",Ut.STEP="step",Ut.REFLECT="reflect",Ut.DISTANCE="distance",Ut.DOT="dot",Ut.CROSS="cross",Ut.POW="pow",Ut.MIX="mix",Ut.CLAMP="clamp",Ut.REFRACT="refract",Ut.SMOOTHSTEP="smoothstep",Ut.FACEFORWARD="faceforward";var ey=class extends Bi{constructor(e,t,i){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=i}bilinearCubeUV(e,t,i,n){let r=new d6(ey.Nodes.bilinearCubeUV,[t,i,n]);this.colorSpaceTL=this.colorSpaceTL??new Fl(new Hi("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(r.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new Fl(new Hi("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(r.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new Fl(new Hi("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(r.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new Fl(new Hi("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(r.build(e)+".br");let s={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(s),this.colorSpaceTLExp=new Hi(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new Hi(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new Hi(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new Hi(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let o=new Hi("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=r,o}generate(e,t){if(e.isShader("fragment")){let i=this.uv,n=this.bias||e.context.roughness,r=new d6(ey.Nodes.roughnessToMip,[n]),s=new Ut(r,ey.Nodes.m0,ey.Nodes.cubeUV_maxMipLevel,Ut.CLAMP),o=new Ut(s,Ut.FLOOR),a=new Ut(s,Ut.FRACT),l=this.bilinearCubeUV(e,this.value,i,o),c=this.bilinearCubeUV(e,this.value,i,new Ps(o,new ft(1).setReadonly(!0),Ps.ADD)),h=new Ut(l,c,a,Ut.MIX);return e.format(h.build(e),"v4",t)}else return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},$B=ey;$B.Nodes=function(){let e=new HJ(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new Mi("float cubeUV_maxMipLevel 8.0",!0),i=new Mi("float cubeUV_minMipLevel 4.0",!0),n=new Mi("float cubeUV_maxTileSize 256.0",!0),r=new Mi("float cubeUV_minTileSize 16.0",!0),s=new it(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let o=new it(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);o.useKeywords=!1;let a=new it(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,s,o,t,i,n,r]);a.useKeywords=!1;let l=new Mi("float r0 1.0",!0),c=new Mi("float v0 0.339",!0),h=new Mi("float m0 -2.0",!0),u=new Mi("float r1 0.8",!0),d=new Mi("float v1 0.276",!0),f=new Mi("float m1 -1.0",!0),p=new Mi("float r4 0.4",!0),g=new Mi("float v4 0.046",!0),m=new Mi("float m4 2.0",!0),v=new Mi("float r5 0.305",!0),x=new Mi("float v5 0.016",!0),w=new Mi("float m5 3.0",!0),b=new Mi("float r6 0.21",!0),M=new Mi("float v6 0.0038",!0),A=new Mi("float m6 4.0",!0),T=[l,c,h,u,d,f,p,g,m,v,x,w,b,M,A],S=new it(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,T);return{bilinearCubeUV:a,roughnessToMip:S,m0:h,cubeUV_maxMipLevel:t}}();var mm=class extends Bi{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??mm.VIEW}getShared(){return this.scope===mm.WORLD}build(e,t,i,n){let r=e.context[this.scope+"Normal"];return r?r.build(e,t,i,n):super.build(e,t,i)}generate(e,t,i,n,r){let s;switch(this.scope){case mm.VIEW:e.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case mm.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case mm.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal");break}return e.format(s,this.getType(e),t)}},zs=mm;zs.LOCAL="local",zs.WORLD="world",zs.VIEW="view",zs.NORMAL="normal";Os.addKeyword("viewNormal",function(){return new zs(zs.VIEW)});Os.addKeyword("localNormal",function(){return new zs(zs.NORMAL)});Os.addKeyword("worldNormal",function(){return new zs(zs.WORLD)});var Pc=class extends Bi{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??Pc.LOCAL}getType(){switch(this.scope){case Pc.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Pc.LOCAL:case Pc.WORLD:return!1}return!0}generate(e,t,i,n,r){let s;switch(this.scope){case Pc.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case Pc.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case Pc.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Pc.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(s,this.getType(),t)}},Ua=Pc;Ua.LOCAL="local",Ua.WORLD="world",Ua.VIEW="view",Ua.PROJECTION="projection";Os.addKeyword("position",function(){return new Ua});Os.addKeyword("worldPosition",function(){return new Ua(Ua.WORLD)});Os.addKeyword("viewPosition",function(){return new Ua(Ua.VIEW)});var Sl=class extends Bi{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??Sl.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case Sl.SPHERE:return"v2"}return this.type}generate(e,t){let i=this.getUnique(e);if(e.isShader("fragment")){let n;switch(this.scope){case Sl.VECTOR:{let r=new zs(zs.VIEW),s=e.context.roughness,o=r.build(e,"v3"),a=new Ua(Ua.VIEW).build(e,"v3"),l=s?s.build(e,"f"):void 0,c=`reflect( -normalize( ${a} ), ${o} )`;l&&(c=`normalize( mix( ${c}, ${o}, ${l} * ${l} ) )`);let h=`inverseTransformDirection( ${c}, viewMatrix )`;i?(e.addNodeCode(`vec3 reflectVec = ${h};`),n="reflectVec"):n=h;break}case Sl.CUBE:{let r=new Sl(Sl.VECTOR).build(e,"v3"),s="vec3( -"+r+".x, "+r+".yz )";i?(e.addNodeCode(`vec3 reflectCubeVec = ${s};`),n="reflectCubeVec"):n=s;break}case Sl.SPHERE:{let r="normalize( ( viewMatrix * vec4( "+new Sl(Sl.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";i?(e.addNodeCode(`vec2 reflectSphereVec = ${r};`),n="reflectSphereVec"):n=r;break}}return e.format(n,this.getType(),t)}else return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},hg=Sl;hg.CUBE="cube",hg.SPHERE="sphere",hg.VECTOR="vector";var QBe=class extends Bi{constructor(e=new zc,t,i){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new $B(this.value,t??new hg(hg.VECTOR),i),this.irradianceNode=new $B(this.value,new zs(zs.WORLD),new ft(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},JBe=class extends qs{constructor(e=new iO,t,i){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new hg,this.bias=i}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var l;if(t==="samplerCube")return this.getTexture(e,t);let i=this.getTexture(e,t),n=(l=this.uv)==null?void 0:l.build(e,"v3"),r=this.bias?this.bias.build(e,"f"):void 0;r===void 0&&e.context.bias&&(r=e.context.bias.setTexture(this).build(e,"f"));let s;r?s="texCubeBias( "+i+", "+n+", "+r+" )":s="texCube( "+i+", "+n+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},a=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new Fl(new Hi("",a)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(e,a),e.removeContext(),e.format(s,a,t)}},KBe=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,ZBe=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,$Be=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,eLe=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// NOTE: We use the blue channel to avoid temporal reprojection
// with incorrect velocity if the fragment is transparent.
gVelocity = vec4(velocity, gl_FragColor.a < 1.0 ? 0.0 : 1.0, 1.);
`,f6=["x","y","z","w"],tLe=["float","vec2","vec3","vec4"],iLe={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},nLe={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},rLe=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(t,i){return t.deps.length-i.deps.length}return function(t,i){let n=this.getIncludes(t,i);if(!n)return"";let r="";n=n.sort(e);for(let s=0;s<n.length;s++)n[s].src&&(r+=n[s].src+`
`);return r}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode(KBe),this.addFragmentParsCode(ZBe),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let i=0;i<this.requires.uv.length;i++)if(this.requires.uv[i]){let n=i>0?i+1:"";this.addVaryCode("varying vec2 vUv"+n+";"),i>0&&this.addVertexParsCode("attribute vec2 uv"+n+";"),this.addVertexFinalCode("vUv"+n+" = uv"+n+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode($Be),this.addFragmentFinalCode(eLe)),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,i){return this.addSlot(e).addCache(t).addContext(i)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){this.fragmentParsVariables[e]===void 0&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){this.vertexParsVariables[e]===void 0&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+`
`}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,i,n="varying",r="V",s=""){let o=this.getVars(n),a=o[e];if(!a){let l=o.length;a={name:i||"node"+r+l+(s?"_"+s:""),type:t},o.push(a),o[e]=a}return a}getTempVar(e,t,i,n){return this.getVar(e,t,i,this.shader,"T",n)}getAttribute(e,t){if(!this.attributes[e]){let i=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(i.name+" = "+e+";"),this.attributes[e]={varying:i,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t??"";let i="";for(let n=0,r=e.length;n<r;++n){let s=e[n],o=s.type,a=s.name,l=s.size,c=this.getFormatByType(o);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?i+=t+" "+c.substring(0,c.length-2)+" "+a+`[${l}];
`:i+=t+" "+c+" "+a+`;
`}return i}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof $h?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,i,n,r,s){if(t.includes("[]")){let o=this.inputs.arrayUniforms,a=o.list.length,l=new u6({type:t,size:i.size,name:n||"nodeUA"+a+(s?"_"+s:""),node:i,needsUpdate:r});return o.list.push(l),o[e].push(l),o[e][l.name]=l,this.uniforms[l.name]=l,l}else{let o=this.inputs.uniforms,a=o.list.length,l=new u6({type:t,name:n||"nodeU"+a+(s?"_"+s:""),node:i,needsUpdate:r});return o.list.push(l),o[e].push(l),o[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,i,n,r){return this.createUniform("vertex",e,t,i,n,r)}createFragmentUniform(e,t,i,n,r){return this.createUniform("fragment",e,t,i,n,r)}include(e,t,i){var s;let n;if(e=typeof e=="string"?Os.get(e):e,this.context.include===!1)return e.name;e instanceof it?n=this.includes.functions:e instanceof Mi?n=this.includes.consts:e instanceof HJ&&(n=this.includes.structs);let r=n[this.shader]=n[this.shader]||[];if(e){let o=r[e.name];if(o||(o=r[e.name]={node:e,deps:[]},r.push(o),o.src=e.build(this,"source")),e instanceof it&&t&&r[t.name]&&r[t.name].deps.indexOf(e)===-1&&(r[t.name].deps.push(e),(s=e.includes)==null?void 0:s.length)){let a=0;do this.include(e.includes[a++],t);while(a<e.includes.length)}return i&&(o.src=i),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return tLe[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let i=e[t];if(i!=null&&i.isNode)return i}}resolve(...e){for(let t=0;t<arguments.length;t++){let i=e[t];if(i!==void 0){if(i.isNode)return i;if(i.isTexture)switch(i.mapping){case Ff:case Nf:return new JBe(i);case w1:return new QBe(new zc(i));default:return new zc(i)}else{if(i.isVector2)return new jr(i);if(i.isVector3)return new Vo(i);if(i.isVector4)return new Lc(i)}}}}format(e,t,i){switch(this.colorToVector(i+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return iLe[e]||e}getFormatByType(e){return nLe[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return f6[e]}getIndexByElement(e){return f6.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=Ql,t===Ql&&this.context.gamma&&(t=Vt),t}},xn=class extends qs{constructor(e=0,t,i,n){super("c"),this.nodeType="Color",this.value=e instanceof Ws?e:new Ws(e||0,t,i,n)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,i,n,r,s){i=e.getUUID(i??this.getUUID()),n=n??this.getType(e);let o=e.getNodeData(i),a=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return a?this.generateReadonly(e,t,i,n,r,s):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(n,this,r,s,this.getLabel())),e.format(o.vertex.name,n,t)):(o.fragment||(o.fragment=e.createFragmentUniform(n,this,r,s,this.getLabel())),e.format(o.fragment.name,n,t))}generateReadonly(e,t,i,n,r,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",n,t)}},Li=class extends qs{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,i,n,r,s){return e.format(this.value.toString(),n,t)}},us=class extends qs{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,i,n){return e.format(this.value?"true":"false",n,t)}},Ud=class extends qs{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}},ZO=class extends qs{},sLe=class extends ZO{constructor(e){super("v3"),this.image=e,this._value=new I}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},eL=class extends ZO{constructor(e,t){super("t"),this.image=e,this.wrap=t}get value(){return this.image.getTexture(this.wrap)}},jJ=class extends qs{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new Cr}generateReadonly(e,t,i,n,r,s){return e.format("mat3("+this.value.elements.join(", ")+")",n,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},$l=class extends qs{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=e??new Je}generateReadonly(e,t,i,n,r,s){return e.format("mat4("+this.value.elements.join(", ")+")",n,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function p6(e,t,i){e.setUvTransform(i[0],i[1],t[0],t[1],0,0,0)}var oLe=class extends jJ{constructor(e,t){super(new Cr),this.repeat=e,this.offset=t,p6(this.value,e,t)}updateMatrix(){p6(this.value,this.repeat,this.offset)}},Gd=class extends qs{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof Kt?new Array(e).fill(t):new Array(e).fill(new Kt(0))}},m6=class extends Bi{constructor(e,t,i,n){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=i,this.mode=n}generate(e,t){if(e.isShader("fragment")){let i=[];return i.push(this.a.build(e,"c")),i.push(this.b.build(e,"c")),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),e.format("spe_blend("+i.join(",")+")",this.getType(e),t)}else return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},WJ=class extends Bi{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let i=e.include(WJ.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.color.build(e,"v3")),n.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},tL=WJ;tL.Nodes=function(){return{customColor:new it(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var XJ=class extends Bi{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let i=e.include(XJ.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.cnormal.build(e,"v3")),n.push("normal"),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},YJ=XJ;YJ.Nodes=function(){return{customNormal:new it(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var ty=class extends Bi{constructor(e,t,i,n,r,s,o,a,l,c,h,u){super("v3"),this.nodeType="CustomTexture",this.firstTime=!0,this.texture=e,this.textureSize=t,this.crop=i,this.projection=n,this.axis=r,this.side=s,this.size=o,this.blending=a,this.mat=l,this.alpha=c,this.mode=h,this.isMask=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let i=`g${this.uuid.toString().replace(/-/g,"")}`,n;switch(this.projection.value){case 3:n=e.include(ty.Nodes.cylindrical);break;case 2:n=e.include(ty.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],o=new it(`
		vec3 ${i}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha) {

				vec2 uvs = ( mat * vec3( (${i}_vCustomUv * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, mat * ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);n=e.include(o);break;case 4:n=e.include(ty.Nodes.triplanar);break;default:n=e.include(ty.Nodes.uv);break}if(this.projection.value===1&&this.firstTime){e.addVertexParsCode(`varying vec2 ${i}_vCustomUv;`),e.addFragmentParsCode(`varying vec2 ${i}_vCustomUv;`);let s=["zy","xz","xy"][this.axis.value];e.addVertexFinalCode(`${i}_vCustomUv = (1. + (transformed.${s})) / 2.;`)}e.addFragmentVariable(this.calpha,"float");let r=[];return r.push("normal"),r.push(this.texture.generate(e,"t")),r.push(this.textureSize.build(e,"v2")),r.push(this.crop.build(e,"f")),r.push(this.mat.build(e,"mat3")),r.push(this.size.build(e,"v2")),r.push(this.blending.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),this.firstTime=!this.firstTime,e.format(n+"("+r.join(",")+")",this.getType(e),t)}},qJ=ty;qJ.Nodes=function(){let e=new it(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),t=new it(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),i=new it(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha) {

				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),n=new it(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:e,spherical:t,uv:i,triplanar:n}}();var iy=class extends Bi{constructor(e,t,i,n,r,s,o,a,l,c,h,u){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=i,this.far=n,this.isVector=r,this.isWorldSpace=s,this.origin=o,this.direction=a,this.colors=l,this.steps=c,this.isMask=u,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let i=`g${this.uuid.toString().replace(/-/g,"")}`,n=new it(`vec3 ${i}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${i}_MAX_COLORS], float steps[${i}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${i}_IS_VECTOR
                   #ifdef ${i}_LINEAR
                       #ifdef ${i}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${i}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${i}_SMOOTH
				for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[iy.Nodes.vectorLinearWorldSpaceDepth,iy.Nodes.vectorLinearObjectSpaceDepth,iy.Nodes.vectorSphericalObjectSpaceDepth,iy.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${i}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${i}_SMOOTH`),this.isVector.value>.5&&e.define(`${i}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${i}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${i}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let r=e.include(n),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.isMask.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(r+"("+s.join(",")+")",this.getType(e),t)}else return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},QJ=iy;QJ.Nodes=function(){let e=new it(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new it(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),i=new it(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),n=new it(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:i,vectorSphericalObjectSpaceDepth:n}}();var aLe=class extends Bi{constructor(e,t,i,n,r,s,o,a){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=i,this.intensity=n,this.factor=r,this.isMask=a,this.alpha=s,this.mode=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let i=new it(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),n=e.include(i),r=[];return r.push(this.color.build(e,"c")),r.push(this.bias.build(e,"f")),r.push(this.scale.build(e,"f")),r.push(this.intensity.build(e,"f")),r.push(this.factor.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),e.format(n+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},JJ=class extends Bi{constructor(e,t,i,n,r,s,o,a,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=i,this.steps=n,this.offset=r,this.morph=s,this.angle=o,this.isMask=l,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(JJ.Nodes.gradient),n=[];return n.push(this.gradientType.build(e,"i")),n.push(this.smooth.build(e,"b")),n.push(this.colors.build(e,"v4[]")),n.push(this.steps.build(e,"f[]")),n.push(this.offset.build(e,"v2")),n.push(this.morph.build(e,"v2")),n.push(this.angle.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},KJ=JJ;KJ.Nodes=function(){return{gradient:new it(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var ZJ=class extends Bi{constructor(e,t,i,n){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=n,this.alpha=t,this.mode=i,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let i=e.include(ZJ.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let n=[];return n.push(this.texture.generate(e,"t")),n.push("normal"),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},$J=ZJ;$J.Nodes=function(){return{matcap:new it(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var $O=(e=>(e.SIMPLEX="simplex3d",e.SIMPLEX_FRACTAL="simplex3dFractal",e.ASHIMA="simplexAshima",e.FBM="fbm",e.PERLIN="perlin",e.VORONOI="voronoi",e))($O||{}),Bs=function(){let e=new it(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new it(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new Mi("float F3 0.3333333"),t.keywords.G3=new Mi("float G3 0.1666667");let i=new it(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[t]),n=new it("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),r=new it("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new it(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[n,r]),o=new it("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),a=new it("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new it(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[a]),c=new it(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new Mi("int NUM_OCTAVES 5");let h=new it("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),u=new it(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[n,r,h]),d=new it(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),f=new it(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),p=new it(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),g=new it(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),m=new it(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),v=new it(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),x=new it(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[d,f,p,g,m,v]);return{simplex:t,simplexFractal:i,simplexAshima:s,fbm:c,perlin:u,voronoi:x}}(),eK=class extends Bi{constructor(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,g,m,v,x){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=i,this.fA=n,this.fB=r,this.distortion=s,this.colorA=o,this.colorB=a,this.colorC=l,this.colorD=c,this.noiseType=u,this.voronoiStyle=f,this.highCut=p,this.lowCut=g,this.smoothness=m,this.seed=v,this.quality=x,this.isMask=d,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,i,n,r){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=Object.values($O)[this.noiseType.value],o=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,a=new it(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${o}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[Bs.simplex,Bs.simplexFractal,Bs.simplexAshima,Bs.fbm,Bs.perlin,Bs.voronoi]),l=e.include(a),c=[];return c.push(this.scale.build(e,"f")),c.push(this.size.build(e,"v3")),c.push(this.move.build(e,"f")),c.push(this.fA.build(e,"v2")),c.push(this.fB.build(e,"v2")),c.push(this.distortion.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.colorC.build(e,"v4")),c.push(this.colorD.build(e,"v4")),c.push(this.voronoiStyle.build(e,"i")),c.push(this.highCut.build(e,"f")),c.push(this.lowCut.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.seed.build(e,"f")),c.push(this.quality.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}};eK.numOctaves=5;var tK=class extends Bi{constructor(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,g){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=i,this.contourWidth=n,this.contourThreshold=r,this.outlineThreshold=s,this.contourFrequency=o,this.outlineSmoothing=a,this.contourDirection=l,this.positionalLines=c,this.compensation=h,this.resolution=u,this.normalMap=d,this.depthMap=f,this.pixelRatio=p,this.alpha=g,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let i=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${i}_offset`),this.firstTime){let n=this.outlineWidth.build(e,"f"),r=this.resolution.build(e,"v2"),s=this.compensation.build(e,"b"),o=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(n,"uniform float"),e.addVertexParsVariable(r,"uniform vec2"),e.addVertexParsVariable(s,"uniform bool"),e.addVertexParsVariable(o,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${i}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${i}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${i}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${i}_offset = normalize(${i}_clipNormal.xy) / ${r} * (${n} / 2.0) * ${i}_clipPosition.w * 2.0 * ${o};
                    ${i}_clipPosition.xy += ${i}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${i}_clipPosition;
                }
            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let n=e.include(tK.Nodes.outline),r=[];return r.push(this.outlineColor.build(e,"c")),r.push(this.contourColor.build(e,"c")),r.push(this.outlineWidth.build(e,"f")),r.push(this.contourWidth.build(e,"f")),r.push(this.contourThreshold.build(e,"f")),r.push(this.outlineThreshold.build(e,"f")),r.push(this.contourFrequency.build(e,"f")),r.push(this.outlineSmoothing.build(e,"f")),r.push(this.contourDirection.build(e,"v3")),r.push(this.positionalLines.build(e,"b")),r.push(this.resolution.build(e,"v2")),r.push(this.normalMap.getTexture(e,"t")),r.push(this.depthMap.getTexture(e,"t")),r.push(this.pixelRatio.build(e,"f")),r.push(this.compensation.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),this.firstTime=!this.firstTime,e.format(n+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},iK=tK;iK.Nodes=function(){let e=new it(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new it(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[e])}}();var Dc=class extends Bi{constructor(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,g,m,v){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=i,this.blending=n,this.offset=r,this.colorA=s,this.colorB=o,this.frequency=a,this.size=l,this.variation=c,this.smoothness=h,this.zigzag=u,this.rotation=d,this.vertical=f,this.horizontal=p,this.sides=g,this.isMask=v,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float");let i;switch(this.style.value){case 0:i="circle";break;case 1:i="ring";break;case 2:i="polygon";break;case 3:i="xcross";break;case 4:i="diamond";break;case 5:i="checkerboard";break;case 6:i="line";break;case 7:i="wave";break;default:i="circle";break}let n=`g${this.uuid.toString().replace(/-/g,"")}`,r=new it(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new it(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),o="";if(this.projection.value===4){let h=this.style.value===2?`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,u=this.style.value===2?`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;o=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${h};
				float d1 = ${u};
				float d2 = ${d};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let h=this.style.value===2?`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,u="";this.axis.value===0?u=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?u=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,u=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let d="";switch(this.projection.value){case 0:d="custom_uv = vUv.st;";break;case 1:break;case 2:d=`
							vec3 p = position;
							${u}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}o=`
				vec2 custom_uv;
				${d}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${h};
				`}let a=new it(`vec3 ${n}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${o}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,r,Dc.DrawFunctions.circle,Dc.DrawFunctions.ring,Dc.DrawFunctions.polygon,Dc.DrawFunctions.cross,Dc.DrawFunctions.diamond,Dc.DrawFunctions.checkerboard,Dc.DrawFunctions.line,Dc.DrawFunctions.wave]),l=e.include(a),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}else return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},nK=Dc;nK.DrawFunctions=function(){let e=new it(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),t=new it(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[e]),i=new it(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[t]),n=new it(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[t]),r=new it(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[t]),s=new it(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[t]),o=new it(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[t]),a=new it(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new it(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[t]),c=new it(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:t,circle:i,ring:n,polygon:r,cross:s,diamond:o,checkerboard:a,line:l,wave:c}}();var rK=class extends Bi{constructor(e,t,i,n,r,s,o,a){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=i,this.noiseStrength=n,this.noiseScale=r,this.offset=s,this.isMask=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(rK.Nodes.rainbow),n=[];return n.push(this.filmThickness.build(e,"f")),n.push(this.movement.build(e,"f")),n.push(this.wavelengths.build(e,"v3")),n.push(this.noiseStrength.build(e,"f")),n.push(this.noiseScale.build(e,"f")),n.push(this.offset.build(e,"v3")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},sK=rK;sK.Nodes=function(){let e=new it(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[Bs.simplex]);return{rainbow:new it(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[e])}}();var oK=class extends Bi{constructor(e,t,i,n,r,s,o,a,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=i,this.source=n,this.isWorldSpace=r,this.noiseStrength=s,this.noiseScale=o,this.shadowColor=a,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let i=e.include(oK.Nodes.toon),n=[];return n.push(this.positioning.build(e,"i")),n.push(this.colors.build(e,"v4[]")),n.push(this.steps.build(e,"f[]")),n.push(this.source.build(e,"v3")),n.push(this.isWorldSpace.build(e,"b")),n.push(this.noiseStrength.build(e,"f")),n.push(this.noiseScale.build(e,"f")),n.push(this.shadowColor.build(e,"v4")),n.push(this.offset.build(e,"v3")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},aK=oK;aK.Nodes=function(){let e=new it(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),t=new it(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),i=new it(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[t]),n=new it(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),r=new it(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[n]);return{toon:new it(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[Bs.simplex,e,i,r])}}();var lK=class extends Bi{constructor(e,t,i,n,r,s,o,a){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=i,this.transmissionSamplerSize=n,this.transmissionSamplerMap=r,this.transmissionDepthMap=s,this.aspectRatio=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,Tt.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let i=e.include(lK.Nodes.transmission),n=[];return n.push(this.thickness.build(e,"f")),n.push(this.ior.build(e,"f")),n.push(this.roughness.build(e,"f")),n.push(this.transmissionSamplerSize.build(e,"v2")),n.push(this.transmissionSamplerMap.getTexture(e,"t")),n.push(this.transmissionDepthMap.getTexture(e,"t")),n.push(this.aspectRatio.build(e,"v2")),n.push("normal"),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},cK=lK;cK.Nodes=function(){let e=new it(`
            vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);

            }`),t=new it(`
            vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        // Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		        // The thickness is specified in local space.
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),i=new it(`
float applyIorToRoughness( float roughness, float ior ) {
		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	} `),n=new it(`
vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
        float lod = applyIorToRoughness(roughness, ior);

        return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
	}`,[i,e]),r=new it(`
vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
        vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
        vec3 refractedRayExit = position + transmissionRay;

        // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
        vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
        vec2 refractionCoords = ndcPos.xy / ndcPos.w;
        refractionCoords += 1.0;
        refractionCoords /= 2.0;

        vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
        vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
        unrefractedCoords += 1.0;
        unrefractedCoords /= 2.0;

        // Sample framebuffer to get pixel the refracted ray hits.
        return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    }`,[n,t]);return{transmission:new it(`
            vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[r])}}();var iL=(e=>(e.NOISE="noise",e.MAP="map",e))(iL||{}),uK=class extends Bi{constructor(e,t,i,n,r,s,o,a,l,c,h){super("v3"),this.displacementTypeIndex=new Li(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,Object.values(iL)[this.displacementTypeIndex.value]==="map"&&(this.mat=new jJ(this.movementOrTexture.value.matrix)),this.cropOrOffset=i,this.scale=c,this.noiseFunctionIndex=h,this.voronoiStyle=n,this.smoothness=r,this.seed=s,this.highCut=o,this.lowCut=a,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let i,n=[];switch(n.push("displaced_position"),n.push("displaced_normal"),Object.values(iL)[this.displacementTypeIndex.value]){case"map":{i=e.include(uK.Nodes.map),n.push(this.movementOrTexture.getTexture(e,"t")),n.push("uv"),n.push(this.cropOrOffset.build(e,"f")),this.mat&&n.push(this.mat.build(e,"mat3"));break}case"noise":{let r=Object.values($O)[this.noiseFunctionIndex.value],s=new it(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),o=r=="voronoi"?`
					float v = ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,a=new it(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${o}
						}`,[Bs.simplex,Bs.simplexFractal,Bs.simplexAshima,Bs.fbm,Bs.perlin,Bs.voronoi]),l=new it(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[a,s]);i=e.include(l),n.push(this.scale.build(e,"f")),n.push(this.cropOrOffset.build(e,"v3")),n.push(this.movementOrTexture.build(e,"f")),n.push(this.voronoiStyle.build(e,"i")),n.push(this.smoothness.build(e,"f")),n.push(this.seed.build(e,"f")),n.push(this.highCut.build(e,"f")),n.push(this.lowCut.build(e,"f")),n.push(this.quality.build(e,"i"));break}}return n.push(this.intensity.build(e,"f")),n.push("displaced_normal"),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},hK=uK;hK.Nodes=function(){let e=new it(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new it(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new it(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var Tt={normalRenderTarget:new zc,normalRenderTargetDepth:new zc,transmissionRenderTarget:new zc,transmissionSize:new jr(2048,2048),transmissionRenderTargetDepth:new zc,aoRenderTarget:new zc,aoEnabled:new us,pixelRatioNode:new ft(1),resolution:new jr,penumbraSize:new Ud(5,.5),frameIndex:new Li(0),transmissionLod:new Li(2)};for(let e of Object.values(Tt))e.isRenderGlobal=!0;var dK=class extends $h{constructor(){super("basic"),this.nodeType="Basic",this.color=new xn(5526619),this.shadingAlpha=new ft(1),this.shadingBlend=new Li(0),this.previousModelViewMatrix=new $l,this.previouseProjectionMatrix=new $l}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Tt.frameIndex}),e.mergeUniform({resolution:Tt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(av.merge([et.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join(`
`)}else{this.color===void 0&&(this.color=new xn(5526619)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let i=this.color.flow(e,"c",{slot:"color"}),n=this.alpha?this.alpha.flow(e,"f"):void 0,r=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=n!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let s=["#include <normal_fragment_begin>",i.code];n&&s.push(n.code,"#ifdef ALPHATEST"," if ( "+n.result+" <= ALPHATEST ) discard;","#endif"),r?s.push(r.code,`vec3 outgoingLight = ${i.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${r.result}, 1.0, SPE_BLENDING_NORMAL);`):s.push(`vec3 finalColor = ${i.result};`);let o="1.0";this.mask&&(this.mask.analyze(e),o=`luminance(${this.mask.flow(e,"v3").result})`),n?s.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${n.result} * ${o} );`):s.push("gl_FragColor = vec4("+i.result+", 1.0 );"),s.push("#include <fog_fragment>","#include <dithering_fragment>"),t=s.join(`
`)}return t}},lLe=class extends $h{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new xn(5526619),this.emissive=new xn(0),this.emissiveIntensity=new ft(1),this.previousModelViewMatrix=new $l,this.previouseProjectionMatrix=new $l,this.shadingAlpha=new ft(1),this.shadingBlend=new Li(0),this.occlusion=new us(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Tt.frameIndex}),e.mergeUniform({resolution:Tt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(av.merge([et.fog,et.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join(`
`)}else{e.mergeUniform({penumbraSize:Tt.penumbraSize}),e.mergeUniform({frameIndex:Tt.frameIndex}),e.mergeUniform({aoMap:Tt.aoRenderTarget}),e.mergeUniform({aoEnabled:Tt.aoEnabled}),this.color===void 0&&(this.color=new xn(5526619)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.emissive.flow(e,"c",{slot:"emissive"}),r=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.occlusion.flow(e,"b",{slot:"occlusion"}),o=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];h.push(i.code,"vec3 diffuseColor = "+i.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),n&&h.push(n.code,"reflectedLight.directDiffuse += "+n.result+" * "+r.result+";"),h.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let u="1.0";this.mask&&(this.mask.analyze(e),u=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${u} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${u}, ${a.result} );

					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},cLe=class extends $h{constructor(){super("phong"),this.nodeType="Phong",this.color=new xn(5526619),this.specular=new xn(1118481),this.shininess=new ft(30),this.previousModelViewMatrix=new $l,this.previouseProjectionMatrix=new $l,this.shadingAlpha=new ft(1),this.shadingBlend=new Li(0),this.occlusion=new us(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Tt.frameIndex}),e.mergeUniform({resolution:Tt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(av.merge([et.fog,et.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join(`
`)}else{e.mergeUniform({penumbraSize:Tt.penumbraSize}),e.mergeUniform({frameIndex:Tt.frameIndex}),e.mergeUniform({aoMap:Tt.aoRenderTarget}),e.mergeUniform({aoEnabled:Tt.aoEnabled}),this.color===void 0&&(this.color=new xn(5526619)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let n=this.color.flow(e,"c",{slot:"color"}),r=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];h.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",r.code,"	vec3 specular = "+r.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let u="1.0";this.mask&&(this.mask.analyze(e),u=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${u} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${u}, ${a.result} );
					
					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},uLe=class extends $h{constructor(){super("standard"),this.nodeType="Standard",this.color=new xn(5526619),this.roughness=new ft(.3),this.metalness=new ft(0),this.reflectivity=new ft(.5),this.previousModelViewMatrix=new $l,this.previouseProjectionMatrix=new $l,this.shadingAlpha=new ft(1),this.shadingBlend=new Li(0),this.occlusion=new us(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Tt.frameIndex}),e.mergeUniform({resolution:Tt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(av.merge([et.fog,et.lights])),et.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join(`
`)}else{e.mergeUniform({penumbraSize:Tt.penumbraSize}),e.mergeUniform({frameIndex:Tt.frameIndex}),e.mergeUniform({aoMap:Tt.aoRenderTarget}),e.mergeUniform({aoEnabled:Tt.aoEnabled});let i={gamma:!0};this.color===void 0&&(this.color=new xn(5526619)),this.color.analyze(e,{slot:"color",context:i}),this.roughness.analyze(e),this.metalness.analyze(e);let n=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let r=this.color.flow(e,"c",{slot:"color",context:i}),s=this.roughness.flow(e,"f"),o=this.metalness.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,h=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=h!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let d=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];d.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",s.code,"	float roughnessFactor = "+s.result+";",o.code,"	float metalnessFactor = "+o.result+";"),h&&d.push(h.code,"#ifdef ALPHATEST","	if ( "+h.result+" <= ALPHATEST ) discard;","#endif"),d.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),d.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),u?d.push(u.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+u.result+" ) ), diffuseColor, metalnessFactor );"):d.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),d.push("#include <lights_fragment_begin>"),d.push("#include <lights_fragment_end>"),d.push("vec3 ao = aoEnabled && "+n.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let f="1.0";this.mask&&(this.mask.analyze(e),f=`luminance(${this.mask.flow(e,"v3").result})`),d.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${f} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${f}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),c&&d.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),h?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${h.result} );`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=d.join(`
`)}return t}},hLe=class extends $h{constructor(){super("toon"),this.nodeType="Toon",this.color=new xn(5526619),this.specular=new xn(1118481),this.shininess=new ft(30),this.previousModelViewMatrix=new $l,this.previouseProjectionMatrix=new $l,this.shadingAlpha=new ft(1),this.shadingBlend=new Li(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Tt.frameIndex}),e.mergeUniform({resolution:Tt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(av.merge([et.fog,et.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join(`
`)}else{e.mergeUniform({penumbraSize:Tt.penumbraSize}),e.mergeUniform({frameIndex:Tt.frameIndex}),e.mergeUniform({aoMap:Tt.aoRenderTarget}),e.mergeUniform({aoEnabled:Tt.aoEnabled}),this.color===void 0&&(this.color=new xn(5526619)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),r=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),a=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];c.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",n.code,"	vec3 specular = "+n.result+";",r.code,"	float shininess = max( 0.0001, "+r.result+" );","	float specularStrength = 1.0;"),l&&c.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),c.push("material.diffuseColor = diffuseColor;"),c.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),c.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${h}, ${o.result} );
				}
				`),a&&c.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=c.join(`
`)}return t}},dLe=class{constructor(e=1e3*10){this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...e){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){var t;return(t=this.cache.get(e))==null?void 0:t.data}load(e){let t=Date.now(),i=this.cache.get(e);return i===void 0?(i={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,i)):(i.time=t,i.prev.next=i.next,i.next.prev=i.prev),i.prev=this.tail.prev,i.next=this.tail,this.tail.prev.next=i,this.tail.prev=i,this.scheduleCleanup(),i.data}},fLe=class extends dLe{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}},pP;function pLe(e){return typeof e=="string"?e:(pP||(pP=new fLe),pP.load(e))}var mLe=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},gLe=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data)}load(e){let t=this.cache.get(e);return t===void 0&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},fK=class extends mLe{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isVideo=e.type==="video",this.updateSrc(e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;let n=[1e3,1001,1002];for(let r of n){let s=this[r];s&&(s.image=this.img,s.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof e!="string"){var i=new FileReader;i.readAsDataURL(new Blob([e],{type:"video/mp4"}));let n;await new Promise(r=>{i.onloadend=s=>{var o;n=(o=s.target)==null?void 0:o.result,r(null)}}),this.img.src=n}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=pLe(e),this.img.onload=t}getTexture(e){let t=this[e];if(t)return t;{let i;return this.isVideo?i=new a_e(this.img,void 0,e,e):i=new tr(this.img,void 0,e,e),this.loaded&&(i.needsUpdate=!0),this[e]=i,i}}disposeTextures(){var e,t,i;(e=this[1e3])==null||e.dispose(),this[1e3]=void 0,(t=this[1001])==null||t.dispose(),this[1001]=void 0,(i=this[1002])==null||i.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},lf=class extends fK{};function qr(e,t){return t.color(e)}function vLe(e,t){switch(e.type){case"fresnel":return wLe(e,t);case"gradient":return _Le(e);case"depth":return bLe(e);case"normal":return ALe(e);case"noise":return SLe(e,t);case"rainbow":return MLe(e);case"toon":return ELe(e,t);case"outline":return CLe(e,t);case"transmission":return TLe(e);case"color":return xLe(e,t);case"pattern":return PLe(e,t)}}function yLe(e){return{type:e.type}}function rl(e){let{alpha:t,mode:i,isMask:n}=e;return{...yLe(e),alpha:t,mode:i,isMask:n}}function xLe(e,t){return{...rl(e),color:qr(e.color,t)}}function wLe(e,t){let{bias:i,scale:n,intensity:r,factor:s,color:o,isMask:a}=e;return{...rl(e),color:qr(o,t),bias:i,scale:n,intensity:r,factor:s}}function _Le(e){let{gradientType:t,smooth:i,colors:n,steps:r,angle:s,offset:o,morph:a}=e;return{...rl(e),gradientType:t,smooth:i,colors:n.map(l=>new Kt(l[0],l[1],l[2],l[3])),num:n.length,steps:r,offset:new ge(...o),morph:new ge(...a),angle:s}}function bLe(e){let{gradientType:t,near:i,far:n,isVector:r,isWorldSpace:s,origin:o,direction:a,colors:l,steps:c,smooth:h}=e;return{...rl(e),gradientType:t,near:i,far:n,isVector:r,isWorldSpace:s,origin:new I(...o),direction:a?new I(...a):new I(1,0,0),colors:l.map(u=>u!==void 0?new Kt(u[0],u[1],u[2],u[3]):new Kt(0,0,0,0)),steps:c.slice(0,l.length),smooth:h}}function ALe(e){let{cnormal:t}=e;return{...rl(e),cnormal:new I(t[0],t[1],t[2])}}function SLe(e,t){return{...rl(e),scale:e.scale,move:e.move,fA:new ge(...e.fA),fB:new ge(...e.fB),size:new I(...e.size),distortion:new ge(...e.distortion),colorA:qr(e.colorA,t),colorB:qr(e.colorB,t),colorC:qr(e.colorC,t),colorD:qr(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}function MLe(e){return{...rl(e),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new I(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new I(...e.offset)}}function ELe(e,t){return{...rl(e),positioning:e.positioning,colors:e.colors.map(i=>new Kt(i[0],i[1],i[2],i[3])),num:e.colors.length,steps:e.steps,source:new I(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:qr(e.shadowColor,t),offset:new I(...e.offset)}}function CLe(e,t){return{...rl(e),outlineColor:qr(e.outlineColor,t),contourColor:qr(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new I(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}function TLe(e,t){return{...rl(e),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}function PLe(e,t){return{...rl(e),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new ge(...e.offset),colorA:qr(e.colorA,t),colorB:qr(e.colorB,t),frequency:new ge(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new ge(...e.vertical),horizontal:new ge(...e.horizontal),sides:e.sides}}var YS=class extends Ws{},pK={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},mK={depth:["colors"]};function DLe(e,t,i){var s,o;if(t==="isMask")return!0;let n=pK[e.type],r=mK[e.type];if(r!==void 0){let a=e.color;if(r.includes(t)){let l=(o=(s=a[t])==null?void 0:s.value)==null?void 0:o.length;if(l!==void 0&&l!==i.length)return!0}}return n!==void 0?n.includes(t):!1}function gK(e,t,i){let n=i.uniforms[`f${i.id}_texture`];if(!n)return!1;let r=!1,s=e;if("image"in s){let o=s.image,a=t.image(o),l=n;l.image instanceof lf||l.image.deref(),l.image=a}if("video"in s){let o=s.video,a=t.video(o),l=n;l.image instanceof lf||l.image.deref(),l.image=a}if("wrapping"in s){let o=n;o.wrap=s.wrapping}if("repeat"in s||"offset"in s){let o="mat",a=i.uniforms[`f${i.id}_${o}`];"repeat"in s&&(a.repeat=s.repeat),"offset"in s&&(a.offset=s.offset),a.updateMatrix()}return r}function BLe(e,t,i,n){let r=!1;for(let[s,o]of Object.entries(e)){if(!s||o===void 0)continue;if(yK(s,i,n)){s==="visible"&&i.type==="light"&&(r=!0);continue}i.visible=n.visible;let a=i.uniforms[`f${i.id}_${s}`];if(a&&!(a instanceof ZO))switch(r=r||DLe(i,s,o),a.constructor){case xn:if(typeof o=="string"){let l=t.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof YS?a.value=new Ws(l.r,l.g,l.b,l.a):a.setRGBA(l);break}case Lc:if(typeof o=="string"){let l=t.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof YS?a.value=new Ws(l.r,l.g,l.b,l.a):a.value.setRGBA(l.r,l.g,l.b,l.a);break}case jr:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]);break}case Vo:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]),a.value.setZ(l[2]);break}case zc:{gK(o,t,i);break}case Gd:{a.value=o.map(l=>new Kt(...l));break}default:{a.value=o;break}}}return r}var Ef=class{constructor(e,t,i,n){this.id=e,this.uuid=t,this.data=i,this.uniforms={};for(let r in n)this.uniforms[`f${this.id}_${r}`]=n[r];for(let r in i)yK(r,this,i)}get type(){return this.data.type}static create(e,t,i,n){if(i.type==="light")return eh.createLigherLayer(e,t,i,n);if(i.type==="texture"||i.type==="video"){let r=i.type==="texture"?n.image(i.texture.image):n.video(i.texture.video),s=new eL(r,i.texture.wrapping),o=new sLe(r),a=new oLe(i.texture.repeat,i.texture.offset),l=new ft(i.crop?1:0),c=new Li(i.projection??0),h=new Li(["x","y","z"].indexOf(i.axis)??0),u=new Li(i.side??0),d=new jr(i.size?new ge(i.size[0],i.size[1]):new ge(100,100)),f=new ft(i.blending??0),p=new ft(i.alpha??1),g=new Li(i.mode??0),m=new us(i.isMask??!1),v=new qJ(s,o,l,c,h,u,d,f,a,p,g,m),x=new Hi(v.calpha,"f");return new En(e,t,i,{texture:s,textureSize:o,crop:l,projection:c,axis:h,side:u,size:d,blending:f,mat:a,alpha:p,mode:g,isMask:m},v,g,x,m)}else if(i.type==="matcap"){let r=n.image(i.texture.image),s=new eL(r,i.texture.wrapping),o=new ft(i.alpha??1),a=new Li(i.mode??0),l=new us(i.isMask??!1),c=new $J(s,o,a,l),h=new Hi(c.calpha,"f");return new En(e,t,i,{texture:s,alpha:o,mode:a,isMask:l},c,a,h,l)}else if(i.type==="displace")if(i.displacementType==="noise"){let r=new Vo(new I(...i.offset)),s=new ft(i.scale??10),o=new ft(i.intensity??8),a=new ft(i.movement??1),l=new Li(i.noiseType??0),c=new Li(i.voronoiStyle??0),h=new ft(i.smoothness??.5),u=new ft(i.seed??0),d=new ft(i.highCut??1),f=new ft(i.lowCut??0),p=new Li(i.quality??1),g=new hK(o,a,r,c,h,u,d,f,p,s,l);return new vK(e,t,i,{offset:r,scale:s,intensity:o,movement:a,noiseType:l,voronoiStyle:c,smoothness:h,seed:u,highCut:d,lowCut:f,quality:p},g)}else throw new Error;else return ILe(e,t,i,n)}updateByOp(e,t,i){var r;let n=e;if(n.path[0]===void 0){if(n.type===0)return"type"in n.props||"category"in n.props||"visible"in n.props?((r=i.scene)==null||r.markNeedsUpdateRendererDirty(),!0):BLe(n.props,i.shared,this,t)}else if(n.path[0]==="texture")return"texture"in t||"video"in t?gK(n.props,i.shared,this):!0;return!1}dispose(){if(LLe(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof lf||t.image.deref()}}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let i=`f${this.id}_${e}`;this.hasValueByKey(i)&&t!==void 0&&(this.uniforms[i].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let i=this.getName(t);i&&e.push(i)}return e}},En=class extends Ef{constructor(e,t,i,n,r,s,o,a){super(e,t,i,n),this.params=n,this.color=r,this.mode=s,this.alpha=o,this.isMask=a}},vK=class extends Ef{constructor(e,t,i,n,r){super(e,t,i,n),this.position=r}},eh=class extends Ef{constructor(e,t,i,n,r){super(e,t,i,r),this.node=n}static createLigherLayer(e,t,i,n){let r,s=new ft(i.alpha),o=new Li(i.mode),a;if(!i.visible)r=new dK,a={};else if(i.category==="lambert"){r=new lLe;let l=new xn(n.color(i.emissive)??0),c=new us(i.occlusion??!0);a={emissive:l,occlusion:c},r.emissive=l,r.occlusion=c}else if(i.category==="toon"){r=new hLe;let l=new ft(i.shininess??30),c=new xn(n.color(i.specular)??1118481);a={shininess:l,specular:c},r.shininess=l,r.specular=c}else if(i.category==="physical"){r=new uLe;let l=new ft(i.roughness??.3),c=new ft(i.metalness??0),h=new ft(i.reflectivity??.5),u=new us(i.occlusion??!0);a={roughness:l,metalness:c,reflectivity:h,occlusion:u},r.roughness=l,r.metalness=c,r.reflectivity=h,r.occlusion=u}else{r=new cLe;let l=new ft(i.shininess??30),c=new xn(i.specular!==void 0?n.color(i.specular)??1118481:1118481),h=new us(i.occlusion??!0);a={shininess:l,specular:c,occlusion:h},r.shininess=l,r.specular=c,r.occlusion=h}return r.alpha=new ft(1),r.shadingAlpha=s,r.shadingBlend=o,a.alpha=r.shadingAlpha,a.mode=r.shadingBlend,new eh(e,t,i,r,a)}get category(){return this.node.category}};function LLe(e){let t=e instanceof Ef?e.type:e;return t==="texture"||t==="video"||t==="displace_map"||t==="matcap"}function zo(e){return{alpha:new ft(e.alpha??1),mode:new Li(e.mode??0),isMask:new us(e.isMask??!1)}}function RLe(e,t,i,n){switch(e.type){case"color":{let r=new xn(n.color??5526619),s=zo(n),o=new tL(r,s.alpha),a=new Hi(o.calpha,"f");return new En(t,i,e,{color:r,...s},o,s.mode,a,s.isMask)}case"fresnel":{let r=new xn(n.color??16777215),s=new ft(n.bias??.1),o=new ft(n.scale??1),a=new ft(n.intensity??2),l=new ft(n.factor??1),c=zo(n),h=new aLe(r,s,o,a,l,c.alpha,c.mode,c.isMask),u=new Hi(h.calpha,"f");return new En(t,i,e,{color:r,bias:s,scale:o,intensity:a,factor:l,...c},h,c.mode,u,c.isMask)}case"rainbow":{let r=new ft(n.filmThickness??30),s=new ft(n.movement??0),o=new Vo(n.wavelengths??new I(0,0,0)),a=new ft(n.noiseStrength??0),l=new ft(n.noiseScale??1),c=new Vo(n.offset??new I(0,0,0)),h=zo(n),u=new sK(r,s,o,a,l,c,h.alpha,h.isMask),d=new Hi(u.calpha,"f");return new En(t,i,e,{filmThickness:r,movement:s,wavelengths:o,noiseStrength:a,noiseScale:l,offset:c,...h},u,h.mode,d,h.isMask)}case"transmission":{let r=new ft(n.thickness??10),s=new ft(n.ior??1.5),o=new ft(n.roughness??.5),a=Tt.transmissionSize,l=Tt.transmissionRenderTarget,c=Tt.transmissionRenderTargetDepth,h=window.innerWidth,u=window.innerHeight,d=h>=u?new jr(u/h,1):new jr(1,h/u),f=zo(n),p=new cK(r,s,o,a,l,c,d,f.alpha),g=new Hi(p.calpha,"f");return new En(t,i,e,{thickness:r,ior:s,roughness:o,aspectRatio:d,...f},p,f.mode,g,f.isMask)}case"toon":{let r=new Li(n.positioning??0),s;n.colors?s=new Gd(n.colors.length,n.colors):(s=new Gd(10,new Kt(0,0,0,1)),s.value[1]=new Kt(1,1,1,1));let o;n.steps?o=new Ud(n.steps.length,n.steps):(o=new Ud(10,1),o.value[0]=0);let a=new Vo(n.source??new I(0,0,0)),l=new us(n.isWorldSpace??!0),c=new ft(n.noiseStrength??0),h=new ft(n.noiseScale??1),u=new Lc(n.shadowColor),d=new Vo(n.offset??new I(0,0,0)),f=zo(n),p=new aK(r,s,o,a,l,c,h,u,d,f.alpha),g=new Hi(p.calpha,"f");return new En(t,i,e,{positioning:r,colors:s,steps:o,source:a,isWorldSpace:l,noiseStrength:c,noiseScale:h,shadowColor:u,offset:d,...f},p,f.mode,g,f.isMask)}case"outline":{let r=new xn(n.outlineColor??16777215),s=new xn(n.contourColor??16777215),o=new ft(n.outlineWidth??.1),a=new ft(n.contourWidth??.1),l=new ft(n.outlineThreshold??.1),c=new ft(n.contourThreshold??.1),h=new ft(n.outlineSmoothing??.1),u=new ft(n.contourFrequency??.1),d=new Vo(n.contourDirection??new I(0,1,0)),f=new us(n.positionalLines??!1),p=new us(n.compensation??!0),g=Tt.normalRenderTarget,m=Tt.normalRenderTargetDepth,v=Tt.pixelRatioNode,x=Tt.resolution,w=zo(n),b=new iK(r,s,o,a,l,c,h,u,d,f,p,x,g,m,v,w.alpha),M=new Hi(b.calpha,"f");return new En(t,i,e,{outlineColor:r,contourColor:s,outlineWidth:o,contourWidth:a,outlineThreshold:l,contourThreshold:c,outlineSmoothing:h,contourFrequency:u,contourDirection:d,positionalLines:f,compensation:p,...w},b,w.mode,M,w.isMask)}case"depth":{let r=new Li(n.gradientType??0),s=new us(n.smooth??!1),o=new ft(n.near??50),a=new ft(n.far??200),l=new ft(n.isVector??1),c=new ft(n.isWorldSpace??0),h=new Vo(n.origin??new I),u=new Vo(n.direction??new I),d;n.colors?d=new Gd(n.colors.length,n.colors):(d=new Gd(2,new Kt(0,0,0,1)),d.value[1]=new Kt(1,1,1,1));let f;n.steps?f=new Ud(n.steps.length,n.steps):(f=new Ud(2,1),f.value[0]=0);let p=zo(n),g=new QJ(r,s,o,a,l,c,h,u,d,f,p.alpha,p.isMask),m=new Hi(g.calpha,"f");return new En(t,i,e,{gradientType:r,smooth:s,near:o,far:a,isVector:l,isWorldSpace:c,origin:h,direction:u,colors:d,steps:f,...p},g,p.mode,m,p.isMask)}case"noise":{let r=new ft(n.scale??1),s=new Vo(n.size??new I(100,100,100)),o=new ft(n.move??1),a=new jr(n.fA??new ge(1.7,9.2)),l=new jr(n.fB??new ge(8.3,2.8)),c=new jr(n.distortion??new ge(1,1)),h=new Lc(n.colorA),u=new Lc(n.colorB),d=new Lc(n.colorC),f=new Lc(n.colorD),p=new Li(n.noiseType??0),g=new Li(n.voronoiStyle??0),m=new ft(n.highCut??1),v=new ft(n.lowCut??0),x=new ft(n.smoothness??.5),w=new ft(n.seed??.5),b=new Li(n.quality??1),M=zo(n),A=new eK(r,s,o,a,l,c,h,u,d,f,M.alpha,p,M.isMask,g,m,v,x,w,b),T=new Hi(A.calpha,"f");return new En(t,i,e,{scale:r,size:s,move:o,fA:a,fB:l,distortion:c,colorA:h,colorB:u,colorC:d,colorD:f,noiseType:p,...M,voronoiStyle:g,highCut:m,lowCut:v,smoothness:x,seed:w,quality:b},A,M.mode,T,M.isMask)}case"normal":{let r=new Vo(n.cnormal??new I(1,1,1)),s=zo(n),o=new YJ(r,s.alpha),a=new Hi(o.calpha,"f");return new En(t,i,e,{cnormal:r,...s},o,s.mode,a,s.isMask)}case"gradient":{let r=new Li(n.gradientType??0),s=new us(n.smooth??!1),o;n.colors?o=new Gd(n.colors.length,n.colors):(o=new Gd(10,new Kt(0,0,0,1)),o.value[1]=new Kt(1,1,1,1));let a;n.steps?a=new Ud(n.steps.length,n.steps):(a=new Ud(10,1),a.value[0]=0);let l=new jr(n.offset??new ge(0,0)),c=new jr(n.morph??new ge(0,0)),h=new ft(n.angle??0),u=zo(n),d=new KJ(r,s,o,a,l,c,h,u.alpha,u.isMask),f=new Hi(d.calpha,"f");return new En(t,i,e,{gradientType:r,smooth:s,colors:o,steps:a,offset:l,morph:c,angle:h,...u},d,u.mode,f,u.isMask)}case"pattern":{let r=new Li(n.style??0),s=new Li(n.projection??0),o=new Li(["x","y","z"].indexOf(n.axis)??0),a=new ft(n.blending??0),l=new jr(n.offset??new ge(0,0)),c=new Lc(n.colorA),h=new Lc(n.colorB),u=new jr(n.frequency??new ge(10,10)),d=new ft(n.size??.5),f=new ft(n.variation??0),p=new ft(n.smoothness??.5),g=new ft(n.zigzag??0),m=new ft(n.rotation??0),v=new jr(n.vertical??new ge(0,1)),x=new jr(n.horizontal??new ge(0,1)),w=new Li(n.sides??6),b=zo(n),M=new nK(r,s,o,a,l,c,h,u,d,f,p,g,m,v,x,w,b.alpha,b.isMask),A=new Hi(M.calpha,"f");return new En(t,i,e,{style:r,projection:s,axis:o,blending:a,offset:l,colorA:c,colorB:h,frequency:u,size:d,variation:f,smoothness:p,zigzag:g,rotation:m,vertical:v,horizontal:x,sides:w,...b},M,b.mode,A,b.isMask)}default:{let r=new xn(1,0,0,1),s=zo(n),o=new tL(r,s.alpha),a=new Hi(o.calpha,"f");return new En(t,i,e,{color:r,...s},o,s.mode,a,s.isMask)}}}function ILe(e,t,i,n){let r=vLe(i,n);return RLe(i,e,t,r)}function yK(e,t,i){if(i.type==="displace"&&(e==="intensity"||e==="visible")){let n=t.uniforms[`f${t.id}_intensity`];return n?(n.value=i.intensity*(i.visible?1:0),n):void 0}if(i.type!=="displace"&&(e==="alpha"||e==="visible")){let n=t.uniforms[`f${t.id}_alpha`];if(!n)return;if(n.value=i.alpha*(i.visible?1:0),i.type==="outline"&&e==="visible"){let r=t.uniforms[`f${t.id}_compensation`];r&&(r.value=i.compensation&&i.visible)}return n}}function qS(e,t){let i=0;for(let n of e.layers){if(n.data.type!=="displace"&&n.data.isMask)return!0;if(n.data.type!=="displace"&&"alpha"in n.data&&n.data.type!=="light"&&n.data.type!=="fresnel"&&n.data.type!=="texture"&&n.data.type!=="matcap"&&n.data.type!=="rainbow"&&n.data.type!=="outline"&&n.data.type!=="pattern"){let r=n.data.visible?n.data.alpha:0;if(r===1&&n.data.type==="depth"||n.data.type==="gradient"){for(let s of n.data.colors)if(s[3]<1){r=s[3];break}}else if(r===1&&n.data.type==="noise"){let s=t.color(n.data.colorA).a,o=t.color(n.data.colorB).a,a=t.color(n.data.colorC).a,l=t.color(n.data.colorD).a,c=Math.min(s,Math.min(o,Math.min(a,l)));c<1&&(r=c)}i+=(1-i)*r}}return i<1}var Gh=class extends ji{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},OLe=class extends Gh{constructor(e,t,i,n){super(),this.flatShading=e,this.side=t,this.wireframe=i,this.root=n}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,i){return this.root.getFlavor(e,t,i)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,i){this.root.updateByOp(e,t,i)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},xK=class extends Gh{constructor(e,t){super(),this.data=e,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.reset0(e,t)}get nodeMaterial(){return this}getFlavor(e,t,i){let n=i?6:(e?3:0)+t;if(n===0)return this;this.flavors===void 0&&(this.flavors=[]),n-=1;let r=this.flavors[n];return r===void 0&&(r=new OLe(e,t,i,this),this.flavors[n]=r,r.flatShading=e,r.side=t,r.updateAfterBuild()),r}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e;return((e=this.lightLayer.getNode("occlusion"))==null?void 0:e.value)??!1}reset(e,t){this.data!==e&&this.reset0(e,t)}reset0(e,t){this.data=e;let i=e.layers??yo.defaultTwoLayerData("phong").layers;this.layers=i.map(n=>Ef.create(this.layerIdGen++,n.id,n.data,t.shared)),this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(),this.transparent=qS(e,t.shared)}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(e=>e instanceof eh),this.lightLayer===void 0&&(this.lightLayer=new eh(0,"",{...Qo.defaultData("light","phong"),visible:!1},new dK,{})),this.dispose();for(let e of this.flavors)e&&e.dispose();this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions()}updateByOp(e,t,i){var n,r,s,o;if(t!==void 0?this.data=t:t=this.data,this.transparent=qS(t,i.shared),e.path[0]==="layers"){this.data=t;let a=i.shared,l=e.path[1];if(l===void 0){if(this.layers.reverse(),e.type===4){let c=Ef.create(this.layerIdGen++,e.id,e.data,i.shared);this.layers.splice(e.localIndex,0,c),(n=i.scene)==null||n.markNeedsUpdateRendererDirty()}else if(e.type===5)this.layers.splice(e.localIndex,1)[0].dispose(),(r=i.scene)==null||r.markNeedsUpdateRendererDirty();else if(e.type===6){let c=this.layers.findIndex(u=>u.uuid===e.id),h=this.layers[c];this.layers.splice(c,1),this.layers.splice(e.localIndex,0,h),(s=i.scene)==null||s.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate()}else{e.type===0&&e.props.occlusion!==void 0&&((o=i.scene)==null||o.markNeedsUpdateRendererDirty());let c=this.layers.find(h=>h.uuid===l);if(c){let h=t.layers.data(l);if(c.updateByOp({...e,path:e.path.slice(2)},h,i)){let u=Ef.create(this.layerIdGen++,l,h,a);this.layers.splice(this.layers.findIndex(d=>d.uuid===l),1,u),this.onUpdate()}}}}else this.reset(t,i)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof En?t.color.mask=void 0:t instanceof eh&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof En&&t.isMask.value&&t.data.visible&&e>0){let i=e-1,n=this.layers[i];n instanceof eh?n.node.mask=new Ps(t.color,t.alpha,Ps.MUL):n instanceof En&&(n.isMask.value||(n.color.mask=new Ps(t.color,t.alpha,Ps.MUL)))}}}blendColors(){let e=this.layers.findIndex(i=>i instanceof En),t=this.layers.findIndex(i=>i instanceof eh);if(e!==-1&&e<t){let i=this.layers[e].color;for(let n=e+1;n<t;++n){let r=this.layers[n];if(r instanceof En){if(r.isMask.value)continue;i=new m6(i,r.color,r.alpha,r.mode)}}this.fragment.color=i}else this.fragment.color=void 0}blendAfterColors(){let e=new Hi("outgoingLight","f"),t=this.layers.findIndex(i=>i instanceof eh);if(this.layers.length>t+1){for(let i=t+1;i<this.layers.length;++i){let n=this.layers[i];if(n instanceof En){if(n.isMask.value)continue;e=new m6(e,n.color,n.alpha,n.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(t=>t instanceof vK);if(e.length>0){let t=e[0].position;for(let i=1;i<e.length;++i)e[i]&&(t=new Ps(t,e[i].position,Ps.ADD),t=new Ps(t,new ft(.5).setReadonly(!0),Ps.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(e,t){let i=(n,r,s)=>Math.min(Math.max(n,r),s);for(let n of this.layers)if(n.type==="displace"){let r=i(n.uniforms[`f${n.id}_intensity`].value,e,t);n.uniforms[`f${n.id}_intensity`].value=r}}computeCacheKey(){let e="[";for(let{data:t}of this.data.layers)if(t.type==="light")e+=`"${t.visible?t.category.toUpperCase():"Basic"}"`;else{let i=(pK[t.type]??[]).map(s=>t[s]),n=(mK[t.type]??[]).map(s=>{var o;return((o=t[s])==null?void 0:o.length)??0}),r=[...i,...n];r.length?e+=`["${t.type}", "${r.join('","')}"],`:e+=`"${t.type}",`}return e=e.slice(0,-1)+"]",e}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new rLe;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof En){let t=e.params.texture;if(t instanceof eL&&!t.image.loaded)return!1}return!0}getHash(){let e="{";return e+='"fragment":'+this.fragment.getHash(),e+="}",e}};Object.defineProperties(Gh.prototype,{properties:{get:function(){return this.fragment.properties}}});var nL=class extends xK{},FLe=x1($ge()),g6=new Map;function NLe(e){if(typeof e=="string")return e;let t=g6.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},g6.set(e,t)),t.url}var ny=class{constructor({src:e,volume:t,delay:i,loop:n}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let r;typeof e=="string"?r={src:e}:r={src:NLe(e),format:"wav"},this.sound=new FLe.Howl(r),this.sound.on("end",this.onEnd),this.src=e,t!==void 0&&(this.volume=t),i!==void 0&&(this.delay=i),n!==void 0&&(this.loop=n)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e,t=1e3){e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,i){this.sound.on(e,t,i)}off(e,t,i){this.sound.off(e,t,i)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(e=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},zLe=class{constructor(){this.type="ShapePath",this.color=new Pt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new pS,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var i;return(i=this.currentPath)==null||i.lineTo(e,t),this}quadraticCurveTo(e,t,i,n){var r;return(r=this.currentPath)==null||r.quadraticCurveTo(e,t,i,n),this}bezierCurveTo(e,t,i,n,r,s){var o;return(o=this.currentPath)==null||o.bezierCurveTo(e,t,i,n,r,s),this}splineThru(e){var t;return(t=this.currentPath)==null||t.splineThru(e),this}toShapes(){let e={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},t={loc:e.ORIGIN,t:0};function i(f,p,g,m){let v=f.x,x=p.x,w=g.x,b=m.x,M=f.y,A=p.y,T=g.y,S=m.y,C=(b-w)*(M-T)-(S-T)*(v-w),P=(x-v)*(M-T)-(A-M)*(v-w),B=(S-T)*(x-v)-(b-w)*(A-M),k=C/B,z=P/B;if(B===0&&C!==0||k<=0||k>=1||z<0||z>1)return null;if(C===0&&B===0){for(let F=0;F<2;F++)if(n(F===0?g:m,f,p),t.loc===e.ORIGIN){let W=F===0?g:m;return{x:W.x,y:W.y,t:t.t}}else if(t.loc===e.BETWEEN){let W=+(v+t.t*(x-v)).toPrecision(10),K=+(M+t.t*(A-M)).toPrecision(10);return{x:W,y:K,t:t.t}}return null}else{for(let K=0;K<2;K++)if(n(K===0?g:m,f,p),t.loc===e.ORIGIN){let Z=K===0?g:m;return{x:Z.x,y:Z.y,t:t.t}}let F=+(v+k*(x-v)).toPrecision(10),W=+(M+k*(A-M)).toPrecision(10);return{x:F,y:W,t:k}}}function n(f,p,g){let m=g.x-p.x,v=g.y-p.y,x=f.x-p.x,w=f.y-p.y,b=m*w-x*v;if(f.x===p.x&&f.y===p.y){t.loc=e.ORIGIN,t.t=0;return}if(f.x===g.x&&f.y===g.y){t.loc=e.DESTINATION,t.t=1;return}if(b<-Number.EPSILON){t.loc=e.LEFT;return}if(b>Number.EPSILON){t.loc=e.RIGHT;return}if(m*x<0||v*w<0){t.loc=e.BEHIND;return}if(Math.sqrt(m*m+v*v)<Math.sqrt(x*x+w*w)){t.loc=e.BEYOND;return}let M;m!==0?M=x/m:M=w/v,t.loc=e.BETWEEN,t.t=M}function r(f,p){let g=[],m=[];for(let v=1;v<f.length;v++){let x=f[v-1],w=f[v];for(let b=1;b<p.length;b++){let M=p[b-1],A=p[b],T=i(x,w,M,A);T!==null&&g.find(S=>S.t<=T.t+Number.EPSILON&&S.t>=T.t-Number.EPSILON)===void 0&&(g.push(T),m.push(new ge(T.x,T.y)))}}return m}function s(f,p,g){let m=new ge;p.getCenter(m);let v=[];return g.forEach(x=>{x.boundingBox.containsPoint(m)&&r(f,x.points).forEach(w=>{v.push({identifier:x.identifier,isCW:x.isCW,point:w})})}),v.sort((x,w)=>x.point.x-w.point.x),v}function o(f,p,g,m,v){(v==null||v==="")&&(v="nonzero");let x=new ge;f.boundingBox.getCenter(x);let w=[new ge(g,x.y),new ge(m,x.y)],b=s(w,f.boundingBox,p);b.sort((P,B)=>P.point.x-B.point.x);let M=[],A=[];b.forEach(P=>{P.identifier===f.identifier?M.push(P):A.push(P)});let T=M[0].point.x,S=[],C=0;for(;C<A.length&&A[C].point.x<T;)S.length>0&&S[S.length-1]===A[C].identifier?S.pop():S.push(A[C].identifier),C++;if(S.push(f.identifier),v==="evenodd"){let P=S.length%2===0,B=S[S.length-2];return{identifier:f.identifier,isHole:P,for:B}}else if(v==="nonzero"){let P=!0,B=null,k=null;for(let z=0;z<S.length;z++){let F=S[z];p[F]&&(P?(k=p[F].isCW,P=!1,B=F):k!==p[F].isCW&&(k=p[F].isCW,P=!0))}return{identifier:f.identifier,isHole:P,for:B}}else console.warn('fill-rule: "'+v+'" is currently not implemented.')}let a=0,l=999999999,c=-999999999,h=[];this.subPaths.forEach(f=>{let p=f.getPoints(),g=-999999999,m=999999999,v=-999999999,x=999999999;for(let w=0;w<p.length;w++){let b=p[w];b.y>g&&(g=b.y),b.y<m&&(m=b.y),b.x>v&&(v=b.x),b.x<x&&(x=b.x)}c<=v&&(c=v+1),l>=x&&(l=x-1),p.length&&h.push({curves:f.curves,points:p,isCW:Iq.isClockWise(p),identifier:a++,boundingBox:new q_e(new ge(x,m),new ge(v,g))})});let u=h.map(f=>{var p;return o(f,h,l,c,(p=this.userData)==null?void 0:p.style.fillRule)}),d=[];return h.forEach(f=>{let p=u[f.identifier];if(p&&!p.isHole){let g=new mS;g.curves=f.curves,u.filter(m=>(m==null?void 0:m.isHole)&&m.for===f.identifier).forEach(m=>{if(m){let v=h[m.identifier],x=new pS;x.curves=v.curves,g.holes.push(x)}}),d.push(g)}}),d}},wK,v6=new Promise(e=>{wK=e}),y6=!1;async function kLe(){if(y6)return;let e=await y1(()=>import("./opentype-fc28cde9.js"),[]);wK(e),y6=!0}var ULe=class{async load(e,t,i=()=>{}){let{load:n}=await v6;n(e,(r,s)=>{r||!s?i(r??"Something went wrong"):t(s)})}async parse(e){let{parse:t,Bidi:i}=await v6;try{let n=t(e),r=new i,s=o=>n.charToGlyphIndex(o.char);return r.registerModifier("glyphIndex",null,s),r.applyFeatures(n,n.defaultRenderOptions.features),{font:n,bidi:r}}catch(n){console.error(n)}}};async function GLe(e){return await(await fetch(e)).arrayBuffer()}var HLe=new ULe;async function x6(e){let t,i,n=!1;if(e.url?(t=await GLe(e.url),i=e.url,n=e.url.startsWith("/")):e.data&&(t=e.data.buffer),t){let r=await HLe.parse(t);if(r)return{font:r.font,url:i,intercepted:n,arr:t,bidi:r.bidi}}}function VLe(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var jLe=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=x6(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=x6(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,i){if(!this._bidi)return[];let n=this._bidi;n.getTextGlyphs(t);let r=n.tokenizer.tokens,s=[],o=0,a=i.length===r.length;for(let l=0;l<i.length;l++){let c=i[l].index,h=String.fromCharCode(i[l].unicode),u=r[o];if(VLe(c,u)||a)s.push({char:h,index:c,replacements:[u.state.glyphIndex],replacementChars:[u.char]}),o++;else{let d=u.char,f="",p=[u.state.glyphIndex],g=[],m=!1;for(;!m;)o++,f=t.charAt(o),d+=f,p.push(e.charToGlyphIndex(f)),g=e.stringToGlyphs(d),g.length===1&&g[0].index===c&&(m=!0),o>t.length&&(m=!0);s.push({char:h,index:c,replacements:p,replacementChars:Array.from(d)}),o++}}return s}generateShapes(e,t){if(!this._isLoaded)return;let i=this.font,n=t.fontSize/this.unitsPerEm,r=t.fontSize*t.lineHeight,s=e.map(v=>this.getTextWidth(v,t)),o=t.width,a=this.getCharWidth(`
`,t),l=t.horizontalAlign===1?a:0,c=this.computeSpaceWidthForLine(e,0,t),h=this.getLineInitialOffsetX(s[0],o,t.horizontalAlign,e[0],a),u=this.getLineInitialOffsetY(r,e.length,t.height,n,t.verticalAlign),d=[],f=e.map(v=>[]),p=e.map(v=>[]),g;for(let v=0;v<e.length;v++){let x=e[v],w={features:{liga:!0}},b=[];try{b=i.stringToGlyphs(x,w)}catch(A){console.warn(A)}h=this.getLineInitialOffsetX(s[v],o,t.horizontalAlign,x,a);let M=[];try{M=this.reverseLigaturesTable(i,x,b)}catch(A){console.warn(A)}c=this.computeSpaceWidthForLine(e,v,t);for(let A=0;A<b.length;A++){let T=b[A],S=T.index===0?`
`:T.unicode?String.fromCharCode(T.unicode):void 0,C=M[A],P=0,B=0;A===0&&t.horizontalAlign===2&&T.leftSideBearing!==void 0&&(B=-T.leftSideBearing*n),g&&(P=i.getKerningValue(T,g)*n),h+=B+P;let k=0;if(S===`
`)k=l;else if(S===" ")k=c;else{let z=this.createPath(T,n,h,u,t);z&&(k=z.offsetX-(P+B),d.push(z.path))}if(C.replacements.length===1)p[v].push([h,u]),f[v].push(k);else{let z=C.replacements.map(Z=>(i.glyphs.get(Z).advanceWidth??0)*n),F=z.reduce((Z,U)=>Z+=U,0),W=z.map(Z=>Z/F),K=h;for(let Z=0;Z<W.length;Z++){let U=k*W[Z];p[v].push([K,u]),f[v].push(U),K+=U}}h+=k,g=T}u-=r}let m=[];for(let v=0,x=d.length;v<x;v++)m.push(...d[v].toShapes());return{shapes:m,charWidths:f,lineWidths:s,charCoords:p}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e;return((e=this.font)==null?void 0:e.ascender)??0}get descender(){var e;return((e=this.font)==null?void 0:e.descender)??0}get familyName(){var e;return((e=this.font)==null?void 0:e.names.fontFamily)??""}get subfamilyName(){var e;return((e=this.font)==null?void 0:e.names.fontSubfamily)??""}get unitsPerEm(){var e;return((e=this.font)==null?void 0:e.unitsPerEm)??1}getLineInitialOffsetX(e,t,i,n,r){return(i===3||i===2)&&n.indexOf(`
`)>=0&&(e-=r),i===3?t*.5-e*.5:i===2?t-e:0}getLineInitialOffsetY(e,t,i,n,r){let s=t*e,o=Math.abs(this.ascender-this.descender)*n,a=e-o,l=-this.ascender*n-a/2;return r===3?-(i-s-l):r===2?-(i*.5-s*.5-l):l}createPath(e,t,i,n,r){var l;let s=e.getPath(i,-n,r.fontSize,{kerning:!1,letterSpacing:r.letterSpacing});if(!s){console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");return}let o=new zLe,a=(e.advanceWidth??1)*t;if(e)for(let c of s.commands){let h=(l=o.currentPath)==null?void 0:l.currentPoint;if(!(h&&c.type!=="Z"&&h.x===c.x&&-h.y===c.y))switch(c.type){case"M":o.moveTo(c.x,-c.y);break;case"L":o.lineTo(c.x,-c.y);break;case"Q":o.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":o.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return o.subPaths.forEach(c=>{let h=WLe(c.curves);h!==void 0&&c.currentPoint.distanceTo(h)>0&&c.lineTo(h.x,h.y)}),{offsetX:a+r.fontSize*r.letterSpacing,path:o}}getCharWidth(e,t){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}getTextWidth(e,t){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}computeSpaceWidthForLine(e,t,i){let n=this.getCharWidth(" ",i),r=e[t];if(r){let s=this.countSpaces(r.trimEnd());if(i.horizontalAlign===4&&t<e.length-1&&s){let o=i.width,a=this.getTextWidth(r,i);return(o-(a-s*n))/s}}return n}countSpaces(e){return(e.match(/ /g)||[]).length}};function WLe(e){if(e.length){let t=e[0];if(t instanceof qa)return t.v1;if(t instanceof ka||t instanceof kh)return t.v0}}var XLe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t){let i=this.objects.get(e);return i===void 0?(i=this.createObject(e,t),this.objects.set(e,i)):i.isShared=!0,i}mutateIfUnique(e,t){let i=this.objects.get(e);if(i&&i.isShared!==!0)return this.objects.delete(e),this.objects.set(t,i),i}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){let i=this.objects.get(e);t===i&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},w6=class extends XLe{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t){let i=XS(e,t,this.flatShading);return i.computeBoundingSphere(),i}},YLe={find(e){},markNeedsUpdateRendererDirty:function(){},markGeometryCacheDirty:function(){},addPendingExpandCloner:function(e){},addPendingUpdateCloner(e){},addPendingCommand(e){}},qLe=class extends gLe{constructor(e){super(),this.shared=e}create(e){return new fK(e,this.shared)}},eF=class{constructor(e,t={}){if(this.geometryCache=new w6(!0),this.geometryCache2=new w6(!1),this.imageHolderCache=new qLe(this),this.thisContext={scene:YLe,shared:this},this.deletedMaterial=new nL(yo.defaultTwoLayerData("phong"),this.thisContext),this.deletedImage=new lf(US.emptyImage,this),this.deletedVideo=new lf(LS.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.penumbraSize=[],this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[i,n]of Object.entries(t.images))this.addImage(i,n);if(t.videos)for(let[i,n]of Object.entries(t.videos))this.addVideo(i,n);if(t.audios)for(let[i,n]of Object.entries(t.audios))this.addAudio(i,n.data);this.reset(e)}setRequestRender(e){this._requestRender=e}reset(e){for(let[t,i]of Object.entries(e.images))this.addImage(t,i);for(let[t,i]of Object.entries(e.videos))this.addVideo(t,i);for(let[t,i]of Object.entries(e.colors))this.addColor(t,i);for(let[t,i]of Object.entries(e.materials))this.addMaterial(t,new nL(i,this.thisContext));for(let[t,i]of Object.entries(e.audios))this.addAudio(t,i.data);for(let[t,i]of Object.entries(e.fonts))this.addFont(t,i);this.penumbraSize=e.penumbraSize}addMaterial(e,t){t.uuid=e,this.materials[e]?(this.materials[e].reset(t.data,this.thisContext),t.dispose()):this.materials[e]=t}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return typeof e=="string"?this.getMaterialOrDeletedPlaceholder(e):new xK(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new lf(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return typeof e=="string"?this.getImage(e):this.imageHolderCache.load(e)}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new lf(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return typeof e=="string"?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new YS(t.r,t.g,t.b,t.a):this.colors[e]=new YS(t.r,t.g,t.b,1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let i=this.colors[e];return this.colors[e].r=t.r??i.r,this.colors[e].g=t.g??i.g,this.colors[e].b=t.b??i.b,this.colors[e].a=t.a??i.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}color(e){let t;if(typeof e=="string"){let i=this.getColor(e);i?t=i:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new Ws(0,0,0,0))}else return"a"in e?new Ws(e.r,e.g,e.b,e.a):new Ws(e.r,e.g,e.b,1);return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof ny)return t;{let i=new ny({src:t});return this.audios[e]=i,i}}deleteAudio(e){let t=this.audios[e];t&&(t instanceof ny&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new jLe(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof ny&&e.dispose()}),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}};new eF(GB.emptyData());var E1=class extends Ys{updateByPatchedOp(e,t,i){if(super.updateByPatchedOp(e,t,i),UPe(e.path,["materials"])!==null&&e.type===0&&Array.isArray(this.material))for(let[n,r]of Object.entries(e.props)){let s=i.shared.material(r);this.material[Number(n)]=s}else if(nh(e.path,["material"])&&this.material instanceof Gh)"material"in t&&typeof t.material!="string"&&this.material.updateByOp(fo.drop(e,1),t.material,i);else if(nh(e.path,["materials","*"])&&Array.isArray(this.material)){let n=e.path[1];if("materials"in t&&n<this.material.length){let r=t.materials[n];typeof r!="string"&&this.material[n].updateByOp(fo.drop(e,2),r,i)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(e,t){var n,r,s,o,a;super.updateState(e,t),e.castShadow!==void 0&&(this.castShadow=e.castShadow),e.receiveShadow!==void 0&&(this.receiveShadow=e.receiveShadow);let i=this.dataPatched;if(((n=e.geometry)==null?void 0:n.type)!=="NonParametricGeometry"&&"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(i.flatShading,i.side,i.wireframe),(r=t.scene)==null||r.markNeedsUpdateRendererDirty()),((s=e.geometry)==null?void 0:s.type)==="NonParametricGeometry"&&("materials"in e&&e.materials!==void 0?(this.disposeMaterial(),this.material=e.materials.map(l=>t.shared.material(l).getFlavor(i.flatShading,i.side,i.wireframe)),(o=t.scene)==null||o.markNeedsUpdateRendererDirty()):"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(i.flatShading,i.side,i.wireframe)],(a=t.scene)==null||a.markNeedsUpdateRendererDirty())),e.flatShading!==void 0||e.wireframe!==void 0||e.side!==void 0)if(Array.isArray(this.material))for(let l=0;l<this.material.length;l++)this.material[l]=this.material[l].getFlavor(i.flatShading,i.side,i.wireframe);else this.material=this.material.getFlavor(i.flatShading,i.side,i.wireframe)}disposeMaterial(){this.material&&AQ(this.material).forEach(e=>{e instanceof Gh&&(e instanceof nL||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},da=class extends E1{constructor(e,t,i){super(e,t),this.data=t,this.localGeometry=void 0}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof Ot&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof eF){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return OS.is2DParametricMesh(e.type)&&e.depth===0}get is2DType(){return OS.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),nh(e.path,["geometry"])&&this.updateByPatchedOpGeometry(fo.drop(e,1),t.geometry,i)}removeInteractionGeometry(){var e;(e=this.localGeometry)==null||e.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){var n;this.invalidateDownstreamBooleanData();let i=this.data.geometry.type;if(i==="NonParametricGeometry"||i==="SubdivGeometry"){let r=e;if(this.localGeometry===void 0){let c={...this.data.geometry,...r};this.localGeometry=XS(c,t,this.data.flatShading)}let s,o,a;r.scaleBaked?[s,o,a]=r.scaleBaked:{width:s,height:o,depth:a}=r;let l=this.localGeometry.userData;l.sxPrev!==void 0&&ZB(this.localGeometry.attributes,s/l.sxPrev,o/l.syPrev,a/l.szPrev),l.sxPrev=s,l.syPrev=o,l.szPrev=a}else{let r={...this.data.geometry,...e};(n=this.localGeometry)==null||n.dispose(),this.localGeometry=XS(r,t,this.data.flatShading)}}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand(()=>t.updateShape())}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,i){var r;let n=!1;e.type===0&&e.path.length===0&&BO(["scaleBaked"],Object.keys(e.props))&&this.geometryCreateDeleyed instanceof cs&&this.chooseGeoemtryCache(i.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(n=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(i),this.refreshAttachedPaths(i)),n||((r=i.scene)==null||r.markGeometryCacheDirty(),this.createGeometryDelayed(i)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){e.geometry!==void 0&&this.updateGeometryOnStateUpdate(e.geometry,t),super.updateState(e,t)}updateGeometryGroupsIfNeeded(){var e;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((e=this.geometry.getIndex())==null?void 0:e.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){let i=this.geometry.userData.parameters;this.is2DType?e.set(0,0,i.depth*.5):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)):e.setScalar(0),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}};function QLe(e){var o,a;if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,i=e.geometry.attributes,n=i.position.array,r=i.normal.array,s=new Float32Array(n.length);for(let l=0;l<n.length;l+=3){let c=`${n[l]}_${n[l+1]}_${n[l+2]}`,h=new I(r[l],r[l+1],r[l+2]);t.has(c)?(o=t.get(c))==null||o.normals.push(h):t.set(c,{normals:[h],result:new I})}t.forEach((l,c)=>{for(let h of l.normals)l.result.add(h);l.result.divideScalar(l.normals.length)});for(let l=0;l<n.length;l+=3){let c=`${n[l]}_${n[l+1]}_${n[l+2]}`,h=(a=t.get(c))==null?void 0:a.result;h&&(s[l]=h.x,s[l+1]=h.y,s[l+2]=h.z)}e.geometry.setAttribute("extrudeNormal",new gt(s,3))}function JLe(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,i=new Float32Array(t.length),n=new I;for(let r=0;r<t.length;r+=3)n.set(t[r],t[r+1],t[r+2]).normalize(),i[r]=n.x,i[r+1]=n.y,i[r+2]=n.z;e.geometry.setAttribute("extrudeNormal",new gt(i,3))}function tF(e){if(Array.isArray(e.material)){for(let t of e.material)if(t.getLayersOfType("outline").length===0)return}else if(!(e.material instanceof Gh)||e.material.getLayersOfType("outline").length===0)return;e instanceof da&&e.is2DAndNoDepth?JLe(e):QLe(e)}function iF(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,i=new Float32Array(t.length),n=parseInt(e.uuid.replace(/\D/g,"")),r=[si.seededRandom(n),si.seededRandom(n+1e4),si.seededRandom(n+2e4)];for(let s=0;s<t.length;s++)i[s]=r[s%3];e.geometry.setAttribute("randomColor",new zt(i,3))}QO.then(e=>{});var yl=new Vn,B0=new I;function KLe(e){let t=!1;return e.scene.objects.traverse((i,n)=>{n.type==="Mesh"&&n.geometry.type==="SubdivGeometry"&&(t=!0)}),t}var Ix=class extends da{constructor(e,t,i){super(e,t,i),this.data=t,this.hiddenMatrixOld=new Je,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let i=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}createGeometryByControls(e){var s,o,a;if(this.skipReactionUpdate===!0)return;let t=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:i,subdividedGeometry:n,subdivPointer:r}=cs.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=r,i!==void 0&&((o=this.originalGeometry)==null||o.dispose(),this.originalGeometry=i),n!==void 0&&((a=this.subdividedGeometry)==null||a.dispose(),this.subdividedGeometry=n??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,tF(this),iF(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),e.flatShading!==void 0){let i=this.material;this.material=i.getFlavor(!1,i.side,i.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(e=!1){cs.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&cs.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=cs.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=cs.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let i=this.localGeometry;this.localGeometry=this.originalGeometryNew,Ys.prototype.raycast.call(this,e,t),this.localGeometry=i}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new ua,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,i=e.boundingSphere.center;yl.setFromBufferAttribute(t),yl.getCenter(i),e.boundingSphere.radius=i.distanceTo(yl.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),yl.getSize(B0),this.hasNonUniformScale&&B0.divide(this.scale);let n={width:B0.x,height:B0.y,depth:B0.z};return this.geometry.userData.parameters=n,n}updateBoundingSphere(e){let t=this.originalGeometry;yl.min.set(e[0],e[2],e[4]),yl.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(yl.min.applyMatrix4(this.shearScaleInv),yl.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new ua);let i=t.boundingSphere.center;yl.getCenter(i),t.boundingSphere.radius=i.distanceTo(yl.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(cs.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(e=this.originalGeometry)==null||e.dispose(),(t=this.subdividedGeometry)==null||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,i){super.updateByPatchedOpGeometry(e,t,i),this.localGeometry&&this.createGeometryByControls(t)}},_6=-1,ZLe=1,$Le={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},eRe={polygon_center:0,edge:1,vertex:2},Db=(e,t)=>(i,n)=>!t||i===0||e===0?0:e*n/100,Ht=(e,t)=>{let i=Math.abs(t),n=i*-1;return(e-_6)*(i-n)/(ZLe-_6)+n};function tRe(e){let t=[],i={};for(var n=0,r=e.length;n<r;n++){var s=JSON.stringify(e[n].pos.map(o=>Math.round(o*1e4)/1e4));i[s]||(t.push(e[n]),i[s]=!0)}return t}var iRe=new I,Bb=new I,nRe=new I,rRe=new I;function dg(e,t){let i=nRe.fromArray(e),n=rRe.fromArray(t);Bb.copy(n).sub(i);let r=Bb.length();return Bb.normalize().multiplyScalar(r*.5),iRe.copy(i).add(Bb).toArray()}var Jo=new Rs,Lb=new I,QS=new I,Yd=new I;function sRe(e){let t=[];for(let i=0;i<=e.index.count;i++)if(Lb.fromArray(e.index.array,i*3),Jo.setFromAttributeAndIndices(e.attributes.position,Lb.x,Lb.y,Lb.z),Jo.getNormal(QS),Jo.getMidpoint(Yd),!(isNaN(Yd.x)||isNaN(Yd.y)||isNaN(Yd.z))){let{a:n,b:r,c:s}=Jo,o=n.toArray(),a=r.toArray(),l=s.toArray(),c=n.distanceTo(r),h=r.distanceTo(s),u=s.distanceTo(n),d=dg(o,a),f=dg(a,l),p=dg(l,o),g=[c,h,u],m=Math.max(...g),v=g.filter(b=>Math.round(b)===Math.round(m)).length>1,x=[],w=Jo.getMidpoint(Yd).toArray();m===c&&!v&&(x=[f,p,p],w=d),m===h&&!v&&(x=[d,p,p],w=f),m===u&&!v&&(x=[d,f,f],w=p),v&&(x=[d,f,p]),t.push({vertices:[o,a,l],faceCenters:x,midpoint:w,norm:Jo.getNormal(QS).toArray()})}return t}function oRe(e){let t=[],{position:i}=e.attributes;for(let n=0;n<i.count;n++){Jo.setFromAttributeAndIndices(i,n*3,n*3+1,n*3+2),Jo.getNormal(QS),Jo.getMidpoint(Yd);let r=Jo.a.toArray(),s=Jo.b.toArray(),o=Jo.c.toArray();t.push({vertices:[r,s,o],faceCenters:[dg(r,s),dg(s,o),dg(o,r)],midpoint:Yd.toArray(),norm:QS.toArray()})}return t}var aRe=4,lRe=.5,mP=e=>.5*(1-Math.cos(e*Math.PI)),cRe=class{constructor(){this.perlin=new Array(4095+1)}noise(e,t=0,i=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let m=0;m<4095+1;m++)this.perlin[m]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),i<0&&(i=-i);let n=Math.floor(e),r=Math.floor(t),s=Math.floor(i),o=e-n,a=t-r,l=i-s,c,h,u=0,d=.5,f,p,g;for(let m=0;m<aRe;m++){let v=n+(r<<4)+(s<<8);c=mP(o),h=mP(a),f=this.perlin[v&4095],f+=c*(this.perlin[v+1&4095]-f),p=this.perlin[v+16&4095],p+=c*(this.perlin[v+16+1&4095]-p),f+=h*(p-f),v+=256,p=this.perlin[v&4095],p+=c*(this.perlin[v+1&4095]-p),g=this.perlin[v+16&4095],g+=c*(this.perlin[v+16+1&4095]-g),p+=h*(g-p),f+=mP(l)*(p-f),u+=f*d,d*=lRe,n<<=1,o*=2,r<<=1,a*=2,s<<=1,l*=2,o>=1&&(n++,o--),a>=1&&(r++,a--),l>=1&&(s++,l--)}return u}noiseSeed(e){let t=(()=>{let i,n;return{setSeed(r){n=i=(r??Math.random()*4294967296)>>>0},getSeed(){return i},rand(){return n=(1664525*n+1013904223)%4294967296,n/4294967296}}})();t.setSeed(e),this.perlin=new Array(4095+1);for(let i=0;i<4095+1;i++)this.perlin[i]=t.rand()}},uRe=cRe,b6=new I,A6=new Je,S6=new sv;function M6(e){let t=!1;return e.scene.objects.traverse((i,n)=>{n.type==="Mesh"&&n.geometry.type==="TextGeometry"&&(t=!0)}),t}var _K=class extends da{constructor(e,t,i){super(e,t,i),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var t;let e=this.dataPatched;return((t=this.font)==null?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign))??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e;return(((e=this.font)==null?void 0:e.ascender)??1)*this.fontScale}get descender(){var e;return(((e=this.font)==null?void 0:e.descender)??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:i}=this;if(!(isNaN(e.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(A6.copy(i).invert(),S6.copy(e.ray).applyMatrix4(A6),S6.intersectBox(this.singleBBox,b6))){let n=b6.applyMatrix4(i),r=e.ray.origin.distanceTo(n);t.push({distance:r,point:n.clone(),object:this})}}},rs=1e-4,xl,bK,AK,SK,E6=new I,C6=new I;QO.then(e=>{xl=e,bK=[xl.get_face_center,xl.get_edge_midpoint,xl.get_vertex_position],AK=[xl.get_face_normal,xl.get_edge_normal,xl.get_vertex_normal],SK=[xl.face_count,xl.edge_count,xl.vertex_count]});var hRe=new Je,dRe=new Je,Nu=new I,Td=new I,L0=new I,gP=new I,fRe=new I,pRe=new I,Ac=new uRe,Ga=class extends VO(Ii){constructor(t,i){super(),this.parameters=i,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=t}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(t){if(this.parent===null)this.updateState(this.parameters,t);else for(let i of this.children)i instanceof fs&&i.expand()}invalidateTransform(t){this.matrixWorldNeedsUpdate=!0,this.traverse(i=>{i instanceof fs&&i.object===t&&(i.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let t of this.children)t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD())}_updateCount(t){let i;if(t!==void 0?i=t:i=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(i=0),this.parameters.type==="toObject"&&this.objectForSample){for(let r=0,s=this.children.length;r<s;++r)this.remove(this.children[0]);let n=this.children;if(n.length===i)return;if(n.length<i)for(let r=0,s=i-n.length;r<s;++r){let o=new fs(this.object);o.expand(),this.add(o)}else for(let r=0,s=n.length-i;r<s;++r)this.remove(n[r])}else{if(this.children.length===i)return;if(this.children.length<i)for(let n=0,r=i-this.children.length;n<r;++n){let s=new fs(this.object);s.expand(),this.add(s)}else for(let n=0,r=this.children.length-i;n<r;++n)this.remove(this.children[0])}}_updateRadial(t){let i=t.radial,n=i.start*si.DEG2RAD,r=i.end*si.DEG2RAD,s=n-r,o=new Er(i.rotation[0],i.rotation[1],i.rotation[2]),a;switch(i.axis){case"z":a=new I(0,0,1);break;case"y":a=new I(0,1,0);break;default:case"x":a=new I(1,0,0);break}let l=t.randomnessObject??dh.defaultData([1,1,1]).randomnessObject,c=l.noiseType==="perlin";Ac.noiseSeed(l.seed);let h=$2((0,M0.default)(l.seed)),u=Db(l.strength,this.parameters.randomness);for(let[d,f]of this.children.entries()){let p=d*(l.freqScale/10)+l.movement,g=c?Ac.noise(p):h(p,p);f.scale.x=i.scale[0]+u(d,Ht(g,l.scale[0]))||rs,f.scale.y=i.scale[1]+u(d,Ht(g,l.scale[1]))||rs,f.scale.z=i.scale[2]+u(d,Ht(g,l.scale[2]))||rs,f.position.setScalar(0);let m=s/t.count*d-n;switch(i.axis){case"x":f.rotation.set(0,m,0);break;case"y":f.rotation.set(0,0,m);break;case"z":f.rotation.set(m,0,0);break}f.translateOnAxis(a,i.radius),f.position.x+=i.position[0]+u(d,Ht(g,l.position[0])),f.position.y+=i.position[1]+u(d,Ht(g,l.position[1])),f.position.z+=i.position[2]+u(d,Ht(g,l.position[2]));let v=u(d,Ht(g,l.rotation[0])),x=u(d,Ht(g,l.rotation[1])),w=u(d,Ht(g,l.rotation[2]));i.alignment===!0?(f.rotation.x+=o.x+v,f.rotation.y+=o.y+x,f.rotation.z+=o.z+w):f.rotation.set(o.x+v,o.y+x,o.z+w)}}_updateLinear(t){if(t.type!=="linear")throw new Error;let i=t.linear,n=new Er(i.rotation[0],i.rotation[1],i.rotation[2]),r=t.randomnessObject??dh.defaultData([1,1,1]).randomnessObject,s=r.noiseType==="perlin";Ac.noiseSeed(r.seed);let o=$2((0,M0.default)(r.seed)),a=Db(r.strength,this.parameters.randomness);for(let[l,c]of this.children.entries()){let h=l*(r.freqScale/10)+r.movement,u=s?Ac.noise(h):o(h,h),d=a(l,Ht(u,r.rotation[0])),f=a(l,Ht(u,r.rotation[1])),p=a(l,Ht(u,r.rotation[2]));c.scale.x=1+(i.scale[0]-1)*l+a(l,Ht(u,r.scale[0]))||rs,c.scale.y=1+(i.scale[1]-1)*l+a(l,Ht(u,r.scale[1]))||rs,c.scale.z=1+(i.scale[2]-1)*l+a(l,Ht(u,r.scale[2]))||rs,c.rotation.x=n.x*l+d,c.rotation.y=n.y*l+f,c.rotation.z=n.z*l+p,c.position.x=i.position[0]*l+a(l,Ht(u,r.position[0])),c.position.y=i.position[1]*l+a(l,Ht(u,r.position[1])),c.position.z=i.position[2]*l+a(l,Ht(u,r.position[2]))}}_updateGrid(t){let i=0,n=t.grid,r=t.randomnessObject??dh.defaultData([1,1,1]).randomnessObject,s=Db(r.strength,this.parameters.randomness),o=r.noiseType==="perlin";Ac.noiseSeed(r.seed);let a=c3e((0,M0.default)(r.seed));if(n.useCenter===!0){let l={x:n.count[0]%2===0?2:1,y:n.count[1]%2===0?2:1,z:n.count[2]%2===0?2:1},c=new I(n.size[0]*(n.count[0]-l.x)*.5,n.size[1]*(n.count[1]-l.y)*.5,n.size[2]*(n.count[2]-l.z)*.5);for(let h=0;h<n.count[0];h++)for(let u=0;u<n.count[1];u++)for(let d=0;d<n.count[2];d++){let f=[(h+1)*(r.freqScale/10)+r.movement,(u+1)*(r.freqScale/10)+r.movement,(d+1)*(r.freqScale/10)+r.movement],p=o?Ac.noise(...f):a(...f),g=this.children[i++];g.scale.x=1+s(i,Ht(p,r.scale[0]))||rs,g.scale.y=1+s(i,Ht(p,r.scale[1]))||rs,g.scale.z=1+s(i,Ht(p,r.scale[2]))||rs;let m=s(i,Ht(p,r.rotation[0])),v=s(i,Ht(p,r.rotation[1])),x=s(i,Ht(p,r.rotation[2]));g.rotation.set(m,v,x),g.position.x=n.size[0]*h-c.x+s(i,Ht(p,r.position[0])),g.position.y=n.size[1]*u-c.y+s(i,Ht(p,r.position[1])),g.position.z=n.size[2]*d-c.z+s(i,Ht(p,r.position[2]))}}else for(let l=0;l<n.count[0];l++)for(let c=0;c<n.count[1];c++)for(let h=0;h<n.count[2];h++){let u=[(l+1)*(r.freqScale/10)+r.movement,(c+1)*(r.freqScale/10)+r.movement,(h+1)*(r.freqScale/10)+r.movement],d=o?Ac.noise(...u):a(...u),f=this.children[i++];f.scale.x=1+s(i,Ht(d,r.scale[0]))||rs,f.scale.y=1+s(i,Ht(d,r.scale[1]))||rs,f.scale.z=1+s(i,Ht(d,r.scale[2]))||rs;let p=s(i,Ht(d,r.rotation[0])),g=s(i,Ht(d,r.rotation[1])),m=s(i,Ht(d,r.rotation[2]));f.rotation.set(p,g,m),f.position.x=n.size[0]*l+s(i,Ht(d,r.position[0])),f.position.y=-n.size[1]*c+s(i,Ht(d,r.position[1])),f.position.z=-n.size[2]*h+s(i,Ht(d,r.position[2]))}}_updateToObject(t){var m;if(t.type!=="toObject")throw new Error;let{toObject:i}=t,n=new Er(i.rotation[0],i.rotation[1],i.rotation[2]),r=t.randomnessObject??dh.defaultData([1,1,1]).randomnessObject,s=r.noiseType==="perlin";Ac.noiseSeed(r.seed);let o=$2((0,M0.default)(r.seed)),a=Db(r.strength,this.parameters.randomness);if(!i.object){for(let[,v]of this.children.entries())v.position.set(0,0,0),v.scale.setScalar(1),v.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof _K)if(!((m=this.objectForSample.font)!=null&&m.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let l=this.getSubdivData(),c=[],h=v=>{let x=v.length,w=v.map(A=>A[0]).reduce((A,T)=>A+T,0),b=v.map(A=>A[1]).reduce((A,T)=>A+T,0),M=v.map(A=>A[2]).reduce((A,T)=>A+T,0);return[w/x,b/x,M/x]},u=v=>Math.round(v*1e6)/1e6;l.forEach(v=>{let x=l.filter(w=>u(v.pos[0])===u(w.pos[0])&&u(v.pos[1])===u(w.pos[1])&&u(v.pos[2])===u(w.pos[2]));x.length>1?c.push({pos:v.pos,norm:h(x.map(w=>w.norm))}):c.push(v)});let d=tRe(c);if(l.length>0){let v=Math.round(d.length*i.count/100);this._updateCount(v)}this.objectForSample.updateMatrixWorld();let f=new u3e(this.objectForSample).build(),p=$Le[i.axis],g=this.children;f.setRandomGenerator((0,M0.default)(this.object.uuid+i.seed));for(let[v,x]of g.entries()){let w=v*(r.freqScale/10)+r.movement,b=s?Ac.noise(w):o(w,w),M=a(v,Ht(b,r.rotation[0])),A=a(v,Ht(b,r.rotation[1])),T=a(v,Ht(b,r.rotation[2]));i.spreadType==="random"?f.sample(L0,gP):(d.length&&(L0.fromArray(d[v].pos),gP.fromArray(d[v].norm)),this.objectForSample instanceof Ix&&L0.applyMatrix4(hRe.copy(this.objectForSample.matrixWorld).invert())),L0.applyMatrix4(this.object.hiddenMatrix.clone().invert()),x.position.copy(L0),Nu.fromArray(p);let S=i.align==="normal"?gP:this.object.getWorldDirection(pRe),C=Td.fromArray(i.position);Td.x+=Td.x+a(v,Ht(b,r.position[0])),Td.y+=Td.y+a(v,Ht(b,r.position[1])),Td.z+=Td.z+a(v,Ht(b,r.position[2]));let P=Math.acos(S.dot(Nu)),B=fRe.crossVectors(Nu,S).normalize(),k=dRe.makeRotationAxis(B,P),z=S.clone().cross(this.object.up).normalize(),F=z.clone().cross(S).normalize(),W=new Je().makeBasis(z,S,F),K=new I(Nu.y,Nu.z,Nu.x).normalize(),Z=K.clone().cross(Nu).normalize(),U=new Je().makeBasis(K,Nu,Z).invert(),X=new Je().multiplyMatrices(W,U);x.rotation.setFromRotationMatrix(X),C.applyMatrix4(k),x.position.add(C),x.rotation.x=x.rotation.x+n.x+M,x.rotation.y=x.rotation.y+n.y+A,x.rotation.z=x.rotation.z+n.z+T,x.scale.setScalar(1),x.scale.x=x.scale.x+i.scale[0]+a(v,Ht(b,r.scale[0]))||rs,x.scale.y=x.scale.y+i.scale[1]+a(v,Ht(b,r.scale[1]))||rs,x.scale.z=x.scale.z+i.scale[2]+a(v,Ht(b,r.scale[2]))||rs,x.scale.multiply(this.object.scale),x.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let t=this.parameters.toObject.spreadType;if(t==="random")return[];if(this.objectForSample instanceof Ix){let i=this.objectForSample,n=eRe[t],r=SK[n],s=bK[n],o=AK[n],a=[],l=r(i.subdivPointerNew);for(let c=0;c<=l-1;c++){let h=s(i.subdivPointerNew,c),u=o(i.subdivPointerNew,c);E6.fromArray(h).applyMatrix4(i.matrixWorld),C6.fromArray(u),a.push({pos:E6.toArray(),norm:C6.toArray()})}return a}else return(this.objectForSample.geometry.index?sRe(this.objectForSample.geometry):oRe(this.objectForSample.geometry)).map((i,n)=>t==="polygon_center"?{pos:i.midpoint,norm:i.norm}:t==="vertex"?[{pos:i.vertices[0],norm:i.norm},{pos:i.vertices[1],norm:i.norm},{pos:i.vertices[2],norm:i.norm}]:t==="edge"?[{pos:i.faceCenters[0],norm:i.norm},{pos:i.faceCenters[1],norm:i.norm},{pos:i.faceCenters[2],norm:i.norm}]:[]).flat()}updateState(t,i){var n;if(this.parameters=iE(t),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(n=this.object.parent)==null||n.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let r=i.find(this.parameters.toObject.object);r instanceof Ys?this.objectForSample=r:this.objectForSample=void 0,this.matrix=new Je,this.hiddenMatrix=new Je,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,r&&r.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},C1=e=>{var t;return t=class extends e{},t.geometryHelper=new Jl(30,30,30),t},Rb=new sv,vP=new ua,T6=new Je,T1=(e,t,i,n,r=!1)=>{let s=t,o=e.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),vP.copy(s.boundingSphere),vP.applyMatrix4(o),i.ray.intersectsSphere(vP)===!1||(T6.copy(o).invert(),Rb.copy(i.ray).applyMatrix4(T6),s.boundingBox!==null&&Rb.intersectsBox(s.boundingBox)===!1))return;let a,l,c,h,u=s.index,d=s.attributes.position,f=s.drawRange,p,g;if(r===!1){let v=Math.max(0,f.start),x=Math.min(u.count,f.start+f.count);for(p=v,g=x;p<g;p+=3)if(l=u.getX(p),c=u.getX(p+1),h=u.getX(p+2),a=m(e,i,Rb,d,l,c,h),a){a.faceIndex=Math.floor(p/3),n.push(a);return}}else{let v=s.attributes.position,x=new I,w=new I,b=new I,M=new I,A=2,T=1/((e.scale.x+e.scale.y+e.scale.z)/3),S=T*T,C=Math.max(0,f.start),P=Math.min(v.count,f.start+f.count);for(let B=C,k=P-1;B<k;B+=A){if(x.fromBufferAttribute(v,B),w.fromBufferAttribute(v,B+1),Rb.distanceSqToSegment(x,w,M,b)>S)continue;M.applyMatrix4(e.matrixWorld);let z=i.ray.origin.distanceTo(M);z<i.near||z>i.far||n.push({distance:z,point:b.clone().applyMatrix4(e.matrixWorld),object:e})}}function m(v,x,w,b,M,A,T){let S=new I,C=new I,P=new I,B=new I,k=new I;if(S.fromBufferAttribute(b,M),C.fromBufferAttribute(b,A),P.fromBufferAttribute(b,T),w.intersectTriangle(S,C,P,!1,B)===null)return null;k.copy(B),k.applyMatrix4(v.matrixWorld);let z=x.ray.origin.distanceTo(k);return z<x.near||z>x.far?null:{faceIndex:1,distance:z,point:k.clone(),object:v}}},Ib=new I,ko=new lv,mRe=class extends b1{constructor(e){let t=new Ot,i=new Zh({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],s={},o=new Pt(15711266),a=new Pt(15711266),l=new Pt(2857471);c("n1","n2",o),c("n2","n4",o),c("n4","n3",o),c("n3","n1",o),c("f1","f2",o),c("f2","f4",o),c("f4","f3",o),c("f3","f1",o),c("n1","f1",o),c("n2","f2",o),c("n3","f3",o),c("n4","f4",o),c("p","n1",a),c("p","n2",a),c("p","n3",a),c("p","n4",a),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(u,d,f){h(u,f),h(d,f)}function h(u,d){n.push(0,0,0),r.push(d.r,d.g,d.b),s[u]===void 0&&(s[u]=[]),s[u].push(n.length/3-1)}t.setAttribute("position",new gt(n,3)),t.setAttribute("color",new gt(r,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;ko.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let i=1,n=1,r=.8;Ca("n1",t,e,ko,-i,-n,r),Ca("n2",t,e,ko,i,-n,r),Ca("n3",t,e,ko,-i,n,r),Ca("n4",t,e,ko,i,n,r);let s=r;Ca("f1",t,e,ko,-i,-n,s),Ca("f2",t,e,ko,i,-n,s),Ca("f3",t,e,ko,-i,n,s),Ca("f4",t,e,ko,i,n,s);let o=s,a=.5;Ca("u1",t,e,ko,i*.7*a,n*1.1,o),Ca("u2",t,e,ko,-i*.7*a,n*1.1,o),Ca("u3",t,e,ko,0,n*(1.1+.9*a),o),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Ca(e,t,i,n,r,s,o){Ib.set(r,s,o).unproject(n);let a=t[e];if(a!==void 0){let l=i.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],Ib.x,Ib.y,Ib.z)}}var gRe=class extends C1(mRe){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){T1(this.object,this.geometry,e,t,!0)}},rL;(e=>e.is=t=>"objectHelper"in t)(rL||(rL={}));var hE=(e,t)=>class extends hJ(e){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(i,n){this.objectHelper.raycast(i,n)}showGizmos(){for(let i in this.gizmos){let n=this.gizmos[i];n instanceof vS&&(n.visible=!0)}}updateEntityBoxSize(i,n){this.objectHelper.visible&&this.geometryHelper instanceof Jl?(i.setScalar(0),n.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(i,n)}hideGizmos(){for(let i in this.gizmos){let n=this.gizmos[i];n instanceof vS&&(n.visible=!1)}}},yP=790,tm=new I,xP=new I,wP=new ai,_P=new I,R0=new I,bP=new I,gs=class extends hE(lv,gRe){constructor(e="",t={...FS.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=Tx.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new Je,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let i=this.width,n=this.height;if(t.orthographic.autoZoom){let r=t.orthographic.autoZoomFrustumSize??yP,s=i/n,o=i>n?s:1,a=i>n?1:s;this.orthoCamera=new dS(-r*.5*o,r*.5*o,r*.5*(1/a),-r*.5*(1/a),-5e4,1e4)}else this.orthoCamera=new dS(i*-.5,i*.5,n*.5,n*-.5,-5e4,1e4);this.perspCamera=new Yr(45,i/n,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){e==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,i){typeof e=="number"&&(e=new I(e,t,i)),super.lookAt(e),this.getWorldPosition(tm),this.targetOffset=tm.distanceTo(e)}getTarget(e=new I){return this.getWorldDirection(xP),this.getWorldPosition(tm),xP.multiplyScalar(this.targetOffset),e.copy(tm).add(xP),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(tm),tm.distanceTo(e)}updateUp(){this.getWorldQuaternion(wP),_P.set(0,0,1).applyQuaternion(wP),R0.copy(Ii.DEFAULT_UP),this.isUpVectorFlipped&&R0.negate(),R0.applyQuaternion(wP),bP.copy(Ii.DEFAULT_UP).projectOnPlane(_P),this.angleOffsetFromUp=bP.angleTo(R0),this.angleOffsetFromUp*=bP.cross(R0).dot(_P)>=0?1:-1}updateTransformState(e){let t=super.updateTransformState(e);return e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),t}getViewFrontToObject(e){let t=e.getWorldPosition(new I),i=e.getWorldDirection(new I).multiplyScalar(this.targetOffset);return{position:t.clone().add(i),target:t}}getViewToObject(e){let t=e.getWorldPosition(new I),i=this.getWorldDirection(new I).multiplyScalar(this.targetOffset);return{position:t.clone().sub(i),target:t}}setViewplaneSize(e,t){if(this.aspect=e/t,this.data.type==="OrthographicCamera"&&this.data.orthographic.autoZoom){let i=this.data.orthographic.autoZoomFrustumSize??yP,n=e>t?this.aspect:1,r=e>t?1:this.aspect;this.left=-i*.5*n,this.right=i*.5*n,this.top=i*.5*(1/r),this.bottom=-i*.5*(1/r)}else this.left=-e*.5,this.right=e*.5,this.top=t*.5,this.bottom=-t*.5;this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,i,n,r,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,t,i,n,r,s):this.orthoCamera.setViewOffset(e,t,i,n,r,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(e=[]){let t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom,autoZoom:!0,autoZoomFrustumSize:yP},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return yB(t,e)}updateCameraSubtype(e,t){let i=e==="perspective"?"PerspectiveCamera":"OrthographicCamera";t.zoom!==void 0&&this.setZoom(i,t.zoom),t.near!==void 0&&this.setNear(i,t.near),t.fov!==void 0&&i==="PerspectiveCamera"&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),e.far!==void 0&&(this.far=e.far),e.orthographic!==void 0&&this.updateCameraSubtype("orthographic",e.orthographic),e.perspective!==void 0&&this.updateCameraSubtype("perspective",e.perspective),e.type!==void 0&&(this.cameraType=e.type),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),e.path.length===1&&e.type===0&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},im=new Je,vRe=new Je;function P6(e){let t=!1;return e.scene.objects.traverse((i,n)=>{var r;((r=n.geometry)==null?void 0:r.type)==="BooleanGeometry"&&(t=!0)}),t}var Wg=class extends E1{constructor(e,t,i){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Ot,this.onAfterRender=(n,r,s,o,a,l)=>{super.onAfterRender(n,r,s,o,a,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&e.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e,t=!0){var n;if(this.booleanMeshSetAddress!==-1&&!e)return;for(let r=0;r<this.children.length;r++){let s=this.children[r];s instanceof Wg&&s.recomputeBoolean(e===!0,t)}this.meshSetAddresses=[];for(let r=0;r<this.children.length;r++){let s=this.children[r];if(s instanceof Ys&&s.dataPatched.visible===!0&&((n=s.geometry.attributes.position)==null?void 0:n.count)>0&&s.geometry.drawRange.count>0){if(im.multiplyMatrices(s.hiddenMatrix,s.matrix),s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=$u.getMeshSet(s.geometry,e===!0,t)),s.booleanMeshSetAddress===-1)return;$u.transformMeshSet(s.booleanMeshSetAddress,im),s.booleanMatrixInvOld.copy(im).invert(),s.booleanWasTransformed=!1}else s instanceof Wg&&s.needsTransformForDownstream===!0?($u.transformMeshSet(s.booleanMeshSetAddress,im),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&($u.transformMeshSet(s.booleanMeshSetAddress,vRe.multiplyMatrices(im,s.booleanMatrixInvOld)),s.booleanMatrixInvOld.copy(im).invert(),s.booleanWasTransformed=!1);this.meshSetAddresses.push(s.booleanMeshSetAddress)}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new gt([],0)),this.geometry.setDrawRange(0,0);return}if(e===!0)return $u.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let i=this.geometry;i.dispose(),this.geometry=new Ot,this.geometry.userData=i.userData,this.geometry.boundingSphere=i.boundingSphere;try{this.booleanMeshSetAddress=$u.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(r){this.booleanMeshSetAddress=0,console.error(r)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,tF(this),iF(this)}dispose(){super.dispose(),this.geometry.dispose()}},sL;(e=>{function t(i){return Ei.is(i)&&i instanceof A1}e.is=t})(sL||(sL={}));var nF=(e,t)=>class extends hE(e,t){updateState_Light(i,n){this.updateState_Entity(i,n),i.color!==void 0&&(this.color=n.shared.color(i.color)),i.intensity!==void 0&&(this.intensity=i.intensity),i.depth!==void 0&&(this.shadow.camera.far=i.depth,this.shadow.needsUpdate=!0),i.shadows!==void 0&&(this.castShadow=i.shadows)}},Ol=e=>e instanceof Ys,Yc=e=>e!==null&&e instanceof Wg,yRe=e=>e instanceof gs,xRe=e=>sL.is(e),D6=e=>rL.is(e),rF=class extends C1(Z_e){constructor(e,t=15){super(t),this.object=e,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}raycast(e,t){T1(this.object,rF.geometryHelper,e,t)}update(){}},JS=class extends hE(Nm,rF){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},MK=class extends C1(K_e){constructor(e,t=15,i=10066329){super(e,t,i),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){T1(this.object,MK.geometryHelper,e,t)}},EK=class extends C1(J_e){constructor(e,t=15,i=6710886){super(e,t,i),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){T1(this.object,EK.geometryHelper,e,t)}},oL=class extends C1(Q_e){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){T1(this.object,oL.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=oL._vector,t=this.object.distance?this.object.distance:1e3,i=t*Math.tan(this.object.angle);this.cone.scale.set(i,i,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let n=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let r=0,s=this.cone.material.length;r<s;r++)this.cone.material[r].color.set(n);else this.cone.material.color.set(n)}}},CK=oL;CK._vector=new I;function wRe(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var _Re=class extends nF(j_e,MK){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.top=1250,n.bottom=-1250,n.right=1250,n.left=-1250,n.near=-1e4,n.far=2500;let r=new gS(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof gS&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let i=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;e.size!==void 0&&wRe(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),i&&this.update()}},bRe=class extends nF(H_e,EK){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=90,n.aspect=1,n.near=100,n.far=2500;let r=new I(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),s=new I(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z),o=new Vn(r,s),a=new vS(o,new Pt(16755200));a.visible=!1,this.gizmos.shadowmap=a,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof vS){let i=this.shadow.camera,n=new I(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),r=new I(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z);t.box.set(n,r),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},B6=new I,L6=new I,R6=new ai,ARe=class extends nF(U_e,CK){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=si.RAD2DEG*2*this.angle,n.aspect=1,n.near=100,n.far=2500;let r=new gS(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof gS&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),L6.setFromMatrixPosition(this.matrixWorld),R6.setFromRotationMatrix(this.matrixWorld),B6.copy(this.up).applyQuaternion(R6).negate().multiplyScalar(this.distance),this.target.position.copy(L6).add(B6),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},SRe=class extends da{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");i!==void 0?JO(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},sF=class extends da{constructor(e,t,i){super(e,t,i),this._shapeId=null,this._context=i}updateState(e,t){super.updateState(e,t),this.updateShape()}updateShape(){var n;let e=this.data.geometry.extrusion.shape,t;if(e.type==="Custom"){let r=e.shapeId;if(r!==this._shapeId&&this.detachShape(),r){this._shapeId=r;let s=this._context.scene.find(r);s!=null&&s.data&&(s.attachedPaths.add(this),t=(n=s.geometry.userData)==null?void 0:n.shape),t||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let r;switch(e.type){case"Rectangle":r=BJ;break;case"Ellipse":r=qO;break;case"Polygon":r=DJ;break;case"Star":r=LJ;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=r.create({parameters:e}).userData.shape}let i=this.geometry;t&&i.inputs&&(i.inputs.shapeData=t,i.build(),this.attachedSurfaceCloners.forEach(r=>r.update()))}detachShape(){var e;this._shapeId!==null&&((e=this._context.scene.find(this._shapeId))==null||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e){return super.updateTransformState(e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");i!==void 0?JO(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},fg=class extends hE(Nm,rF){constructor(e,t,i){super(),t.type==="Instance"&&typeof e=="string"&&(t=this.transformAssignData(t,i)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(e,t){let i=t.scene.data.objects.get(e.component);if(i){let n,r;for(let s of Vg.rootOverrideProps)e[s]===void 0?(n===void 0&&(n={...e}),n[s]=i.data[s]):(r===void 0&&(r={}),r[s]=e[s]);return this.overrideData=r,n??e}return e}updateByOp(e,t,i,n){let r;if(this.isInstanceRoot&&!n&&(t=this.transformAssignData(t,i),e.type===0&&e.path.length===0&&this.component))for(let s of Vg.rootOverrideProps)s in e.props&&e.props[s]===void 0&&(r===void 0&&(r={...e,props:{...e.props}}),r.props[s]=this.component.data[s]);super.updateByOp(r??e,t,i,n)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(this.component===void 0){this.component=e.scene.find(t.component)??null;let i=!1;if(this.component!==this.oldComponent){if(this.oldComponent){let n=0;for(let r of this.children)if(Ei.is(r))e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),oF(r),n+=1;else break;this.children.splice(0,n)}i=!0}this.component&&TK(e,[this.uuid],t.overrides,this,this.component,this.component,0,i),this.oldComponent=this.component}}};function oF(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let i of e.children)Ei.is(i)&&oF(i)}}function I6(e,t,i,n){return e.component===t&&BO(e.identity,n)?e.overrideData===i?2:1:0}function TK(e,t,i,n,r,s,o,a){if(o>50)return!1;if(n.component!==r){if(n.component){let c=n.component.instances.indexOf(n);c>=0&&n.component.instances.splice(c,1)}r.instances.push(n),n.component=r}r instanceof fg&&r.isInstanceRoot&&r.expandInstanceChildren(e);let l=0;for(let c of r.children)if(Ei.is(c)){let h=[...t,...typeof c.identity=="string"?[c.identity]:c.identity],u=NS.resolve(i,h,1),d=null,f;if(!a){let p=n.children[l];if(d=Ei.is(p)?p:null,d!==null){let g=I6(d,c,u,h);f=g>=1?d.stateSelection:void 0,g!==2&&(d=null)}if(d===null&&(d=e.scene.findInstance(h)??null,d!==null)){let g=I6(d,c,u,h);if(f=g>=1?d.stateSelection:void 0,g!==2)d=null;else{let m=d.parent.children.indexOf(d);d.parent.children.splice(m,1),n.children.splice(l,0,d),d.parent===n?m<=l&&console.error("not possible"):(d.parent=n,d.matrixWorldNeedsUpdate=!0,d.resetBBoxNeedsUpdate(),d.updateVisible(),e.pendingDeletes.delete(d))}}}if(d===null){let p=u?Af.apply(c.data,u):c.data;Gf.is(p.type)&&(p={...p,type:"Empty"}),d=fh.createEntity(h,p,e),d.overrideData=u,n.add(d),n.children.splice(n.children.length-1,1),n.children.splice(l,0,d),d.updateState(d.data,e),f&&d.changeSelectedState(f,e),e.scene.registerInstanceAndSetUuid(d)}l+=1,TK(e,t,i,d,c,s,o+1,a)}if(!a){let c=l;for(;;){let h=n.children[l];if(Ei.is(h))e.pendingDeletes.add(h);else break;l+=1}n.children.splice(c,l-c)}return!0}function MRe(e,t,i){let n;return t.geometry.type==="TextGeometry"?new _K(e,t,i):(t.geometry.type==="SubdivGeometry"?n=new Ix(e,t,i):t.geometry.type==="PathGeometry"?n=new sF(e,t,i):t.geometry.type==="VectorGeometry"?n=new SRe(e,t,i):t.geometry.type==="BooleanGeometry"?n=new Wg(e,t,i):n=new da(e,t,i),n)}function aF(e,t,i){return t.type==="Mesh"?MRe(e,t,i):t.type==="Empty"?new JS(e,t):t.type==="PointLight"?new bRe(e,t,i):t.type==="SpotLight"?new ARe(e,t,i):t.type==="DirectionalLight"?new _Re(e,t,i):t.type==="Component"||t.type==="Instance"?new fg(e,t,i):Gf.is(t.type)?new gs(e,t):(console.error(t),new JS(e,t))}fh.createEntity=aF;function ERe(e,t,i){let n=aF(e.identity,t,i),r=e.children,s=e.attachedPaths,o=e.parent,a=e.component,l=e.instances,c=e.overrideData,h=e.uuid,u=e.stateSelection;e.dispose();for(let d of Object.keys(e))delete e[d];Object.setPrototypeOf(e,Object.getPrototypeOf(n));for(let d of Object.keys(n))e[d]=n[d];e.children=[...e.children,...r],e.attachedPaths=s,e.parent=o,e.component=a,e.instances=l,e.uuid=h,e.overrideData=c,e.updateState(e.data,i),u&&e.changeSelectedState(u,i),e.resetBBoxNeedsUpdate()}fh.changeEntityProptotype=ERe;fh.Cloner=Ga;function CRe(e,t,i,n){e.updateByOp(t,i,n,!1)}function O6(e,t){let i=!1,n=t.getLayersOfType("transmission"),r=t.getLayersOfType("outline");return r.length>0&&(e.layers.set(8),n.length>0&&e.layers.enable(3),i=!0,iF(e),tF(e)),n.length===0&&r.length===0&&e.layers.set(0),e instanceof E1&&e.needsAO&&e.layers.enable(5),i}function F6(e,t){if(!t.layers)return!1;let i=!1,n=t.getLayersOfType("transmission").filter(s=>s.data.visible),r=t.getLayersOfType("outline").filter(s=>s.data.visible);return n.length>0&&(e.layers.set(3),r.length>0&&e.layers.enable(8),i=!0),n.length===0&&r.length===0&&e.layers.set(0),e.needsAO&&e.layers.enable(5),i}function TRe(e){let t=!1;return e.traverseEntity(i=>{if(i instanceof E1)if(Array.isArray(i.material))for(let n=0;n<i.material.length;n++)O6(i,i.material[n])&&(t=!0);else O6(i,i.material)&&(t=!0)}),t}function PRe(e){let t=!1;return e.traverseEntity(i=>{if(i instanceof E1)if(Array.isArray(i.material))for(let n=0;n<i.material.length;n++)F6(i,i.material[n])&&(t=!0);else F6(i,i.material)&&(t=!0)}),t}var DRe=new Uq,BRe=new Je,LRe=new sv;function N6(e,t,i,n=!1){let r=e.cloner;if(r)for(let s of r.children){let o=BRe.copy(s.matrixWorld).invert(),a=LRe.copy(t.ray).applyMatrix4(o),l=e.matrixWorld;a.applyMatrix4(l);let c=DRe;c.set(a.origin,a.direction),c.near=t.near,c.far=t.far;let h=c.intersectObject(e,!1);h.length>0&&i.push({...h[0],object:n?s:e})}}var RRe=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,IRe=Wt.lights_fragment_begin,ORe=Wt.shadowmask_pars_fragment,z6=!1,FRe=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},NRe=(e="medium")=>{if(z6)return;z6=!0;let t=FRe(e);Wt.shadowmap_pars_fragment=RRe(t);let i=IRe.slice();i=i.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),i=i.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),Wt.lights_fragment_begin=i;let n=ORe.slice();n=n.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),Wt.shadowmask_pars_fragment=n},zRe=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;

void main()
{
vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
}
`,kRe=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,AP=new ji({vertexShader:zRe,fragmentShader:kRe,uniforms:{depthContrast:{value:1}}}),URe=class{constructor(){this._constraints=new Map}setConstraint(e,t){t===null?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((i,n)=>{let r=[n,i],s=i;for(;this._constraints.has(s);)s=this._constraints.get(s),t.has(s)||r.push(s);for(let o=r.length-2;o>=0;o--)if(!t.has(r[o])){let a=e.find(r[o]);a?a.applyPathSnapping(e):console.warn(`missing entity ${r[o]}`),t.add(r[o])}})}findDependency(e,t){let i=e;for(;this._constraints.has(i);)if(i=this._constraints.get(i),i===t)return!0;return!1}},aL=new ov;aL.wireframe=!0;var k6=new I,PK=class extends bf{constructor(e,t){super(),this.data=e,this.backupFog=new Mq(16777215,.1,2e3),this.fogUseBGColor=!1,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.occlusion=!1,this.aoFullRes=!1,this.radius=128,this.bias=.5,this.aoColor={r:0,g:0,b:0},this.geometryCacheChanged=!1,this.bgColor=new Ws(1,1,1,1),this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new URe,this.needsRecomputeInstances=!1,this.ambientLight=new z_e(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.personalCamera=this.createPersonalCamera(),this.activeCamera=this.personalCamera,this.postprocessing=e.postprocessing,this.init(e,t),this.matrixAutoUpdate=!1}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=PRe(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=TRe(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),i=this.entityIdentityToEntity[t];i&&(e.uuid=i.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let i=[],n=t;for(;n!==this;){let r=n;n=n.parent;let s=n.children.indexOf(r);i.splice(0,0,s)}return{entity:t,sortKey:i}}getAllSorted(e){let t=[];for(let i of e){let n=this.getWithSortKey(i.id);n!==void 0&&t.push(n)}return t.sort((i,n)=>_Pe(i.sortKey,n.sortKey)),t.map(i=>i.entity)}nonExistOrDescendantOf(e,t){let i=this.find(e);if(i===void 0)return!0;for(;i;){if(i.uuid===t)return!0;i=i.parent}return!1}find(e){if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}debugEnsureEntity(e){let t=this.find(e);if(t){if(Array.isArray(t.identity)&&this.findInstance(t.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(t=>{this.toExpandCloner.add(t)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{var t;(t=e.cloner)==null||t.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateTreeByOp(e,t){var i;if(e.path.length===0&&e.type===7){let n=e.parent===null?this:this.find(e.parent);if(n===void 0)throw new Error("unexpected");let r=this.createObject(e.id,e.data,e.children,n,e.localIndex,t);r.updateVisible(),r.resetBBoxNeedsUpdate(),Ol(r)&&Yc(r.parent)&&(r.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(r),this.markToExpandCloner(r)}else if(e.path.length===0&&e.type===8){let n=this.find(e.id);if(n===void 0)throw new Error("unexpected");this.markToExpandCloner(n),n.resetBBoxNeedsUpdate(),this.unregisterObject(n);let r=n.parent;this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(n),n.parent.remove(n),Yc(n.parent)&&(n.parent.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),Ol(n)&&(n.freeBooleanPointer(),r instanceof Wg&&r.invalidateDownstreamBooleanData().recomputeBoolean()),n instanceof sF&&n.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),this.pathConstraints.removeDependencies(n.uuid)}else if(e.path.length===0&&e.type===9){let n=this.find(e.id);if(n===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(n);let r=n.parent;this.markNeedsRecomputeInstancesForAncessors(r),(i=n.cloner)==null||i.resetOnMove(),this.markToExpandCloner(n);let s=e.parent===null?this:this.find(e.parent);if(s===void 0)throw new Error("unexpected");s.add(n),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(n),n.invalidateClonerTransform(n),n.updateVisible(),n.resetBBoxNeedsUpdate();let o=e.localIndex;s.children.splice(o,0,s.children.pop()),Ol(n)&&(n.invalidateUpstreamBooleanData(),Yc(n.parent)?n.parent.invalidateDownstreamBooleanData().recomputeBoolean():r instanceof Wg&&r.invalidateDownstreamBooleanData().recomputeBoolean())}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}updateEntityByOp(e,t,i,n){if(t.type===0){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),t.path.includes("overrides")&&"states"in t.props){let{rest:s}=t.props;t={...t,props:s},this.markNeedsRecomputeInstances()}t.path[0]==="pathSnapping"&&t.props.pathId!==void 0&&this.pathConstraints.setConstraint(e,t.props.pathId)}let r=this.find(e);if(r)try{CRe(r,t,i,{scene:this,shared:n}),r instanceof da&&r.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}get enableFog(){return this.fog!==null}set enableFog(e){this.fog=e===!0?this.backupFog:null}init(e,t){if(this.createChildrenObjects(e.objects,this,t),this.personalCamera.removeFromParent(),this.add(this.personalCamera),this.ambientLight.removeFromParent(),this.add(this.ambientLight),this.setBackgroundColor(qr(e.backgroundColor,t)),this.updateFog(e.fog,t),this.updateAmbientLight(e.environment.ambientLight,t),this.activeCamera=this.personalCamera,e.publish.playCamera!==null){let i=this.find(e.publish.playCamera);i instanceof gs&&this.switchActiveCamera(i)}this.expandInstances(t,!0),this.traverseEntity(i=>{Yc(i)&&i.recomputeBoolean(),i instanceof gs&&i.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(t=>{(t.data.type==="Component"||t.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){Ei.is(e)&&(e.data.type==="Component"&&this.markNeedsRecomputeInstances(),e.traverseAncestors(t=>{Ei.is(t)&&t.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,i,n,r,s,o){e&&e!==n.uuid&&n.find(e)&&r.forInstancesRec(a=>{a.isInstanceRoot||(a.data=CS(a.data,l=>{let c=l.events.data(o.id),h=a.goUp(s);if(h){let u=[...AQ(h.identity),e].join("-"),d=this.entityIdentityToEntity[u];if(d){let f=d.uuid;jl.zoom(c,t)[i]=f}else console.warn("cannot find instance")}}).data)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof fg&&typeof e.identity=="string"&&e.data.type==="Component")return e.traverseEntity((t,i)=>{t.data.events.forEach(n=>{n.data.type==="GameControl"?t.forInstancesRec(r=>{r.isInstanceRoot||(r.data=CS(r.data,s=>{s.events.delete(n.id)}).data)}):n.data.type==="Conditional"?(n.data.condition.type==="Distance"?(this.relativeizeInner(n.data.condition.fromObject,["condition"],"fromObject",e,t,i,n),this.relativeizeInner(n.data.condition.toObject,["condition"],"toObject",e,t,i,n)):n.data.condition.type==="State"?this.relativeizeInner(n.data.condition.object,["condition"],"object",e,t,i,n):n.data.condition.type==="Comparison"&&(n.data.condition.lOperand.type==="Property"&&this.relativeizeInner(n.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,i,n),n.data.condition.rOperand.type==="Property"&&this.relativeizeInner(n.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,i,n)),n.data.inActions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["inActions",r.id],"object",e,t,i,n)}),n.data.outActions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["outActions",r.id],"object",e,t,i,n)})):"actions"in n.data&&n.data.actions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["actions",r.id],"object",e,t,i,n)})})}),!0})}expandInstances(e,t){let i=new Set;this.traverseEntity(n=>{if(n instanceof fg&&n.isInstanceRoot)return n.expandInstanceChildren({scene:this,shared:e,pendingDeletes:i}),t||n.resetBBoxNeedsUpdate(),!0});for(let n of i)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),oF(n)}recomputeInstances(e){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(t=>{t instanceof fg&&t.isInstanceRoot&&(t.component=void 0)}),this.expandInstances(e,!1))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(t=>{let i=typeof t.identity=="string"?t.identity:t.identity.join("-");this.entityIdentityToEntity[i]===t&&(delete this.entityByUuid[t.uuid],delete this.entityIdentityToEntity[i]),t.dispose()})}clearScene(){for(let e of this.children)Ei.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}createPersonalCamera(){let e=new gs(PK.PERSONAL_CAMERA_ID,{...FS.defaultData,name:"Personal Camera"});return e.objectHelper.visible=!1,this.registerObjectCreatedInLegacy(e),e}raycast(e){let t=[],i=n=>{for(let r of n.children){let s=r.cloner;Ei.is(r)&&!r.raycastLock&&(r.visible||s!=null&&s.object.data.visible)&&((Ol(r)||D6(r)&&this.enableHelpers&&r.objectHelper.visible)&&(e.intersectObject(r,!1,t),N6(r,e,t)),i(r))}};return i(this),t}raycastWithClones(e){let t=[],i=n=>{for(let r of n.children){let s=r.cloner;Ei.is(r)&&(r.visible||s!=null&&s.object.data.visible)&&((Ol(r)||D6(r)&&this.enableHelpers&&r.objectHelper.visible)&&(e.intersectObject(r,!1,t),N6(r,e,t,!0)),i(r))}};return i(this),t}forEachEntity(e){for(let t of this.children)Ei.is(t)&&e(t)}traverseEntity(e){for(let t of this.children)Ei.is(t)&&t.traverseEntity(e)}traverseObject(e){for(let t of this.children)jS.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)Ei.is(t)&&t.visible&&t.traverseVisibleEntity(e)}updateFog(e,t){this.enableFog=e.enabled,this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=qr(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}dispose(){this.clearScene()}updateAmbientLight(e,t){e.color!==void 0&&(this.ambientLight.color=qr(e.color,t)),e.intensity!==void 0&&(this.ambientLight.intensity=e.intensity),e.groundColor!==void 0&&(this.ambientLight.groundColor=qr(e.groundColor,t)),e.enabled!==void 0&&(this.ambientLight.visible=e.enabled),e.occlusion!==void 0&&(this.occlusion=e.occlusion),e.aoFullRes!==void 0&&(this.aoFullRes=e.aoFullRes),e.radius!==void 0&&(this.radius=e.radius),e.bias!==void 0&&(this.bias=e.bias),e.aoColor!==void 0&&(this.aoColor=qr(e.aoColor,t))}switchActiveCamera(e){this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1}setBackgroundColor(e){this.bgColor=e,this.fogUseBGColor===!0&&(this.backupFog.color=e)}createChildrenObjects(e,t,i){let n=0;for(let r of e)this.createObject(r.id,r.data,r.children,t,n,i),n+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,i,n,r,s){var l;let o={scene:this,shared:s},a=aF(e,t,o);return a&&(this.entityByUuid[e]=a,n.add(a),n.children.splice(r,0,n.children.pop()),i.length>0&&(a.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(i,a,s)),a.updateState(t,o),a instanceof da&&a.updateGeometryGroupsIfNeeded(),a.updateVisible(),a.cloner&&this.toExpandCloner.add(a),(l=t.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),a}getCenter(e){let t=[];for(let n=0,r=e.length;n<r;++n){let{id:s,recursive:o}=e[n],a=this.find(s),l=o?a.recursiveBBox:a.singleBBox;t.push(...l.vertices)}let i=new Vn;return i.setFromPoints(t),i.getCenter(k6),k6}copyMatrixWorld(e,t){if(e===null){t.identity();return}let i=this.find(e);i?t.copy(i.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var n;if(e===null){t.identity();return}let i=(n=this.find(e))==null?void 0:n.parent;i?t.copy(i.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof Ys)if(Array.isArray(t.material))for(let i=0;i<t.material.length;i++)t.material[i]instanceof Gh&&e(t.material[i]);else t.material instanceof Gh&&e(t.material)})}updateCanvasSize(e,t){this.activeCamera.setViewplaneSize(e,t);let i,n;e>=t?(i=t/e,n=1):(i=1,n=e/t),this.traverseMaterial(r=>{r.getLayersOfType("transmission").forEach(s=>{s.uniforms[`f${s.id}_aspectRatio`].value.x=i,s.uniforms[`f${s.id}_aspectRatio`].value.y=n})})}},sa=PK;sa.PERSONAL_CAMERA_ID="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera",sa.PERSONAL_CAMERA_EXPORT_ID="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCameraExport";var _A=(e,t)=>{let i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},GRe=(e,t)=>{let i=t.x-e.x,n=t.y-e.y;return VRe(Math.atan2(n,i))},HRe=(e,t,i)=>{let n={x:0,y:0};return i=lL(i),n.x=e.x-t*Math.cos(i),n.y=e.y-t*Math.sin(i),n},lL=e=>e*(Math.PI/180),VRe=e=>e*(180/Math.PI),jRe=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,SP=new Map,U6=e=>{SP.has(e)&&clearTimeout(SP.get(e)),SP.set(e,setTimeout(e,100))},KS=(e,t,i)=>{let n=t.split(/[ ,]+/g),r;for(let s=0;s<n.length;s+=1)r=n[s],e.addEventListener?e.addEventListener(r,i,!1):e.attachEvent&&e.attachEvent(r,i)},G6=(e,t,i)=>{let n=t.split(/[ ,]+/g),r;for(let s=0;s<n.length;s+=1)r=n[s],e.removeEventListener?e.removeEventListener(r,i):e.detachEvent&&e.detachEvent(r,i)},DK=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),H6=()=>{if(typeof window>"u")return;let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},cL=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},lF=(e,t,i)=>{let n=BK(e);for(let r in n)if(n.hasOwnProperty(r))if(typeof t=="string")n[r]=t+" "+i;else{let s="";for(let o=0,a=t.length;o<a;o+=1)s+=t[o]+" "+i+", ";n[r]=s.slice(0,-2)}return n},WRe=(e,t)=>{let i=BK(e);for(let n in i)i.hasOwnProperty(n)&&(i[n]=t);return i},BK=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(i){t[i+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},MP=(e,t)=>{for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},XRe=(e,t)=>{let i={};for(let n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)?i[n]=t[n]:e.hasOwnProperty(n)&&(i[n]=e[n]);return i},uL=(e,t)=>{if(e.length)for(let i=0,n=e.length;i<n;i+=1)t(e[i]);else t(e)},YRe=(e,t,i)=>({x:Math.min(Math.max(e.x,t.x-i),t.x+i),y:Math.min(Math.max(e.y,t.y-i),t.y+i)});typeof window<"u"&&(LK="ontouchstart"in window,RK=!!window.PointerEvent,IK=!!window.MSPointerEvent);var LK,RK,IK,I0={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Vm,Ox={};RK?Vm=I0.pointer:IK?Vm=I0.MSPointer:LK?(Vm=I0.touch,Ox=I0.mouse):Vm=I0.mouse;function ip(){}ip.prototype.on=function(e,t){var i=this,n=e.split(/[ ,]+/g),r;i._handlers_=i._handlers_||{};for(var s=0;s<n.length;s+=1)r=n[s],i._handlers_[r]=i._handlers_[r]||[],i._handlers_[r].push(t);return i};ip.prototype.off=function(e,t){var i=this;return i._handlers_=i._handlers_||{},e===void 0?i._handlers_={}:t===void 0?i._handlers_[e]=null:i._handlers_[e]&&i._handlers_[e].indexOf(t)>=0&&i._handlers_[e].splice(i._handlers_[e].indexOf(t),1),i};ip.prototype.trigger=function(e,t){var i=this,n=e.split(/[ ,]+/g),r;i._handlers_=i._handlers_||{};for(var s=0;s<n.length;s+=1)r=n[s],i._handlers_[r]&&i._handlers_[r].length&&i._handlers_[r].forEach(function(o){o.call(i,{type:r,target:i},t)})};ip.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=XRe(t.options,e))};ip.prototype.bindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[t]=function(){typeof i["on"+t]=="function"?i["on"+t].apply(i,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},KS(e,Vm[t],i._domHandlers_[t]),Ox[t]&&KS(e,Ox[t],i._domHandlers_[t]),i};ip.prototype.unbindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},G6(e,Vm[t],i._domHandlers_[t]),Ox[t]&&G6(e,Ox[t],i._domHandlers_[t]),delete i._domHandlers_[t],this};var cF=ip;function or(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=or.id,or.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}or.prototype=new cF;or.constructor=or;or.id=0;or.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};or.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=WRe("borderRadius","50%"),i=lF("transition","opacity",e),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},MP(n.el,i),this.options.shape==="circle"&&MP(n.back,t),MP(n.front,t),this.applyStyles(n),this};or.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var i in e[t])this.ui[t].style[i]=e[t][i];return this};or.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};or.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};or.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};or.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};or.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var i=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=i,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let i=t.options.restJoystick,n={};n.x=i===!0||i.x!==!1?0:t.instance.frontPosition.x,n.y=i===!0||i.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,n)}return t};or.prototype.setPosition=function(e,t){var i=this;i.frontPosition={x:t.x,y:t.y};var n=i.options.fadeTime+"ms",r={};r.front=lF("transition",["top","left"],n);var s={front:{}};s.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"},i.applyStyles(r),i.applyStyles(s),i.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(i),i.restCallback()},i.options.fadeTime)};or.prototype.restCallback=function(){var e=this,t={};t.front=lF("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};or.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};or.prototype.computeDirection=function(e){var t=e.angle.radian,i=Math.PI/4,n=Math.PI/2,r,s,o;if(t>i&&t<i*3&&!e.lockX?r="up":t>-i&&t<=i&&!e.lockY?r="left":t>-i*3&&t<=-i&&!e.lockX?r="down":e.lockY||(r="right"),e.lockY||(t>-n&&t<n?s="left":s="right"),e.lockX||(t>0?o="up":o="down"),e.force>this.options.threshold){var a={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(a[l]=this.direction[l]);var c={};this.direction={x:s,y:o,angle:r},e.direction=this.direction;for(l in a)a[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+s,e),c.y||this.trigger("plain:"+o,e),c.angle||this.trigger("dir dir:"+r,e)}else this.resetDirection();return e};var qRe=or;function Bn(e,t){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=e,i.id=Bn.id,Bn.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(t),(i.options.mode==="static"||i.options.mode==="semi")&&(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);let n=getComputedStyle(i.options.zone.parentElement);return n&&n.display==="flex"&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}Bn.prototype=new cF;Bn.constructor=Bn;Bn.id=0;Bn.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(i){if(i===void 0)return t[0];for(var n=0,r=t.length;n<r;n+=1)if(t[n].identifier===i)return t[n];return!1}};Bn.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};Bn.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var i=e.createNipple(t.position,e.manager.getIdentifier());i.add(),e.idles.push(i)}};Bn.prototype.createNipple=function(e,t){var i=this,n=i.manager.scroll,r={},s=i.options,o={x:i.parentIsFlex?n.x:n.x+i.box.left,y:i.parentIsFlex?n.y:n.y+i.box.top};if(e.x&&e.y)r={x:e.x-o.x,y:e.y-o.y};else if(e.top||e.right||e.bottom||e.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=e.top,a.style.right=e.right,a.style.bottom=e.bottom,a.style.left=e.left,a.style.position="absolute",s.zone.appendChild(a);var l=a.getBoundingClientRect();s.zone.removeChild(a),r=e,e={x:l.left+n.x,y:l.top+n.y}}var c=new qRe(i,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(cL(c.ui.el,r),cL(c.ui.front,c.frontPosition)),i.nipples.push(c),i.trigger("added "+c.identifier+":added",c),i.manager.trigger("added "+c.identifier+":added",c),i.bindNipple(c),c};Bn.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};Bn.prototype.bindNipple=function(e){var t=this,i,n=function(r,s){i=r.type+" "+s.id+":"+r.type,t.trigger(i,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)};Bn.prototype.pressureFn=function(e,t,i){var n=this,r=0;clearInterval(n.pressureIntervals[i]),n.pressureIntervals[i]=setInterval(function(){var s=e.force||e.pressure||e.webkitForce||0;s!==r&&(t.trigger("pressure",s),n.trigger("pressure "+t.identifier+":pressure",s),r=s)}.bind(n),100)};Bn.prototype.onstart=function(e){var t=this,i=t.options,n=e;e=DK(e),t.updateBox();var r=function(s){t.actives.length<i.maxNumberOfNipples?t.processOnStart(s):n.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(o){if(Object.values(n.touches).findIndex(function(l){return l.identifier===o})<0){var a=[e[0]];a.identifier=o,t.processOnEnd(a)}}),t.actives.length<i.maxNumberOfNipples&&t.processOnStart(s))};return uL(e,r),t.manager.bindDocument(),!1};Bn.prototype.processOnStart=function(e){var t=this,i=t.options,n,r=t.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,o={x:e.pageX,y:e.pageY},a=t.getOrCreate(r,o);a.identifier!==r&&t.manager.removeIdentifier(a.identifier),a.identifier=r;var l=function(h){h.trigger("start",h),t.trigger("start "+h.id+":start",h),h.show(),s>0&&t.pressureFn(e,h,h.identifier),t.processOnMove(e)};if((n=t.idles.indexOf(a))>=0&&t.idles.splice(n,1),t.actives.push(a),t.ids.push(a.identifier),i.mode!=="semi")l(a);else{var c=_A(o,a.position);if(c<=i.catchDistance)l(a);else{a.destroy(),t.processOnStart(e);return}}return a};Bn.prototype.getOrCreate=function(e,t){var i=this,n=i.options,r;return/(semi|static)/.test(n.mode)?(r=i.idles[0],r?(i.idles.splice(0,1),r):n.mode==="semi"?i.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(r=i.createNipple(t,e),r)};Bn.prototype.processOnMove=function(e){var t=this,i=t.options,n=t.manager.getIdentifier(e),r=t.nipples.get(n),s=t.manager.scroll;if(!jRe(e)){this.processOnEnd(e);return}if(!r){console.error("Found zombie joystick with ID "+n),t.manager.removeIdentifier(n);return}if(i.dynamicPage){var o=r.el.getBoundingClientRect();r.position={x:s.x+o.left,y:s.y+o.top}}r.identifier=n;var a=r.options.size/2,l={x:e.pageX,y:e.pageY};i.lockX&&(l.y=r.position.y),i.lockY&&(l.x=r.position.x);var c=_A(l,r.position),h=GRe(l,r.position),u=lL(h),d=c/a,f={distance:c,position:l},p,g;if(r.options.shape==="circle"?(p=Math.min(c,a),g=HRe(r.position,p,h)):(g=YRe(l,r.position,a),p=_A(g,r.position)),i.follow){if(c>a){let w=l.x-g.x,b=l.y-g.y;r.position.x+=w,r.position.y+=b,r.el.style.top=r.position.y-(t.box.top+s.y)+"px",r.el.style.left=r.position.x-(t.box.left+s.x)+"px",c=_A(l,r.position)}}else l=g,c=p;var m=l.x-r.position.x,v=l.y-r.position.y;r.frontPosition={x:m,y:v},i.dataOnly||cL(r.ui.front,r.frontPosition);var x={identifier:r.identifier,position:l,force:d,pressure:e.force||e.pressure||e.webkitForce||0,distance:c,angle:{radian:u,degree:h},vector:{x:m/a,y:-v/a},raw:f,instance:r,lockX:i.lockX,lockY:i.lockY};x=r.computeDirection(x),x.angle={radian:lL(180-h),degree:180-h},r.trigger("move",x),t.trigger("move "+r.id+":move",x)};Bn.prototype.processOnEnd=function(e){var t=this,i=t.options,n=t.manager.getIdentifier(e),r=t.nipples.get(n),s=t.manager.removeIdentifier(r.identifier);!r||(i.dataOnly||r.hide(function(){i.mode==="dynamic"&&(r.trigger("removed",r),t.trigger("removed "+r.id+":removed",r),t.manager.trigger("removed "+r.id+":removed",r),r.destroy())}),clearInterval(t.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),t.trigger("end "+r.id+":end",r),t.ids.indexOf(r.identifier)>=0&&t.ids.splice(t.ids.indexOf(r.identifier),1),t.actives.indexOf(r)>=0&&t.actives.splice(t.actives.indexOf(r),1),/(semi|static)/.test(i.mode)?t.idles.push(r):t.nipples.indexOf(r)>=0&&t.nipples.splice(t.nipples.indexOf(r),1),t.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(t.manager.ids[s.id]=s.identifier))};Bn.prototype.onDestroyed=function(e,t){var i=this;i.nipples.indexOf(t)>=0&&i.nipples.splice(i.nipples.indexOf(t),1),i.actives.indexOf(t)>=0&&i.actives.splice(i.actives.indexOf(t),1),i.idles.indexOf(t)>=0&&i.idles.splice(i.idles.indexOf(t),1),i.ids.indexOf(t.identifier)>=0&&i.ids.splice(i.ids.indexOf(t.identifier),1),i.manager.removeIdentifier(t.identifier),i.manager.unbindDocument()};Bn.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(i){i.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var QRe=Bn;function xr(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=H6(),t.config(e),t.prepareCollections();var i=function(){var r;t.collections.forEach(function(s){s.forEach(function(o){r=o.el.getBoundingClientRect(),o.position={x:t.scroll.x+r.left,y:t.scroll.y+r.top}})})};if(typeof window>"u")return t.collections;KS(window,"resize",function(){U6(i)});var n=function(){t.scroll=H6()};return KS(window,"scroll",function(){U6(n)}),t.collections}xr.prototype=new cF;xr.constructor=xr;xr.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var i;return e.collections.every(function(n){return i=n.get(t),!i}),i}};xr.prototype.create=function(e){return this.createCollection(e)};xr.prototype.createCollection=function(e){var t=this,i=new QRe(t,e);return t.bindCollection(i),t.collections.push(i),i};xr.prototype.bindCollection=function(e){var t=this,i,n=function(r,s){i=r.type+" "+s.id+":"+r.type,t.trigger(i,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)};xr.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};xr.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};xr.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};xr.prototype.removeIdentifier=function(e){var t={};for(var i in this.ids)if(this.ids[i]===e){t.id=i,t.identifier=this.ids[i],delete this.ids[i];break}return t};xr.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};xr.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};xr.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};xr.prototype.onAny=function(e,t){var i=this,n,r="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=DK(t);var s=function(a,l,c){c.ids.indexOf(l)>=0&&(c[r](a),a._found_=!0)},o=function(a){n=i.getIdentifier(a),uL(i.collections,s.bind(null,a,n)),a._found_||i.removeIdentifier(n)};return uL(t,o),!1};xr.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};xr.prototype.onDestroyed=function(e,t){var i=this;if(i.collections.indexOf(t)<0)return!1;i.collections.splice(i.collections.indexOf(t),1)};var JRe=xr,V6=new JRe,KRe={create:function(e){return V6.create(e)},factory:V6},ZRe=x1(iq());function Ic(e,t){let i=new Ot;if(!e.getAttribute("position"))return i.setAttribute("position",new gt([],3)),i.setIndex([]),i;let{positions:n,triIndices:r}=uE(e.getAttribute("position"),e.getIndex());return i.setAttribute("position",new gt(n,3)),i.setIndex(r),t&&i.applyMatrix4(t),i}var $Re=new Je,eIe=new Je,wl=[[0,0,0],[0,0,0],[0,0,0]];function OK(e){let t=e.elements;wl[0][0]=t[0],wl[0][1]=t[4],wl[0][2]=t[8],wl[1][0]=t[1],wl[1][1]=t[5],wl[1][2]=t[9],wl[2][0]=t[2],wl[2][1]=t[6],wl[2][2]=t[10];let{u:i,v:n}=(0,ZRe.SVD)(wl),r=$Re.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),s=eIe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1);return r.multiply(s.transpose())}var tIe=class extends Uq{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e,t=!0,i=[]){return e.forEach(n=>{n.visible&&this.intersectObject(n,t,i)}),i}createRaycastLineHelper(){let e=new Zh({color:65280,linewidth:10}),t=new I(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),i=new I(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),n=this.camera.far-this.camera.near,r=new I().addVectors(t,i.multiplyScalar(n)),s=new Ot;return s.setFromPoints([t,r]),new fS(s,e)}},FK=e=>e instanceof JS||e instanceof fg;function iIe(e,t){return e.distance-t.distance}function NK(e,t,i){if(!(!sh(t)||!t.visible)){Ol(t)&&t.raycast(e,i);for(let n of t.children)NK(e,n,i)}}function hL(e,t,i){if(!i.some(r=>ZS(e,r)!==void 0))return[];let n=[];return t.children.forEach(r=>NK(e,r,n)),n.sort(iIe),n}function dL(e){let t=[];if(e.length){let i=e[0].object;sh(i)&&t.push(i);let n=i.parent;for(;n;)FK(n)&&t.push(n),n=n.parent}return t}function ZS(e,t){if(Ol(t)){if(t.visible){let i=[];return t.raycast(e,i),i.length?i[0]:void 0}}else if(FK(t))return zK(e,t)}function zK(e,t){if(!(!sh(t)||!t.visible)){if(Ol(t)){let i=[];if(t.raycast(e,i),i.length)return i[0]}for(let i of t.children){let n=zK(e,i);if(n)return n}}}function nIe(e,t,i){return{x:(e-(i.left+window.scrollX))/i.width*2-1,y:-((t-(i.top+window.scrollY))/i.height)*2+1}}var rIe=class{constructor(e,t,i,n,r,s,o){this.scene=t,this.camera=i,this.sharedAssets=n,this.stopRaycast=r,this.requestRender=s,this.isExport=o,this.raycaster=new tIe,this.raycasterNeedsUpdate=!0,this._useWindowEvents=!1,this.renderer=e,this._useWindowEvents=t.data.publish.mouseEventTarget==="window",this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}updateRaycaster(e){if(!this.raycasterNeedsUpdate)return;this.raycasterNeedsUpdate=!1;let{pageX:t,pageY:i}=e.touches!==void 0&&e.touches.length>0?e.touches[0]:e,n=this.domElement.getBoundingClientRect();this.raycaster.setFromCamera(nIe(t,i,n),this.camera)}},kK=(e=>(e[e.keydown=0]="keydown",e[e.keyup=1]="keyup",e[e.pointerdown=2]="pointerdown",e[e.pointerup=3]="pointerup",e[e.pointermove=4]="pointermove",e[e.wheel=5]="wheel",e[e.scroll=6]="scroll",e))(kK||{}),fu=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},UK=new Map,Py=new Map,jm=class{constructor(e,t,i,n){this.data=t;let{audio:r,volume:s,delay:o,loop:a}=t;if(!r)throw new Error("Missing property");let l=typeof r=="string"?n.getAudio(r).src:r.data;this.audioPlayer=new ny({src:l,volume:s,delay:o,loop:a}),Py.has(i.uuid)?Py.get(i.uuid).push(this):Py.set(i.uuid,[this]),UK.set(e,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},fL=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=UK.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=Py.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(i=>i.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(i=>i.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...Py.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(i=>{i.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(i=>{i.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Dy=class{constructor(e,t,i,n){if(this.data=t,t.interaction==="play")this.interaction=new jm(e,t,i,n);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new fL(t);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof jm?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof jm?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){this.interaction instanceof jm&&(e==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}};function sIe(e,t){let i=e.material.layers.find(n=>n.uuid===t);if(i)return i.color.texture.image.img instanceof HTMLVideoElement?i.color.texture.image.img:void 0}var GK=new Map,By=new Map,Ly=class{constructor(e,t,i){this.data=t,this.delay=0,this.status="stopped";let{layerId:n,loop:r,volume:s,delay:o}=t;if(this.object=i,n===void 0)throw new Error("Missing property");let a=sIe(i,n);a&&(this.videoElement=a,this.videoElement.loop=r===1/0,this.videoElement.autoplay=!0,s!==void 0&&(this.videoElement.volume=s)),o!==void 0&&(this.delay=o),By.has(i.uuid)?By.get(i.uuid).push(this):By.set(i.uuid,[this]),GK.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let i=this.videoElement.play();i!==void 0&&i.then(n=>{}).catch(n=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},pL=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=GK.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=By.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(i=>i[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(i=>i[this.data.interaction]()))}pauseAllVideos(){let e=[...By.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(i=>{i[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(i=>{i[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},uF=class{constructor(e,t,i){if(this.data=t,t.interaction==="play")this.interaction=new Ly(e,t,i);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new pL(t);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof Ly?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof Ly?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},oIe="text/plain",aIe="us-ascii",j6=(e,t)=>t.some(i=>i instanceof RegExp?i.test(e):i===e),lIe=(e,{stripHash:t})=>{let i=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!i)throw new Error(`Invalid URL: ${e}`);let{type:n,data:r,hash:s}=i.groups,o=n.split(";");s=t?"":s;let a=!1;o[o.length-1]==="base64"&&(o.pop(),a=!0);let l=(o.shift()||"").toLowerCase(),c=[...o.map(h=>{let[u,d=""]=h.split("=").map(f=>f.trim());return u==="charset"&&(d=d.toLowerCase(),d===aIe)?"":`${u}${d?`=${d}`:""}`}).filter(Boolean)];return a&&c.push("base64"),(c.length>0||l&&l!==oIe)&&c.unshift(l),`data:${c.join(";")},${a?r.trim():r}${s?`#${s}`:""}`};function cIe(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return lIe(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let i=e.startsWith("//");!i&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let n=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&n.protocol==="https:"&&(n.protocol="http:"),t.forceHttps&&n.protocol==="http:"&&(n.protocol="https:"),t.stripAuthentication&&(n.username="",n.password=""),t.stripHash?n.hash="":t.stripTextFragment&&(n.hash=n.hash.replace(/#?:~:text.*?$/i,"")),n.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,o=0,a="";for(;;){let c=s.exec(n.pathname);if(!c)break;let h=c[0],u=c.index,d=n.pathname.slice(o,u);a+=d.replace(/\/{2,}/g,"/"),a+=h,o=u+h.length}let l=n.pathname.slice(o,n.pathname.length);a+=l.replace(/\/{2,}/g,"/"),n.pathname=a}if(n.pathname)try{n.pathname=decodeURI(n.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let s=n.pathname.split("/"),o=s[s.length-1];j6(o,t.removeDirectoryIndex)&&(s=s.slice(0,-1),n.pathname=s.slice(1).join("/")+"/")}if(n.hostname&&(n.hostname=n.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(n.hostname)&&(n.hostname=n.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...n.searchParams.keys()])j6(s,t.removeQueryParameters)&&n.searchParams.delete(s);if(t.removeQueryParameters===!0&&(n.search=""),t.sortQueryParameters){n.searchParams.sort();try{n.search=decodeURIComponent(n.search)}catch{}}t.removeTrailingSlash&&(n.pathname=n.pathname.replace(/\/$/,""));let r=e;return e=n.toString(),!t.removeSingleSlash&&n.pathname==="/"&&!r.endsWith("/")&&n.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||n.pathname==="/")&&n.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),i&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var uIe=class{constructor({url:e,context:t},i){if(this.managers=i,!e)throw new Error("Missing property");this.url=e.startsWith("mailto:")?e:cIe(e,{removeTrailingSlash:!1,removeSingleSlash:!1}),this.context=t??"tab"}dispatch(){var e;bQ?window.location.assign(this.url):(this.context==="tab"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(e=this.managers.controlsManager.orbitControls)==null||e.onPointerUp(Lt[0]),bPe())}},HK=class{constructor(e,t,i){this.data=e,this.managers=i,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=n=>{var a,l;this.timeoutIdQueue.shift();let r=this.scene.find(n);if(r===void 0)return;let s=this.controlsManager.sharedGameControlGlobals.rapierWorld,o=s?(a=r.dataPatched.physics)==null?void 0:a.fusedBody:!0;if(r.cloner){for(let c of r.cloner.children)o?(c.playModeVisible=!1,c.rigidBody&&((l=r.dataPatched.physics)==null?void 0:l.rigidBody)==="positioned"&&(s.removeRigidBody(c.rigidBody),c.rigidBody=void 0),c.boundsTree&&(c.boundsTree=void 0)):this.clone===void 0||this.clone===c?(c.playModeVisible=!1,c.rigidBody&&(s.removeRigidBody(c.rigidBody),c.rigidBody=void 0)):c.playModeVisible===void 0&&(c.playModeVisible=!0);(o||this.clone===void 0||this.clone===!1)&&(r.visible=!1,r.rigidBody&&(s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.boundsTree&&(r.boundsTree=void 0))}else r.rigidBody&&(s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.boundsTree&&(r.boundsTree=void 0),r.visible=!1;s===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.boundsTree!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.rigidBody!==void 0),this.managers.eventManager.requestRender()},this.objects=[...e.objects],this.scene=t,this.controlsManager=i.controlsManager}dispatch(e){this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},W6=(()=>{let e,t,i,n;function r(a){!e&&!X6()&&(t==null?void 0:t.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(s)),a&&(t=a,n=a.requestRender)}function s(a){let l=i?a-i:0,c=t.sharedGameControlGlobals.createdObjects,h=t.sharedGameControlGlobals.nCreatedPerAction,u=c.length,d=0;for(;d<u;){let f=c[d];f.userData.createdTime===void 0&&(f.userData.createdTime=a),f.userData.lifetime===void 0&&f.userData.quantity===void 0||f.userData.lifetime&&a-f.userData.createdTime<f.userData.lifetime||f.userData.quantity&&h[f.userData.actionId]<=f.userData.quantity?(f.userData.velocity&&(f.position.addScaledVector(f.userData.velocity,l/1e3),f.updateMatrix(),n()),d++):(h[f.userData.actionId]>f.userData.quantity&&h[f.userData.actionId]--,c.splice(d,1),f.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&f.rigidBody?t.sharedGameControlGlobals.rapierWorld.removeRigidBody(f.rigidBody):(f.boundsTree=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(p=>p.boundsTree!==void 0)),u--,n())}e=d>0?requestAnimationFrame(s):void 0,i=d>0?a:void 0}function o(){X6()?e&&(cancelAnimationFrame(e),i=void 0):r()}return typeof document<"u"&&document.addEventListener("visibilitychange",o),r})();function X6(){return!!document&&document.hidden}var Y6=new ai,hIe=new I,dIe=new I,Ry=class{constructor(e,t,i){this.data=e,this.scene=t,this.controlsManager=i,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=si.generateUUID(),this.dispatch=()=>{this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=hPe(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{if(this.timeoutIdQueue.shift(),this.object===void 0)return;let n=new fs(this.object);if(n.playModeVisible=!0,n.expand(),this.data.coordinateSystem!=="world"){let s=this.data.coordinateSystem;s===sa.PERSONAL_CAMERA_ID&&this.scene.find(sa.PERSONAL_CAMERA_EXPORT_ID)&&(s=sa.PERSONAL_CAMERA_EXPORT_ID);let o=this.scene.find(s);o&&(o.updateMatrixWorldSVD(),n.hiddenMatrix.setPosition(0,0,0),n.hiddenMatrix.premultiply(o.matrixWorldRigid),n.updateMatrixWorld())}n.position.fromArray(this.data.position),n.rotation.fromArray(this.data.rotation),n.updateMatrix(),this.scene.add(n);let r=this.controlsManager.sharedGameControlGlobals;r.createdObjects.push(n),r.nCreatedPerAction[this.uniqueId]===void 0?r.nCreatedPerAction[this.uniqueId]=1:r.nCreatedPerAction[this.uniqueId]++,n.updateWorldMatrix(!0,!0),n.traverseObject(this.traverseObjectCB),W6(),this.controlsManager.requestRender()},this.traverseObjectCB=n=>{var a,l,c,h;n.hasNonUniformScale&&n.updateMatrixWorldSVD();let r;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(n instanceof Ga)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;r=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof fs)r=n.object;else if(r=n,(a=r.dataPatched.cloner)==null?void 0:a.hideBase)return!0}else{if(n instanceof Ga)return;n instanceof fs?r=n.object:r=n}this.data.destroy==="Time"?n.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(n.userData.quantity=this.data.destroyAfterQuantity,n.userData.actionId=this.uniqueId),n.matrixWorld.decompose(hIe,Y6,dIe);let s=new I().fromArray(this.data.velocity).applyQuaternion(Y6),o=r.dataPatched;if(!(o.collision==="visibility"?!o.visible:!o.collision)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(n,r,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((l=n.rigidBody)==null||l.collider(0).setActiveEvents(1),n.userData.hasCollisionDestroy=!0),this.data.velocity.some(u=>u!==0)&&this.data.dynamic&&((c=n.rigidBody)==null||c.setLinvel(s.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in n.object&&this.controlsManager.addBoundsTree(n),this.data.velocity.some(u=>u!==0)&&this.data.dynamic&&(n.userData.velocity=s)),((h=r.dataPatched.physics)==null?void 0:h.fusedBody)===!0))return!0},this.scene=t,this.object=this.scene.find(this.data.object),W6(i)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.scene.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},fIe=class{constructor(e,t,i,n){this.scene=t,this.sharedAssets=i,this.sceneData=e,this.managers=n}dispatch(){var t,i;aZ(this.sceneData,this.scene,this.sharedAssets,!0),(t=this.managers.eventManager)==null||t.reset(),(i=this.managers.controlsManager)==null||i.gameControls.forEach(n=>n.reset(!0));let e;this.sceneData.publish.playCamera?e=this.scene.find(this.sceneData.publish.playCamera):(e=this.scene.find(sa.PERSONAL_CAMERA_ID),e||(e=this.scene.find(sa.PERSONAL_CAMERA_EXPORT_ID))),this.scene.switchActiveCamera(e),this.managers.controlsManager.requestRender()}},VK={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},hF={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},pIe=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],$S={CSS:{},springs:{}};function Ha(e,t,i){return Math.min(Math.max(e,t),i)}function Iy(e,t){return e.indexOf(t)>-1}function EP(e,t){return e.apply(null,t)}var It={arr:function(e){return Array.isArray(e)},obj:function(e){return Iy(Object.prototype.toString.call(e),"Object")},pth:function(e){return It.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||It.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return It.hex(e)||It.rgb(e)||It.hsl(e)},key:function(e){return!VK.hasOwnProperty(e)&&!hF.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function jK(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(i){return parseFloat(i)}):[]}function WK(e,t){var i=jK(e),n=Ha(It.und(i[0])?1:i[0],.1,100),r=Ha(It.und(i[1])?100:i[1],.1,100),s=Ha(It.und(i[2])?10:i[2],.1,100),o=Ha(It.und(i[3])?0:i[3],.1,100),a=Math.sqrt(r/n),l=s/(2*Math.sqrt(r*n)),c=l<1?a*Math.sqrt(1-l*l):0,h=1,u=l<1?(l*a+-o)/c:-o+a;function d(p){var g=t?t*p/1e3:p;return l<1?g=Math.exp(-g*l*a)*(h*Math.cos(c*g)+u*Math.sin(c*g)):g=(h+u*g)*Math.exp(-g*a),p===0||p===1?p:1-g}function f(){var p=$S.springs[e];if(p)return p;for(var g=1/6,m=0,v=0;;)if(m+=g,d(m)===1){if(v++,v>=16)break}else v=0;var x=m*g*1e3;return $S.springs[e]=x,x}return t?d:f}function mIe(e){return e===void 0&&(e=10),function(t){return Math.ceil(Ha(t,1e-6,1)*e)*(1/e)}}var gIe=function(){var e=11,t=1/(e-1);function i(h,u){return 1-3*u+3*h}function n(h,u){return 3*u-6*h}function r(h){return 3*h}function s(h,u,d){return((i(u,d)*h+n(u,d))*h+r(u))*h}function o(h,u,d){return 3*i(u,d)*h*h+2*n(u,d)*h+r(u)}function a(h,u,d,f,p){var g,m,v=0;do m=u+(d-u)/2,g=s(m,f,p)-h,g>0?d=m:u=m;while(Math.abs(g)>1e-7&&++v<10);return m}function l(h,u,d,f){for(var p=0;p<4;++p){var g=o(u,d,f);if(g===0)return u;var m=s(u,d,f)-h;u-=m/g}return u}function c(h,u,d,f){if(!(0<=h&&h<=1&&0<=d&&d<=1))return;var p=new Float32Array(e);if(h!==u||d!==f)for(var g=0;g<e;++g)p[g]=s(g*t,h,d);function m(v){for(var x=0,w=1,b=e-1;w!==b&&p[w]<=v;++w)x+=t;--w;var M=(v-p[w])/(p[w+1]-p[w]),A=x+M*t,T=o(A,h,d);return T>=.001?l(v,A,h,d):T===0?A:a(v,x,x+t,h,d)}return function(v){return h===u&&d===f||v===0||v===1?v:s(m(v),u,f)}}return c}(),XK=function(){var e={linear:function(){return function(n){return n}}},t={Sine:function(){return function(n){return 1-Math.cos(n*Math.PI/2)}},Circ:function(){return function(n){return 1-Math.sqrt(1-n*n)}},Back:function(){return function(n){return n*n*(3*n-2)}},Bounce:function(){return function(n){for(var r,s=4;n<((r=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((r*3-2)/22-n,2)}},Elastic:function(n,r){n===void 0&&(n=1),r===void 0&&(r=.5);var s=Ha(n,1,10),o=Ha(r,.1,2);return function(a){return a===0||a===1?a:-s*Math.pow(2,10*(a-1))*Math.sin((a-1-o/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/o)}}},i=["Quad","Cubic","Quart","Quint","Expo"];return i.forEach(function(n,r){t[n]=function(){return function(s){return Math.pow(s,r+2)}}}),Object.keys(t).forEach(function(n){var r=t[n];e["easeIn"+n]=r,e["easeOut"+n]=function(s,o){return function(a){return 1-r(s,o)(1-a)}},e["easeInOut"+n]=function(s,o){return function(a){return a<.5?r(s,o)(a*2)/2:1-r(s,o)(a*-2+2)/2}}}),e}();function dF(e,t){if(It.fnc(e))return e;var i=e.split("(")[0],n=XK[i],r=jK(e);switch(i){case"spring":return WK(e,t);case"cubicBezier":return EP(gIe,r);case"steps":return EP(mIe,r);default:return EP(n,r)}}function YK(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function dE(e,t){for(var i=e.length,n=arguments.length>=2?arguments[1]:void 0,r=[],s=0;s<i;s++)if(s in e){var o=e[s];t.call(n,o,s,e)&&r.push(o)}return r}function fE(e){return e.reduce(function(t,i){return t.concat(It.arr(i)?fE(i):i)},[])}function q6(e){return It.arr(e)?e:(It.str(e)&&(e=YK(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function fF(e,t){return e.some(function(i){return i===t})}function pF(e){var t={};for(var i in e)t[i]=e[i];return t}function mL(e,t){var i=pF(e);for(var n in e)i[n]=t.hasOwnProperty(n)?t[n]:e[n];return i}function pE(e,t){var i=pF(e);for(var n in t)i[n]=It.und(e[n])?t[n]:e[n];return i}function vIe(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function yIe(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,i=e.replace(t,function(a,l,c,h){return l+l+c+c+h+h}),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i),r=parseInt(n[1],16),s=parseInt(n[2],16),o=parseInt(n[3],16);return"rgba("+r+","+s+","+o+",1)"}function xIe(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),i=parseInt(t[1],10)/360,n=parseInt(t[2],10)/100,r=parseInt(t[3],10)/100,s=t[4]||1;function o(d,f,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?d+(f-d)*6*p:p<1/2?f:p<2/3?d+(f-d)*(2/3-p)*6:d}var a,l,c;if(n==0)a=l=c=r;else{var h=r<.5?r*(1+n):r+n-r*n,u=2*r-h;a=o(u,h,i+1/3),l=o(u,h,i),c=o(u,h,i-1/3)}return"rgba("+a*255+","+l*255+","+c*255+","+s+")"}function wIe(e){if(It.rgb(e))return vIe(e);if(It.hex(e))return yIe(e);if(It.hsl(e))return xIe(e)}function eu(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function _Ie(e){if(Iy(e,"translate")||e==="perspective")return"px";if(Iy(e,"rotate")||Iy(e,"skew"))return"deg"}function gL(e,t){return It.fnc(e)?e(t.target,t.id,t.total):e}function Nl(e,t){return e.getAttribute(t)}function mF(e,t,i){var n=eu(t);if(fF([i,"deg","rad","turn"],n))return t;var r=$S.CSS[t+i];if(!It.und(r))return r;var s=100,o=document.createElement(e.tagName),a=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;a.appendChild(o),o.style.position="absolute",o.style.width=s+i;var l=s/o.offsetWidth;a.removeChild(o);var c=l*parseFloat(t);return $S.CSS[t+i]=c,c}function qK(e,t,i){if(t in e.style){var n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=e.style[t]||getComputedStyle(e).getPropertyValue(n)||"0";return i?mF(e,r,i):r}}function gF(e,t){if(It.dom(e)&&!It.inp(e)&&(Nl(e,t)||It.svg(e)&&e[t]))return"attribute";if(It.dom(e)&&fF(pIe,t))return"transform";if(It.dom(e)&&t!=="transform"&&qK(e,t))return"css";if(e[t]!=null)return"object"}function QK(e){if(It.dom(e)){for(var t=e.style.transform||"",i=/(\w+)\(([^)]*)\)/g,n=new Map,r;r=i.exec(t);)n.set(r[1],r[2]);return n}}function bIe(e,t,i,n){var r=Iy(t,"scale")?1:0+_Ie(t),s=QK(e).get(t)||r;return i&&(i.transforms.list.set(t,s),i.transforms.last=t),n?mF(e,s,n):s}function vF(e,t,i,n){switch(gF(e,t)){case"transform":return bIe(e,t,n,i);case"css":return qK(e,t,i);case"attribute":return Nl(e,t);default:return e[t]||0}}function yF(e,t){var i=/^(\*=|\+=|-=)/.exec(e);if(!i)return e;var n=eu(e)||0,r=parseFloat(t),s=parseFloat(e.replace(i[0],""));switch(i[0][0]){case"+":return r+s+n;case"-":return r-s+n;case"*":return r*s+n}}function JK(e,t){if(It.col(e))return wIe(e);if(/\s/g.test(e))return e;var i=eu(e),n=i?e.substr(0,e.length-i.length):e;return t?n+t:n}function xF(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function AIe(e){return Math.PI*2*Nl(e,"r")}function SIe(e){return Nl(e,"width")*2+Nl(e,"height")*2}function MIe(e){return xF({x:Nl(e,"x1"),y:Nl(e,"y1")},{x:Nl(e,"x2"),y:Nl(e,"y2")})}function KK(e){for(var t=e.points,i=0,n,r=0;r<t.numberOfItems;r++){var s=t.getItem(r);r>0&&(i+=xF(n,s)),n=s}return i}function EIe(e){var t=e.points;return KK(e)+xF(t.getItem(t.numberOfItems-1),t.getItem(0))}function ZK(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return AIe(e);case"rect":return SIe(e);case"line":return MIe(e);case"polyline":return KK(e);case"polygon":return EIe(e)}}function CIe(e){var t=ZK(e);return e.setAttribute("stroke-dasharray",t),t}function TIe(e){for(var t=e.parentNode;It.svg(t)&&It.svg(t.parentNode);)t=t.parentNode;return t}function $K(e,t){var i=t||{},n=i.el||TIe(e),r=n.getBoundingClientRect(),s=Nl(n,"viewBox"),o=r.width,a=r.height,l=i.viewBox||(s?s.split(" "):[0,0,o,a]);return{el:n,viewBox:l,x:l[0]/1,y:l[1]/1,w:o/l[2],h:a/l[3]}}function PIe(e,t){var i=It.str(e)?YK(e)[0]:e,n=t||100;return function(r){return{property:r,el:i,svg:$K(i),totalLength:ZK(i)*(n/100)}}}function DIe(e,t){function i(a){a===void 0&&(a=0);var l=t+a>=1?t+a:0;return e.el.getPointAtLength(l)}var n=$K(e.el,e.svg),r=i(),s=i(-1),o=i(1);switch(e.property){case"x":return(r.x-n.x)*n.w;case"y":return(r.y-n.y)*n.h;case"angle":return Math.atan2(o.y-s.y,o.x-s.x)*180/Math.PI}}function Q6(e,t){var i=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,n=JK(It.pth(e)?e.totalLength:e,t)+"";return{original:n,numbers:n.match(i)?n.match(i).map(Number):[0],strings:It.str(e)||t?n.split(i):[]}}function eZ(e){var t=e?fE(It.arr(e)?e.map(q6):q6(e)):[];return dE(t,function(i,n,r){return r.indexOf(i)===n})}function tZ(e){var t=eZ(e);return t.map(function(i,n){return{target:i,id:n,total:t.length,transforms:{list:QK(i)}}})}function BIe(e,t){var i=pF(t);if(/^spring/.test(i.easing)&&(i.duration=WK(i.easing)),It.arr(e)){var n=e.length,r=n===2&&!It.obj(e[0]);r?e={value:e}:It.fnc(t.duration)||(i.duration=t.duration/n)}var s=It.arr(e)?e:[e];return s.map(function(o,a){var l=It.obj(o)&&!It.pth(o)?o:{value:o};return It.und(l.delay)&&(l.delay=a?0:t.delay),It.und(l.endDelay)&&(l.endDelay=a===s.length-1?t.endDelay:0),l}).map(function(o){return pE(o,i)})}function LIe(e){for(var t=dE(fE(e.map(function(s){return Object.keys(s)})),function(s){return It.key(s)}).reduce(function(s,o){return s.indexOf(o)<0&&s.push(o),s},[]),i={},n=function(s){var o=t[s];i[o]=e.map(function(a){var l={};for(var c in a)It.key(c)?c==o&&(l.value=a[c]):l[c]=a[c];return l})},r=0;r<t.length;r++)n(r);return i}function RIe(e,t){var i=[],n=t.keyframes;n&&(t=pE(LIe(n),t));for(var r in t)It.key(r)&&i.push({name:r,tweens:BIe(t[r],e)});return i}function IIe(e,t){var i={};for(var n in e){var r=gL(e[n],t);It.arr(r)&&(r=r.map(function(s){return gL(s,t)}),r.length===1&&(r=r[0])),i[n]=r}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}function OIe(e,t){var i;return e.tweens.map(function(n){var r=IIe(n,t),s=r.value,o=It.arr(s)?s[1]:s,a=eu(o),l=vF(t.target,e.name,a,t),c=i?i.to.original:l,h=It.arr(s)?s[0]:c,u=eu(h)||eu(l),d=a||u;return It.und(o)&&(o=c),r.from=Q6(h,d),r.to=Q6(yF(o,h),d),r.start=i?i.end:0,r.end=r.start+r.delay+r.duration+r.endDelay,r.easing=dF(r.easing,r.duration),r.isPath=It.pth(s),r.isColor=It.col(r.from.original),r.isColor&&(r.round=1),i=r,r})}var iZ={css:function(e,t,i){return e.style[t]=i},attribute:function(e,t,i){return e.setAttribute(t,i)},object:function(e,t,i){return e[t]=i},transform:function(e,t,i,n,r){if(n.list.set(t,i),t===n.last||r){var s="";n.list.forEach(function(o,a){s+=a+"("+o+") "}),e.style.transform=s}}};function nZ(e,t){var i=tZ(e);i.forEach(function(n){for(var r in t){var s=gL(t[r],n),o=n.target,a=eu(s),l=vF(o,r,a,n),c=a||eu(l),h=yF(JK(s,c),l),u=gF(o,r);iZ[u](o,r,h,n.transforms,!0)}})}function FIe(e,t){var i=gF(e.target,t.name);if(i){var n=OIe(t,e),r=n[n.length-1];return{type:i,property:t.name,animatable:e,tweens:n,duration:r.end,delay:n[0].delay,endDelay:r.endDelay}}}function NIe(e,t){return dE(fE(e.map(function(i){return t.map(function(n){return FIe(i,n)})})),function(i){return!It.und(i)})}function rZ(e,t){var i=e.length,n=function(s){return s.timelineOffset?s.timelineOffset:0},r={};return r.duration=i?Math.max.apply(Math,e.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return n(s)+o+a+l+s.duration*(s.loop??1)})):t.duration,r.delay=i?Math.min.apply(Math,e.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0;return n(s)+o+a+s.delay})):t.delay,r.endDelay=i?r.duration-Math.max.apply(Math,e.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return n(s)+o+a+s.duration*(s.loop??1)-s.endDelay-l})):t.endDelay,r}var J6=0;function zIe(e){var t=mL(VK,e),i=mL(hF,e),n=RIe(i,e),r=tZ(e.targets),s=NIe(r,n),o=rZ(s,i),a=J6;return J6++,pE(t,{id:a,children:[],animatables:r,animations:s,duration:o.duration,delay:o.delay,endDelay:o.endDelay,startOnceDelay:i.startOnceDelay,pingPongDelayCorrection:i.pingPongDelayCorrection,pingPongEndDelayCorrection:i.pingPongEndDelayCorrection})}var oa=[],K6=[],bA,kIe=function(){function e(){bA=requestAnimationFrame(t)}function t(i){var n=oa.length;if(n){for(var r=0;r<n;){var s=oa[r];s.paused?(oa.splice(r,1),n-=1):(s.tick(i),r++)}e()}else bA=cancelAnimationFrame(bA)}return e}();function UIe(e){document.hidden?(oa.forEach(function(t){return t.pause(e.timeStamp)}),K6=oa.slice(0),Dn.running=oa=[]):K6.forEach(function(t){return t.play(e.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",UIe);function Dn(e){e===void 0&&(e={});var t=0,i=0,n=0,r,s,o=0,a=null;function l(A){var T=window.Promise&&new Promise(function(S){return a=S});return A.finished=T,T}var c=zIe(e);l(c);function h(){var A=c.direction;A!=="alternate"&&(c.direction=A!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,s.forEach(function(T){(T.loop===1||T.loop%2===0)&&(T.reversed=c.reversed)})}function u(){c.direction="normal",c.reversed=!1,s.forEach(function(A){return A.reversed=!1})}function d(A){return c.reversed?c.duration-A:A}function f(){t=0,i=d(c.currentTime)*(1/Dn.speed)}function p(A,T){T&&(c.reversed?T.seek(T.duration*T.loop-(A-T.timelineOffset-T.pingPongDelayCorrection)):T.seek(A-T.timelineOffset-T.startOnceDelay-T.pingPongDelayCorrection))}function g(A){if(c.reversed)for(var T=o;T--;)p(A,s[T]);else for(var S=0;S<o;S++)p(A,s[S])}function m(A){var ve,pe,me,de,Se,ce,se,be,Ee,Le;var T=0,S=c.animations,C=S.length;for(c.direction!=="alternate"&&((ve=c.parent)==null?void 0:ve.direction)==="alternate"?((pe=c.parent)==null?void 0:pe.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((me=c.parent)!=null&&me.reversed&&c.direction==="alternate"?A=c.duration-c.delay+c.endDelay-A:A=c.duration+c.delay-c.endDelay-A):b(!1,(de=c.parent)==null?void 0:de.rewind,c.rewind,(Se=c.parent)==null?void 0:Se.reversePlayback,c.reversePlayback)&&((ce=c.parent)!=null&&ce.reversed&&c.direction==="alternate"?A=c.duration-c.delay+c.endDelay-A:A=c.duration+c.delay-c.endDelay-A);T<C;){var P=S[T],B=P.animatable,k=P.tweens,z=k.length-1,F=k[z];z&&(F=dE(k,function(Oe){return A<Oe.end})[0]||F);let ze;(se=c.parent)!=null&&se.reversed&&c.direction==="alternate"?ze=Ha(A-F.start-F.endDelay,0,F.duration)/F.duration:ze=Ha(A-F.start-F.delay,0,F.duration)/F.duration;for(var W=isNaN(ze)?1:F.easing(ze),K=F.to.strings,Z=F.round,U=[],X=F.to.numbers.length,V=void 0,q=0;q<X;q++){var H=void 0;let Oe,Ge;c.direction!=="alternate"?((be=c.parent)==null?void 0:be.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(Oe=F.to.numbers[q],Ge=F.from.numbers[q]||0):(Ge=F.to.numbers[q],Oe=F.from.numbers[q]||0):b(!0,(Ee=c.parent)==null?void 0:Ee.rewind,c.rewind,(Le=c.parent)==null?void 0:Le.reversePlayback,c.reversePlayback)?(Oe=F.to.numbers[q],Ge=F.from.numbers[q]||0):(Ge=F.to.numbers[q],Oe=F.from.numbers[q]||0),F.isPath?H=DIe(F.value,W*Ge):H=Oe+W*(Ge-Oe),Z&&(F.isColor&&q>2||(H=Math.round(H*Z)/Z)),U.push(H)}var Q=K.length;if(!Q)V=U[0];else{V=K[0];for(var J=0;J<Q;J++){K[J];var le=K[J+1],j=U[J];isNaN(j)||(le?V+=j+le:V+=j+" ")}}iZ[P.type](B.target,P.property,V,B.transforms),P.currentValue=V,T++}}function v(A){c[A]&&!c.passThrough&&c[A](c)}function x(){c.remaining&&c.remaining!==!0&&c.remaining--}let w={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function b(A,T,S,C,P){return w[A<<4|T<<3|S<<2|C<<1|P]}function M(A){var B;var T=c.duration;let S=c.delay,C=T-c.endDelay;(B=c.parent)!=null&&B.reversed&&c.direction==="alternate"&&(S=c.endDelay,C=T-c.delay);var P=d(A);if(c.progress=Ha(P/T*100,0,100),c.reversePlayback=P<c.currentTime,o&&g(P),!c.began&&c.currentTime>=0&&(c.began=!0,v("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,v("loopBegin")),(c.reversed||P>=0)&&P<=S&&c.currentTime!==0&&(m(0),v("change")),(P>=C&&c.currentTime!==T+c.pingPongDelayCorrection||!T)&&(m(T),v("change")),P>S&&P<C?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,v("changeBegin")),m(P),v("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,v("change"),o&&v("timelineChangeComplete")):c.began&&P>C&&v("changeComplete"),c.currentTime=Ha(P,0,T+c.pingPongDelayCorrection),c.began&&v("update"),A>=T)if(x(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,v("loopComplete"),v("complete"),!c.passThrough&&"Promise"in window&&(a(),l(c)));else{o?t+=c.duration/Dn.speed:t+=c.duration;for(let k of s)k.setStartTime(0),k.remaining=k.loop;v("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?h():o&&u()}}return c.reset=function(){var A=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=A==="reverse",c.remaining=c.loop,s=c.children,o=s.length;for(var T=o;T--;)c.children[T].reset();(c.reversed&&c.loop!==!0||A==="alternate"&&c.loop===1)&&c.remaining++,m(c.reversed?c.duration:0)},c.setStartTime=function(A){t=A},c.set=function(A,T){return nZ(A,T),c},c.tick=function(A){n=A,t||(t=n),M((n+(i-t))*Dn.speed)},c.seek=function(A){M(A-t)},c.pause=function(A){c.paused=!0,o&&(r=A??performance.now())},c.play=function(A){!c.paused||(c.completed&&c.reset(),c.paused=!1,oa.push(c),o&&r!==void 0&&(t+=(A??performance.now())-r),bA||kIe())},c.reverse=function(){h(),c.completed=!c.reversed,f()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function Z6(e,t){for(var i=t.length;i--;)fF(e,t[i].animatable.target)&&t.splice(i,1)}function GIe(e){for(var t=eZ(e),i=oa.length;i--;){var n=oa[i],r=n.animations,s=n.children;Z6(t,r);for(var o=s.length;o--;){var a=s[o],l=a.animations;Z6(t,l),!l.length&&!a.children.length&&s.splice(o,1)}!r.length&&!s.length&&n.pause()}}function HIe(e,t){t===void 0&&(t={});var i=t.direction||"normal",n=t.easing?dF(t.easing):null,r=t.grid,s=t.axis,o=t.from||0,a=o==="first",l=o==="center",c=o==="last",h=It.arr(e),u=parseFloat(h?e[0]:e),d=h?parseFloat(e[1]):0,f=eu(h?e[1]:e)||0,p=t.start||0+(h?u:0),g=[],m=0;return function(v,x,w){if(a&&(o=0),l&&(o=(w-1)/2),c&&(o=w-1),!g.length){for(var b=0;b<w;b++){if(!r)g.push(Math.abs(o-b));else{var M=l?(r[0]-1)/2:o%r[0],A=l?(r[1]-1)/2:Math.floor(o/r[0]),T=b%r[0],S=Math.floor(b/r[0]),C=M-T,P=A-S,B=Math.sqrt(C*C+P*P);s==="x"&&(B=-C),s==="y"&&(B=-P),g.push(B)}m=Math.max.apply(Math,g)}n&&(g=g.map(function(z){return n(z/m)*m})),i==="reverse"&&(g=g.map(function(z){return s?z<0?z*-1:-z:Math.abs(m-z)}))}var k=h?(d-u)/m:u;return p+k*(Math.round(g[x]*100)/100)+f}}function VIe(e){e===void 0&&(e={});var t=Dn(e);return t.duration=0,t.add=function(i,n){var r=oa.indexOf(t),s=t.children;r>-1&&oa.splice(r,1);function o(d){d.passThrough=!0}for(var a=0;a<s.length;a++)o(s[a]);var l=pE(i,mL(hF,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=It.und(n)?c:yF(n,c),o(t);var h=Dn(l);o(h),s.push(h),h.parent=t;var u=rZ(s,e);return t.delay=u.delay,t.endDelay=u.endDelay,t.duration=u.duration,h.loop===!0&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}Dn.version="3.2.0";Dn.speed=1;Dn.running=oa;Dn.remove=GIe;Dn.get=vF;Dn.set=nZ;Dn.convertPx=mF;Dn.path=PIe;Dn.setDashoffset=CIe;Dn.stagger=HIe;Dn.timeline=VIe;Dn.easing=dF;Dn.penner=XK;Dn.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var sZ=Dn,$6=new I,ej=new I,tj=new ai;function jIe(e,t,i,n){if(n===0)return i.copy(e);if(n===1)return i.copy(t);let r=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(r>=1)return i.copy(e);let s=1-r*r;if(s<=Number.EPSILON){let h=1-n;return i.w=h*e.w+n*t.w,i.x=h*e.x+n*t.x,i.y=h*e.y+n*t.y,i.z=h*e.z+n*t.z,i.normalize(),i}let o=Math.sqrt(s),a=Math.atan2(o,r),l=Math.sin((1-n)*a)/o,c=Math.sin(n*a)/o;return i.w=e.w*l+t.w*c,i.x=e.x*l+t.x*c,i.y=e.y*l+t.y*c,i.z=e.z*l+t.z*c,i}function Hf(e,t,i,n,r){let s=i[e]?i[e]:void 0,o=n[e];if(o==null)return;let a=s??t[e],l=o;if(a!==l)return{update:c=>{let h=si.lerp(a,l,c);r?t[e]=Math.trunc(h):t[e]=h},start:()=>{t[e]=a},end:()=>{t[e]=l}}}function oZ(e,t,i,n,r){let s=i[e]?i[e]:void 0,o=n[e];if(!o)return;let a=t[e],l=[...s??a],c=[...o];if(!(l.length!==c.length||BO(l,c)))return{update:h=>{l.forEach((u,d)=>{let f=si.lerp(u,c[d],h);t[e][d]=r?Math.trunc(f):f})},start:()=>{Object.assign(t[e],l)},end:()=>{Object.assign(t[e],c)}}}function ij(e,t,i,n){let r=i[e]?i[e]:void 0,s=n[e];if(!s)return;let o=t[e],a=r?new I().fromArray(r):o.clone(),l=new I().fromArray(s);if(!a.equals(l))return{update:c=>{o.lerpVectors(a,l,c)},start:()=>{o.copy(a)},end:()=>{o.copy(l)}}}function WIe(e,t,i,n){let r=i[e]?i[e]:void 0,s=n[e];if(!s)return;let o=t[e],a=r?new Je().fromArray(r):o.clone(),l=new I,c=new ai,h=new I;a.decompose(l,c,h);let u=new Je().fromArray(s),d=new I,f=new ai,p=new I;if(u.decompose(d,f,p),!a.equals(u))return{update:g=>{tj.slerpQuaternions(c,f,g),$6.lerpVectors(l,d,g),ej.lerpVectors(h,p,g),o.compose($6,tj,ej)},start:()=>{o.compose(l,c,h)},end:()=>{o.compose(d,f,p)}}}function XIe(e,t,i,n,r){let s=i[e]?i[e]:void 0,o=n[e];if(!o)return;let a=t[e],l=s?typeof s=="string"?r.getColor(s).clone():new Pt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new Pt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let h=a.clone();return t[e]=h,{update:u=>{h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function ed(e,t,i,n){if(typeof t[e]=="number")return Hf(e,t,i??{},n);if(Array.isArray(t[e]))return oZ(e,t,i??{},n)}function YIe(e,t,i){var o,a,l,c;let n=[],r=e.cameraType==="OrthographicCamera"?(o=t.orthographic)==null?void 0:o.zoom:(a=t.perspective)==null?void 0:a.zoom,s=e.cameraType==="OrthographicCamera"?(l=i.orthographic)==null?void 0:l.zoom:(c=i.perspective)==null?void 0:c.zoom;if(s!==void 0){let h=r??e.zoom,u=s;h!==u&&n.push({update:d=>{e.zoom=si.lerp(h,u,d),e.updateProjectionMatrix()},start:()=>{e.zoom=h,e.updateProjectionMatrix()},end:()=>{e.zoom=u,e.updateProjectionMatrix()}})}if(i.targetOffset!==void 0){let h=Hf("targetOffset",e,t,i);h&&n.push(h)}return n}function qIe(e,t,i,n){if(i.scaleBaked===void 0)return;let r=t.scaleBaked??e.data.geometry.scaleBaked,s=i.scaleBaked;if(Sf.isEqual(r,s))return;let o=[];return o.push({update:a=>{e.updateGeometryInteractions({scaleBaked:[si.lerp(r[0],s[0],a),si.lerp(r[1],s[1],a),si.lerp(r[2],s[2],a)]},n),e.invalidateDownstreamBooleanData()},start:()=>{e.updateGeometryInteractions({scaleBaked:r},n),e.invalidateDownstreamBooleanData()},end:()=>{e.updateGeometryInteractions({scaleBaked:s},n),e.invalidateDownstreamBooleanData()}}),o}function QIe(e,t,i){if(!i.extrusion)return;let n=e.extrusion,r=t.extrusion??{},s=i.extrusion,o=[];return rJ.forEach(a=>{let l=ed(a,n,r,s);l&&o.push(l)}),o}function JIe(e,t,i,n){let r=[];if(!("geometry"in i))return r;let s=e.geometry.userData.parameters,o="geometry"in t?t.geometry:{},a=i.geometry;if(e instanceof Ix){let l=qIe(e,o,a,n);l&&r.push(...l)}else{let l={};if(Object.assign(l,Mx(s,uV)),uV.forEach(c=>{let h=ed(c,l,o,a);h&&r.push(h)}),e instanceof sF){Object.assign(l,{extrusion:{...s.extrusion}});let c=QIe(l,o,a);c&&r.push(...c)}r.length&&r.push({update:c=>{e.updateGeometryInteractions(l,n),e.updateGeometryGroupsIfNeeded()},start:c=>{e.updateGeometryInteractions(l,n),e.updateGeometryGroupsIfNeeded()},end:c=>{e.updateGeometryInteractions(l,n),e.updateGeometryGroupsIfNeeded()}})}return r}function KIe(e,t,i,n){let r=[];if(i.intensity!==void 0){let s=Hf("intensity",e,t,i);s&&r.push(s)}if(i.color!==void 0){let s=XIe("color",e,t,i,n);s&&r.push(s)}return r}function ZIe(e,t,i,n){let r=[];if(Array.isArray(e.material)){if(!("materials"in i&&i.materials))return r;let s="materials"in t&&t.materials?t.materials:[],o=i.materials;e.material.forEach((a,l)=>{if(!o[l])return;let c=s[l]??{},h=o[l];typeof c=="string"||typeof h=="string"||r.push(...nj(a,c,h,n))})}else{if(!("material"in i&&i.material))return r;let s="material"in t&&t.material?t.material:{},o=i.material;if(typeof s=="string"||typeof o=="string")return r;r.push(...nj(e.material,s,o,n))}return r}function nj(e,t,i,n){var o;let r=[],s=qS(i,n)||!!t.layers&&qS(t,n);r.push(aOe(e,s));for(let a of e.layers){let l=(o=t.layers)==null?void 0:o.data(a.uuid),c=i.layers.data(a.uuid);if(!c||!(a.visible??!0)||!(c.visible??!0))continue;let h=a.getNames().filter(u=>!tJ.some(d=>u.includes(d)));for(let u of h)try{let d=a.getValue(u),f;if(u==="colors")f=sOe(a,l,c,u);else if(Array.isArray(d))u==="steps"&&(f=rOe(a,l,c,u));else if(typeof d=="number")f=$Ie(a,l,c,u);else{if(typeof d=="boolean")continue;d instanceof ge?f=eOe(a,l,c,u):d instanceof I?f=tOe(a,l,c,u):d instanceof Ws?f=nOe(a,l,c,u,n):d instanceof Pt?f=iOe(a,l,c,u,n):"isTexture"in d&&(f=oOe(a,l,c,u))}f&&(Array.isArray(f)?r.push(...f):r.push(f))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${u}`,d)}}return r}function $Ie(e,t,i,n){if(!e.hasValue(n)||!(n in i))return;let r=t?t[n]:e.getValue(n),s=i[n];if(r!==s)return{update:o=>{e.setValue(n,si.lerp(r,s,o))},start:()=>{e.setValue(n,r)},end:()=>{e.setValue(n,s)}}}function eOe(e,t,i,n){if(!e.hasValue(n)||!(n in i))return;let r=e.getValue(n),s=t?new ge().fromArray(t[n]):r.clone(),o=new ge().fromArray(i[n]);if(!s.equals(o))return{update:a=>{r.lerpVectors(s,o,a)},start:()=>{r.copy(s)},end:()=>{r.copy(o)}}}function tOe(e,t,i,n){if(!e.hasValue(n)||!(n in i))return;let r=e.getValue(n),s=t?new I().fromArray(t[n]):r.clone(),o=new I().fromArray(i[n]);if(!s.equals(o))return{update:a=>{r.lerpVectors(s,o,a)},start:()=>{r.copy(s)},end:()=>{r.copy(o)}}}function iOe(e,t,i,n,r){if(!e.hasValue(n)||!(n in i))return;let s=t?t[n]:void 0,o=i[n],a=e.getValue(n),l=s?typeof s=="string"?r.getColor(s).clone():new Pt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new Pt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let h=a.clone();return e.setValue(n,h),{update:u=>{h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function nOe(e,t,i,n,r){if(!e.hasValue(n)||!(n in i))return;let s=t?t[n]:void 0,o=i[n],a=e.getValue(n),l=s?typeof s=="string"?r.getColor(s).clone():new Pt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new Ws(o.r,o.g,o.b,o.a);if(l.equals(c))return;let h=a.clone();return e.setValue(n,h),{update:u=>{h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function rOe(e,t,i,n="steps"){if(!e.hasValue(n)||!(n in i))return;let r=[],s=e.getValue(n),o=t?t[n]:s,a=i[n];for(let l=0;l<s.length;++l){let c=o[l],h=a[l];c!==h&&r.push({update:u=>{s[l]=si.lerp(c,h,u)},start:()=>{s[l]=c},end:()=>{s[l]=h}})}return r.length?r:void 0}function sOe(e,t,i,n="colors"){if(!e.hasValue(n)||!(n in i))return;let r=[],s=e.getValue(n),o=t?t[n]:s.map(l=>l.toArray()),a=i[n];for(let l=0;l<s.length;++l){let c=[...o[l]],h=[...a[l]];BS.isEqual(c,h)||r.push({update:u=>{s[l].fromArray(BS.lerp(c,h,u))},start:()=>{s[l].fromArray(c)},end:()=>{s[l].fromArray(h)}})}return r.length?r:void 0}function oOe(e,t,i,n="texture"){if(!e.hasValue(n)||!(n in i))return;let r=e.getNode("mat");if(!r)return;let s=t?t[n]:r,o=i[n],a=[...s.repeat],l=[...s.offset],c=[...o.repeat],h=[...o.offset];if(!km.isEqual(a,c)||!km.isEqual(l,h))return{update:u=>{r.repeat=km.lerp(a,c,u),r.offset=km.lerp(l,h,u),r.updateMatrix()},start:()=>{r.repeat=[...a],r.offset=[...l],r.updateMatrix()},end:()=>{r.repeat=[...c],r.offset=[...h],r.updateMatrix()}}}function aOe(e,t){return{update:()=>{e.transparent=t}}}var CP=new I,rj=new Er;function lOe(e,t,i,n){let r=[],s,o,a,l,c,h,u={slide:(t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping).slide,offset:(t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping).offset};if(c=Hf("slide",u,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,i.pathSnapping??e.dataPatched.pathSnapping),c&&r.push(c),h=Hf("offset",u,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,i.pathSnapping??e.dataPatched.pathSnapping),h&&r.push(h),!c&&!h&&(s=ij("position",e,t,i),s&&r.push(s),o=ij("scale",e,t,i),o&&r.push(o),a=cOe(e,t,i,n),a&&r.push(a),l=WIe("hiddenMatrix",e,t,i),l&&r.push(l)),s||o||a||l||c||h){let d=()=>{var f;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),(f=e.parent)!=null&&f.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),Ol(e)&&Yc(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,u))};r.push({update:d,start:d,end:d})}return r}function cOe(e,t,i,n){let r=t!=null&&t.rotation?t.rotation:void 0,s=i.rotation;if(!s)return;let o=r?new I().fromArray(r):new I().setFromEuler(e.rotation),a=new I().fromArray(s);if(o.equals(a))return;let l=CP.subVectors(a,o);if(n&&l.toArray().every(c=>Math.abs(c)<2*Math.PI)){let c=new ai().setFromEuler(rj.setFromVector3(o)),h=new ai().setFromEuler(rj.setFromVector3(a));return{update:u=>{jIe(c,h,e.quaternion,u)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(a)}}}else return{update:c=>{CP.lerpVectors(o,a,c),e.rotation.setFromVector3(CP)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(a)}}}function uOe(e,t,i){let n=[];if(!("cloner"in i)||!e.cloner)return n;let r=e.cloner,s="cloner"in t?t.cloner:{},o=i.cloner;QQ.forEach(d=>{let f;d==="count"?f=Hf("count",r.parameters,s,o,!0):f=ed(d,r.parameters,s??{},o),f&&n.push(f)});let a=hOe(r,s,o);a!=null&&a.length&&n.push(...a);let l=dOe(r,s,o);l!=null&&l.length&&n.push(...l);let c=fOe(r,s,o);c!=null&&c.length&&n.push(...c);let h=pOe(r,s,o);h!=null&&h.length&&n.push(...h);let u=mOe(r,s,o);return u!=null&&u.length&&n.push(...u),n.length&&n.push({update:()=>{r.update()}}),n}function hOe(e,t,i){if(e.parameters.type!=="radial")return;let n=t.radial,r=i.radial;if(!r)return;let s=e.parameters.radial,o=[];return JQ.forEach(a=>{let l=ed(a,s,n??{},r);l&&o.push(l)}),o}function dOe(e,t,i){if(e.parameters.type!=="linear")return;let n=t.linear,r=i.linear;if(!r)return;let s=[],o=e.parameters.linear;return KQ.forEach(a=>{let l=ed(a,o,n??{},r);l&&s.push(l)}),s}function fOe(e,t,i){if(e.parameters.type!=="grid")return;let n=t.grid,r=i.grid;if(!r)return;let s=[],o=e.parameters.grid;return ZQ.forEach(a=>{let l;a==="count"?l=oZ(a,o,n??{},r,!0):l=ed(a,o,n??{},r),l&&s.push(l)}),s}function pOe(e,t,i){if(e.parameters.type!=="toObject")return;let n=t.toObject,r=i.toObject;if(!r)return;let s=[],o=e.parameters.toObject;return $Q.forEach(a=>{let l;a==="count"?l=Hf(a,o,n??{},r,!0):l=ed(a,o,n??{},r),l&&s.push(l)}),s}function mOe(e,t,i){if(!e.parameters.randomness)return;let n=t.randomnessObject,r=i.randomnessObject;if(!r)return;let s=[],o=e.parameters.randomnessObject;return eJ.forEach(a=>{let l=ed(a,o,n??{},r);l&&s.push(l)}),s}function sj(e,t,i,n,r){let s=[];return e.data.visible&&s.push(...lOe(e,t,i,r)),e.data.visible&&s.push(...uOe(e,t,i)),Ol(e)?(e instanceof da&&e.data.visible&&s.push(...JIe(e,t,i,n)),e.data.visible&&s.push(...ZIe(e,t,i,n))):xRe(e)?e.data.visible&&s.push(...KIe(e,t,i,n)):yRe(e)&&s.push(...YIe(e,t,i)),s.length?{update:o=>{s.forEach(a=>a.update(o))},start:o=>{s.forEach(a=>{var l;return(l=a.start)==null?void 0:l.call(a,o)})},end:o=>{s.forEach(a=>{var l;return(l=a.end)==null?void 0:l.call(a,o)})}}:void 0}var oj=new I;function aZ(e,t,i,n=!1){let r=[];t.traverseObject(s=>{var c,h,u,d,f;if(n&&((c=s.rigidBody)==null||c.setTranslation(s.position0,!0),(h=s.rigidBody)==null||h.setRotation(s.rotation0,!0),(u=s.rigidBody)==null||u.setLinvel(oj,!0),(d=s.rigidBody)==null||d.setAngvel(oj,!0)),!Ei.is(s))return;let o=s.uuid,a=s.data;if(delete s.states,!a.states)return;let l=!1;r.some(p=>e.objects.isDescendantOf(o,p))?l=!0:((f=a.physics)==null?void 0:f.fusedBody)===!0&&a.physics.rigidBody==="dynamic"&&r.push(o),s.data=a,s.currentState=null,s.reversibleToState=null,s.currentTransitionEvent=null;for(let p of a.states)e.environment.usePhysics===!0&&a.physics&&(a.physics.rigidBody==="dynamic"||l)&&(p.data.position!==void 0||p.data.rotation!==void 0||p.data.hiddenMatrix!==void 0)||(s.states||(s.states={}),s.states[p.id]=of.patch(a,p.data));vOe(t,s,null,i,a.events.find(p=>p.data.type==="Follow"||p.data.type==="LookAt")!==void 0),gOe(t)})}function gOe(e){e.traverseEntity(t=>{for(let i of t.data.events){let n=[];switch(i.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":n.push(...i.data.actions);break;case"GameControl":for(let r of Object.values(i.data.gameActions))n.push(...r);break;case"DragDrop":n.push(...i.data.dragDropActions.drag,...i.data.dragDropActions.drop);break;case"Conditional":n.push(...i.data.inActions,...i.data.outActions);break}for(let r of n)r.data.type==="Create"&&r.data.hideBase==="Yes"&&(e.find(r.data.object).visible=!1)}})}function vOe(e,t,i,n,r=!1){if(t instanceof da&&t.removeInteractionGeometry(),t.changeSelectedState(i,{scene:e,shared:n},r),t instanceof da&&t.updateGeometryGroupsIfNeeded(),t instanceof gs&&t.updateCameraState(t.dataPatched,{scene:e,shared:n}),t.cloner)for(let s of t.cloner.children)s.playModeVisible=void 0;t.updateVisible()}function lZ(e){let t;if(e.easing===5){let{control1:i,control2:n}=e;t=`cubicBezier(
			${i[0]}, ${i[1]}, ${n[0]}, ${n[1]}
		)`}else if(e.easing===6){let{mass:i,stiffness:n,damping:r,velocity:s}=e;t=`spring( ${i}, ${n}, ${r}, ${s} )`}else{let i;switch(e.easing){case 0:i=Zu.linear;break;case 1:i=Zu.ease;break;case 2:i=Zu.easeIn;break;case 3:i=Zu.easeOut;break;case 4:i=Zu.easeInOut;break;default:i=Zu.linear}let[n,r,s,o]=i;t=`cubicBezier( ${n}, ${r}, ${s}, ${o} )`}return{duration:e.duration,easing:t}}function cZ(e){let t={delay:0,loop:e.repeat===-1?!0:e.repeat+1};if(e.repeat===0)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1;break}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay;break}return t.direction==="alternate"&&(t.delay/=2,t.endDelay/=2,e.delayDirection==="start"?(t.pingPongDelayCorrection=t.delay,typeof t.loop=="number"&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):e.delayDirection==="end"?typeof t.loop=="number"&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):e.delayDirection==="start-end"&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var yOe={type:"beginState"},xOe={type:"completeState",isfromEntity:!1},aj=class{constructor(e,t,i,n,r,s){if(this.object=e,this.data=n,this.sharedAssets=r,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.dispatchEvent({type:"requestRender"})),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let o=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"beginState",state:o}),this.object.traverseEntity(a=>{a!==this.object&&a instanceof gs&&a.dispatchEvent(yOe)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let o=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"completeState",state:o}),this.object.traverseEntity(a=>{a!==this.object&&a instanceof gs&&a.dispatchEvent(xOe)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=sj(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},t===void 0){let o=AA(this.object,this.object.currentState===i?this.object.prevState:this.object.currentState);if(!o)throw new Error("Missing property");this.from=o}else{let o=AA(this.object,t);if(!o)throw new Error("Missing property");this.from=o}if(i===void 0)throw new Error("Missing property");{let o=AA(this.object,i);if(!o)throw new Error("Missing property");this.to=o}this.useCurrentState=t===void 0||i===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...cZ(n),...lZ(n),change:this.onChange},this.callback=sj(this.object,t===void 0?{}:this.from.data,i===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},Oy=class extends _s{constructor(e,t,i){if(super(),this.data=e,this.scene=t,this.sharedAssets=i,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.useToggle=!1,this.onTimelineChangeComplete=()=>{var r;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward,isRebuild:!0}),this.timeline.play())},!e.object)throw new Error("Missing property");let n=t.find(e.object);if(!n)throw new Error("Missing property");if(!n.states)throw new Error("Missing property");if(this.object=n,e.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=e.tweens[0].data.delayDirection==="start-once"?e.tweens[0].data.delay:0,this.init()}get playing(){return this.tweens.some(e=>e.changeBegan)??!1}init(){this.initialCurrentState=AA(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.useToggle?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:e=!0,isRebuild:t=!1}={}){var i,n,r,s;try{let o=cZ(this.data.tweens[0].data),a=o.loop;t&&typeof o.loop=="number"&&o.loop--,(i=this.timeline)==null||i.pause(),this.timeline=sZ.timeline({autoplay:!1,...o,...a===!0||a>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(this.timelineNeedsRebuild=l!==-1&&(a===!0||a>1),o.pingPongDelayCorrection&&t===!1&&(this.timelineNeedsRebuild=!0),e){let c=l===-1?0:l;for(let h=c;h<this.data.tweens.length-1;h++){let u=this.data.tweens[h],d=this.data.tweens[h+1],f;h===c&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.playing)===!0)?(f=void 0,this.object instanceof gs&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new aj(this.object,f,d.data.state===void 0?this.currentState:d.data.state,d.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&h===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[h]=p,this.timeline.add(p.params,this.timeline.duration+(h===c?o.delay:0)+(h===c&&!t?o.pingPongDelayCorrection:0))}this.timeline.duration+=o.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let h=c;h>0;h--){let u=this.data.tweens[h],d=this.data.tweens[h-1],f;h===c&&(this.object.wasMovedByUser===!0||((r=this.object.previousAction)==null?void 0:r.playing)===!0)?(f=void 0,this.object instanceof gs&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new aj(this.object,f,d.data.state===void 0?this.currentState:d.data.state,u.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&h===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[h-1]=p,this.timeline.add(p.params,this.timeline.duration+(h===c?o.endDelay:0))}this.timeline.duration+=o.delay+(t?0:o.pingPongDelayCorrection)}}catch(o){o instanceof Error&&console.error(o.message)}((s=this.object.previousAction)==null?void 0:s.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(this.playing)return!1;clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(e){e instanceof Error&&console.error(e.message)}},this.startOnceDelay)}pause(){var e;(e=this.timeline)==null||e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object.changeSelectedState(e,{scene:this.scene,shared:this.sharedAssets}),this.object.currentState=e}seek(e){var t;this.timeline===void 0&&this.buildTimeline(),(t=this.timeline)==null||t.seek(e*this.timeline.duration)}toggle(e){var t;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?((t=this.timeline)==null||t.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var i;(i=this.timeline)==null||i.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function AA(e,t){var r;let i,n;if(typeof t=="string"?(i=t,n=(r=e.states)==null?void 0:r[i]):t===null&&(i=null,n=e.data),!(i===void 0||n===void 0))return{id:i,data:n}}var wOe={type:"beginState"},lj={type:"completeState",isfromEntity:!1},cj={type:"requestRender"},uZ=class extends _s{constructor(e,t){super(),this.data=e,this.scene=t,this.toggleIsForward=!1,this.useToggle=!1,this.posStart=new I,this.posEnd=new I,this.qStart=new ai,this.qEnd=new ai,this.zoomStart=1,this.zoomEnd=1,this.toCamera=t.find(e.targetCamera)}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(e=!1){if(!this.data.animate)return;let t={t:0};this.posStart.copy(this.scene.activeCamera.position),this.qStart.copy(this.scene.activeCamera.quaternion),this.zoomStart=this.scene.activeCamera.zoom,this.animation=sZ({targets:t,t:1,...lZ(this.data),update:()=>{t.t===0&&(this.useToggle&&!this.toggleIsForward?(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera)):(this.posEnd.copy(this.toCamera.position),this.qEnd.copy(this.toCamera.quaternion),this.zoomEnd=this.toCamera.zoom,this.fromCamera=this.scene.activeCamera,this.switchCamera(this.toCamera)),this.scene.activeCamera.dispatchEvent(wOe));let i=this.scene.activeCamera;i.position.lerpVectors(this.posStart,this.posEnd,t.t),i.quaternion.slerpQuaternions(this.qStart,this.qEnd,t.t),i.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*t.t,i.wasMovedBySwitchCameraAction=!0,i.updateMatrix(),i.updateMatrixWorld(),i.updateProjectionMatrix(),i.dispatchEvent(cj),t.t===1&&i.dispatchEvent(lj)}})}switchCamera(e){this.scene.activeCamera.dispatchEvent({type:"cameraChange",camera:e}),this.scene.switchActiveCamera(e)}play(){this.playing||this.scene.activeCamera!==this.toCamera&&(clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var e;delete this.timeoutId;try{this.data.animate?(this.buildAnimation(),(e=this.animation)==null||e.play()):this.switchCamera(this.toCamera)}catch(t){t instanceof Error&&console.error(t.message)}},this.data.delay*1e3))}pause(){var e;(e=this.animation)==null||e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){var t,i;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?((t=this.animation)==null||t.pause(),this.buildAnimation(!0),(i=this.animation)==null||i.play()):this.timeoutId=window.setTimeout(()=>{var n,r;delete this.timeoutId,this.data.animate?((n=this.animation)==null||n.pause(),this.buildAnimation(),(r=this.animation)==null||r.play()):(this.toggleIsForward?(this.fromCamera=this.scene.activeCamera,this.switchCamera(this.toCamera)):this.switchCamera(this.fromCamera),this.scene.activeCamera.dispatchEvent(lj),this.scene.activeCamera.dispatchEvent(cj))},this.data.delay*1e3)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function $a(e,t,i,n,r,s){let o={Audio:[],Video:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[]};return t.forEach(({id:a,data:l})=>{try{l.type==="Audio"?Iu[e.type].includes("Audio")&&o.Audio.push(new Dy(a,l,s,n)):l.type==="Video"?Iu[e.type].includes("Video")&&o.Video.push(new uF(a,l,s)):l.type==="Link"?Iu[e.type].includes("Link")&&o.Link.push(new uIe(l,r)):l.type==="Create"?Iu[e.type].includes("Create")&&o.Create.push(new Ry(l,i,r.controlsManager)):l.type==="Destroy"?Iu[e.type].includes("Destroy")&&o.Destroy.push(new HK(l,i,r)):l.type==="Reset"?Iu[e.type].includes("Reset")&&o.Reset.push(new fIe(i.data,i,n,r)):l.type==="Transition"?Iu[e.type].includes("Transition")&&o.Transition.push(new Oy(l,i,n)):l.type==="SwitchCamera"&&Iu[e.type].includes("SwitchCamera")&&o.SwitchCamera.push(new uZ(l,i))}catch{}}),o}function fa(e){Object.values(e).forEach(t=>{t.forEach(i=>{(i instanceof Dy||i instanceof uF||i instanceof Oy||i instanceof Ry||i instanceof HK||i instanceof uZ)&&i.dispose()})})}var wF=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],hZ=e=>{var t;return(t=wF.find(([i,n])=>n===e))==null?void 0:t[0]},P1=e=>{var t;return(t=wF.find(([i])=>i===e))==null?void 0:t[1]},_Oe=(e,t)=>{let i=hZ(e);if(i){let n=new CustomEvent(i,{bubbles:!0});return Object.defineProperty(n,"target",{writable:!1,value:t}),n}},bOe=class extends fu{constructor(e){super(e),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=i=>{var s;if(!i.eventName||!i.target||i.eventName==="Scroll")return;let n=(s=this.splineEvents[hZ(i.eventName)])==null?void 0:s[i.target.uuid];if(!n)return;i.eventName==="Scroll"&&i.deltaY!==void 0&&Object.assign(n,{deltaY:i.deltaY});let{domElement:r}=this.eventContext;r.dispatchEvent(n)};let{scene:t}=this.eventContext;t.traverseEntity(i=>{var n,r;if((n=i.data)!=null&&n.events.length){for(let[s,o]of wF)if(i.data.events.some(a=>a.data.type===o&&!a.data.disabled)){this.objectsPerEvents.has(s)?(r=this.objectsPerEvents.get(s))==null||r.push(i):this.objectsPerEvents.set(s,[i]);let a={id:i.uuid,name:i.name},l=_Oe(o,a),c=this.splineEvents[s];c?c[i.uuid]=l:this.splineEvents[s]={[i.uuid]:l}}}})}connect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.removeEventListener("beginEvent",this.onBeginEvent)})})}},AOe=class{constructor(e,t,i,n,r,s){if(this.id=e,this.data=t,this.object=i,this.entered=!1,this.useToggle=t.toggle,(t.type==="KeyDown"||t.type==="KeyUp"||t.type==="KeyPress")&&!t.key)throw new Error("Missing property");this.actions=$a(t,t.actions,n,r,s,i)}disconnect(){fa(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(e=!1){let t=new Set;this.actions.Transition.forEach(i=>{i.object.currentTransitionEvent!==this?(i.object.currentTransitionEvent=this,i.init()):this.useToggle===!1&&t.add(i)}),this.useToggle?(this.actions.Transition.forEach(i=>{i.toggle()}),this.actions.SwitchCamera.forEach(i=>{i.toggle()})):this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(i=>i.playFromCurrent()),this.actions.SwitchCamera.forEach(i=>i.playFromCurrent()),this.actions.Create.forEach(i=>i.dispatchStart())):(this.actions.Transition.some(i=>i.playing)||this.actions.Transition.forEach(i=>{t.has(i)===!1&&i.play()}),this.actions.SwitchCamera.some(i=>i.playing)||this.actions.SwitchCamera.forEach(i=>{i.play()})),this.actions.Link.forEach(i=>{i.dispatch()}),e===!1&&this.actions.Create.forEach(i=>{i.dispatch()}),this.actions.Destroy.forEach(i=>{i.dispatch()}),this.actions.Reset.forEach(i=>{i.dispatch()}),this.actions.Audio.forEach(i=>{i.dispatchBasic()}),this.actions.Video.forEach(i=>{i.dispatchBasic()})}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()})}},SOe=class extends fu{constructor(e,t){super(e),this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.windowMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.onWindowMouseDown=r=>{r.target===this.eventContext.domElement&&this.canvasMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()}),this.windowMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()})},this.onWindowMouseUp=r=>{r.target===this.eventContext.domElement&&this.canvasMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()}),this.windowMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()})},this.onMouseDown=r=>{Lt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseDown"))},this.onMouseUp=r=>{Lt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=r=>{Lt.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent())},this.onMousePressRelease=r=>{Lt.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent(!0))},this.onKeyDown=r=>{this.heldKeys[r.key]||(this.handleKeyEvent(r,"KeyDown"),this.handleKeyEventHeld(r,"KeyDown",!0)),this.heldKeys[r.key]=!0},this.onKeyUp=r=>{this.handleKeyEvent(r,"KeyUp"),this.handleKeyEventHeld(r,"KeyUp",!0)},this.onKeyPressDown=r=>{this.heldKeysPress[r.key]?this.handleKeyEventHeld(r,"KeyPress"):(this.handleKeyEvent(r,"KeyPress"),this.handleKeyEventHeld(r,"KeyPress",!0)),this.heldKeysPress[r.key]=!0},this.onKeyPressUp=r=>{this.handleKeyEvent(r,"KeyPress",!0)},this.releaseHeldKey=r=>{delete this.heldKeys[r.key]},this.releaseHeldKeyPress=r=>{delete this.heldKeysPress[r.key]},this._onUserEvent=({eventName:r,target:s,reverse:o})=>{var l,c,h,u;if(!r||!s)return;let a=P1(r);a&&(a==="MouseDown"||a==="MouseUp"||a==="MousePress"?(s.dispatchEvent({type:"beginEvent",eventName:a}),(c=(l=this.eventsPerObjects[a])==null?void 0:l[s.uuid])==null||c.forEach(d=>{d.dispatchUserEvent(o)})):(a==="KeyDown"||a==="KeyUp"||a==="KeyPress")&&(s.dispatchEvent({type:"beginEvent",eventName:a}),(u=(h=this.eventsPerObjects[a])==null?void 0:h[s.uuid])==null||u.forEach(d=>{d.dispatchUserEvent()})))};let{scene:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var o,a;if(!((o=r.data)!=null&&o.events.length))return;let s=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let l of s){let c=this.eventsPerObjects[l];r.data.events.filter(({data:h})=>h.type===l&&h.disabled!==!0).forEach(({id:h,data:u})=>{try{let d=new AOe(h,u,r,i,n,t);d.actions.Video.length&&(this.hasVideoAction=!0),(u.type==="MouseDown"||u.type==="MouseUp"||u.type==="MousePress")&&(u.mode==="Canvas"||u.mode==="Window")?u.mode==="Canvas"&&this.canvasMouseEvents.push(d):c[r.uuid]?c[r.uuid].push(d):c[r.uuid]=[d]}catch{}}),(a=c[r.uuid])!=null&&a.length&&this.objectsPerTypes[l].push(r)}})}connect(){var t,i,n,r,s,o;let{domElement:e}=this.eventContext;this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),typeof window<"u"&&(window.addEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.addEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),(t=this.objectsPerTypes.MouseDown)!=null&&t.length&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseDown)),(i=this.objectsPerTypes.MouseUp)!=null&&i.length&&(this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMouseUp)),(n=this.objectsPerTypes.MousePress)!=null&&n.length&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMousePressRelease)),(r=this.objectsPerTypes.KeyDown)!=null&&r.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(s=this.objectsPerTypes.KeyUp)!=null&&s.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(o=this.objectsPerTypes.KeyPress)!=null&&o.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([a,l])=>{l.forEach(c=>{c.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},typeof window<"u"&&(window.removeEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.removeEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(t=>{Object.values(t).forEach(i=>{i.forEach(n=>{n.disconnect()})})}),this.canvasMouseEvents.forEach(t=>{t.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([t,i])=>{i.forEach(n=>{n.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){let{stopRaycast:t,raycaster:i,scene:n}=this.eventContext,r=this.objectsPerTypes[e];if(r.length)if(t){let s=hL(i,n,r);dL(s).forEach(o=>{this.eventsPerObjects[e][o.uuid]&&this.handleObjectMouseEventDispatch(o,e)})}else r.forEach(s=>{ZS(i,s)&&this.handleObjectMouseEventDispatch(s,e)})}handleMousePressEvent(e=!1){let t="MousePress",i=this.objectsPerTypes[t],n=[];if(i.length){if(!e){let{stopRaycast:r,raycaster:s,scene:o}=this.eventContext;if(r){let a=hL(s,o,i);n=dL(a)}else i.forEach(a=>{ZS(s,a)&&n.push(a)})}this._prevObjects.length&&this._prevObjects.forEach(r=>{n.includes(r)||this.handleObjectMouseEventDispatchRelease(r,t)}),n.length&&n.forEach(r=>{this.handleObjectMouseEventDispatch(r,t)}),this._prevObjects=n}}handleObjectMouseEventDispatch(e,t){var i,n;e.dispatchEvent({type:"beginEvent",eventName:t}),(n=(i=this.eventsPerObjects[t])==null?void 0:i[e.uuid])==null||n.forEach(r=>{r.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){var i,n;e.dispatchEvent({type:"beginEvent",eventName:t}),(n=(i=this.eventsPerObjects[t])==null?void 0:i[e.uuid])==null||n.forEach(r=>{r.dispatchRelease()})}handleKeyEvent(e,t,i=!1){this.objectsPerTypes[t].forEach(n=>{let r=this.eventsPerObjects[t][n.uuid];r.some(({data:s})=>"key"in s&&s.key===e.key)&&n.dispatchEvent({type:"beginEvent",eventName:t}),r.forEach(s=>{"key"in s.data&&s.data.key===e.key&&(i?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(e,t,i=!1){this.objectsPerTypes[t].forEach(n=>{this.eventsPerObjects[t][n.uuid].forEach(r=>{"key"in r.data&&r.data.key===e.key&&r.dispatchHeld(i)})})}},MOe=new I,EOe=new I,dZ=class{constructor(e,t,i,n,r){this.actionsIn=$a(e,e.inActions,i,n,r,t),this.actionsOut=$a(e,e.outActions,i,n,r,t)}disconnect(){fa(this.actionsIn),fa(this.actionsOut)}},COe=class extends dZ{constructor(e,t,i,n,r,s){super(t,i,n,r,s),this.id=e,this.data=t,this.object=i,this.stage="out",this.objects=[],this.onUpdateMatrix=()=>{let c=MOe.setFromMatrixPosition(this.objects[0].matrixWorld),h=EOe.setFromMatrixPosition(this.objects[1].matrixWorld),u=c.distanceTo(h)<=this.distance?"in":"out";if(this.stage!==u){let d=u==="in"?this.actionsIn:this.actionsOut;d.Audio.forEach(f=>f.dispatchConditional()),d.Video.forEach(f=>f.dispatchConditional()),d.Create.forEach(f=>f.dispatch()),d.Destroy.forEach(f=>f.dispatch()),d.Transition.forEach(f=>{f.object.currentTransitionEvent!==this&&(f.object.currentTransitionEvent=this),f.init()}),d.Transition.forEach(f=>f.play()),d.SwitchCamera.forEach(f=>f.play()),this.stage=u}};let{distance:o,fromObject:a,toObject:l}=t.condition;this.distance=o;for(let c of[a,l]){if(!c)throw new Error("Missing property");let h=n.find(c);if(!h)throw new Error("Missing property");this.objects.push(h)}}connect(){this.objects.forEach(e=>{e.addEventListener("updateMatrix",this.onUpdateMatrix)}),this.onUpdateMatrix()}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrix",this.onUpdateMatrix)})}},TOe=class extends dZ{constructor(e,t,i,n,r,s){var l;super(t,i,n,r,s),this.id=e,this.data=t,this.object=i,this.onBegin=({target:c,state:h})=>{this.toState!==h&&(this.actionsOut.Audio.forEach(u=>u.dispatchConditional()),this.actionsOut.Video.forEach(u=>u.dispatchConditional()),this.actionsOut.Create.forEach(u=>u.dispatch()),this.actionsOut.Destroy.forEach(u=>u.dispatch()),this.actionsIn.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(u=>u.play()),this.actionsIn.SwitchCamera.forEach(u=>u.pause()),this.actionsOut.SwitchCamera.forEach(u=>u.play()))},this.onComplete=({target:c,state:h})=>{this.toState===h&&(this.actionsIn.Audio.forEach(u=>u.dispatchConditional()),this.actionsIn.Video.forEach(u=>u.dispatchConditional()),this.actionsIn.Create.forEach(u=>u.dispatch()),this.actionsIn.Destroy.forEach(u=>u.dispatch()),this.actionsOut.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(u=>u.play()),this.actionsOut.SwitchCamera.forEach(u=>u.pause()),this.actionsIn.SwitchCamera.forEach(u=>u.play()))};let{condition:o}=t;if(!o.object)throw new Error("Missing property");let a=n.find(o.object);if(!a)throw new Error("Missing property");if(this.toObject=a,o.state&&!((l=this.toObject.states)!=null&&l[o.state]))throw new Error("Missing property");this.toState=o.state}connect(){(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.SwitchCamera.length)&&this.toObject.addEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.SwitchCamera.length)&&this.toObject.addEventListener("completeState",this.onComplete)}disconnect(){super.disconnect(),(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.SwitchCamera.length)&&this.toObject.removeEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.SwitchCamera.length)&&this.toObject.removeEventListener("completeState",this.onComplete)}},POe=class extends fu{constructor(e,t){super(e),this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1;let{scene:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var s;if((s=r.data)!=null&&s.events.length){for(let{id:o,data:a}of r.data.events)if(!a.disabled&&a.type==="Conditional")try{let l;a.condition.type==="Comparison"||(a.condition.type==="Distance"?l=new COe(o,a,r,i,n,t):a.condition.type==="State"&&(l=new TOe(o,a,r,i,n,t))),l&&(this.eventsPerConditions[a.condition.type].push(l),(l.actionsIn.Video.length||l.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}})}connect(){super.connect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.disconnect()))}},O0=new I,zu=new I,Pd=new I,uj=new oo,DOe=.01,_i=new I,Qn=new I,hj=new I,cf=new ai,TP=new Er,BOe=new Je,PP=new Cr,nm=new I,_l=new I,rm=.2;function DP(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var LOe=function(){let e=new Je;return(t,i,n)=>{let r=t.obj;e.copy(r.hiddenMatrix),r.parent!==null&&e.premultiply(r.parent.matrixWorld),e.invert(),r.position.copy(i),t.reference==="global"&&DP(r.position,t.limits),r.position.applyMatrix4(e),t.reference==="parent"?DP(r.position,t.limits):t.reference==="local"&&(cf.copy(t.quat0).invert(),r.position.sub(t.position0),r.position.applyQuaternion(cf),DP(r.position,t.limits),cf.invert(),r.position.applyQuaternion(cf),r.position.add(t.position0)),e.multiply(n??r.matrixWorld).decompose(_i,r.quaternion,Qn),r.updateMatrix(),r.hasNonUniformScale&&(r.updateMatrixWorld(),r.updateMatrixWorldSVD()),r instanceof Ys&&Yc(r.parent)&&r.invalidateDownstreamBooleanData(!0)}}(),ROe=class{constructor(e,t,i,n,r,s){this.object=e,this.data=t,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=$a(t,t.dragDropActions.drag,i,n,r,this.object),this.actionsDrop=$a(t,t.dragDropActions.drop,i,n,r,this.object);let o=[];this.data.objects.forEach(a=>{let l=i.find(a);!l||l.dataPatched.visible!==!1&&(o.push(l),s[l.uuid]&&s[l.uuid].forEach(c=>{let h=i.find(c);!h||h.dataPatched.visible!==!1&&o.push(h)}))}),this.data.dropDestinations.forEach(a=>{let l=i.find(a);!l||l.dataPatched.visible!==!1&&(this.dropDestIds.push(l.uuid),s[l.uuid]&&s[l.uuid].forEach(c=>{let h=i.find(c);!h||h.dataPatched.visible!==!1&&this.dropDestIds.push(h.uuid)}))}),this.dragItems=o.map(a=>(this.data.planeMode==="locked"&&(a.userData.lockedPlane=!0),a.userData.worldPosition0=new I().setFromMatrixPosition(a.matrixWorld),{obj:a,fromPosition:new I().setFromMatrixPosition(a.matrixWorld),pointStart:new I,pointEnd:new I,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new I().copy(a.position),quat0:new ai().copy(a.quaternion),snapped:!1,orientationMatrix:new Je,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){fa(this.actionsDrag),fa(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},IOe=class extends fu{constructor(e,t){super(e),this.managers=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=n=>{var a;if(Lt.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:r,scene:s}=this.eventContext,o=s.raycastWithClones(r);if(this.lastDropDestination=null,o.length===0){this.activeEvent=null;return}for(let l of this.events){let c=0;for(let{obj:h,pointEnd:u,pointStart:d}of l.dragItems){if(h===o[0].object||h===o[0].object.object||Ei.is(h)&&h.isAncestorOf(o[0].object.uuid)){if(l.activeIdx=c,l.activeDragItem.reset=!1,l.activeDragItem.currentDampingFactor=l.data.dampingFactor,l.activeDragItem.snapped=!1,l.data.cursor==="hand"&&this.setCursor("grabbing"),this.managers.controlsManager.usePhysics){l.activeDragItem.obj.rigidBody&&l.activeDragItem.obj.rigidBody.setBodyType(2,!0);let f=l.activeDragItem.obj;h.hasNonUniformScale&&h.updateMatrixWorldSVD(),(f.hasNonUniformScale?f.matrixWorldRigid:f.matrixWorld).decompose(_i,cf,Qn),TP.setFromQuaternion(cf),f.prevR===void 0?(f.prevR=TP.clone(),f.prevT=_i.clone()):(f.prevR.copy(TP),f.prevT.copy(_i)),this.managers.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(l.activeDragItem.obj)}this.calcPlaneIntersectPos(h,d,l.data.plane,l.data.referenceFrame),u.copy(d),(this.managers.controlsManager.usePhysics&&((a=h.dataPatched.physics)==null?void 0:a.rigidBody)==="dynamic"||l.data.drop===!1||l.data.resetOnSnapFail===!1)&&l.activeDragItem.fromPosition.setFromMatrixPosition(l.activeDragItem.obj.matrixWorld),this.activeEvent=l,this.managers.controlsManager.orbitControls&&(this.managers.controlsManager.orbitControls.enabled=!1);return}c++}}this.activeEvent=null},this.onPointerMove=n=>{var a,l,c,h;if(Lt.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:r,scene:s}=this.eventContext,o=s.raycastWithClones(r);if(Lt.length===0){let u=!1;for(let d of this.events){for(let{obj:f}of d.dragItems)if(f===((a=o[0])==null?void 0:a.object)||f===((c=(l=o[0])==null?void 0:l.object)==null?void 0:c.object)||Ei.is(f)&&f.isAncestorOf((h=o[0])==null?void 0:h.object.uuid)){switch(u=!0,d.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(u)break}u||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let u=this.activeEvent.activeDragItem;u.snapped=!1;let d;if(this.activeEvent.data.drop&&(d=o.filter(f=>u.obj!==f.object&&!u.obj.isAncestorOf(f.object.uuid)&&!(f.object instanceof JS)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(p=>p===f.object.uuid||s.find(p).isAncestorOf(f.object.uuid))))[0]),d){let f=hj.copy(d.face.normal).applyMatrix3(PP.getNormalMatrix(d.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")u.fromPosition.setFromMatrixPosition(d.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(u.fromPosition.copy(d.point),this.activeEvent.data.snapSurfaceMode==="bbox"){_i.copy(f).applyMatrix3(PP.setFromMatrix4(u.obj.matrixWorld).transpose());let p=u.obj;_i.x>rm?Qn.x=-p.recursiveBBox.min.x:_i.x<-rm&&(Qn.x=-p.recursiveBBox.max.x),_i.y>rm?Qn.y=-p.recursiveBBox.min.y:_i.y<-rm&&(Qn.y=-p.recursiveBBox.max.y),_i.z>rm?Qn.z=-p.recursiveBBox.min.z:_i.z<-rm&&(Qn.z=-p.recursiveBBox.max.z),Qn.applyMatrix3(PP.invert())}else Qn.copy(f).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);u.fromPosition.add(Qn)}this.activeEvent.data.autoOrient&&(_i.set(0,1,0).cross(f),_i.length()<1e-4&&_i.set(-1,0,0).cross(f),Qn.crossVectors(hj,_i),u.orientationMatrix.makeBasis(_i,Qn,f)),u.pointStart.copy(u.fromPosition),u.pointEnd.copy(u.pointStart),u.currentDampingFactor=this.activeEvent.snapDampingFactor,u.snapped=!0,this.lastDropDestination!==d.object&&(this.lastDropDestination=d.object,this.activeEvent.actionsDrop.Transition.forEach(p=>{p.play()}),this.activeEvent.actionsDrop.Audio.forEach(p=>{p.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(p=>{p.dispatchThrottled()}))}else u.orientationMatrix.makeRotationFromQuaternion(u.quat0),this.lastDropDestination=null,u.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(u.obj,u.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(f=>{f.stop(),f.object.currentState!==null&&f.object.changeSelectedState(null,{scene:this.eventContext.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(f=>{f.dispatchThrottled()}),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrag.Audio.forEach(f=>{f.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(f=>{f.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(f=>{f.stop(),f.object.currentState!==null&&f.object.changeSelectedState(null,{scene:this.eventContext.scene,shared:this.eventContext.sharedAssets})}))},500),this.updateDragItem(u),u.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=n=>{var r;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let s=((r=this.activeEvent.activeDragItem.obj.dataPatched.physics)==null?void 0:r.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.managers.controlsManager.usePhysics===!1||!s)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.managers.controlsManager.usePhysics&&s&&(this.managers.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(o=>{o.stop(),o.object.currentState!==null&&o.object.changeSelectedState(null,{scene:this.eventContext.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Audio.forEach(o=>{o.dispatchGameControl("stop")})),this.managers.controlsManager.orbitControls&&(this.managers.controlsManager.orbitControls.enabled=!0)}};let i={};e.scene.traverseEntity(n=>{n.component&&(i[n.component.uuid]?i[n.component.uuid].push(n.uuid):i[n.component.uuid]=[n.uuid])}),e.scene.traverseEntity(n=>{var r;(r=n.data)==null||r.events.filter(s=>s.data.type==="DragDrop"&&!s.data.disabled).forEach(s=>{this.events.push(new ROe(n,s.data,e.scene,e.sharedAssets,t,i))})})}connect(){if(!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let e=this.eventContext.domElement;e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("pointermove",this.onPointerMove),e.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(t=>t.dispose())}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,i,n){let{camera:r,raycaster:s}=this.eventContext;r.getWorldDirection(zu),zu.negate();let o=cf.identity();switch(n==="parent"?BOe.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(_i,o,Qn):n==="local"&&e.matrixWorld.decompose(_i,o,Qn),i){case"x":_i.set(1,0,0).applyQuaternion(o),nm.copy(zu).cross(_i),_l.copy(_i).cross(nm);break;case"y":_i.set(0,1,0).applyQuaternion(o),nm.copy(zu).cross(_i),_l.copy(_i).cross(nm);break;case"z":_i.set(0,0,1).applyQuaternion(o),nm.copy(zu).cross(_i),_l.copy(_i).cross(nm);break;case"xy":_l.set(0,0,1).applyQuaternion(o);break;case"yz":_l.set(1,0,0).applyQuaternion(o);break;case"xz":_l.set(0,1,0).applyQuaternion(o);break;case"adaptive":zu.angleTo(Qn.set(0,1,0))>Math.PI/6?(_i.crossVectors(Qn.set(0,1,0),zu),_l.crossVectors(_i,Qn)):_l.set(0,1,0);break;default:_l.copy(zu);break}Pd.setFromMatrixPosition(e.matrixWorld);let a=e.userData.lockedPlane?e.userData.worldPosition0:Pd;if(uj.setFromNormalAndCoplanarPoint(_l,a),!!s.ray.intersectPlane(uj,t)&&(i==="x"||i==="y"||i==="z")){let l=Qn.subVectors(t,a).dot(_i);t.copy(a).addScaledVector(_i,l)}}updateDragItem(e,t=!1){var i,n;Pd.setFromMatrixPosition(e.obj.matrixWorld),e.reset==="current"?O0.subVectors(e.fromPosition,Pd).divideScalar(e.currentDampingFactor):e.reset==="original"?(O0.subVectors(e.obj.userData.worldPosition0,Pd).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):O0.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(Pd).divideScalar(e.currentDampingFactor),e.paused=e.currentDampingFactor>1?O0.length()<DOe:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||t)&&LOe(e,O0.add(Pd),(i=this.activeEvent)!=null&&i.data.drop&&((n=this.activeEvent)!=null&&n.data.autoOrient)?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.managers.eventManager.requestRender()}},sm=new I,BP=new I,Sc=new I,Mc=new I,dj=new oo,OOe=.01,FOe={type:"requestRender"},NOe=function(){let e=new I,t=new I;return(i,n,r)=>r>0?(e.subVectors(i,n),e.length()<=r?i:t.copy(n).add(e.normalize().multiplyScalar(r))):n}(),fj=function(){let e=new Je;return(t,i)=>{t.position.copy(i),t.parent!==null&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof Ys&&Yc(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),zOe=class{constructor(e,t,i,n,r){this.data=e,this.object=t,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new I,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...EB.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(e.target==="personal camera"?this.target=i.find(sa.PERSONAL_CAMERA_ID):this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=$a(e,e.actions,i,n,r,t)}},kOe=class extends fu{constructor(e,t){super(e),this.events=[],this.pairOfEventListeners=[],this.onMouseMove=n=>{if(!(Lt.length>1)){this.eventContext.updateRaycaster(n);for(let r of this.events)r.target===void 0&&this.updateSingleEvent(r)}},this.onMouseEnter=n=>{for(let r of this.events)r.target===void 0&&(r.isReset=!1,r.currentDampingFactor=r.data.dampingFactor)},this.onMouseLeave=n=>{for(let r of this.events)r.target===void 0&&(r.data.resetOnPointerLeave&&(r.isReset=!0,r.currentDampingFactor=r.resetDampingFactor),this.updateSingleEvent(r))},this.onTargetChange=n=>()=>{this.updateSingleEvent(n)};let{scene:i}=this.eventContext;i.traverseEntity(n=>{var s,o;let r=(s=n.data)==null?void 0:s.events.find(a=>a.data.type==="Follow"&&!a.data.disabled);r&&(!i.data.environment.usePhysics||((o=n.dataPatched.physics)==null?void 0:o.rigidBody)!=="dynamic")&&this.events.push(new zOe(r.data,n,i,e.sharedAssets,t))})}connect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),ho&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(e.addEventListener("pointerenter",this.onMouseEnter),e.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events)if(i.target!==void 0){let n=i.target,r=this.onTargetChange(i);this.pairOfEventListeners.push([n,r]),n.addEventListener("requestRender",r)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),ho&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[i,n]of this.pairOfEventListeners)i.removeEventListener("requestRender",n);for(let i of this.events)i.paused=!0,i.isReset=!1,fa(i.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e,t=!1){var o;this.events.forEach(a=>{a.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:i,limitDistance:n,limitDistanceEnabled:r}=e.data;if(e.object.getWorldPosition(Sc),e.isReset)Mc.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(Mc);else{let{camera:a,raycaster:l}=this.eventContext;if(i==="custom"?(a.getWorldDirection(BP),BP.negate(),sm.copy(BP)):i==="xy"?sm.set(0,0,1):i==="xz"?sm.set(0,1,0):i==="yz"&&sm.set(1,0,0),dj.setFromNormalAndCoplanarPoint(sm,Sc),!l.ray.intersectPlane(dj,Mc))return}if(!e.isReset){if(Mc.distanceTo(e.worldPosition0)>n&&r&&e.target)if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Mc.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor;else return;else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return}e.data.enabledTranslation[0]===!1&&(Mc.x=Sc.x),e.data.enabledTranslation[1]===!1&&(Mc.y=Sc.y),e.data.enabledTranslation[2]===!1&&(Mc.z=Sc.z);let s=NOe(Sc,Mc,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let a=sm.subVectors(s,Sc).divideScalar(e.currentDampingFactor);Sc.add(a),t&&fj(e.object,Sc),e.paused=a.length()<OOe}else fj(e.object,s),e.paused=!0;(o=e.object)==null||o.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(FOe)}},F0=new I,Ob=new I,N0=new Je,om=new ai,ku=new ai,z0=new I,k0=new I,Dd=new I,Ec=new I,LP=new oo,UOe=1e-6,GOe={type:"requestRender"},HOe={type:"changeRotation"},pj=function(){let e=new Je;return function(t,i){t.parent!==null?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),i.premultiply(OK(e).invert()),t.rotation.setFromRotationMatrix(i),t.updateMatrix(),t instanceof Ys&&Yc(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),VOe=class{constructor(e,t,i){this.object=t,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new ai,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...CB.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(e.target==="personal camera"?this.target=i.find(sa.PERSONAL_CAMERA_ID):this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},jOe=class extends fu{constructor(e){super(e),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=i=>{if(!(Lt.length>1)){this._lastMouseEvent=i,this.eventContext.updateRaycaster(i);for(let n of this.events)n.target===void 0&&this.updateSingleEvent(n)}},this.onMouseEnter=i=>{for(let n of this.events)n.target===void 0&&(n.isReset=!1,n.currentDampingFactor=n.data.dampingFactor)},this.onMouseLeave=i=>{for(let n of this.events)n.target===void 0&&(n.data.resetOnPointerLeave&&(n.isReset=!0,n.currentDampingFactor=n.resetDampingFactor),this.updateSingleEvent(n))},this.onScroll=i=>{if(this._lastMouseEvent){let n=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(n)}},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)},this.createUserEventListener=i=>({eventName:n,target:r})=>{if(!n||!r)return;let s=P1(n);s&&s==="LookAt"&&this.updateSingleEvent(i)};let{scene:t}=this.eventContext;t.traverseEntity(i=>{var r,s;let n=(r=i.data)==null?void 0:r.events.find(o=>o.data.type==="LookAt"&&!o.data.disabled);n&&(!t.data.environment.usePhysics||((s=i.dataPatched.physics)==null?void 0:s.rigidBody)!=="dynamic")&&this.events.push(new VOe(n.data,i,t))})}connect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),ho&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?t.addEventListener("scroll",this.onScroll):(e.addEventListener("pointerenter",this.onMouseEnter),e.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events){if(i.target!==void 0){let s=this.onTargetChange(i),o=i.target;this.pairOfEventListeners.push([o,s]),o.addEventListener("requestRender",s)}let n=this.createUserEventListener(i),r=i.object;this.pairOfUserEventListeners.push([r,n]),r.addEventListener("userEvent",n)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),ho&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[i,n]of this.pairOfEventListeners)i.removeEventListener("requestRender",n);for(let[i,n]of this.pairOfUserEventListeners)i.removeEventListener("userEvent",n);for(let i of this.events)i.paused=!0,i.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var d;let{tilt:t,axis:i,distance:n,plane:r,limitDistance:s,enabledRotation:o,limitDistanceEnabled:a}=e.data,{camera:l,raycaster:c}=this.eventContext,{object:h,target:u}=e;if(h.getWorldPosition(z0),!e.isReset)if(e.target)e.target.getWorldPosition(k0);else{if(r==="custom"?(l.getWorldDirection(Ob),Ob.negate(),LP.setFromNormalAndCoplanarPoint(Ob,z0)):(r==="xy"?F0.set(0,0,1):r==="xz"?F0.set(0,1,0):r==="yz"&&F0.set(1,0,0),LP.setFromNormalAndCoplanarPoint(F0,z0)),!c.ray.intersectPlane(LP,k0))return;n>0&&(r==="custom"||r===void 0)&&k0.addScaledVector(Ob,n)}if(e.isReset||(u?t==="target"?Dd.copy(u.up).applyMatrix4(N0.extractRotation(u.matrixWorld)).normalize():o.some(f=>f===!1)?(i==="x"?(Ec.set(0,0,1),o[2]===!1&&Ec.set(0,1,0)):i==="y"?(Ec.set(1,0,0),o[0]===!1&&Ec.set(0,0,1)):(Ec.set(0,1,0),o[1]===!1&&Ec.set(1,0,0)),Dd.copy(Ec).applyQuaternion(e.worldQuaternion0).normalize()):Dd.set(0,1,0):r==="custom"?Dd.set(0,1,0):Dd.copy(F0)),e.isReset)ku.copy(e.worldQuaternion0);else if(z0.distanceTo(k0)>s&&a&&u)if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)ku.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor;else return;else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return;WOe(N0,k0,z0,Dd,i,Ec),ku.setFromRotationMatrix(N0),om.setFromUnitVectors(Ec.applyQuaternion(ku),Dd),o.some(f=>f===!1)&&t!=="target"&&ku.premultiply(om).normalize()}e.currentDampingFactor>1?(h.updateWorldMatrix(!0,!1),om.setFromRotationMatrix(OK(h.matrixWorld)),om.slerp(ku,1/e.currentDampingFactor),pj(h,N0.makeRotationFromQuaternion(om)),e.paused=8*(1-om.dot(ku))<UOe):(pj(h,N0.makeRotationFromQuaternion(ku)),e.paused=!0),(d=e.object)==null||d.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),h.dispatchEvent(GOe),h.dispatchEvent(HOe)}},Uo=new I,qn=new I,Mn=new I;function WOe(e,t,i,n,r,s){let o=e.elements;Mn.subVectors(t,i),Mn.lengthSq()===0&&(Mn.z=1),Mn.normalize(),qn.crossVectors(n,Mn),qn.lengthSq()===0&&(Math.abs(n.z)===1?Mn.x+=1e-4:Mn.z+=1e-4,Mn.normalize(),qn.crossVectors(n,Mn)),qn.normalize(),Uo.crossVectors(Mn,qn),r==="x"?s.z===1?[qn,Uo,Mn]=[Mn,qn,Uo]:(qn.negate(),[qn,Mn]=[Mn,qn]):r==="y"?s.x===1?[qn,Uo,Mn]=[Uo,Mn,qn]:(qn.negate(),[Uo,Mn]=[Mn,Uo]):s.x===1&&(qn.negate(),[qn,Uo]=[Uo,qn]),o[0]=qn.x,o[4]=Uo.x,o[8]=Mn.x,o[1]=qn.y,o[5]=Uo.y,o[9]=Mn.y,o[2]=qn.z,o[6]=Uo.z,o[10]=Mn.z}var XOe=class{constructor(e,t,i,n,r,s){this.id=e,this.data=t,this.object=i,this.entered=!1,this.actions=$a(t,t.actions,n,r,s,i)}disconnect(){fa(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()))}},YOe=class extends fu{constructor(e,t){super(e),this.eventsPerObjects={},this.objects=[],this._prevObjects=[],this.onMouseDown=r=>{Lt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onMouseUp=r=>{Lt.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=r=>{Lt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:r,target:s,reverse:o})=>{var l;if(!r||!s)return;let a=P1(r);a&&a==="MouseHover"&&(s.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(l=this.eventsPerObjects[s.uuid])==null||l.forEach(c=>c.dispatchUserEvent(o)))};let{scene:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var s,o;if(!(!r.visible||!((s=r.data)!=null&&s.events.length))){for(let{id:a,data:l}of r.data.events)if(!l.disabled&&l.type==="MouseHover")try{let c=new XOe(a,l,r,i,n,t);this.eventsPerObjects[r.uuid]?this.eventsPerObjects[r.uuid].push(c):this.eventsPerObjects[r.uuid]=[c]}catch{}(o=this.eventsPerObjects[r.uuid])!=null&&o.length&&this.objects.push(r)}})}connect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),ho&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(t=>{t.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),ho&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(t=>{t.forEach(i=>{i.disconnect()})}),this.objects.forEach(t=>{t.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(e=!1){let t=[];if(!e){let{stopRaycast:i,raycaster:n,scene:r}=this.eventContext;if(i){let s=hL(n,r,this.objects);t=dL(s)}else this.objects.forEach(s=>{ZS(n,s)&&t.push(s)})}this._prevObjects.length&&this._prevObjects.forEach(i=>{var n;t.includes(i)||(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(n=this.eventsPerObjects[i.uuid])==null||n.forEach(r=>r.dispatchLeave()))}),t.length&&t.forEach(i=>{var n;i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(n=this.eventsPerObjects[i.uuid])==null||n.forEach(r=>r.dispatchEnter())}),this._prevObjects=t}},qOe=class{constructor(e,t,i,n,r,s){this.id=e,this.data=t,this.object=i,this.scrollCounter=0,this.actions=$a(t,t.actions,n,r,s,i)}connect(){this.scrollCounter=0}disconnect(){fa(this.actions)}dispatch(e){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let i=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(n=>n.seek(i)),this.actions.Create.forEach(n=>n.dispatchThrottled())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?this.actions.Transition.forEach(t=>t.reverseFromCurrent()):this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Create.forEach(t=>t.dispatchThrottled())}},QOe=class{constructor(e,t,i,n,r,s,o){this.id=e,this.data=t,this.object=i,this.domElement=s,this.managers=o,this.scrollStart=0,this.scrollEnd=0,this.actions=$a(t,t.actions,n,r,o,i)}computeScrollBounds(){let e=this.domElement.getBoundingClientRect(),t=document.body,i=document.documentElement,n=window.pageYOffset||i.scrollTop||t.scrollTop,r=i.clientTop||t.clientTop||0,s=Math.round(e.top+n-r);if(this.data.startFrom==="enter"){let o=window.innerHeight,a=e.height,l=this.data.enterAnchor,c=l==="top"?o:l==="bottom"?o-a:o-a*.5;this.scrollStart=s-c}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.dispatch({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){fa(this.actions)}handleResize(){this.computeScrollBounds()}dispatch({x:e,y:t}){this.actions.Transition.forEach(r=>{r.object.currentTransitionEvent!==this&&(r.object.currentTransitionEvent=this,r.init())});let i=this.scrollEnd-this.scrollStart,n=Math.min(1,Math.max(0,(t-this.scrollStart)/i));this.actions.Transition.forEach(r=>r.seek(n)),this.actions.Create.forEach(r=>r.dispatchThrottled())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?this.actions.Transition.forEach(t=>t.reverseFromCurrent()):this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Create.forEach(t=>t.dispatchThrottled())}},JOe=class extends fu{constructor(e,t){super(e),this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([o,a])=>{a.forEach(l=>l.handleResize())})},this.onScroll=o=>{if(!this.isInview)return;let a={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([l,c])=>{l.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:a}),c.forEach(h=>h.dispatch(a))})},this.onWheel=o=>{!this.isInview||o.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([a,l])=>{a.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:o.deltaY}),l.forEach(c=>c.dispatch(o.deltaY))})},this.onUserEvent=({eventName:o,target:a,reverse:l})=>{var h;if(!o||!a)return;let c=P1(o);c&&c==="Scroll"&&(a.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(h=this.wheelEventsPerObject.get(a))==null||h.forEach(u=>{u.dispatchUserEvent(l)}))};let{scene:i,sharedAssets:n,domElement:r,isExport:s}=this.eventContext;i.traverseEntity(o=>{var a,l,c;if((a=o.data)!=null&&a.events.length){for(let{id:h,data:u}of o.data.events)if(!u.disabled&&u.type==="Scroll")if(u.trigger==="load"||!s){let d=new qOe(h,u,o,i,n,t);this.wheelEventsPerObject.has(o)?(l=this.wheelEventsPerObject.get(o))==null||l.push(d):this.wheelEventsPerObject.set(o,[d])}else{let d=new QOe(h,u,o,i,n,r,t);this.scrollEventsPerObject.has(o)?(c=this.scrollEventsPerObject.get(o))==null||c.push(d):this.scrollEventsPerObject.set(o,[d])}}}),this.intersectionObserver=new IntersectionObserver(o=>{let a=o[0];a&&(this.isInview=a.isIntersecting)},{root:null})}connect(){this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.connect()),e.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.connect()),e.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)})}},KOe=class{constructor(e,t,i,n,r,s){this.id=e,this.data=t,this.object=i,this.actions=$a(t,t.actions,n,r,s,i)}disconnect(){fa(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof jm?t.interaction.audioPlayer.play():t.interaction instanceof fL&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{let i=t.interaction.data.triggerAfter??"autoplay";i===e&&(t.interaction instanceof Ly?t.interaction.play(i==="autoplay"):t.interaction instanceof pL&&t.interaction.dispatch())})}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.interaction instanceof jm?t.interaction.audioPlayer.play():t.interaction instanceof fL&&t.interaction.dispatch()}),this.actions.Video.forEach(t=>{t.interaction instanceof Ly?t.interaction.play():t.interaction instanceof pL&&t.interaction.dispatch()})}},ZOe=class extends fu{constructor(e,t){super(e),this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:r,isExport:s}=this.eventContext;(s?document:r).removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([o,a])=>{o.dispatchEvent({type:"beginEvent",eventName:"Start"}),a.forEach(l=>{l.dispatchAfter("any")})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:r,target:s,reverse:o})=>{var l,c;if(!r||!s)return;let a=P1(r);a&&a==="Start"&&(s.dispatchEvent({type:"beginEvent",eventName:"Start"}),(l=this.eventsPerObject.get(s))==null||l.forEach(h=>{h.dispatchUserEvent(o)}),(c=this.eventsAfterPerObject.get(s))==null||c.forEach(h=>{h.dispatchUserEvent(o)}))};let{scene:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var s,o,a,l;if((s=r.data)!=null&&s.events.length)for(let{id:c,data:h}of r.data.events){if(h.disabled||h.type!=="Start")continue;let u=new KOe(c,h,r,i,n,t);(u.actions.Transition.length||u.actions.SwitchCamera.length||u.actions.Create.length||u.actions.Destroy.length)&&(this.eventsPerObject.has(r)?(o=this.eventsPerObject.get(r))==null||o.push(u):this.eventsPerObject.set(r,[u])),u.actions.Audio.length&&(this.eventsAfterPerObject.has(r)?(a=this.eventsAfterPerObject.get(r))==null||a.push(u):this.eventsAfterPerObject.set(r,[u])),u.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(r)?(l=this.eventsAfterPerObject.get(r))==null||l.push(u):this.eventsAfterPerObject.set(r,[u]))}})}connect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,i=t?document:e;i.addEventListener("pointerdown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),i.addEventListener("pointerdown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([n,r])=>{n.addEventListener("userEvent",this.onUserEvent)}),this.onPlay()}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.dispatchEvent({type:"beginEvent",eventName:"Start"}),t.forEach(i=>i.dispatch()),e.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,i=t?document:e;i.removeEventListener("pointerdown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),i.removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([n,r])=>{n.removeEventListener("userEvent",this.onUserEvent),r.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.removeEventListener("userEvent",this.onUserEvent),t.forEach(i=>i.disconnect())})}},$Oe=class{constructor(e,t,i,n,r,s){this.id=e,this.data=t,this.object=i,this.disabled=!0,this.actions=$a(t,t.actions,n,r,s,i),this.target=t.target,this.useToggle=t.toggle}disconnect(){fa(this.actions)}dispatch(e){this.disabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.useToggle?this.actions.Transition.forEach(t=>{t.toggle()}):this.actions.Transition.forEach(t=>{t.play()}),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(e??!1)}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}))}},eFe="https://unpkg.com/@splinetool/runtime@0.9.366/build/",tFe="https://unpkg.com/@splinetool/navmesh-wasm@0.9.366/build/",iFe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${eFe}' + 'navmesh.js'),
		fetch('${tFe}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,nFe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,rFe=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,sFe=.001,oFe={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},fZ,oi,Ar;MPe.then(e=>{fZ=e,oi=new e.Vec3,Ar=new e.Vec3});var aFe=new I,lFe=class{constructor(e=!1,t=!1){this.usePhysics=e,this.isExport=t,this.onPointerDown=i=>{if(Lt.length!==1)return;let{raycaster:n,scene:r}=this.eventContext;this.eventContext.updateRaycaster(i);let s=r.raycastWithClones(n);if(s.length!==0){for(let o of this.gameControls){let a=aFe.copy(o.colliderWorldPosition);a.y-=o.colliderHeight/2,o.path=this.computePath(a,s[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(i,n)=>r=>{var d,f,p,g,m,v;let s;if(r instanceof Ga)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;s=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof fs)s=r.object;else if(s=r,((d=s.dataPatched.cloner)==null?void 0:d.disabled)===!1&&((f=s.dataPatched.cloner)==null?void 0:f.hideBase)&&((p=s.dataPatched.physics)==null?void 0:p.fusedBody)!==!0)return!0;if(n&&!s.userData.navmesh)return;let o=s.dataPatched;if(!o.visible&&o.collision!==!0)return!0;r.updateMatrixWorldSVD();let a=eM(o),l=s.userData.hasDestroy,c=s.userData.hasDrag,h=!1,u=!1;for(let x of o.events)x.data.disabled!==!0&&(x.data.type==="GameControl"?h=!0:x.data.type==="Follow"&&(u=!0));if(h||a||u||l||c)return!0;if(this.usePhysics&&((g=o.physics)==null?void 0:g.rigidBody)==="dynamic"){if(this.usePhysics&&((m=o.physics)!=null&&m.fusedBody))return!0}else if("geometry"in r&&i.push(Ic(r.geometry,r.matrixWorld)),this.usePhysics&&((v=o.physics)==null?void 0:v.fusedBody))return r.traverseObject((x,w)=>{var A;if(w===0)return;let b;if(x instanceof Ga)if(x.objectForSample){if(x.objectForSample.dataPatched.physics.fusedBody)return;b=x.object}else return x.object.dataPatched.physics.fusedBody===!0&&x.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(x instanceof fs)b=x.object;else if(b=x,(A=x.dataPatched.cloner)==null?void 0:A.hideBase)return!0;let M=b.dataPatched;if(!M.visible&&M.collision!==!0)return!0;"geometry"in x&&i.push(Ic(x.geometry,x.matrixWorld))}),!0},this.traverseNoPhysics=(i,n)=>r=>{let s;if(r instanceof Ga)return;r instanceof fs?s=r.object:s=r;let o=s.dataPatched;if(o.collision==="visibility"?!o.visible:!o.collision)return!0;if(n&&!s.userData.navmesh)return;let a=r.geometry,l=s.userData.hasDestroy===!0,c=s.userData.hasDrag===!0;if(eM(o)||l||c||s.dataPatched.events.some(h=>h.data.disabled!==!0&&h.data.type==="GameControl"))return!0;a&&i.push(Ic(a,r.matrixWorld))},this.navmeshWasm=fZ,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?iFe:nFe)+rFe])),this._worker=new Worker(this._workerURL)}init(e,t,i){this.gameControls=t,this.eventContext=i,this.resolution=e.ch,this.setDefaultQueryExtent(new I().setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(i.scene,e,n=>{this.buildFromNavmeshData(n.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,i){t.objects.forEach(l=>{var h;let c=e.find(l);c.traverseEntity(u=>{u.userData.navmesh=!0}),(h=c.cloner)==null||h.traverseObject(u=>{u.userData.navmesh=!0})});let n=[],r=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(n,t.zones==="custom");if(e.traverseObject(r),t.objects.forEach(l=>{var h;let c=e.find(l);c.traverseEntity(u=>{u.userData.navmesh=void 0}),(h=c.cloner)==null||h.traverseObject(u=>{u.userData.navmesh=void 0})}),n.length===0)return!1;let s=af(n),{positions:o,triIndices:a}=uE(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([o,o.length/3,a,a.length,{...oFe,...t}]),this._worker.onmessage=i,!0}createDebugNavGeometry(){let e,t,i=this.navMesh.getDebugNavMesh(),n=i.getTriangleCount(),r=new Uint32Array(n*3),s=new Float32Array(n*3*3);for(e=0;e<n*3;e++)r[e]=e;for(e=0;e<n;e++)for(t=0;t<3;t++){let a=i.getTriangle(e).getPoint(t);s[e*9+t*3+0]=a.x,s[e*9+t*3+1]=a.y,s[e*9+t*3+2]=a.z}let o=new Ot;return o.setIndex(new zt(r,1)),o.setAttribute("position",new zt(s,3)),o}getClosestPoint(e){return oi.x=e.x,oi.y=e.y,oi.z=e.z,this.navMesh.getClosestPoint(oi)}getClosestPointToRef(e,t){oi.x=e.x,oi.y=e.y,oi.z=e.z;let i=this.navMesh.getClosestPoint(oi);t.set(i.x,i.y,i.z)}getRandomPointAround(e,t){return oi.x=e.x,oi.y=e.y,oi.z=e.z,this.navMesh.getRandomPointAround(oi,t)}getRandomPointAroundToRef(e,t,i){oi.x=e.x,oi.y=e.y,oi.z=e.z;let n=this.navMesh.getRandomPointAround(oi,t);i.set(n.x,n.y,n.z)}moveAlong(e,t){return oi.x=e.x,oi.y=e.y,oi.z=e.z,Ar.x=t.x,Ar.y=t.y,Ar.z=t.z,this.navMesh.moveAlong(oi,Ar)}moveAlongToRef(e,t,i){return oi.x=e.x,oi.y=e.y,oi.z=e.z,Ar.x=t.x,Ar.y=t.y,Ar.z=t.z,this.navMesh.moveAlong(oi,Ar)}computePath(e,t){let i=this.getClosestPoint(t);Ar.x=i.x,Ar.y=i.y,Ar.z=i.z,this.getClosestPoint(e);let n=this.navMesh.computePath(oi,Ar),r=n.getPointCount(),s=[];for(let o=0;o<r;o++){let a=n.getPoint(o);s.push(new I(a.x,a.y,a.z))}return s}createCrowd(e,t){return new cFe(this,e,t)}setDefaultQueryExtent(e){oi.x=e.x,oi.y=e.y,oi.z=e.z,this.navMesh.setDefaultQueryExtent(oi)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,i=this.navmeshWasm._malloc(t),n=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,i,t);n.set(e);let r=new this.navmeshWasm.NavmeshData;r.dataPointer=n.byteOffset,r.size=e.length,this.navMesh.buildFromNavmeshData(r),this.navmeshWasm._free(n.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),i=new Uint8Array(e.size);return i.set(t),this.navMesh.freeNavmeshData(e),i}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(e=this.eventContext)==null||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,i){return oi.x=e.x,oi.y=e.y,oi.z=e.z,this.navMesh.addCylinderObstacle(oi,t,i)}addBoxObstacle(e,t,i){return oi.x=e.x,oi.y=e.y,oi.z=e.z,Ar.x=t.x,Ar.y=t.y,Ar.z=t.z,this.navMesh.addBoxObstacle(oi,Ar,i)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return this.navmeshWasm!==void 0}},cFe=class{constructor(e,t,i){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,i,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,i){let n=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;n.radius=t.radius,n.height=t.height,n.maxAcceleration=t.maxAcceleration,n.maxSpeed=t.maxSpeed,n.collisionQueryRange=t.collisionQueryRange,n.pathOptimizationRange=t.pathOptimizationRange,n.separationWeight=t.separationWeight,n.updateFlags=7,n.obstacleAvoidanceType=0,n.queryFilterType=0,n.userData=0;let r=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),n);return this.transforms.push(i),this.agents.push(r),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new I(0,0,0)),r}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let i=this.crowd.getAgentPosition(e);t.set(i.x,i.y,i.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let i=this.crowd.getAgentVelocity(e);t.set(i.x,i.y,i.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let i=this.crowd.getAgentNextTargetPath(e);t.set(i.x,i.y,i.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let i=this.agents.indexOf(e);i>-1&&(this._agentDestinationArmed[i]=!0,this._agentDestination[i].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let i=this.crowd.getAgentParameters(e);t.radius!==void 0&&(i.radius=t.radius),t.height!==void 0&&(i.height=t.height),t.maxAcceleration!==void 0&&(i.maxAcceleration=t.maxAcceleration),t.maxSpeed!==void 0&&(i.maxSpeed=t.maxSpeed),t.collisionQueryRange!==void 0&&(i.collisionQueryRange=t.collisionQueryRange),t.pathOptimizationRange!==void 0&&(i.pathOptimizationRange=t.pathOptimizationRange),t.separationWeight!==void 0&&(i.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,i)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=sFe)return;let t=1/60,i=10;{let n=Math.floor(e/t);n>i&&(n=i),n<1&&(n=1);let r=e/n;for(let s=0;s<n;s++)this.crowd.update(r)}for(let n=0;n<this.agents.length;n++){let r=this.agents[n],s=this.getAgentPosition(r);if(this.transforms[n].copy(s),this._agentDestinationArmed[n]){let o=s.x-this._agentDestination[n].x,a=s.z-this._agentDestination[n].z,l=this.reachRadii[n],c=this._agentDestination[n].y-this.reachRadii[n],h=this._agentDestination[n].y+this.reachRadii[n],u=o*o+a*a;s.y>c&&s.y<h&&u<l*l&&(this.onReachTarget(r,this._agentDestination[n]),this._agentDestinationArmed[n]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,i=this.crowd.getCorners(e),n=i.getPointCount(),r=[];for(t=0;t<n;t++){let s=i.getPoint(t);r.push(new I(s.x,s.y,s.z))}return r}dispose(){this.crowd.destroy()}};function uFe(e){var n,r;let t=!1,i=e.scene.publish.gameControlObject;return i&&((r=(n=e.scene.objects.data(i))==null?void 0:n.events)==null||r.forEach(s=>{s.data.type==="GameControl"&&s.data.navmesh.enabled&&(t=!0)})),t}var Ki;CPe.then(e=>Ki=e);var Fn=new I,Ta=new ai,Uu=new I,RP=new Er(0,0,0,"YXZ"),hFe={type:"updateMatrix"},pZ={type:"beginEvent",eventName:"Collision"};function dFe(e){if(e.scene.environment.usePhysics)return!0;let t=!1;return e.scene.objects.traverse((i,n)=>{for(let r of n.events)if(r.data.disabled!==!0&&r.data.type==="GameControl"&&r.data.collisionEnabled){t=!0;break}}),t}var eM=e=>e.states.some(t=>t.data.position!==void 0||t.data.rotation!==void 0||t.data.hiddenMatrix!==void 0||t.data.cloner!==void 0||t.data.pathSnapping!==void 0),fFe=class{constructor(e,t){this.collab=e,this.eventContext=t,this.orbitControlsNeedsUpdate=!0,this.gameControls=[],this.gameControlStates=[],this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],eventsPerObjects:{},colliderToEntity:{},gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=i=>{if(i.bodyType()!==Ki.RigidBodyType.Dynamic)return;i.isSleeping()||this.nActiveRigidBodies++;let[n,r,s]=this.rigidBodyToMesh.get(i.handle);if(Fn.copy(i.translation()).multiplyScalar(this.pixelsPerMeter),Ta.copy(i.rotation()),n.matrixWorld.compose(Fn,Ta,r),n.hasNonUniformScale&&n.matrixWorld.multiply(n.shearScale),n.dispatchEvent(hFe),s){let o=n.cloner;if(o&&o.objectForSample===void 0){o.matrixWorld.copy(n.matrixWorld);for(let a of o.children)a.updateMatrixWorld(!0)}for(let a of n.children)a.updateMatrixWorld(!0)}},this.handleCollisionEvents=(i,n,r)=>{var s,o;if(r!==!1){for(let a=this.sharedGameControlGlobals.createdObjects.length-1;a>=0;a--){let l=this.sharedGameControlGlobals.createdObjects[a];if(l.userData.hasCollisionDestroy&&(((s=l.rigidBody)==null?void 0:s.collider(0).handle)===i||((o=l.rigidBody)==null?void 0:o.collider(0).handle)===n)){this.sharedGameControlGlobals.createdObjects.splice(a,1),l.removeFromParent(),requestAnimationFrame(()=>{var c;return(c=this.sharedGameControlGlobals.rapierWorld)==null?void 0:c.removeRigidBody(l.rigidBody)});break}}if(this.gameControls.some(a=>a.object===this.sharedGameControlGlobals.colliderToEntity[i])){let a=this.sharedGameControlGlobals.colliderToEntity[n],l=this.sharedGameControlGlobals.eventsPerObjects[a.uuid];if(l===void 0)return;for(let c of l)c.data.target==="character"&&this.dispatchCollisionEvent(c,a,n)}else if(this.gameControls.some(a=>a.object===this.sharedGameControlGlobals.colliderToEntity[n])){let a=this.sharedGameControlGlobals.colliderToEntity[i],l=this.sharedGameControlGlobals.eventsPerObjects[a.uuid];if(l===void 0)return;for(let c of l)c.data.target==="character"&&this.dispatchCollisionEvent(c,a,i)}else{let a=this.sharedGameControlGlobals.colliderToEntity[i],l=this.sharedGameControlGlobals.eventsPerObjects[a.uuid];if(l!==void 0)for(let u of l)u.data.target==="scene"&&this.dispatchCollisionEvent(u,a,i);let c=this.sharedGameControlGlobals.colliderToEntity[n],h=this.sharedGameControlGlobals.eventsPerObjects[c==null?void 0:c.uuid];if(h!==void 0)for(let u of h)u.data.target==="scene"&&this.dispatchCollisionEvent(u,c,n)}}},this.isExport=t.isExport,this.sharedAssets=t.sharedAssets,this.scene=t.scene,this.renderer=t.renderer,this.requestRender=t.requestRender,this.domElement=this.renderer.domElement,this.usePhysics=this.collab.scene.environment.usePhysics??ao.defaultData.usePhysics,this.pixelsPerMeter=this.collab.scene.environment.pixelsPerMeter??ao.defaultData.pixelsPerMeter,this.gravity=this.collab.scene.environment.gravity??ao.defaultData.gravity}attachVRControllers(e){e.forEach(t=>{t.addEventListener("connected",i=>{"gamepad"in i.data&&"axes"in i.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(i.data.gamepad)})})}markIsDestroyTarget(){this.scene.traverseVisibleEntity(e=>{var i,n;let t=e.dataPatched;for(let r of t.events){if(r.data.disabled===!0)continue;let s=(n=(i=r.data.actions)==null?void 0:i.find(o=>o.data.type==="Destroy"))==null?void 0:n.data;if(s)for(let o of s.objects){let a=this.scene.find(o);a&&(a.userData.hasDestroy=!0)}}})}markIsDragObject(){this.scene.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let i of t.events)if(!(i.data.disabled===!0||i.data.type!=="DragDrop"))for(let n of i.data.objects){let r=this.scene.find(n);r&&(r.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.scene.traverseObject(t=>{let i;if(t instanceof Ga)return;t instanceof fs?i=t.object:i=t;let n=i.dataPatched;if(n.collision==="visibility"?!n.visible:!n.collision)return!0;let r=t.geometry,s=i.userData.hasDestroy===!0,o=i.userData.hasDrag===!0;if(eM(n)||s||o||i.dataPatched.events.some(a=>a.data.disabled!==!0&&a.data.type==="GameControl"))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;r&&e.push(Ic(r,t.matrixWorld))}),e.length>0){let t=af(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new Dr(t)}}addRigidBody(e,t,i){let n=[],r="geometry"in e?e.geometry:void 0,s=t.dataPatched;if((r==null?void 0:r.getAttribute("position"))!==void 0&&n.push(Ic(r,e.shearScale)),s.physics.fusedBody){let o=this.gatherChildrenGeom(e,n);e.traverseObject(o),e.children.forEach(l=>l.updateMatrixWorld(!0));let a=e.cloner;a&&a.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(a.traverseObject(o),a.children.forEach(l=>l.updateMatrixWorld(!0)))}if(n.length>0){let o,a=!i.fromCreate&&s.physics.rigidBody==="dynamic"||i.fromCreate&&i.dynamic;a?(o=Ki.RigidBodyDesc.dynamic(),o.setLinearDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(i.hasTransformAnim||i.hasFollow||i.hasDrag)&&!i.fromCreate?(o=Ki.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):o=Ki.RigidBodyDesc.fixed();let l=af(n);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Fn,Ta,Uu),e.position0=Fn.clone().divideScalar(this.pixelsPerMeter),e.rotation0=Ta.clone(),Fn.divideScalar(this.pixelsPerMeter),o.setTranslation(Fn.x,Fn.y,Fn.z).setRotation(Ta),r?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Uu.x/this.pixelsPerMeter,Uu.y/this.pixelsPerMeter,Uu.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(o);a&&this.rigidBodyToMesh.set(c.handle,[e,Uu.clone(),s.physics.fusedBody]);let h=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(c,s.physics,l,i.fromCreate?void 0:t,h)}catch{try{this.addCollider(c,s.physics,l,i.fromCreate?void 0:t,!1)}catch(u){console.error(u)}}e.rigidBody=c}}addBoundsTree(e){let t=[];if("geometry"in e&&e.geometry.getAttribute("position")!==void 0&&t.push(Ic(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach(i=>i.updateMatrixWorld(!0)),t.length>0){let i=af(t,!1);e.boundsTree=new Dr(i),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)}}addCollider(e,t,i,n,r=!0){var a,l;if((i==null?void 0:i.getAttribute("position").count)===0||((a=i==null?void 0:i.getIndex())==null?void 0:a.count)===0)return;let s;i&&(t.colliderType==="trimesh"?s=Ki.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array):s=Ki.ColliderDesc.convexMesh(i.getAttribute("position").array,r?i.getIndex().array:void 0)),s.setFrictionCombineRule(Ki.CoefficientCombineRule.Average).setRestitutionCombineRule(Ki.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let o=this.sharedGameControlGlobals.rapierWorld.createCollider(s,e);n&&(this.sharedGameControlGlobals.colliderToEntity[o.handle]=n,(l=this.sharedGameControlGlobals.eventsPerObjects[n.uuid])!=null&&l.some(c=>c.target==="scene")&&o.setActiveEvents(Ki.ActiveEvents.COLLISION_EVENTS))}gatherChildrenGeom(e,t){return(i,n)=>{var a;if(n===0)return;let r;if(i instanceof Ga)if(i.objectForSample){if(i.objectForSample.dataPatched.physics.fusedBody)return;r=i.object}else return i.object.dataPatched.physics.fusedBody===!0&&i.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(i instanceof fs)r=i.object;else if(r=i,(a=r.dataPatched.cloner)==null?void 0:a.hideBase)return!0;let s=r.dataPatched;if(s.collision==="visibility"?!s.visible:!s.collision)return!0;n===1?e.hasNonUniformScale?i.matrixWorld.multiplyMatrices(e.shearScale,i.hiddenMatrix):i.matrixWorld.copy(i.hiddenMatrix):i.matrixWorld.multiplyMatrices(i.parent.matrixWorld,i.hiddenMatrix),i.matrixWorld.multiply(i.matrix);let o=i.geometry;(o==null?void 0:o.getAttribute("position"))!==void 0&&t.push(Ic(o,i.matrixWorld))}}activate(e){var u,d;this.eventManager=e;let t;this.collab.scene.publish.playCamera===null?t=sa.PERSONAL_CAMERA_ID:t=this.collab.scene.publish.playCamera;let i=this.scene.find(t),n=!1,r,s=5,o=8,a=9,l="drag";if((u=this.collab.scene.objects.data(this.collab.scene.publish.gameControlObject??""))==null||u.events.forEach(f=>{f.data.disabled!==!0&&f.data.type==="GameControl"&&(r=f.data.keyAssignments,s=f.data.joystickPosLoc,o=f.data.joystickRotLoc,a=f.data.jumpTouchButtonLoc,l=f.data.rotByTouch)}),this.scene.traverseEntity(f=>{f.dataPatched.events.forEach(p=>{var m,v;if(p.data.disabled||p.data.type!=="GameControl")return;let g=f;for(;((m=g=g.parent)==null?void 0:m.parent)!==null;)if((v=g.dataPatched.physics)!=null&&v.fusedBody)return;p.data.collisionEnabled&&(this.needsCollisionDetection=!0),this.gameControlStates.push([f,p.data])})}),this.gameControlStates.forEach(([f,p])=>{n=n||p.camera===i.uuid||f.uuid===i.uuid;let g=new mZ(f,this.renderer.domElement,{...p,keyAssignments:r},this.collab.scene.environment,this,f.uuid!==i.uuid&&p.camera===i.uuid,i,this.scene,this.sharedAssets);this.gameControls.push(g),ho&&p.touchControl&&(this.joystickToGameControls[s]!==void 0?this.joystickToGameControls[s].push([g,"pos"]):this.joystickToGameControls[s]=[[g,"pos"]],p.moveMode==="walk"&&(this.joystickToGameControls[a]!==void 0?this.joystickToGameControls[a].push([g,"jmp"]):this.joystickToGameControls[a]=[[g,"jmp"]]),l==="joystick"&&(this.joystickToGameControls[o]!==void 0?this.joystickToGameControls[o].push([g,"rot"]):this.joystickToGameControls[o]=[[g,"rot"]]))}),(d=this.collab.scene.objects.data(this.collab.scene.publish.gameControlObject??""))==null||d.events.forEach(f=>{if(f.data.disabled!==!0&&f.data.type==="GameControl"&&f.data.navmesh.enabled&&!this.navigationMeshWrapper){this.navigationMeshWrapper=new lFe(this.usePhysics,this.isExport);let p;f.data.collider.type==="sphere"?p=f.data.collider.radius*2:p=f.data.collider.height,p=Math.floor(p/f.data.navmesh.ch-1),this.navigationMeshWrapper.init({...f.data.navmesh,walkableHeight:p},this.gameControls,this.eventContext)}}),n===!1){let{enableRotate:f,enablePan:p,enableZoom:g,autoRotate:m,hoverRotatePanMode:v}=this.collab.scene.publish.orbitControls;(f||p||g||m||v!==0)&&(this.orbitControls=new gZ(i,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.collab.scene.publish.orbitControls,this.collab.scene.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let c=this.renderer.domElement.width/this.renderer.getPixelRatio(),h=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((f,p)=>{let g=document.body.appendChild(document.createElement("div")),[m,v,x]=(this.collab.scene.publish.joystickSizeAndXYOffset??jg.defaultData.joystickSizeAndXYOffset)[p],w=(c-5*m)/4+m,b={},M=f.some(C=>C[1]==="jmp"),A=M?0:m;p<10?(p<5?b.top=A/2:b.bottom=A/2,b.left=A/2+p%5*w):p===10?(b.left=A/2,b.top=h/2):(b.right=A/2,b.top=h/2),b.top?b.top-=v[1]:b.bottom+=v[1],b.left?b.left+=v[0]:b.right-=v[0];for(let C in b)b[C]+="px";if(M){let C=g.appendChild(document.createElement("div"));Object.assign(C.style,b,{position:"absolute",width:m+"px",height:m+"px",backgroundColor:`rgba(255,255,255,${x==="show"?.4:0})`,zIndex:"9999",borderRadius:m+"px",border:x==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let P=m/16*16*.4;x==="show"&&(C.innerHTML=`
						<svg width="${P}" height="${m*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),C.addEventListener("pointerdown",()=>{f.forEach(B=>{B[0].movementState.jump=1}),this.requestRender()}),C.addEventListener("touchend",B=>B.preventDefault()),this.joysticks[p]=[void 0,g];return}let T={zone:g,mode:"static",position:b,size:m};x==="hide"&&(T.restOpacity=0);let S=KRe.create(T);S.on("move",(C,P)=>{f.forEach(B=>{let k=B[0];B[1]==="pos"?P.force<.2?k.moveForce=0:(k.movementState.movePosZ=Math.sin(-P.angle.radian),k.movementState.movePosX=Math.cos(-P.angle.radian),P.force<.3?k.moveForce=(P.force-.2)/.1:k.moveForce=1):P.force<.2?k.rotForce=0:(k.movementState.rotPosX=P.vector.y,k.movementState.rotPosY=-P.vector.x,P.force<.3?k.rotForce=(P.force-.2)/.1:k.rotForce=1)}),this.requestRender()}),S.on("end",(C,P)=>{f.forEach(B=>{let k=B[0];B[1]==="pos"?(k.movementState.movePosZ=0,k.movementState.movePosX=0,k.moveForce=1):(k.movementState.rotPosX=0,k.movementState.rotPosY=0,k.rotForce=1)})}),this.joysticks[p]=[S,g]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.usePhysics&&(this.gameControlStates.length===0||this.needsCollisionDetection)&&this.initPhysics(),this.usePhysics===!1&&this.needsCollisionDetection&&this.initBVH(),this.initializationCounter++,window.setTimeout(()=>this.collisionEvents.forEach(f=>f.disabled=!1),80)}initPhysics(){this.sharedGameControlGlobals.rapierWorld=new Ki.World(new Ki.Vector3(0,this.gravity,0)),this.events=new Ki.EventQueue(!0);let e=[];if(this.scene.traverseObject(s=>{var g,m,v,x;let o;if(s instanceof Ga)if(s.objectForSample){if(s.objectForSample.dataPatched.physics.fusedBody)return;o=s.object}else return s.object.dataPatched.physics.fusedBody===!0&&s.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(s instanceof fs)o=s.object;else if(o=s,((g=o.dataPatched.cloner)==null?void 0:g.disabled)===!1&&((m=o.dataPatched.cloner)==null?void 0:m.hideBase)&&((v=o.dataPatched.physics)==null?void 0:v.fusedBody)!==!0)return!0;let a=o.dataPatched;if(!a.physics||(a.collision==="visibility"?!a.visible:!a.collision))return!0;s.updateMatrixWorldSVD();let l=eM(a),c,h=!1,u=o.userData.hasDestroy,d=o.userData.hasDrag,f=!1;for(let w of a.events)if(w.data.disabled!==!0){if(w.data.type==="GameControl")c=w.data;else if(w.data.type==="Collision"){h=!0;let b=new $Oe(w.id,w.data,o,this.scene,this.sharedAssets,{controlsManager:this,eventManager:this.eventManager});this.collisionEvents.push(b),this.sharedGameControlGlobals.eventsPerObjects[o.uuid]&&this.sharedGameControlGlobals.eventsPerObjects[o.uuid].every(M=>M.id!==w.id)?this.sharedGameControlGlobals.eventsPerObjects[o.uuid].push(b):this.sharedGameControlGlobals.eventsPerObjects[o.uuid]=[b]}else if(w.data.type==="Follow"){f=!0;let b=w.data.target;s.traverseVisible(M=>{M.userData.isFollowingObj=b})}}a.physics.rigidBody==="dynamic"&&a.physics.fusedBody===!1&&(s.matrixWorldFusedFalse=s.matrixWorld.clone());let p=s.geometry;if(c!==void 0){let w=Ki.RigidBodyDesc.kinematicPositionBased();(s.hasNonUniformScale?s.matrixWorldRigid:s.matrixWorld).decompose(Fn,Ta,Uu),s.position0=Fn.clone().divideScalar(this.pixelsPerMeter),s.rotation0=Ta.clone(),Fn.divideScalar(this.pixelsPerMeter),w.setTranslation(Fn.x,Fn.y,Fn.z).setRotation(Ta);let b=this.sharedGameControlGlobals.rapierWorld.createRigidBody(w);s.rigidBody=b;let M;c.collider.type==="sphere"?M=Ki.ColliderDesc.ball(c.collider.radius/this.pixelsPerMeter):c.collider.type==="capsule"?M=Ki.ColliderDesc.capsule((c.collider.height/2-c.collider.radius)/this.pixelsPerMeter,c.collider.radius/this.pixelsPerMeter):M=Ki.ColliderDesc.cuboid(c.collider.width/this.pixelsPerMeter/2,c.collider.height/this.pixelsPerMeter/2,c.collider.depth/this.pixelsPerMeter/2),M.setFrictionCombineRule(Ki.CoefficientCombineRule.Average).setRestitutionCombineRule(Ki.CoefficientCombineRule.Average).setDensity(a.physics.density).setFriction(a.physics.friction).setRestitution(a.physics.restitution);let A=this.sharedGameControlGlobals.rapierWorld.createCollider(M,b);this.sharedGameControlGlobals.colliderToEntity[A.handle]=o,Fn.fromArray(c.collider.position).multiply(Uu.setFromMatrixScale(o.matrixWorld)).divideScalar(this.pixelsPerMeter),A.setTranslationWrtParent(Fn);let T=new ai().setFromEuler(new Er().setFromVector3(new I().fromArray(c.collider.rotation)));A.setRotationWrtParent(T),A.setActiveEvents(Ki.ActiveEvents.COLLISION_EVENTS)}else a.physics.rigidBody==="dynamic"||l||f||u||d||h?this.addRigidBody(s,o,{hasFollow:f,hasTransformAnim:l,hasDrag:d}):(p&&e.push(Ic(p,s.matrixWorld)),a.physics.fusedBody&&s.traverseObject((w,b)=>{var S;if(b===0)return;let M;if(w instanceof Ga)if(w.objectForSample){if(w.objectForSample.dataPatched.physics.fusedBody)return;M=w.object}else return w.object.dataPatched.physics.fusedBody===!0&&w.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(w instanceof fs)M=w.object;else if(M=w,(S=M.dataPatched.cloner)==null?void 0:S.hideBase)return!0;let A=M.dataPatched;if(A.collision==="visibility"?!A.visible:!A.collision)return!0;let T=w.geometry;(T==null?void 0:T.getAttribute("position"))!==void 0&&e.push(Ic(T,w.matrixWorld))}));if(((x=a.physics)==null?void 0:x.fusedBody)===!0||c)return!0}),e.length===0)return;let t=af(e);t.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let i=Ki.RigidBodyDesc.fixed(),n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(i),r=Ki.ColliderDesc.trimesh(t.getAttribute("position").array,t.getIndex().array).setFrictionCombineRule(Ki.CoefficientCombineRule.Multiply).setRestitutionCombineRule(Ki.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(r,n)}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){var e;this.usePhysics?((e=this.sharedGameControlGlobals.rapierWorld)==null||e.free(),this.initPhysics()):(this.sharedGameControlGlobals.staticMeshBVH=void 0,this.initBVH())}disconnectCollisionEvents(){this.collisionEvents.forEach(e=>e.disconnect())}deactivate(){var e,t;this.scene.traverse(i=>{let n=i;n.matrixWorldFusedFalse&&(n.matrixWorldFusedFalse=void 0),n.rigidBody&&(n.rigidBody=void 0),n.position0&&(n.position0=void 0),n.rotation0&&(n.rotation0=void 0)}),(e=this.sharedGameControlGlobals.rapierWorld)==null||e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectCollisionEvents(),this.gameControls.forEach(i=>{i.reset(),i.dispose()}),this.gameControls=[],this.joysticks.forEach(([i,n])=>{i==null||i.destroy(),n.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(t=this.navigationMeshWrapper)==null||t.dispose();for(let i of Object.values(this.sharedGameControlGlobals.eventsPerObjects))i.forEach(n=>n.disconnect());this.sharedGameControlGlobals.eventsPerObjects={},this.scene.updateMatrixWorld(!0)}update(e,t,i){var r;let n=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(n=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2)this.initializationCounter++,n=!1;else if(this.initializationCounter===2)for(let s of this.gameControls)n=!s.update(e,t,i)&&n;if(this.usePhysics){for(let s of this.sharedGameControlGlobals.entitiesWithTransformAnim){(s.hasNonUniformScale?s.matrixWorldRigid:s.matrixWorld).decompose(Fn,Ta,Uu),RP.setFromQuaternion(Ta);let o=s;o.prevR===void 0?(o.prevR=RP.clone(),o.prevT=Fn.clone()):(o.prevR.copy(RP),o.prevT.copy(Fn)),s.rigidBody.setNextKinematicTranslation(Fn.divideScalar(this.pixelsPerMeter)),s.rigidBody.setNextKinematicRotation(Ta)}this.sharedGameControlGlobals.rapierWorld.step(this.events),(r=this.events)==null||r.drainCollisionEvents(this.handleCollisionEvents),n=!this.updatePositions()&&n}return n}dispatchCollisionEvent(e,t,i){var s;let n=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(i))._parent,r;if(t.cloner){for(let o of t.cloner.children)if(o.rigidBody===n){r=o;break}}e.dispatch(r),t.dispatchEvent(pZ)}updateUseWindowEvents(e){var t;(t=this.orbitControls)==null||t.updateUseWindowEvents(e)}};new I;var mj=new I,gj=new I,pFe=new I,Cs=new I,Ts=new I,Gu=new I,IP=new Je,vj=new Je,mFe=new Je;new Je;var Pa=new ai,Cc=new ai,bl=new Er(0,0,0,"YXZ"),gFe=new I(1,0,0),Da=new I(0,1,0),vFe=new I(0,0,1),yj=new I(1,1,1),yFe=1,xFe=.025,wFe=16e-6,xj=12,_Fe=20,Hr=new na,Go=new Vn,bFe={type:"requestRender"},wj=Math.PI/6,vL=class extends _s{constructor(e,t,i,n,r,s,o,a,l){var g;super(),this.object=e,this.domElement=t,this.controlsManager=r,this.cameraFollow=s,this.camera=o,this.scene=a,this.sharedAssets=l,this.enableDamping=!0,this.position0=new I,this.rotation0=new Er(0,0,0,"XYZ"),this.scale0=new I,this.hiddenMatrix0=new Je,this.target0=new I,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.euler0=new Er(0,0,0,"YXZ"),this.position0Cam=new I,this.quat0Cam=new ai,this.scale0Cam=new I,this.hiddenMatrix0Cam=new Je,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new na(new I(0,-40,0),new I(0,40,0)),matrix:new Je,position:new I,rotation:new ai},this.euler=new Er(0,0,0,"YXZ"),this.eulerDelta=new I,this.lastPosition=new I,this.lastCameraQuaternion=new ai,this.lastCameraPosition=new I,this.PI_2=Math.PI/2,this.prevMouse=new ge,this.velocityTarget=new I,this.velocity=new I,this.directionXZ=new I,this.rotVelocityStick=new I,this.rotVelocityTarget=new I,this.rotVelocity=new I,this.rotDirection=new I,this.nonColliderRotOffset=new Je,this.nonColliderPosOffset=new Je,this.firstPointerId=-1,this.rot=new I,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new Je,this.objectToTarget=new I,this.objectToTarget0=new I,this.objectToCamXZ=new I,this.objectToCamXZ0=new I,this.targetToCamera=new I,this.targetToCamera0=new I,this.cameraPolarAxis0=new I,this.targetPos=new I,this.targetQuat=new ai,this.lerpFactorPos=new I().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new ai,this.objXZQuatInv=new ai,this.objXZRotMat=new Je,this.isFirstPerson=!1,this.actions={},this.didHit=!1,this.groundVelocity=new I,this.pushedVelocity=new I,this.groundYRotation=0,this.objectRealQuat=new ai,this.colliderWorldQuat=new ai,this.groundNormal=new I,this.groundTilt=new ai,this.groundTiltInv=new ai,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.onPointerDown=m=>{m.target!==this.domElement||this.firstPointerId!==-1||(this.firstPointerId=m.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!ho&&(!OH||FH>=15.5)&&this.domElement.requestPointerLock(),this.prevMouse.set(m.clientX,m.clientY))},this.onPointerUp=m=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),m.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=m=>{if(m.pointerId!==this.firstPointerId)return;let v=m.clientX-this.prevMouse.x,x=m.clientY-this.prevMouse.y;this.prevMouse.set(m.clientX,m.clientY),m.pointerType==="mouse"&&this.rotBy!=="keys"&&(OH&&FH<15.5&&!ho?(this.eulerDelta.y=-v*this.mouseOrbitSensitivity,this.eulerDelta.x=-x*this.mouseOrbitSensitivity):(this.eulerDelta.y=-m.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-m.movementY*this.mouseOrbitSensitivity)),m.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-v*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-x*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=m=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?vL.isLocked=!0:vL.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.onKeyDown=m=>{!(m.target instanceof HTMLInputElement)&&(m.code==="ArrowLeft"||m.code==="ArrowUp"||m.code==="ArrowRight"||m.code==="ArrowDown"||m.code==="Space")&&m.preventDefault();for(let v of this.keyAssignments)if(m.key.toUpperCase()===v[1]||m.key===v[1]){this.movementState[v[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=m=>{for(let v of this.keyAssignments)if(m.key.toUpperCase()===v[1]||m.key===v[1]||m.code.slice(3,m.code.length).toUpperCase()===v[1]){this.movementState[v[0]]=0;break}},this.copyVRGamePadValues=(m,v)=>{for(let x=2;x<4;x++){let w=m.axes[x];v===0?x===2?this.movementState.movePosX=w:this.movementState.movePosZ=w:(m.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,x===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(w)>=.3&&(this.vrEulerYOffset+=w<0?1:-1),this.movementState.rotPosY=w):this.moveMode==="fly"&&(this.movementState.moveNegY=w))}},this.sharedGameControlGlobals=r.sharedGameControlGlobals,e===o&&(this.isFirstPerson=!0),this.position0.copy(this.object.position),this.rotation0.copy(this.object.rotation),this.scale0.copy(this.object.scale),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.object.position,this.object.quaternion,this.object.scale),this.object.rotation.reorder("YXZ"),this.euler0.copy(this.object.rotation);let c=this.object.rotation.y;if(this.objectRealQuat.copy(this.object.quaternion),this.object.rotation.y=0,this.objXZQuat.copy(this.object.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.object.quaternion),this.object.rotation.set(0,c,0),this.rot.setFromEuler(this.object.rotation),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((g=this.camera)==null?void 0:g.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let m=new I(0,0,-1).applyQuaternion(this.camera.quaternion),v=new I().subVectors(this.object.position,this.camera.position);this.objectToCamXZ.copy(v),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let x,w;Math.abs(m.y)<1e-6?(v.y=0,m.y=0,w=v.projectOnVector(m)):v.y/m.y>0?w=m.multiplyScalar(v.y/m.y):w=m.multiplyScalar(v.length()),this.targetToCamera0.copy(w).negate(),x=this.camera.position.clone().add(w),this.objectToTarget0.subVectors(x,this.object.position);let b=new Er().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-b.x,b.x=0,b.z=0,b.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(b)}if(this.object instanceof gs&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.object.quaternion,"YXZ"),this.connect(),this.rotByTouch=i.rotByTouch??"joystick",this.rotBy=i.rotBy??"keys",this.rotationMode=i.rotationMode??"normal",this.moveMode=i.moveMode??"walk",this.collisionEnabled=i.collisionEnabled,this.speedTranslate=(i.speedTranslate??250)*yFe,this.speedOrbit=(i.speedRotate??100)*xFe,this.mouseOrbitSensitivity=(i.speedRotate??100)*wFe,this.keyAssignments=i.keyAssignments.map(m=>{let v=[m[0],m[1]];return v[1]==="▲"?v[1]="ArrowUp":v[1]==="◀"?v[1]="ArrowLeft":v[1]==="▼"?v[1]="ArrowDown":v[1]==="▶"?v[1]="ArrowRight":v[1]==="⇧"?v[1]="Shift":v[1]==="↵"?v[1]="Enter":v[1]==="Space"?v[1]=" ":v[1]==="⌘"?v[1]="Meta":v[1]==="Ctrl"?v[1]="Control":v[1]==="Esc"&&(v[1]="Escape"),v}),i.rotBy==="mouse"){let m;m=this.keyAssignments.findIndex(v=>v[0]==="rotNegX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(v=>v[0]==="rotPosX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(v=>v[0]==="rotPosY"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(v=>v[0]==="rotNegY"),m!==-1&&(this.keyAssignments[m][1]="")}this.lerpFactorPosStart=1-.02**(1/((i.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((i.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((i.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((i.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((i.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((i.delayRotCamera??.3)*60)),this.gravity=(n.gravity??ao.defaultData.gravity)*xj,this.pixelsPerMeter=n.pixelsPerMeter??ao.defaultData.pixelsPerMeter,this.usePhysics=n.usePhysics??ao.defaultData.usePhysics,this.jumpPower=i.jumpPower*_Fe,this.resetYPosition=this.object.position.y+Math.abs(i.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=i.alignToGround??!1,this.orientMode=i.autoOrientMove?i.orientMode:"none",this.orientWith=i.orientWith??GS.defaultDataThirdPerson.orientWith;let h=n.skinWidthRelative??ao.defaultData.skinWidthRelative,u=n.stepThreshRelative??ao.defaultData.stepThreshRelative;this.slopeThresh=(n.slopeThresh??ao.defaultData.slopeThresh)*Math.PI/180,i.collider.type==="capsule"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=i.collider.height/2-i.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=i.collider.height*h/this.pixelsPerMeter,this.stepThresh=i.collider.height*u/this.pixelsPerMeter,this.colliderHeight=i.collider.height):i.collider.type==="sphere"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*i.collider.radius*h/this.pixelsPerMeter,this.stepThresh=2*i.collider.radius*u/this.pixelsPerMeter,this.colliderHeight=i.collider.radius*2):(this.offset=i.collider.height*h/this.pixelsPerMeter,this.stepThresh=i.collider.height*u/this.pixelsPerMeter,this.colliderHeight=i.collider.height),this.collider.type=i.collider.type;let d=new I().fromArray(i.collider.position),f=new ai().setFromEuler(new Er().fromArray([...i.collider.rotation,"XYZ"]));this.collider.position.copy(d).multiply(this.object.scale),this.collider.rotation.copy(f),this.collider.matrix.compose(d,f,yj),i.cameraXAxis!==void 0&&(this.cameraXAxis=i.cameraXAxis,this.cameraYAxis=i.cameraYAxis,this.minPolarAngle=i.cameraRotXLimits[0],this.maxPolarAngle=i.cameraRotXLimits[1],this.minAzimuthAngleRel=i.cameraRotYLimits[0],this.maxAzimuthAngleRel=i.cameraRotYLimits[1]),i.gameActions!==void 0&&Object.entries(i.gameActions).forEach(([m,v],x)=>{v.forEach(({id:w,data:b})=>{try{this.actions[m]===void 0&&(this.actions[m]=[]),b.type==="Transition"?this.actions[m].push(new Oy(b,a,l)):b.type==="Audio"?this.actions[m].push(new Dy(w,b,e,l)):b.type==="Video"?this.actions[m].push(new uF(w,b,e)):b.type==="Create"&&this.actions[m].push(new Ry(b,a,this.controlsManager))}catch{}})}),this.dispatchStopEvent("move"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle");let p=i.navmesh.destinationHelperRadius*2;p>0&&(this.navMeshPathDest=new Ns(dJ.create({parameters:{width:p,height:p/10,hollow:.7}}),new ov({color:Wr.toHex(i.navmesh.destinationHelperColor),transparent:!0,opacity:i.navmesh.destinationHelperColor.a})),this.navMeshPathDest.material.userData.opacity0=i.navmesh.destinationHelperColor.a)}reset(e=!1){if(this.object.rotation.copy(this.rotation0),this.object.position.copy(this.position0),this.object.scale.copy(this.scale0),this.object.hiddenMatrix.copy(this.hiddenMatrix0),e===!0){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.object.position,this.object.quaternion,this.object.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.rotation.reorder("YXZ");let t=this.object.rotation.y;this.object.rotation.y=0,this.objXZQuat.copy(this.object.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.object.quaternion),this.object.rotation.set(0,t,0),this.rot.setFromEuler(this.object.rotation),this.euler.setFromQuaternion(this.object.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}e===!1&&(this.object instanceof gs?this.object.matrixAutoUpdate=!0:this.object.updateMatrix()),this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}connect(){this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError)}dispose(){var e;this.disconnect(),this.disposeActions(),(e=this.navMeshPathDest)!=null&&e.parent&&this.scene.remove(this.navMeshPathDest)}disposeActions(){this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("jump"),fa(this.actions)}dispatchStartEvent(e){this.actions[e]!==void 0&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].forEach(t=>{t instanceof Oy?t.play():t instanceof Ry?t.dispatchStart():t instanceof Dy&&t.dispatchGameControl("start")})))}dispatchStopEvent(e){this.actions[e]!==void 0&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].forEach(t=>{t instanceof Oy?(t.stop(),t.object.currentState!==null&&t.object.changeSelectedState(null,{scene:this.scene,shared:this.sharedAssets})):t instanceof Ry?t.dispatchStop():t instanceof Dy&&t.dispatchGameControl("stop")})))}get colliderWorldPosition(){return Cs.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.object.position)}update(e,t,i){var a,l,c,h,u,d,f,p,g,m,v;if(this.gravity<0?this.object.position.y<this.resetYPosition:this.object.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let n=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let r=n*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let x=Ts.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*xj),1)*(this.gravity>0?1:-1):this.velocity.y)*n,0).divideScalar(this.pixelsPerMeter),w=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,x,(a=this.object.rigidBody)==null?void 0:a.collider(0).shape,1,!1,void 0,void 0,void 0,this.object.rigidBody);if(w){this.onObject=!0,this.groundNormal.set(w.normal2.x,w.normal2.y,w.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=w.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let b=w.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let M of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(M.rigidBody===b&&M.userData.isFollowingObj!==this.object.uuid){(M.hasNonUniformScale?M.matrixWorldRigid:M.matrixWorld).decompose(Cs,Cc,Ts),this.groundVelocity.subVectors(Cs,M.prevT),this.object.getWorldPosition(Ts).add(this.collider.position).sub(M.position),this.groundYRotation=bl.setFromQuaternion(Cc).y-M.prevR.y,Gu.copy(Ts).applyAxisAngle(Da,this.groundYRotation),this.groundVelocity.add(Gu.sub(Ts)).divideScalar(n);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*r),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let x=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.scene.add(this.navMeshPathDest);let w=Cs.subVectors(this.path[1],this.object.position),b=Ts.subVectors(this.path[1],this.path[0]);w.dot(b)<0?this.path.shift():(this.directionXZ.x=b.x,this.directionXZ.z=b.z),x.opacity=x.userData.opacity0}else x.opacity-=.05*x.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.scene.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**r),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**r),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**r)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("move")));let o=pFe.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let x=Ts.copy(o);x.y=0,o.set(0,o.y,x.length()*-1)}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none")if(this.orientWith==="camera"&&this.path.length<=1){let x=Cs;this.camera.getWorldDirection(x);let w=Gu.copy(Da).multiplyScalar(x.dot(Da));x.sub(w);let b=Ts.copy(this.directionXZ);b.x*=-1,this.rot.y=x.angleTo(b)*(x.cross(b).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)-Math.PI/2;if(bl.setFromVector3(this.rot),this.moveMode==="walk"&&(bl.x=0),o.applyEuler(bl),s&&(Cc.setFromUnitVectors(Da,this.groundNormal),o.applyQuaternion(Cc)),i){let x=bl.set(0,this.vrEulerYOffset*wj,0);i.applyEuler(x),o.x+=i.x,o.z+=i.z,this.nonColliderPosOffset.elements[13]+=i.y*n}if(this.usePhysics===!0){let x=Ts;this.pushedVelocity.set(0,0,0);for(let w of this.sharedGameControlGlobals.entitiesWithTransformAnim){let b=Gu.setFromMatrixPosition(w.matrixWorld).sub(w.prevT).divideScalar(n).divideScalar(this.pixelsPerMeter),M=w.rigidBody.collider(0).castCollider(b,this.object.rigidBody.collider(0),Cs.copy(o).divideScalar(this.pixelsPerMeter),n,!1);if(b.multiplyScalar(this.pixelsPerMeter),M!==null){this.pushedVelocity.copy(b),x.copy(M.normal1).applyQuaternion(w.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let w=x.dot(o);w<0&&o.addScaledVector(x,-w),o.add(this.pushedVelocity)}else o.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(n),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**r):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**r),this.euler.x+=this.rotVelocity.x*n,this.euler.y+=this.rotVelocity.y*n+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*n),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(Da,this.euler.y-this.euler0.y);let x=Ts.copy(this.objectToCamXZ).normalize(),w=Gu.copy(o).multiplyScalar(n);w.y=0;let b=w.sub(Cs.copy(x).multiplyScalar(w.dot(x))).cross(x).y;this.euler.y-=Math.atan2(b,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*n+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=si.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=si.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=si.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(bl.copy(t),bl.y=0):(bl.copy(this.euler),bl.y=0),this.nonColliderRotOffset.makeRotationFromEuler(bl)),t&&(this.moveMode==="walk"?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*wj),Pa.setFromAxisAngle(gFe,this.rot.x),Cc.setFromAxisAngle(Da,this.rot.y),Cc.multiply(Pa),Pa.setFromAxisAngle(vFe,this.rot.z),Cc.multiply(Pa),this.object.quaternion.copy(Cc),this.objectRealQuat.multiplyQuaternions(this.object.quaternion,this.objXZQuat),this.objectRealQuat.multiply(this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let x=Ts.copy(o).multiplyScalar(n/this.pixelsPerMeter),w=null;this.didHit=!1;let b=new I;for(let M=0;M<5;M++){let A=x.length(),T=Gu.copy(x).normalize();if(w=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(b),this.colliderWorldQuat,T,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,A,!1,8,void 0,void 0,this.object.rigidBody),w!==null){this.didHit=!0;let S=this.sharedGameControlGlobals.colliderToEntity[w.collider.handle];if(S!==this.lastHitObj&&M===0){this.lastHitObj=S;let k=this.sharedGameControlGlobals.eventsPerObjects[S==null?void 0:S.uuid];if(k){for(let z of k)if(z.data.target==="character"){let F=((h=this.sharedGameControlGlobals.rapierWorld)==null?void 0:h.getCollider(w.collider.handle))._parent,W;if(S.cloner){for(let K of S.cloner.children)if(K.rigidBody===F){W=K;break}}z.dispatch(W),S.dispatchEvent(pZ)}}}let C=mj.set(w.normal2.x,w.normal2.y,w.normal2.z).applyQuaternion(this.colliderWorldQuat),P=gj.copy(T).multiplyScalar(w.toi).dot(C),B=w.toi;if(B===0&&(this.object.position.y+=this.offset*this.pixelsPerMeter),P>this.offset&&(B=w.toi*(P-this.offset)/P,b.addScaledVector(T,B)),x.copy(T).multiplyScalar(A-B),Math.acos(-C.y)>this.slopeThresh){let k=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(b),z=Gu.copy(w.witness2).applyQuaternion(this.colliderWorldQuat);z.y=0;let F=k.add(z);F.y+=this.stepThresh;let W=this.sharedGameControlGlobals.rapierWorld.castShape(F,this.colliderWorldQuat,x,(u=this.object.rigidBody)==null?void 0:u.collider(0).shape,1,!1,8,void 0,void 0,this.object.rigidBody);W!==null&&W.toi===0&&(C.y=0,C.normalize())}x.addScaledVector(C,-x.dot(C))}else{M===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),b.add(x);break}}this.object.position.addScaledVector(b,this.pixelsPerMeter),(d=this.object.rigidBody)==null||d.setTranslation(Cs.copy(this.object.position).divideScalar(this.pixelsPerMeter),!0),(f=this.object.rigidBody)==null||f.setRotation(Pa.copy(this.object.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let x=this.onObject?1:5,w=o.multiplyScalar(n/x);for(let b=0;b<x;b++)this.object.position.add(w),this.collisionAdjustment(n/x)}else this.object.position.addScaledVector(o,n);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.object.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.updateMatrix(),this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.object.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let x=this.objectToTarget.add(this.object.position),w=this.targetToCamera.add(x);IP.lookAt(w,x,Da).setPosition(w),IP.decompose(this.targetPos,this.targetQuat,Cs),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**r),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**r),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=si.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=si.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.path.length<2&&this.lastPosition.distanceToSquared(this.object.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&((g=(p=this.navMeshPathDest)==null?void 0:p.material)==null?void 0:g.opacity)<-.04*((v=(m=this.navMeshPathDest)==null?void 0:m.material)==null?void 0:v.userData.opacity0)?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.object.position),this.object.dispatchEvent(bFe),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e=Pa.setFromAxisAngle(Da,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?si.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(e);let t;this.cameraXAxis==="Limit"?t=si.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):t=si.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let i=Cs.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&i.applyQuaternion(e);let n=Cc.setFromAxisAngle(i,t);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(e),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(n)}groundTiltAdjustment(e){Da.angleTo(e)*180/Math.PI<15||Da.angleTo(e)*180/Math.PI>85?Pa.identity():Pa.setFromUnitVectors(Da,e),this.groundTilt.slerp(Pa,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){var r;let t=gj.set(0,0,0);this.object.updateMatrix();let i=IP.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(Cs,Pa,Ts).compose(Cs,Pa,yj);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;Go.makeEmpty(),s.updateMatrixWorldSVD();let o=s.matrixWorldRigid,a=vj.copy(o).invert(),l=mFe.copy(vj).multiply(i);Hr.copy(this.collider.segment),Hr.start.applyMatrix4(l),Hr.end.applyMatrix4(l);let c=mj.copy(this.object.position).applyMatrix4(a);Go.expandByPoint(Hr.start),Go.expandByPoint(Hr.end),Go.min.addScalar(-this.collider.radius),Go.max.addScalar(this.collider.radius),s.boundsTree.shapecast({intersectsBounds:h=>h.intersectsBox(Go),intersectsTriangle:h=>{let u=Cs,d=Ts,f=h.closestPointToSegment(Hr,u,d);if(f<this.collider.radius){let p=this.collider.radius-f,g=d.sub(u).normalize(),m=Gu.copy(c);m.addScaledVector(g,p);let v=m.applyMatrix4(o).sub(this.object.position);t.add(v),Hr.start.addScaledVector(g,p),Hr.end.addScaledVector(g,p)}}})}),Go.makeEmpty(),Hr.copy(this.collider.segment),Hr.start.applyMatrix4(i),Hr.end.applyMatrix4(i),Go.expandByPoint(Hr.start),Go.expandByPoint(Hr.end),Go.min.addScalar(-this.collider.radius),Go.max.addScalar(this.collider.radius),(r=this.sharedGameControlGlobals.staticMeshBVH)==null||r.shapecast({intersectsBounds:s=>s.intersectsBox(Go),intersectsTriangle:s=>{let o=Cs,a=Ts,l=s.closestPointToSegment(Hr,o,a);if(l<this.collider.radius){let c=this.collider.radius-l,h=a.sub(o).normalize();this.alignToGround&&this.groundTiltAdjustment(h),t.addScaledVector(h,c),Hr.start.addScaledVector(h,c),Hr.end.addScaledVector(h,c)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let n=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(n),this.object.position.add(t)}},mZ=vL;mZ.isLocked=!1;var AFe={type:"change"},_j={type:"changeZoom"},SFe={type:"changePan"},am={type:"start"},lm={type:"end",changed:!0},MFe={type:"end",changed:!1},OP=new ai,bj=new ge,EFe=2*Math.PI,CFe=1e-8,TFe=.01,FP=new I,Fb=new ge,NP=new I,Nb=new ai,Aj=new Je,PFe={type:"requestRender"},gZ=class extends _s{constructor(e,t,i={isPlayMode:!1,isExport:!1}){super(),this.object=e,this.domElement=t,this.options=i,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Fo.DOLLY_ROTATE,Fo.PAN],this.offset=new I,this.eye=new I,this.lastPosition=new I,this.lastQuaternion=new ai,this.current=new ge,this.overShoot=new ge,this.overRatio=new ge,this.spherical=new YG,this.sphericalDelta=new YG,this.panOffset=new I,this.panLeftV=new I,this.panUpV=new I,this.panV=new I,this.rotateStart=new ge,this.rotateEnd=new ge,this.rotateDelta=new ge,this.panStart=new ge,this.panEnd=new ge,this.panDelta=new ge,this.dollyStart=new ge,this.dollyEnd=new ge,this.dollyDelta=new ge,this.rotationRangeFactor=new ge,this.panRangeFactor=new ge,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=n=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=n.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(NP,Nb,FP),this.offset.copy(NP).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(OP.copy(Nb).invert()),this.panOffset.applyQuaternion(OP),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(Nb),this.panOffset.applyQuaternion(Nb)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),NP.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(Aj.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(Aj));let n=this.spherical.phi%EFe;return this.eye.copy(this.offset).normalize(),this.object.up.copy(Ii.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),n>0&&n>Math.PI||n<0&&n>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor):this.sphericalDelta.set(0,0,0),this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>TFe||8*(1-this.lastQuaternion.dot(this.object.quaternion))>CFe?(this.dispatchEvent(AFe),this.object.dispatchEvent(PFe),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=n=>{this.enabled!==!1&&(n.pointerType==="touch"||n.pointerType==="pen"&&ho?this.onPointerDownTouch(n):this.onPointerDownMouse(n),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(am),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),n.stopPropagation(),n.pointerType==="touch"||n.pointerType==="pen"&&ho||this.domElement.setPointerCapture(n.pointerId)))},this.onPointerLeave=n=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,FP.subVectors(this.position0,this.target0),this.spherical.setFromVector3(FP),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=n},this.onPointerEnter=n=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?Fb.set(n.clientX-this.domElement.clientWidth/2,n.clientY-this.domElement.clientHeight/2):Fb.set(n.clientX-this.pointerLeaveEvent.clientX,n.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(Fb).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(bj,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(n.clientX,n.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(Fb).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(n.clientX,n.clientY)),this.update()},this.onPointerMove=n=>{this.enabled!==!1&&(n.pointerType==="touch"||n.pointerType==="pen"&&ho?this.onPointerMoveTouch(n):this.onPointerMoveMouse(n),n.stopPropagation())},this.onPointerUp=n=>{this.isPointerDown=!1,Lt.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),Lt.length>1&&n.preventDefault(),this.hasChange?this.dispatchEvent(lm):this.dispatchEvent(MFe),this.state=-1,n&&(n.stopPropagation(),n.pointerType==="touch"||n.pointerType==="pen"&&ho||this.domElement.releasePointerCapture(n.pointerId))},this.onPointerDownMouse=n=>{let r;switch(this.useKeyEvents?r=this.mouseButtons[n.button]:r=this.mouseButtonsPlay[n.button],r){case 0:if(n.altKey===!0&&!n.shiftKey&&!hb(n)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2;break;case 3:if(hb(n)||n.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}break;case 5:if(hb(n)||n.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=n=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(n);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(n);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(n);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=n=>{switch(Lt.length>1&&n.preventDefault(),this.touches[Lt.length-1]){case Fo.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case Fo.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case Fo.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case Fo.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=n=>{switch(Lt.length>1&&n.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(n),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(n),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(n),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(n),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=DO(()=>this.dispatchEvent(lm),33),this.onMouseWheel=n=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||(this.options.isExport===!1&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&n.preventDefault(),this.dispatchEvent(am),this.handleMouseWheel(n),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=n=>{if(n.preventDefault(),this.enabled!==!1&&!bQ)if(n.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(am),n.scale>this.prevScale?this.dollyIn(this.getZoomScale()):n.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=n.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(lm)},this.onContextMenu=n=>{n.preventDefault()},this.onTouchEnd=n=>{n.preventDefault()},this.onKeyDown=n=>{this.enabled!==!1&&(this.key=n.key,n.key===" "&&this.dispatchEvent(am))},this.onKeyUp=n=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&n.key==="Alt"&&this.onPointerUp(Lt[0]),n.key===" "&&this.dispatchEvent(lm))},this.onPointerHover=n=>{n.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(n,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(n,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=n=>{n.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.addEventListenersToCamera()}dispatchEvent(e){e.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.useWindowEvents=t==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let i=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=i**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let n=this.object.getTarget().applyQuaternion(OP.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+n.y,this.maxV=e.panVerticalOffset.max+n.y,this.minH=-e.panHorizontalOffset.min+n.x,this.maxH=e.panHorizontalOffset.max+n.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=Al(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=Al(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=Al(Al(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=Al(Al(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,e.orbitTouches===1&&(this.touches[0]=Fo.ROTATE),e.panTouches===1&&(this.touches[0]=Fo.PAN),e.orbitTouches===2&&(this.touches[1]=Fo.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=Fo.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=Fo.ROTATE),e.panTouches===3&&(this.touches[2]=Fo.PAN),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,i,n,r,s,o,a){this.overShoot.set(0,0);let l,c,h;e instanceof I?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),h=!0):(l=e.theta,c=e.phi,this.current.set(Al(this.spherical.theta),Al(this.spherical.phi)),h=!1),i===0&&(this.current.x+=l,this.current.y+=c),(t===3||t===2)&&(!h&&this.isThetaFlipped?this.current.x>n&&this.current.x<0?this.overShoot.x=n-this.current.x:this.current.x<r&&this.current.x>0&&(this.overShoot.x=r-this.current.x):this.current.x>n?this.overShoot.x=n-this.current.x:this.current.x<r&&(this.overShoot.x=r-this.current.x)),(t===3||t===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<o&&(this.overShoot.y=o-this.current.y)),h||(this.overShoot.x=Al(this.overShoot.x),this.overShoot.y=Al(this.overShoot.y)),i!==0?(this.overRatio.copy(this.overShoot).divide(a),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),i===1&&(this.overRatio.x=Sj(Math.abs(this.overRatio.x)),this.overRatio.y=Sj(Math.abs(this.overRatio.y))),this.isPointerDown||i===1?i===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):i===2&&(!h&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||h&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),h?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):h?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof I?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let i=this.domElement;if(i&&this.object.isPerspectiveCamera){let n=this.object.position;this.panV.copy(n).sub(this.target);let r=this.panV.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*r/i.clientHeight,this.object.matrixWorld),this.panUp(2*t*r/i.clientHeight,this.object.matrixWorld)}else i&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrixWorld));this.dispatchEvent(SFe)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(_j)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(_j)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(am),this.dollyOut(e),this.dispatchEvent(lm)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(am),this.dollyIn(e),this.dispatchEvent(lm)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){e.movementX!==void 0?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(bj,-this.object.angleOffsetFromUp);let i=this.domElement,n=this.useWindowEvents?window.innerHeight:i.clientHeight,r=2*Math.PI*this.rotateDelta.x/n,s=2*Math.PI*this.rotateDelta.y/n;this.rotateLeft(r),this.rotateUp(s),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){e.movementX!==void 0?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(wPe===!1&&hb(e)===!1&&DFe(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(Lt.length===2){let e=.5*(Lt[0].pageX+Lt[1].pageX),t=.5*(Lt[0].pageY+Lt[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(Lt[0].pageX,Lt[0].pageY)}handleTouchStartPan(){if(Lt.length===2){let e=.5*(Lt[0].pageX+Lt[1].pageX),t=.5*(Lt[0].pageY+Lt[1].pageY);this.panStart.set(e,t)}else this.panStart.set(Lt[0].pageX,Lt[0].pageY)}handleTouchStartDolly(){let e=Lt[0].pageX-Lt[1].pageX,t=Lt[0].pageY-Lt[1].pageY,i=Math.sqrt(e*e+t*t);this.dollyStart.set(0,i)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(Lt.length===2){let i=H2(e),n=.5*(e.pageX+i.x),r=.5*(e.pageY+i.y);this.rotateEnd.set(n,r)}else{if(e.pointerId!==Lt[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(Lt.length===2){let t=H2(e),i=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this.panEnd.set(i,n)}else{if(e.pointerId!==Lt[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=H2(e),i=e.pageX-t.x,n=e.pageY-t.y,r=Math.sqrt(i*i+n*n);this.dollyEnd.set(0,r),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}};function Al(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function Sj(e){return 1-Math.pow(1-e,4)}function DFe(e){return e.wheelDeltaY===0||e.deltaY===0?nE&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY:e.deltaMode===0}var zP=new WeakMap,BFe=class extends uO{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,n){let r=new cB(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,s=>{this.decodeDracoFile(s,t).catch(n)},i,n)}decodeDracoFile(e,t,i,n){let r={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!i};return this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){let i=JSON.stringify(t);if(zP.has(e)){let a=zP.get(e);if(a.key===i)return a.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n,r=this.workerNextTaskID++,s=e.byteLength,o=this._getWorker(r,s).then(a=>(n=a,new Promise((l,c)=>{n._callbacks[r]={resolve:l,reject:c},n.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(a=>this._createGeometry(a.geometry));return o.catch(()=>!0).then(()=>{n&&r&&this._releaseTask(n,r)}),zP.set(e,{key:i,promise:o}),o}_createGeometry(e){let t=new Ot;e.index&&t.setIndex(new zt(e.index.array,1));for(let i=0;i<e.attributes.length;i++){let n=e.attributes[i],r=n.name,s=n.array,o=n.itemSize;t.setAttribute(r,new zt(s,o))}return t}_loadLibrary(e,t){let i=new cB(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((n,r)=>{i.load(e,n,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{let n=i[0];e||(this.decoderConfig.wasmBinary=i[1]);let r=LFe.toString(),s=["/* draco decoder */",n,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let n=new Worker(this.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:this.decoderConfig}),n.onmessage=function(r){let s=r.data;switch(s.type){case"decode":n._callbacks[s.id].resolve(s);break;case"error":n._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(n)}else this.workerPool.sort(function(n,r){return n._taskLoad>r._taskLoad?-1:1});let i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function LFe(){let e,t;onmessage=function(o){let a=o.data;switch(a.type){case"init":e=a.decoderConfig,t=new Promise(function(h){e.onModuleLoaded=function(u){h({draco:u})},DracoDecoderModule(e)});break;case"decode":let l=a.buffer,c=a.taskConfig;t.then(h=>{let u=h.draco,d=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{let p=i(u,d,f,c),g=p.attributes.map(m=>m.array.buffer);p.index&&g.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},g)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{u.destroy(f),u.destroy(d)}});break}};function i(o,a,l,c){let h=c.attributeIDs,u=c.attributeTypes,d,f,p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeBufferToMesh(l,d);else if(p===o.POINT_CLOUD)d=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());let g={index:null,attributes:[]};for(let m in h){let v=self[u[m]],x,w;if(c.useUniqueIDs)w=h[m],x=a.GetAttributeByUniqueId(d,w);else{if(w=a.GetAttributeId(d,o[h[m]]),w===-1)continue;x=a.GetAttribute(d,w)}g.attributes.push(r(o,a,d,m,v,x))}return p===o.TRIANGULAR_MESH&&(g.index=n(o,a,d)),o.destroy(d),g}function n(o,a,l){let c=l.num_faces()*3,h=c*4,u=o._malloc(h);a.GetTrianglesUInt32Array(l,h,u);let d=new Uint32Array(o.HEAPF32.buffer,u,c).slice();return o._free(u),{array:d,itemSize:1}}function r(o,a,l,c,h,u){let d=u.num_components(),f=l.num_points()*d,p=f*h.BYTES_PER_ELEMENT,g=s(o,h),m=o._malloc(p);a.GetAttributeDataArrayForAllPoints(l,u,g,p,m);let v=new h(o.HEAPF32.buffer,m,f).slice();return o._free(m),{name:c,array:v,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var mh;function RFe(){return mh||(mh=new BFe,mh.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),mh.decoderPending}async function IFe(e){if(mh){let t={attributeIDs:mh.defaultAttributeIDs,attributeTypes:mh.defaultAttributeTypes,useUniqueIDs:!1},i;try{i=await mh.decodeGeometry(new Int8Array(e).buffer,t)}catch(n){console.error(n)}if(i)return{index:i.index?{array:i.index.array}:void 0,attributes:Object.entries(i.attributes).map(([n,r])=>({name:n,itemSize:r.itemSize,array:r.array}))}}return null}async function OFe(e,t){let[i,n]=FQ(SB.deserialize(new Uint8Array(e)));ODe(i);let r=[];i.scene.objects.traverse((s,o)=>{o.type==="Mesh"&&o.geometry.type==="NonParametricGeometry"&&o.geometry.data.draco!==void 0&&r.push(o)}),r.length&&await RFe();for(let s of r){let o=await IFe(Qr(s.geometry.data.draco));if(o){o.index&&(s.geometry.data.index={array:o.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let a={};o.attributes.forEach(({name:l,array:c,itemSize:h})=>{a[l]={array:c,itemSize:h,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=a,s.geometry.data.draco=void 0}}return t&&t(i),n.result().data}var Mj=Object.keys(kK).filter(e=>isNaN(Number(e))),FFe=class{constructor(e,t,i){this.controlsManager=t,this.eventContext=i,this.isEnable=!1,this._isPaused=!1,this.onResetRaycaster=()=>{this.eventContext.raycasterNeedsUpdate=!0},this.onTouchMovePreventScroll=r=>{(r.touches.length>1||this.preventTouchScroll)&&r.preventDefault()},this.onMouseWheelPreventScroll=r=>{this.preventScroll&&r.preventDefault()},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=i.requestRender;let n={controlsManager:t,eventManager:this};this.handlers={Spline:new bOe(this.eventContext),Conditional:new POe(this.eventContext,n),Start:new ZOe(this.eventContext,n),Basic:new SOe(this.eventContext,n),MouseHover:new YOe(this.eventContext,n),Scroll:new JOe(this.eventContext,n),Follow:new kOe(this.eventContext,n),DragDrop:new IOe(this.eventContext,n),LookAt:new jOe(this.eventContext)}}activate(){if(this.isPaused)return;let{scene:e,domElement:t,eventElement:i}=this.eventContext;this.hideCursor&&(t.style.cursor="none"),this.isEnable=!0,e.traverseEntity(n=>{n.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(n=>n.connect()),Mj.forEach(n=>{(Object.values(this.handlers).some(r=>r.domEventsNeeded.has(n))||n==="pointerdown"&&this.controlsManager.navigationMeshWrapper)&&(t.addEventListener(n,this.onResetRaycaster),i.addEventListener(n,this.onResetRaycaster))}),t.addEventListener("wheel",this.onMouseWheelPreventScroll),t.addEventListener("touchmove",this.onTouchMovePreventScroll)}deactivate(){let{scene:e,domElement:t}=this.eventContext;this.isEnable=!1,t.style.cursor="",Object.values(this.handlers).forEach(i=>i.disconnect()),this.controlsManager.gameControls.forEach(i=>{i.disposeActions()}),this.controlsManager.disconnectCollisionEvents(),e.traverseEntity(i=>{i.removeEventListener("requestRender",this.requestRender)}),Mj.forEach(i=>{t.removeEventListener(i,this.onResetRaycaster)}),t.removeEventListener("touchmove",this.onTouchMovePreventScroll),t.removeEventListener("wheel",this.onMouseWheelPreventScroll)}get isPaused(){return this._isPaused}pause(){this._isPaused=!0,this.deactivate()}resume(){this._isPaused=!1,this.activate()}reset(){this.deactivate(),this.activate()}updateUseWindowEvents(e){let t=this.isEnable;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}},NFe=class{constructor(e,t,i,n,r){this._aspect=1,this._renderer=e,this._camera=t,this._frameSize=new ge().copy(i),this._editorSize=new ge().copy(n),this._aspect=t.aspect,this._fov=r??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,i=this._editorSize.y;this._aspect=e/t,t<=i&&(this._camera.zoom*=i/t),this._renderer.setViewport(0,0,e,t)}updateCamera(){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let e=this._frameSize.y,t=this._editorSize.y,i=this._fov;if(e>t){let n=zFe(e,1080,2160,1,15)/100;i*=e/t,i*=1-n}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t),this._camera.updateProjectionMatrix())}};function zFe(e,t,i,n,r){return(e-t)/(i-t)*(r-n)+n}var vZ={RED:0,GREEN:1,BLUE:2,ALPHA:3},D1="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",kFe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,zb=class extends ji{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new Ye(null),kernel16:new Ye(null),inputBuffer:new Ye(null),cocBuffer:new Ye(null),texelSize:new Ye(new ge),scale:new Ye(1)},blending:Hn,depthWrite:!1,depthTest:!1,fragmentShader:kFe,vertexShader:D1}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),i=new Float32Array(32),n=0,r=0;for(let a=0;a<80;++a){let l=a*e,c=Math.sqrt(a)/Math.sqrt(80),h=c*Math.cos(l),u=c*Math.sin(l);a%5===0?(i[r++]=h,i[r++]=u):(t[n++]=h,t[n++]=u)}let s=[],o=[];for(let a=0;a<128;)s.push(new Kt(t[a++],t[a++],t[a++],t[a++]));for(let a=0;a<32;)o.push(new Kt(i[a++],i[a++],i[a++],i[a++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=o}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function Ej(e,t,i){return e*(t-i)-t}function yL(e,t,i){return Math.min(Math.max((e+t)/(t-i),0),1)}var UFe=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,GFe=class extends ji{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Ye(null),focusDistance:new Ye(0),focusRange:new Ye(0),cameraNear:new Ye(.3),cameraFar:new Ye(1e3)},blending:Hn,depthWrite:!1,depthTest:!1,fragmentShader:UFe,vertexShader:D1}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=du){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-Ej(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=yL(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-Ej(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=yL(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Yr?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},HFe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,VFe="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",Cj=class extends ji{constructor(e=new ge){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Ye(null),texelSize:new Ye(new ge),halfTexelSize:new Ye(new ge),kernel:new Ye(0),scale:new Ye(1)},blending:Hn,depthWrite:!1,depthTest:!1,fragmentShader:HFe,vertexShader:VFe}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let i=this.uniforms;i.texelSize.value.set(1/e,1/t),i.halfTexelSize.value.copy(i.texelSize.value).multiplyScalar(.5)}},jFe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,WFe=class extends ji{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Ye(null),opacity:new Ye(1)},blending:Hn,depthWrite:!1,depthTest:!1,fragmentShader:jFe,vertexShader:D1}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},XFe=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,YFe=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,mE={DEPTH:0,LUMA:1,COLOR:2},qFe={DISABLED:0,DEPTH:1,CUSTOM:2},QFe=class extends ji{constructor(e=new ge,t=mE.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:rv.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new Ye(null),depthBuffer:new Ye(null),predicationBuffer:new Ye(null),texelSize:new Ye(e)},blending:Hn,depthWrite:!1,depthTest:!1,fragmentShader:XFe,vertexShader:YFe}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=du){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},JFe=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,KFe="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",Ba={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},xL=class extends ji{constructor(e,t,i,n,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:rv.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Ye(null),depthBuffer:new Ye(null),resolution:new Ye(new ge),texelSize:new Ye(new ge),cameraNear:new Ye(.3),cameraFar:new Ye(1e3),aspect:new Ye(1),time:new Ye(0)},blending:Hn,depthWrite:!1,depthTest:!1,dithering:r}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),i&&this.setUniforms(i),this.adoptCameraSettings(n)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=du){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=JFe.replace(Ba.FRAGMENT_HEAD,e.get(Ba.FRAGMENT_HEAD)).replace(Ba.FRAGMENT_MAIN_UV,e.get(Ba.FRAGMENT_MAIN_UV)).replace(Ba.FRAGMENT_MAIN_IMAGE,e.get(Ba.FRAGMENT_MAIN_IMAGE)),this.vertexShader=KFe.replace(Ba.VERTEX_HEAD,e.get(Ba.VERTEX_HEAD)).replace(Ba.VERTEX_MAIN_SUPPORT,e.get(Ba.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Yr?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let i=this.uniforms;i.resolution.value.set(e,t),i.texelSize.value.set(1/e,1/t),i.aspect.value=e/t}static get Section(){return Ba}},ZFe=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,$Fe=class extends ji{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:rv.replace(/\D+/g,"")},uniforms:{inputBuffer:new Ye(null),threshold:new Ye(0),smoothing:new Ye(1),range:new Ye(null)},blending:Hn,depthWrite:!1,depthTest:!1,fragmentShader:ZFe,vertexShader:D1}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},eNe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,yZ={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},tNe=class extends ji{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new Ye(e),inputBuffer:new Ye(null),strength:new Ye(1)},blending:Hn,depthWrite:!1,depthTest:!1,fragmentShader:eNe,vertexShader:D1}),this.toneMapped=!1,this.setColorChannel(vZ.RED),this.setMaskFunction(yZ.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==Kr&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},iNe=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,nNe="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",rNe=class extends ji{constructor(e=new ge,t=new ge){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new Ye(null),searchTexture:new Ye(null),areaTexture:new Ye(null),resolution:new Ye(t),texelSize:new Ye(e)},blending:Hn,depthWrite:!1,depthTest:!1,fragmentShader:iNe,vertexShader:nNe}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let i=this.uniforms;i.texelSize.value.set(1/e,1/t),i.resolution.value.set(e,t)}},sNe=new lv,Hu=null;function oNe(){if(Hu===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);Hu=new Ot,Hu.setAttribute!==void 0?(Hu.setAttribute("position",new zt(e,3)),Hu.setAttribute("uv",new zt(t,2))):(Hu.addAttribute("position",new zt(e,3)),Hu.addAttribute("uv",new zt(t,2)))}return Hu}var bs=class{constructor(e="Pass",t=new bf,i=sNe){this.name=e,this.renderer=null,this.scene=t,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Ns(oNe(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new bf),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=du){}render(e,t,i,n,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,i){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof bf||t===this.renderer)continue;this[e].dispose()}}}},wL=class extends bs{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new WFe,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Pi(1,1,{minFilter:Zt,magFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,i,n,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,i){i!==void 0&&(this.renderTarget.texture.type=i,i!==Kr?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===Vt&&(this.renderTarget.texture.encoding=Vt))}},aNe=class extends bs{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,i,n,r){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},kP=new Pt,_F=class extends bs{constructor(e=!0,t=!0,i=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=i,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,i){this.color=e,this.depth=t,this.stencil=i}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,i,n,r){let s=this.overrideClearColor,o=this.overrideClearAlpha,a=e.getClearAlpha(),l=s!==null,c=o>=0;l?(kP.copy(e.getClearColor(kP)),e.setClearColor(s,c?o:a)):c&&e.setClearAlpha(o),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(kP,a):c&&e.setClearAlpha(a)}},Vu=-1,ks=class extends _s{constructor(e,t=Vu,i=Vu,n=1){super(),this.resizable=e,this.base=new ge(1,1),this.preferred=new ge(t,i),this.target=this.preferred,this.s=n}get width(){let{base:e,preferred:t,scale:i}=this,n;return t.width!==Vu?n=t.width:t.height!==Vu?n=Math.round(t.height*(e.width/Math.max(e.height,1))):n=Math.round(e.width*i),n}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:i}=this,n;return t.height!==Vu?n=t.height:t.width!==Vu?n=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):n=Math.round(e.height*i),n}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(Vu),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Vu}},UP=!1,Tj=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let i;if(t.material.flatShading)switch(t.material.side){case uo:i=this.materialsFlatShadedDoubleSide;break;case gr:i=this.materialsFlatShadedBackSide;break;default:i=this.materialsFlatShaded;break}else switch(t.material.side){case uo:i=this.materialsDoubleSide;break;case gr:i=this.materialsBackSide;break;default:i=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=i[2]:t.isInstancedMesh?t.material=i[1]:t.material=i[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let i of t)i.uniforms=Object.assign({},e.uniforms),i.side=Ka;t[2].skinning=!0,this.materialsBackSide=t.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=gr,n}),this.materialsDoubleSide=t.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=uo,n}),this.materialsFlatShaded=t.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=t.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=gr,n}),this.materialsFlatShadedDoubleSide=t.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=uo,n})}}render(e,t,i){let n=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,UP){let r=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,i);for(let s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{let r=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,i),t.overrideMaterial=r}e.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return UP}static set workaroundEnabled(e){UP=e}},lNe=class extends bs{constructor(e,t,i=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new _F,this.overrideMaterialManager=i===null?null:new Tj(i),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new Tj(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,i,n,r){let s=this.scene,o=this.camera,a=this.selection,l=o.layers.mask,c=s.background,h=e.shadowMap.autoUpdate,u=this.renderToScreen?null:t;a!==null&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(u),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,s,o):e.render(s,o),o.layers.mask=l,s.background=c,e.shadowMap.autoUpdate=h}},Pj=class extends bs{constructor(e,t,{resolutionScale:i=1,width:n=ks.AUTO_SIZE,height:r=ks.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new lNe(e,t,new Aq({depthPacking:uq}));let o=this.renderPass;o.skipShadowMapUpdate=!0,o.ignoreBackground=!0;let a=o.getClearPass();a.overrideClearColor=new Pt(16777215),a.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new Pi(1,1,{minFilter:Ri,magFilter:Ri,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new ks(this,n,r,i);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,i,n,r){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height)}},hi={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},cNe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",uNe="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",hNe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",dNe="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",fNe="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",pNe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",mNe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",gNe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",vNe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",yNe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",xNe="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",wNe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",_Ne="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",bNe="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",ANe="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",SNe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",MNe="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",ENe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",CNe=new Map([[hi.SKIP,null],[hi.ADD,cNe],[hi.ALPHA,uNe],[hi.AVERAGE,hNe],[hi.COLOR_BURN,dNe],[hi.COLOR_DODGE,fNe],[hi.DARKEN,pNe],[hi.DIFFERENCE,mNe],[hi.EXCLUSION,gNe],[hi.LIGHTEN,vNe],[hi.MULTIPLY,yNe],[hi.DIVIDE,xNe],[hi.NEGATION,wNe],[hi.NORMAL,_Ne],[hi.OVERLAY,bNe],[hi.REFLECT,ANe],[hi.SCREEN,SNe],[hi.SOFT_LIGHT,MNe],[hi.SUBTRACT,ENe]]),TNe=class extends _s{constructor(e,t=1){super(),this.f=e,this.opacity=new Ye(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return CNe.get(this.blendFunction)}},Wl={NONE:0,DEPTH:1,CONVOLUTION:2},nc=class extends _s{constructor(e,t,{attributes:i=Wl.NONE,blendFunction:n=hi.SCREEN,defines:r=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}={}){super(),this.name=e,this.renderer=null,this.attributes=i,this.fragmentShader=t,this.vertexShader=a,this.defines=r,this.uniforms=s,this.extensions=o,this.blendMode=new TNe(n),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=du){}update(e,t,i){}setSize(e,t){}initialize(e,t,i){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof bf||t===this.renderer)continue;this[e].dispose()}}}};function Dj(e,t,i){for(let n of t){let r="$1"+e+n.charAt(0).toUpperCase()+n.slice(1),s=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(let o of i.entries())o[1]!==null&&i.set(o[0],o[1].replace(s,r))}}function PNe(e,t,i,n,r,s,o){let a=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=a.get("fragment")!==void 0&&/mainImage/.test(a.get("fragment")),c=a.get("fragment")!==void 0&&/mainUv/.test(a.get("fragment")),h=[],u=[],d=!1,f=!1;if(a.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(c&&o&Wl.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{let p=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,g=xL.Section;if(c){let v=`	${e}MainUv(UV);
`;i.set(g.FRAGMENT_MAIN_UV,i.get(g.FRAGMENT_MAIN_UV)+v),d=!0}if(a.get("vertex")!==null&&/mainSupport/.test(a.get("vertex"))){let v=`	${e}MainSupport(`;v+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(a.get("vertex"))?`vUv);
`:`);
`,i.set(g.VERTEX_MAIN_SUPPORT,i.get(g.VERTEX_MAIN_SUPPORT)+v),h=h.concat([...a.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(x=>x[1])),u=u.concat(h).concat([...a.get("vertex").matchAll(p)].map(x=>x[1]))}u=u.concat([...a.get("fragment").matchAll(p)].map(v=>v[1])),u=u.concat([...t.defines.keys()].map(v=>v.replace(/\([\w\s,]*\)/g,""))),u=u.concat([...t.uniforms.keys()]),t.uniforms.forEach((v,x)=>s.set(e+x.charAt(0).toUpperCase()+x.slice(1),v)),t.defines.forEach((v,x)=>r.set(e+x.charAt(0).toUpperCase()+x.slice(1),v)),Dj(e,u,r),Dj(e,u,a);let m=t.blendMode;if(n.set(m.blendFunction,m),l){let v=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,x=`${e}MainImage(color0, UV, `;o&Wl.DEPTH&&v.test(a.get("fragment"))&&(x+="depth, ",f=!0),x+=`color1);
	`;let w=e+"BlendOpacity";s.set(w,m.opacity),x+=`color0 = blend${m.blendFunction}(color0, color1, ${w});

	`,i.set(g.FRAGMENT_MAIN_IMAGE,i.get(g.FRAGMENT_MAIN_IMAGE)+x),x=`uniform float ${w};

`,i.set(g.FRAGMENT_HEAD,i.get(g.FRAGMENT_HEAD)+x)}i.set(g.FRAGMENT_HEAD,i.get(g.FRAGMENT_HEAD)+a.get("fragment")+`
`),a.get("vertex")!==null&&i.set(g.VERTEX_HEAD,i.get(g.VERTEX_HEAD)+a.get("vertex")+`
`)}return{varyings:h,transformedUv:d,readDepth:f}}var tM=class extends bs{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new xL(null,null,null,e),this.effects=t.sort((i,n)=>n.attributes-i.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=xL.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),i=new Map,n=new Map,r=new Map,s=new Set,o=0,a=0,l=0,c=!1,h=!1;for(let d of this.effects)if(d.blendMode.blendFunction===hi.SKIP)l|=d.getAttributes()&Wl.DEPTH;else if(l&d.getAttributes()&Wl.CONVOLUTION)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let f="e"+o++,p=PNe(f,d,t,i,n,r,l);if(a+=p.varyings.length,c=c||p.transformedUv,h=h||p.readDepth,d.extensions!==null)for(let g of d.extensions)s.add(g)}let u=/\bblend\b/g;for(let d of i.values()){let f=d.getShaderCode().replace(u,`blend${d.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+f+`
`)}if(l&Wl.DEPTH){if(h){let d=`float depth = readDepth(UV);

	`;t.set(e.FRAGMENT_MAIN_IMAGE,d+t.get(e.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(c){let d=`vec2 transformedUv = vUv;
`;t.set(e.FRAGMENT_MAIN_UV,d+t.get(e.FRAGMENT_MAIN_UV)),n.set("UV","transformedUv")}else n.set("UV","vUv");t.forEach((d,f,p)=>p.set(f,d.trim().replace(/^#/,`
#`))),this.uniformCount=r.size,this.varyingCount=a,this.skipRendering=o===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(r).setDefines(n)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=du){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let i of this.effects)i.setDepthTexture(e,t)}render(e,t,i,n,r){for(let s of this.effects)s.update(e,t,n);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,s.time+=n,e.setRenderTarget(this.renderToScreen?null:i),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let i of this.effects)i.setSize(e,t)}initialize(e,t,i){this.renderer=e;for(let n of this.effects)n.initialize(e,t,i),n.addEventListener("change",r=>this.handleEvent(r));this.updateMaterial(),this.verifyResources(),i!==void 0&&i!==Kr&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},DNe=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],xZ=class extends bs{constructor({resolutionScale:e=.5,width:t=ks.AUTO_SIZE,height:i=ks.AUTO_SIZE,kernelSize:n=bF.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new Pi(1,1,{minFilter:Zt,magFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let r=this.resolution=new ks(this,t,i,e);r.addEventListener("change",s=>this.setSize(r.baseWidth,r.baseHeight)),this.blurMaterial=new Cj,this.ditheredBlurMaterial=new Cj,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=n}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,i,n,r){let s=this.scene,o=this.camera,a=this.renderTargetA,l=this.renderTargetB,c=DNe[this.kernelSize],h=this.blurMaterial,u=t,d,f;for(this.fullscreenMaterial=h,d=0,f=c.length-1;d<f;++d){let p=d&1?l:a;h.kernel=c[d],h.inputBuffer=u.texture,e.setRenderTarget(p),e.render(s,o),u=p}this.dithering&&(h=this.ditheredBlurMaterial,this.fullscreenMaterial=h),h.kernel=c[d],h.inputBuffer=u.texture,e.setRenderTarget(this.renderToScreen?null:i),e.render(s,o)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t);let n=i.width,r=i.height;this.renderTargetA.setSize(n,r),this.renderTargetB.setSize(n,r),this.blurMaterial.setSize(n,r),this.ditheredBlurMaterial.setSize(n,r)}initialize(e,t,i){i!==void 0&&(this.renderTargetA.texture.type=i,this.renderTargetB.texture.type=i,i!==Kr?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===Vt&&(this.renderTargetA.texture.encoding=Vt,this.renderTargetB.texture.encoding=Vt))}static get AUTO_SIZE(){return ks.AUTO_SIZE}},BNe=class extends bs{constructor({width:e=ks.AUTO_SIZE,height:t=ks.AUTO_SIZE,renderTarget:i,luminanceRange:n,colorOutput:r}={}){super("LuminancePass"),this.fullscreenMaterial=new $Fe(r,n),this.needsSwap=!1,this.renderTarget=i,this.renderTarget===void 0&&(this.renderTarget=new Pi(1,1,{minFilter:Zt,magFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new ks(this,e,t);s.addEventListener("change",o=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,i,n,r){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height)}initialize(e,t,i){i!==void 0&&i!==Kr&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},LNe=class extends bs{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new _F(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,i,n,r){let s=e.getContext(),o=e.state.buffers,a=this.scene,l=this.camera,c=this.clearPass,h=this.inverted?0:1,u=1-h;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,h,4294967295),o.stencil.setClear(u),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,i))),this.renderToScreen?(e.setRenderTarget(null),e.render(a,l)):(e.setRenderTarget(t),e.render(a,l),e.setRenderTarget(i),e.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},Oc=class extends bs{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,i,n,r){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:i),e.render(this.scene,this.camera)}initialize(e,t,i){i!==void 0&&i!==Kr&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},GP=1/1e3,RNe=1e3,INe=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*GP}getFixedDelta(){return this.fixedDelta*GP}setFixedDelta(e){return this.fixedDelta=e*RNe,this}getElapsed(){return this.elapsed*GP}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},bF={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},ONe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,FNe=class extends nc{constructor({blendFunction:e=hi.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:i=.025,resolutionScale:n=.5,intensity:r=1,width:s=ks.AUTO_SIZE,height:o=ks.AUTO_SIZE,kernelSize:a=bF.LARGE}={}){super("BloomEffect",ONe,{blendFunction:e,uniforms:new Map([["map",new Ye(null)],["intensity",new Ye(r)]])}),this.renderTarget=new Pi(1,1,{minFilter:Zt,magFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new BNe({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=i,this.blurPass=new xZ({resolutionScale:n,width:s,height:o,kernelSize:a});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,i){let n=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,n),this.blurPass.render(e,n,n)):this.blurPass.render(e,t,n)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height),this.luminancePass.resolution.copy(i)}initialize(e,t,i){this.blurPass.initialize(e,t,i),i!==void 0&&(this.renderTarget.texture.type=i,e.outputEncoding===Vt&&(this.renderTarget.texture.encoding=Vt))}},NNe="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",zNe=class extends nc{constructor({blendFunction:e=hi.NORMAL,brightness:t=0,contrast:i=0}={}){super("BrightnessContrastEffect",NNe,{blendFunction:e,uniforms:new Map([["brightness",new Ye(t)],["contrast",new Ye(i)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},kNe="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",UNe=class extends nc{constructor(e=hi.NORMAL){super("ColorAverageEffect",kNe,{blendFunction:e})}},GNe="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",HNe="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",VNe=class extends nc{constructor({blendFunction:e=hi.NORMAL,offset:t=new ge(.001,5e-4)}={}){super("ChromaticAberrationEffect",GNe,{vertexShader:HNe,blendFunction:e,attributes:Wl.CONVOLUTION,uniforms:new Map([["offset",new Ye(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},jNe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,WNe=class extends nc{constructor(e,{blendFunction:t=hi.NORMAL,worldFocusDistance:i,worldFocusRange:n,focusDistance:r=0,focalLength:s=.1,focusRange:o=s,bokehScale:a=1,width:l=ks.AUTO_SIZE,height:c=ks.AUTO_SIZE}={}){super("DepthOfFieldEffect",jNe,{blendFunction:t,attributes:Wl.DEPTH,uniforms:new Map([["nearColorBuffer",new Ye(null)],["farColorBuffer",new Ye(null)],["nearCoCBuffer",new Ye(null)],["scale",new Ye(1)]])}),this.camera=e,this.renderTarget=new Pi(1,1,{minFilter:Zt,magFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Oc(new GFe(e));let h=this.cocMaterial;h.focusDistance=r,h.focusRange=o,i!==void 0&&(h.worldFocusDistance=i),n!==void 0&&(h.worldFocusRange=n),this.blurPass=new xZ({kernelSize:bF.MEDIUM,width:l,height:c});let u=this.blurPass.getResolution();u.addEventListener("change",f=>this.setSize(u.getBaseWidth(),u.getBaseHeight())),this.maskPass=new Oc(new tNe(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=yZ.MULTIPLY,d.colorChannel=vZ.GREEN,this.bokehNearBasePass=new Oc(new zb(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Oc(new zb(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Oc(new zb(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Oc(new zb(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=a}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let i of t)i.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,i=t.position.distanceTo(e);return yL(-i,t.near,t.far)}setDepthTexture(e,t=du){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,i){let n=this.renderTarget,r=this.renderTargetCoC,s=this.renderTargetCoCBlurred,o=this.renderTargetMasked;if(this.target!==null){let a=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=a}this.cocPass.render(e,null,r),this.blurPass.render(e,r,s),this.maskPass.render(e,t,o),this.bokehFarBasePass.render(e,o,n),this.bokehFarFillPass.render(e,n,this.renderTargetFar),this.bokehNearBasePass.render(e,t,n),this.bokehNearFillPass.render(e,n,this.renderTargetNear)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t);let n=i.width,r=i.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(o=>o.setSize(e,t)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(o=>o.setSize(n,r)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(o=>o.fullscreenMaterial.setSize(n,r))}initialize(e,t,i){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(n=>n.initialize(e,t,i)),this.blurPass.initialize(e,t,Kr),i!==void 0&&(this.renderTarget.texture.type=i,this.renderTargetNear.texture.type=i,this.renderTargetFar.texture.type=i,this.renderTargetMasked.texture.type=i,e.outputEncoding===Vt&&(this.renderTarget.texture.encoding=Vt,this.renderTargetNear.texture.encoding=Vt,this.renderTargetFar.texture.encoding=Vt,this.renderTargetMasked.texture.encoding=Vt))}};new I;new Je;var XNe="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",YNe=class extends nc{constructor({blendFunction:e=hi.NORMAL,hue:t=0,saturation:i=0}={}){super("HueSaturationEffect",XNe,{blendFunction:e,uniforms:new Map([["hue",new Ye(new I)],["saturation",new Ye(i)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),i=Math.cos(e);this.uniforms.get("hue").value.set((2*i+1)/3,(-Math.sqrt(3)*t-i+1)/3,(Math.sqrt(3)*t-i+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new Pt;var qNe=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,QNe=class extends nc{constructor({blendFunction:e=hi.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",qNe,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},JNe="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",KNe=class extends nc{constructor(e=30){super("PixelationEffect",JNe,{uniforms:new Map([["active",new Ye(!1)],["d",new Ye(new ge)]])}),this.resolution=new ge,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new I;new I;var Bj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",Lj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",ZNe="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",$Ne="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",qd={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},wZ=class extends nc{constructor({preset:e=qd.MEDIUM,edgeDetectionMode:t=mE.COLOR,predicationMode:i=qFe.DISABLED}={}){super("SMAAEffect",ZNe,{vertexShader:$Ne,blendFunction:hi.NORMAL,attributes:Wl.CONVOLUTION|Wl.DEPTH,uniforms:new Map([["weightMap",new Ye(null)]])});let n,r;arguments.length>1&&(n=arguments[0],r=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new Pi(1,1,{minFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new _F(!0,!1,!1),this.clearPass.overrideClearColor=new Pt(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Oc(new QFe),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=i,this.weightsPass=new Oc(new rNe);let s=new Nq;s.onLoad=()=>{let o=new tr(n);o.name="SMAA.Search",o.magFilter=Ri,o.minFilter=Ri,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!0,this.weightsMaterial.searchTexture=o;let a=new tr(r);a.name="SMAA.Area",a.magFilter=Zt,a.minFilter=Zt,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!1,this.weightsMaterial.areaTexture=a,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),n!==void 0&&r!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(n=new Image,r=new Image,n.addEventListener("load",()=>s.itemEnd("search")),r.addEventListener("load",()=>s.itemEnd("area")),n.src=Bj,r.src=Lj),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,i=this.weightsMaterial;switch(e){case qd.LOW:t.edgeDetectionThreshold=.15,i.orthogonalSearchSteps=4,i.diagonalDetection=!1,i.cornerDetection=!1;break;case qd.MEDIUM:t.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=8,i.diagonalDetection=!1,i.cornerDetection=!1;break;case qd.HIGH:t.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=16,i.diagonalSearchSteps=8,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break;case qd.ULTRA:t.edgeDetectionThreshold=.05,i.orthogonalSearchSteps=32,i.diagonalSearchSteps=16,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break}}setDepthTexture(e,t=du){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,i){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return Bj}static get areaImageDataURL(){return Lj}},eze=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,kb={DEFAULT:0,ESKIL:1},tze=class extends nc{constructor({blendFunction:e=hi.NORMAL,technique:t=kb.DEFAULT,eskil:i=!1,offset:n=.5,darkness:r=.5}={}){super("VignetteEffect",eze,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new Ye(n)],["darkness",new Ye(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===kb.ESKIL}set eskil(e){this.technique=e?kb.ESKIL:kb.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},pu=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(i){this.effect.blendMode.opacity.value=i},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(i){this.effect.blendMode.setBlendFunction(Number(i))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=hi.NORMAL}},ize=class extends pu{constructor(){super(FNe),this.blendFunction=hi.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},nze=class extends pu{constructor(){super(zNe)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},rze=class extends pu{constructor(){super(VNe),this.effect.offset=new ge(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},sze=class extends pu{constructor(){super(UNe)}},oze=class extends pu{constructor(){super(YNe),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},aze=class extends pu{constructor(){super(QNe),this.blendFunction=hi.OVERLAY}},lze=class extends pu{constructor(){super(tze)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},cze=class extends pu{constructor(e){super(WNe,e)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=e}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}},uze=class extends pu{constructor(){super(KNe)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},hze=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,dze=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;vec4 sampleTextureCatmullRom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 getDilatedVelocity(){float closestDepth=100.0;vec2 closestUVOffset=vec2(0.0);for(int i=0;i<9;i++){float neighborDepth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighborDepth<closestDepth){closestUVOffset=vTexCoords[i];closestDepth=neighborDepth;}}return texture2D(velocityBuffer,closestUVOffset).rgb;}vec4 clipAabb(vec3 aabbMin,vec3 aabbMax,vec4 p,vec4 q){vec3 pClip=0.5*(aabbMax+aabbMin);vec3 eClip=0.5*(aabbMax-aabbMin)+0.00000001;vec4 vClip=q-vec4(pClip,p.w);vec3 vUnit=vClip.xyz/eClip;vec3 aUnit=abs(vUnit);float maUnit=max(aUnit.x,max(aUnit.y,aUnit.z));if(maUnit>1.0){return vec4(pClip,p.w)+vClip/maUnit;}else{return q;}}void main(){vec3 dilatedVelocity=getDilatedVelocity();vec2 velocity=dilatedVelocity.rg*(dilatedVelocity.b);vec2 previousPixelPos=vUv-velocity;vec4 currentColor=texture2D(inputBuffer,vUv);vec4 previousColor=sampleTextureCatmullRom(historyBuffer,previousPixelPos,resolution);vec4 ctl=texture2D(inputBuffer,vTexCoords[0]);vec4 ctc=texture2D(inputBuffer,vTexCoords[1]);vec4 ctr=texture2D(inputBuffer,vTexCoords[2]);vec4 cml=texture2D(inputBuffer,vTexCoords[3]);vec4 cmc=texture2D(inputBuffer,vTexCoords[4]);vec4 cmr=texture2D(inputBuffer,vTexCoords[5]);vec4 cbl=texture2D(inputBuffer,vTexCoords[6]);vec4 cbc=texture2D(inputBuffer,vTexCoords[7]);vec4 cbr=texture2D(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);vec4 previousColorClipped=clipAabb(cmin.xyz,cmax.xyz,clamp(cavg,cmin,cmax),previousColor);vec4 result=currentColor*0.1+previousColorClipped*0.9;gl_FragColor=result;}`,fze=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,pze=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,_L=class extends ji{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new Ye(null)},blending:Hn,depthWrite:!1,depthTest:!1,vertexShader:fze,fragmentShader:pze})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},mze=class extends bs{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new _L,this.resolutionVector=new ge,this.resolveMaterial=new ji({name:"TAAResolveMaterial",uniforms:{inputBuffer:new Ye(null),historyBuffer:new Ye(null),velocityBuffer:new Ye(null),depthBuffer:new Ye(null),resolution:new Ye(new ge)},blending:Hn,depthWrite:!1,depthTest:!1,vertexShader:hze,fragmentShader:dze}),this.historyRenderTarget=new Pi(1024,1024,{minFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Pi(1024,1024,{minFilter:Ri,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let i=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(i),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},gze=class extends bs{constructor(e,t,i){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new Pj(e,t,{renderTarget:i.transmissionDepthTarget}),this.passThroughMaterial=new _L,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new _L,this.depthPass=new Pj(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,i){let n=this.camera.layers.mask,r=e;r.setRenderTarget(r.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],r.clear(),r.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,i),r.shadowMap.needsUpdate=!1,r.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(s),e.render(this.splineScene,this.camera),this.camera.layers.mask=n}},Rj=new bf,vze=new ji({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),bL=class extends bs{constructor(e,t,i){super("OpaquePass",t??Rj,i),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=e??Rj}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(n=>{n.layers.isEnabled(3)&&n instanceof Ys&&(this.originalMaterials.set(n.id,n.material),n.material=vze)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let i=this.renderToScreen?null:t;e.setRenderTarget(i),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((n,r)=>{let s=this.scene.getObjectById(r);s&&(s.material=n)})}},yze=class{constructor(e,{depthBuffer:t=!0,stencilBuffer:i=!1,multisampling:n=0,frameBufferType:r=0}={}){this.renderer=e,this.helperStartIndex=0,this.copyPass=new wL,this.depthTexture=null,this.timer=new INe,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,i,r,n,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,i,r,n,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,i,r,n,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,i=this.multisampling;i>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):i!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){var t;if(this.renderer=e,e!==null){let i=e.getSize(new ge),n=((t=e.getContext().getContextAttributes())==null?void 0:t.alpha)??!1,r=this.inputBuffer.texture[0].type;r===Kr&&e.outputEncoding===Vt&&(this.inputBuffer.texture[0].encoding=Vt,this.outputBuffer.texture[0].encoding=Vt,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(i.width,i.height,!1);for(let s of this.passes)s.initialize(e,n,r)}}replaceRenderer(e,t=!0){let i=this.renderer,n=i.domElement.parentNode;return this.setRenderer(e),t&&n!==null&&(n.removeChild(i.domElement),n.appendChild(e.domElement)),i}createDepthTexture(){let e=this.depthTexture=new Ng(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=zf,e.type=xf):e.type=ch,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,i,n,r,s){let o=this.renderer,a=o===null?new ge:o.getDrawingBufferSize(new ge),l={minFilter:Zt,magFilter:Zt,wrapS:Pn,wrapT:Pn,stencilBuffer:t,depthBuffer:e},c;return n>0?(c=new Pi(a.width,a.height,l),c.samples=n):(r?(c=new u0e(a.width,a.height,2,l),c.texture[1].type=Og):c=new Pi(a.width,a.height,l),c.depthTexture=new Ng(2048,2048),c.depthTexture.type=$o),i===Kr&&o!==null&&o.outputEncoding===Vt&&(Array.isArray(c.texture)?c.texture.forEach(h=>h.encoding=Vt):c.texture.encoding=Vt),Array.isArray(c.texture)?c.texture.forEach((h,u)=>{h.name=`EffectComposer.Buffer ${r} ${u}`,h.generateMipmaps=!1}):(c.texture.name=`EffectComposer.Buffer ${r}`,c.texture.generateMipmaps=!1),c.name=s,c}addPass(e,t){var a;let i=this.passes,n=this.renderer,r=n.getDrawingBufferSize(new ge),s=((a=n.getContext().getContextAttributes())==null?void 0:a.alpha)??!1,o;if(e.MRTCompatible&&(o=this.inputBuffer.texture[0].type),e.MRTCompatible||(o=this.inputBuffer.texture.type),e.setRenderer(n),e.setSize(r.width,r.height),e.initialize(n,s,o),this.autoRenderToScreen&&(i.length>0&&(i[i.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?i.splice(t,0,e):i.push(e),this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(e of i)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,i=t.indexOf(e);if(i!==-1&&t.splice(i,1).length>0){if(this.depthTexture!==null){let n=(r,s)=>r||s.needsDepthTexture;t.reduce(n,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&i===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,i=this.copyPass,n=this.inputBuffer,r=this.outputBuffer,s=this.inputBufferSingle,o=this.outputBufferSingle,a=!1,l,c,h,u;e===void 0&&(e=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(t,n,r,e,a):d.render(t,s,o,e,a),d.needsSwap&&(a&&(i.renderToScreen=d.renderToScreen,l=t.getContext(),c=t.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),i.render(t,n,r,e,a),c.setFunc(l.EQUAL,1,4294967295)),h=n,u=s,n=r,s=o,r=h,o=u),d instanceof LNe?a=!0:d instanceof aNe&&(a=!1))}setSize(e,t,i){let n=this.renderer;if(this._width=e,this._height=t,e===void 0||t===void 0){let s=n.getSize(new ge);e=s.width,t=s.height}n.setSize(e,t,i);let r=n.getDrawingBufferSize(new ge);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height),this.inputBufferSingle.setSize(r.width,r.height),this.outputBufferSingle.setSize(r.width,r.height);for(let s of this.passes)s.setSize(r.width,r.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},xze=new ji({name:"CombineMaterial",uniforms:{inputBufferA:new Ye(null),inputBufferB:new Ye(null)},blending:Hn,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),wze=class extends bs{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=xze,this.helperPass=new bL(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new bL(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new wZ({preset:qd.LOW,edgeDetectionMode:mE.COLOR});this.effectPass=new tM(this.camera,t),this.rt=new Pi(10,10,{minFilter:Zt,magFilter:Zt,wrapS:Pn,wrapT:Pn,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,i){super.initialize(e,t,i),this.effectPass.initialize(e,t,i)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,i){this.rt.depthTexture=t.depthTexture;let n=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,i),this.fullscreenMaterial.uniforms.inputBufferA.value=i.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(n),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},_ze=`#define GLSLIFY 1
out vec3 n;void main(){vec4 view_space=viewMatrix*modelMatrix*vec4(position,1.0);gl_Position=projectionMatrix*view_space;n=mat3(viewMatrix*modelMatrix)*normal;n=normalize(n);}`,bze=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,Aze=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,Sze=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,Mze=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,Eze=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,U0=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],Cze=new ji({vertexShader:_ze,fragmentShader:bze}),Ub=new ji({vertexShader:Mze,fragmentShader:Eze,uniforms:{texture_ao_lrez:new Ye(null),texture_depth_lrez:new Ye(null),texture_depth_hrez:new Ye(null),near:new Ye(null),far:new Ye(null)}}),Tze=class extends bs{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let i=1024,n=1024;this.gBuffer=new Pi(i,n,{type:$o,depthTexture:new Ng(i,n),minFilter:Zt,magFilter:Zt}),this.depthBufferHighRes=new Pi(i,n,{depthTexture:new Ng(i,n)}),this.aoBuffer=new Pi(i,n,{minFilter:Zt,magFilter:Zt}),this.splineScene=e,this.splineCamera=t;let r=new Float32Array(U0.length*2);for(let o=0;o<U0.length;o++){let a=o*2;r[a+0]=U0[o][0],r[a+1]=U0[o][1]}this.blueNoiseInDiskTexture=new oB(r,U0.length,1,cq,$o),this.blueNoiseInDiskTexture.wrapS=Wc,this.blueNoiseInDiskTexture.wrapT=Wc,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new ji({vertexShader:Aze,fragmentShader:Sze,uniforms:{near:new Ye(null),far:new Ye(null),fov:new Ye(null),proj_info:new Ye(new Kt),is_ortho:new Ye(!1),resolution:new Ye(new ge),radius_of_influence:new Ye(8),radius_in_screen_space:new Ye(1),exponent:new Ye(1),ao_color:new Ye(new I),bias:new Ye(.5),texture_depth:new Ye(null),texture_normals:new Ye(null),texture_blue_noise:new Ye(null),texture_blue_noise_in_disk:new Ye(this.blueNoiseInDiskTexture),frame_index:new Ye(0),fog_enabled:new Ye(!1),fog_near:new Ye(1),fog_far:new Ye(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Pi(i,n,{minFilter:Zt,magFilter:Zt,wrapS:Pn,wrapT:Pn,depthBuffer:!1,type:$o});let s=new wZ({preset:qd.ULTRA,edgeDetectionMode:mE.COLOR});this.effectPass=new tM(this.camera,s)}initialize(e,t,i){super.initialize(e,t,i),this.effectPass.initialize(e,t,i)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let i=this._runHalfRes?.5:1,n=e*i,r=t*i;this.gBuffer.setSize(n,r),this.aoBuffer.setSize(n,r),this.hbaoMaterial.uniforms.resolution.value.set(n,r),this.aaBuffer.setSize(n,r),this.effectPass.setSize(n,r)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}render(e,t,i){this.splineScene.overrideMaterial=Cze;let n=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=n,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let r=this.splineCamera.perspCamera.projectionMatrix.elements,s=2/r[0],o=2/r[5],a=-(1-r[8])/r[0],l=-(1+r[9])/r[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,o,a,l);let c=this.splineCamera.perspCamera.fov*(Math.PI/180),h=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(c*.5)*2),u=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*h;this.hbaoMaterial.uniforms.radius_in_screen_space.value=u,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let r=this.splineCamera.orthoCamera.projectionMatrix.elements,s=2/r[0],o=2/r[5],a=-(1+r[12])/r[0],l=-(1-r[13])/r[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,o,a,l);let c=.5*(this.hbaoMaterial.uniforms.resolution.value.y/o),h=this.hbaoMaterial.uniforms.radius_of_influence.value*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=h,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=Ub,Ub.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,Ub.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,Ub.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},Pze=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Dze=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,Bze=class extends Oc{constructor(){super(new ji({vertexShader:Pze,fragmentShader:Dze,uniforms:{tInput:new Ye(null),tMap:new Ye(null),uResolution:new Ye(new ge),uSize:new Ye(new ge),uCoords:new Ye(new ge),uScale:new Ye(1),uSceneColor:new Ye(new Pt(16711680)),uDPR:new Ye(1),uCurrent:new Ye(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}};function Ij(e,t){return t&&t.enabled&&e.push(t.effect),e}var Lze=e=>Object.values(hi).includes(e)?e:hi.NORMAL,Rze=class extends _s{constructor(e){super(),this.postprocessingState=Px.defaultData,this._scene=new bf,this._camera=new gs,this.effects=new Map,this.blueNoiseTexture=new oB,this._renderToScreen=!0,this.clock=new X_e,this.renderer=e,this.debug=!1,this.effects.set("bloom",new ize),this.effects.set("chromaticAberration",new rze),this.effects.set("vignette",new lze),this.effects.set("noise",new aze),this.effects.set("colorAverage",new sze),this.effects.set("hueSaturation",new oze),this.effects.set("brightnessContrast",new nze),this.effects.set("depthOfField",new cze),this.effects.set("pixelation",new uze),this.effectComposer=new yze(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new bL(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new gze(this.scene,this.camera,this.renderer),this.aoPass=new Tze(this.scene,this.camera),this.taaPass=new mze,this.taaPass.renderToScreen=!1,this.helperPass=new wze(this.camera),this.helperPass.renderToScreen=!1,this.overlayPass=new Bze,this.overlayPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){e!==void 0?(this.overlayPass.texture=e,this.overlayPass.enabled=!0):this.overlayPass.enabled=!1}get overlayTexture(){return this.overlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),this.aoPass.setCamera(e),this.helperPass.setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let i=this.effectComposer.passes[t];if(i.enabled===!0&&!e&&this._renderToScreen){i.renderToScreen=!0,e=!0;continue}i.renderToScreen=!1}}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new oB(e,128,128),this.blueNoiseTexture.wrapS=Wc,this.blueNoiseTexture.wrapT=Wc,this.blueNoiseTexture.minFilter=Ri,this.blueNoiseTexture.magFilter=Ri,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,i,n,r,s,o,a){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=i,this.aoPass.aoColor=n,this.aoPass.fogEnabled=r,this.aoPass.fogNear=s,this.aoPass.fogFar=o,this.aoPass.runHalfRes!==!a&&(this.aoPass.runHalfRes=!a)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t;if((e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let i=[this.effects.get("pixelation")].reduce(Ij,[]);i.length>0&&(this.uvEffectPass=new tM(this.camera,...i),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let n=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(Ij,[]);n.length>0&&(this.effectPass=new tM(this.camera,...n),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass))}this.effectComposer.addPass(this.overlayPass),this.effectComposer.addPass(this.helperPass)}_initCopyPass(){if(this._savePass)return;let e=new ge;this.renderer.getDrawingBufferSize(e),this._rt=new Pi(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Wc,wrapT:Wc}),this._rt.samples=0,this._savePass=new wL(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new wL(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(e===!0?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...i}=e,n=!1;t!==this.postprocessingState.enabled&&(n=!0);for(let r of Object.entries(i)){let s=r[1],o=this.effects.get(r[0]);if(o){o.enabled!==s.enabled&&(n=!0),o.enabled=s.enabled;for(let[a,l]of Object.entries(s))a==="blendFunction"?o.blendFunction=Lze(l):o[a]=l}}this.postprocessingState=e,n&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,i,n){e instanceof Kt?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,i,n),this.effectComposer.outputBuffer.scissor.set(e,t,i,n));let r=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(r),this.effectComposer.outputBuffer.scissor.multiplyScalar(r),this.renderer.setScissor(e,t,i,n)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,i,n){e instanceof Kt?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,i,n),this.effectComposer.outputBuffer.viewport.set(e,t,i,n))}resize(e,t,i){if(this.effectComposer.setSize(e,t,i),this._rt){let n=this.renderer.getPixelRatio();this._rt.setSize(e*n,t*n)}}dispose(){var e,t;(e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.dispose()}},Oj=new tr,Ize=class extends Sq{constructor(e){super(e),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new ge,this.pipeline=new Rze(this),this.isXRCopyPassSet=!1,this.clear=(r=!0,s=!0,o=!0)=>{let a=this.getContext(),l=0;r&&(l|=a.COLOR_BUFFER_BIT),s&&(l|=a.DEPTH_BUFFER_BIT),o&&(l|=a.STENCIL_BUFFER_BIT),a.clear(l),a.clearBufferfv(a.COLOR,1,[0,0,0,1])},this.overrideTransmission=e==null?void 0:e.overrideTransmission,this.autoClear=!1;let t=this.setPixelRatio.bind(this),i=this.setSize.bind(this),n=this.getContext();if(n&&"drawingBufferColorSpace"in n)try{n.drawingBufferColorSpace="display-p3"}catch(r){console.warn(r)}this.setPixelRatio=r=>{this._pixelRatio=r,t(r)},this.setSize=(r,s,o=!0)=>{var a,l;(this.viewportWidth!==r||this.viewportHeight!==s)&&(this.viewportWidth=r,this.viewportHeight=s,i(r,s,o),(a=this.normalRenderTarget)==null||a.setSize(r*this._pixelRatio,s*this._pixelRatio),this._resizeTransmission(r,s),(l=this.transmissionDepthTarget)==null||l.setSize(r*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(r,s,o))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new Pi(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Zt,magFilter:Zt,wrapS:Pn,wrapT:Pn,depthBuffer:!1}))}_resizeTransmission(e,t){var i,n;(i=this.transmissionRenderTarget)==null||i.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),(n=this.aoRenderTarget)==null||n.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return Tt.transmissionLod.value===1}set hdTransmission(e){Tt.transmissionLod.value=e===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new Pi(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:Ig,magFilter:Zt,wrapS:Pn,wrapT:Pn,depthBuffer:!1}),this.transmissionDepthTarget=new Pi(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:Ri,magFilter:Ri,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new Pi(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Ri,magFilter:Ri,type:$o,depthTexture:new Ng(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t){this.normalRenderTarget&&(this.setClearColor(0),t.layers.enable(8),t.layers.disable(0),t.layers.disable(3),e.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),t instanceof gs?AP.uniforms.depthContrast.value=(t.far-t.near)/1e4:AP.uniforms.depthContrast.value=1,e.overrideMaterial=AP,this.render(e,t),this.setClearColor(e.bgColor,e.bgColor.a),this.setRenderTarget(null),e.overrideMaterial=e.wireframeState?aL:null,t.layers.enable(0),t.layers.enable(3),e.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!0)}))}renderSplineScene(e,t,i,n,r){this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(e.bgColor,e.bgColor.a),i.penumbraSize.forEach((o,a)=>{Tt.penumbraSize.value[a]=o}),Tt.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?Tt.resolution.value.set(this.resolution.x,this.resolution.y):Tt.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),this.overrideNormal!==void 0?(Tt.normalRenderTarget.value=this.overrideNormal,Tt.normalRenderTargetDepth.value=Oj):e.needsNormal()&&(this.createNormalRenderTarget(),Tt.normalRenderTarget.value=this.normalRenderTarget.texture,Tt.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(e,t)),e.occlusion&&(this.createAORenderTarget(),Tt.aoRenderTarget.value=this.aoRenderTarget.texture),Tt.aoEnabled.value=e.occlusion,this.pipeline.setAmbientOcclusionParams(e.occlusion,e.radius,e.bias,e.aoColor,e.enableFog,e.backupFog.near,e.backupFog.far,e.aoFullRes),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture);let s=!1;if(this.overrideTransmission!==void 0)Tt.transmissionRenderTarget.value=this.overrideTransmission,Tt.transmissionRenderTargetDepth.value=Oj,this.pipeline.setTransmissionPassEnabled(!1);else{let o=e.needsTransmission();o&&(this.transmissionRenderTarget===void 0&&(s=!0),this.createTransmissionRenderTarget(),Tt.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,Tt.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(o)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=n,this.pipeline.sceneHelpersOnTop=r,this.pipeline.scene=e,this.pipeline.camera=t,s&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==e.postprocessing&&(this.pipeline.updatePostprocessing(e.postprocessing),!n&&!r&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),e.overrideMaterial=e.wireframeState?aL:null,this.pipeline.render(),Tt.frameIndex.value=(Tt.frameIndex.value+1)%16,t instanceof gs&&t.copyHistory()}_currentDispose(){var e,t,i,n,r,s;this._superDispose(),this.pipeline.dispose(),(e=this.aoRenderTarget)==null||e.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(i=this.transmissionDepthTarget)==null||i.dispose(),(n=this.normalRenderTarget)==null||n.dispose(),(s=(r=this.normalRenderTarget)==null?void 0:r.depthTexture)==null||s.dispose()}},Oze=class{get sharedAssets(){return this.shared}constructor(e,t={}){this.shared=new eF(e.shared,t),this.scene=new sa(e.scene,this.sharedAssets),this.scene.switchActiveCamera(this.scene.activeCamera)}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof da&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},Fze=class{constructor({x:e=10,y:t=10}){this._startTime=0;let i=document.getElementById("spe-perfs");i?this.element=i:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function Nze(e){let t;if(e.index)for(let i=0;i<e.index.array.length;i+=3)t=e.index.array[i],e.index.array[i]=e.index.array[i+2],e.index.array[i+2]=t}function Fy(e){return e instanceof Ix?"SubdivObject":e.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function zze(e,t){let i={};return e.traverseEntity(n=>{var l;if(!n.visible||!(n instanceof Ys)||n.type!=="Mesh"||Array.isArray(n.material)||n.states&&Object.keys(n.states).length)return;let r=n.parent;for(;r;){if(r instanceof Ys&&n.states&&Object.keys(n.states).length)return;r=r.parent}let s=n.material.uuid,o=t.shared.materials[s];if(o){if(!yo.isMergable(o))return}else{let c=(l=t.scene.objects.get(n.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!yo.isMergable(c.material))return;s=yo.getHash(c.material)}}i[s]||(i[s]={});let a=i[s][Fy(n)];if(a){if(a.push(n),n.cloner)for(let c of n.cloner.children)a.push(c)}else if(i[s][Fy(n)]=[n],n.cloner)for(let c of n.cloner.children)i[s][Fy(n)].push(c)}),i}function kze(e){let t=0;return Object.values(e).forEach(i=>{Object.values(i).forEach(n=>{let r=n.length;r>t&&(t=r)})}),t}function Uze(e,t){let i=zze(t,e),n=kze(i),r=new Array(n),s=0,o=new Array(n),a=0,l=new Array(n),c=0,h=new Array(n),u=0;for(let[d,f]of Object.entries(i))for(let p of Object.values(f)){if(a=0,c=0,p.forEach(m=>{m instanceof Ys&&(o[a++]=m.geometry.clone(),l[c++]=m)}),c<2)continue;for(let m=0;m<c;m++)l[m].updateWorldMatrix(!0,!1),o[m].applyMatrix4(l[m].matrixWorld),l[m].matrixWorld.determinant()<0&&Nze(o[m]);let g=af(o.slice(0,a),!1);if(g){let m;switch(d){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),m=new Ns(g,l[0].material);break}default:{m=new Ns(g,l[0].material);break}}m.castShadow=l[0].castShadow,m.receiveShadow=l[0].receiveShadow,t.add(m);let v=x=>{u=0;for(let w of x)w.children&&v(w.children),w instanceof Ys&&(Array.isArray(w.material)||i[w.material.uuid]&&i[w.material.uuid][Fy(w)]&&i[w.material.uuid][Fy(w)].length>1||(h[u++]=w));for(let w=0;w<u;w++)t.attach(h[w])};for(let x=0;x<c;x++){let w=l[x];v(w.children),r[s++]=w}}}for(let d=0;d<s;d++)r[d].removeFromParent()}var Gze=x1(eve(),1),Hze=new ge;function Vze(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)}var jze=class{constructor(e,{renderOnDemand:t,renderMode:i="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this._lastTime=performance.now(),this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=n=>{var r,s,o,a;if(this.time=n,this.dt=this.time-this._lastTime,this._lastTime=this.time,(r=this._perfs)==null||r.start(),!this._renderer){(s=this._perfs)==null||s.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(o=this._perfs)==null||o.end();return}this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&(this._eventManager.handlers.Start.hasVideoAction||this._eventManager.handlers.Basic.hasVideoAction||this._eventManager.handlers.Conditional.hasVideoAction)&&(this._skipRender=!1),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),this._eventManager&&(this._eventManager.isEnable||this._eventManager.activate(),this._eventManager.handlers.Follow.onAnimationFrameDamping(),this._eventManager.handlers.LookAt.onAnimationFrameDamping(),this._eventManager.handlers.DragDrop.onAnimationFrameDamping()),this._scene&&this._camera&&(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.renderSplineScene(this._scene,this._camera,this._sharedAssetsManager)),this.canvas.dispatchEvent(this._renderedEvent),(a=this._perfs)==null||a.end()},this._resize=()=>{var n;!this._renderer||(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=Hze.set(this._viewportWidth,this._viewportHeight)),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._camera&&((n=this._frameView)==null||n.updateCamera(),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()),this._requestRenderAutoMode())},this._debouncedResize=DO(this._resize,10),this.canvas=e,this.renderMode=t?"auto":i,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new Fze({x:10,y:10})),APe(e)}async load(e,t){Vze(e),this.disposed=!1;let i=await(await fetch(e,t)).arrayBuffer();await this.start(i)}async start(e,{interactive:t=!0}={}){var s,o,a;if(this.disposed)return;let i=await OFe(e);this._data=i,i.version&&(0,Gze.default)(i.version,"0.9.366")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([P6(i)&&IBe(),KLe(i)&&BBe(),i.scene.environment.usePhysics&&TPe(),M6(i)&&kLe(),uFe(i)&&EPe()].filter(Boolean)),(s=this._eventManager)==null||s.deactivate(),(o=this._controls)==null||o.deactivate(),(a=this._scene)==null||a.dispose();let n=new Oze(i);if(this._scene=n.scene,this._sharedAssetsManager=n.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let l=performance.now();Uze(i,n.scene);let c=performance.now();console.log("Merged geometries in ",c-l," ms")}P6(i)&&this._scene.traverse(l=>{Yc(l)&&l.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var l;this._requestRenderAutoMode(),(l=this._scene)==null||l.traverse(c=>{c instanceof Ga&&c.pendingMediaLoad&&c.update()})});let r=Object.keys(i.shared.fonts).map(l=>this._sharedAssetsManager.getFont(l).loadingPromise);if(Promise.all(r).then(()=>{n.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),M6(i)&&dFe(i)&&await Promise.all(r),this._scene.rewriteEventsBeforeGoToPlayMode(),aZ(i.scene,this._scene,this._sharedAssetsManager),this._renderer||(this._renderer=new Ize({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=i.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode),this._renderer.shadowMap.enabled=!0,this._renderer.shadowMap.type=i.scene.environment.ambientLight.softShadows?$I:nq,NRe(i.scene.environment.ambientLight.softShadowQuality)),i.scene.environment.ambientLight.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(i.scene.environment.ambientLight.blueNoiseTextureData),this._frameView)this._frameView.setCamera(this._camera);else{let l=Object.values(i.frames)[0];l.preset==="fullscreen"?(this._viewportMode=1,this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=l.size[0],this._viewportHeight=l.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new NFe(this._renderer,this._camera,new ge(this._viewportWidth,this._viewportHeight),new ge(window.innerWidth,window.innerHeight))}if(t){let l=new rIe(this._renderer,this._scene,this._camera,this._sharedAssetsManager,i.scene.publish.stopRaycast,this._requestRenderAutoMode,!0);this._scene.updateMatrixWorld(!0),this._controls=new fFe(i,l),this._eventManager=new FFe(i.scene.publish,this._controls,l),this._controls.activate(this._eventManager)}this._resize(),this.dt===0&&(this.render(performance.now()),this._renderer.setAnimationLoop(this.render)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300)}findObjectById(e){var i;let t=(i=this._scene)==null?void 0:i.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){var i;let t=(i=this._scene)==null?void 0:i.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){var t;let e=[];return(t=this._scene)==null||t.traverseEntity(i=>{if(i.uuid!==sa.PERSONAL_CAMERA_ID){let n=this._createProxyObject(i);n&&e.push(n)}}),e}getSplineEvents(){var e;return((e=this._eventManager)==null?void 0:e.handlers.Spline).splineEvents}emitEvent(e,t){var i;(i=this.findObjectById(t)||this.findObjectByName(t))==null||i.emitEvent(e)}emitEventReverse(e,t){var i;(i=this.findObjectById(t)||this.findObjectByName(t))==null||i.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,i;((t=this._controls)==null?void 0:t.orbitControls)instanceof gZ&&((i=this._controls)==null||i.orbitControls.zoomOut(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var o;let{r:t,g:i,b:n,a:r}={r:0,g:0,b:0,a:1},s=new Ws(t,i,n,r);try{s.setStyle(e)}catch{console.error("This is not a valid css color",e)}(o=this._scene)==null||o.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){var e,t,i,n,r,s,o;this.disposed=!0,(e=this._eventManager)==null||e.deactivate(),(t=this._scene)==null||t.dispose(),(i=this._sharedAssetsManager)==null||i.dispose(),this._proxyObjectCache.forEach(a=>{nH.unsubscribe(a)}),(n=this._renderer)==null||n.setAnimationLoop(null),(r=this._renderer)==null||r.dispose(),this._renderer=void 0,(s=this._sharedAssetsManager)==null||s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(o=this._controls)==null||o.deactivate(),SPe(this.canvas)}get isStopped(){return this._isPaused}stop(){var e,t,i;this._isPaused||((e=this._renderer)==null||e.setAnimationLoop(null),this._isPaused=!0,(t=this._eventManager)==null||t.pause(),(i=this._controls)!=null&&i.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,i;!this._isPaused||(this._isPaused=!1,(e=this._eventManager)==null||e.resume(),(t=this._controls)!=null&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),(i=this._renderer)==null||i.setAnimationLoop(this.render))}setGlobalEvents(e){var t;(t=this._eventManager)==null||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){if(e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,emitEvent(n){e.dispatchEvent({type:"userEvent",eventName:n})},emitEventReverse(n){e.dispatchEvent({type:"userEvent",eventName:n,reverse:!0})}},i=nH(t,(n,r)=>{var s;typeof e[n]!="object"&&((s=Object.getOwnPropertyDescriptor(e,n))!=null&&s.writable)&&(e[n]=r),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,i),i}},Gb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},AL={},Wze={get exports(){return AL},set exports(e){AL=e}},G0={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fj;function Xze(){if(Fj)return G0;Fj=1;var e=kx,t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var h,u={},d=null,f=null;c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(f=l.ref);for(h in l)n.call(l,h)&&!s.hasOwnProperty(h)&&(u[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)u[h]===void 0&&(u[h]=l[h]);return{$$typeof:t,type:a,key:d,ref:f,props:u,_owner:r.current}}return G0.Fragment=i,G0.jsx=o,G0.jsxs=o,G0}(function(e){e.exports=Xze()})(Wze);const SL=AL.jsx;var Yze="Expected a function",Nj=0/0,qze="[object Symbol]",Qze=/^\s+|\s+$/g,Jze=/^[-+]0x[0-9a-f]+$/i,Kze=/^0b[01]+$/i,Zze=/^0o[0-7]+$/i,$ze=parseInt,eke=typeof Gb=="object"&&Gb&&Gb.Object===Object&&Gb,tke=typeof self=="object"&&self&&self.Object===Object&&self,ike=eke||tke||Function("return this")(),nke=Object.prototype,rke=nke.toString,ske=Math.max,oke=Math.min,HP=function(){return ike.Date.now()};function ake(e,t,i){var n,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;if(typeof e!="function")throw new TypeError(Yze);t=zj(t)||0,ML(i)&&(h=!!i.leading,u="maxWait"in i,s=u?ske(zj(i.maxWait)||0,t):s,d="trailing"in i?!!i.trailing:d);function f(A){var T=n,S=r;return n=r=void 0,c=A,o=e.apply(S,T),o}function p(A){return c=A,a=setTimeout(v,t),h?f(A):o}function g(A){var T=A-l,S=A-c,C=t-T;return u?oke(C,s-S):C}function m(A){var T=A-l,S=A-c;return l===void 0||T>=t||T<0||u&&S>=s}function v(){var A=HP();if(m(A))return x(A);a=setTimeout(v,g(A))}function x(A){return a=void 0,d&&n?f(A):(n=r=void 0,o)}function w(){a!==void 0&&clearTimeout(a),c=0,n=l=r=a=void 0}function b(){return a===void 0?o:x(HP())}function M(){var A=HP(),T=m(A);if(n=arguments,r=this,l=A,T){if(a===void 0)return p(l);if(u)return a=setTimeout(v,t),f(l)}return a===void 0&&(a=setTimeout(v,t)),o}return M.cancel=w,M.flush=b,M}function ML(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function lke(e){return!!e&&typeof e=="object"}function cke(e){return typeof e=="symbol"||lke(e)&&rke.call(e)==qze}function zj(e){if(typeof e=="number")return e;if(cke(e))return Nj;if(ML(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ML(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Qze,"");var i=Kze.test(e);return i||Zze.test(e)?$ze(e.slice(2),i?2:8):Jze.test(e)?Nj:+e}var uke=ake;function hke(e){return t=>{e.forEach(i=>{typeof i=="function"?i(t):i!=null&&(i.current=t)})}}const dke=[],fke={width:"100%",height:"100%"},pke=ae.forwardRef(function({className:e,children:t,debounceTime:i=300,ignoreDimensions:n=dke,parentSizeStyles:r,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:o,...a},l){const c=ae.useRef(null),h=ae.useRef(0),[u,d]=ae.useState({width:0,height:0,top:0,left:0}),f=ae.useMemo(()=>{const p=Array.isArray(n)?n:[n];return uke(g=>{d(m=>Object.keys(m).filter(v=>m[v]!==g[v]).every(v=>p.includes(v))?m:g)},i,{leading:s})},[i,s,n]);return ae.useEffect(()=>{const p=o||window.ResizeObserver,g=new p(m=>{m.forEach(v=>{const{left:x,top:w,width:b,height:M}=(v==null?void 0:v.contentRect)??{};h.current=window.requestAnimationFrame(()=>{f({width:b,height:M,top:w,left:x})})})});return c.current&&g.observe(c.current),()=>{window.cancelAnimationFrame(h.current),g.disconnect(),f.cancel()}},[f,o]),SL("div",{style:{...fke,...r},ref:hke([l,c]),className:e,...a,children:t({...u,ref:c.current,resize:f})})}),mke=ae.forwardRef(({scene:e,style:t,onMouseDown:i,onMouseUp:n,onMouseHover:r,onKeyDown:s,onKeyUp:o,onStart:a,onLookAt:l,onFollow:c,onWheel:h,onLoad:u,renderOnDemand:d=!0,...f},p)=>{const g=ae.useRef(null),[m,v]=ae.useState(!0);return ae.useEffect(()=>{v(!0);let x;const w=[{name:"mouseDown",cb:i},{name:"mouseUp",cb:n},{name:"mouseHover",cb:r},{name:"keyDown",cb:s},{name:"keyUp",cb:o},{name:"start",cb:a},{name:"lookAt",cb:l},{name:"follow",cb:c},{name:"scroll",cb:h}];if(g.current){x=new jze(g.current,{renderOnDemand:d});async function b(){await x.load(e);for(let M of w)M.cb&&x.addEventListener(M.name,M.cb);v(!1),u==null||u(x)}b()}return()=>{for(let b of w)b.cb&&x.removeEventListener(b.name,b.cb);x.dispose()}},[e]),SL(pke,{ref:p,parentSizeStyles:t,debounceTime:50,...f,children:()=>SL("canvas",{ref:g,style:{display:m?"none":"block"}})})}),gke=({isMobile:e})=>Be(mke,{scene:"https://prod.spline.design/g9gyG5ueuDclLgjP/scene.splinecode"}),vke=()=>{const[e,t]=ae.useState(!1);return ae.useEffect(()=>{const i=window.matchMedia("(max-width: 500px)");t(i.matches);const n=r=>{t(r.matches)};return i.addEventListener("change",n),()=>{i.removeEventListener("change",n)}},[]),Be(pg,{children:e?Be(pg,{}):Be(gke,{})})},yke=()=>Et("section",{className:"relative w-full h-screen mx-auto",children:[Et("div",{className:`absolute inset-0 top-[150px] max-w-7xl mx-auto ${er.paddingX} flex flex-row items-start gap-5`,children:[Be(vke,{}),Et("div",{className:"flex flex-col justify-center items-center mt-5",children:[Be("div",{className:"w-5 h-5 rounded-full bg-[#915EFF]"}),Be("div",{className:"w-1 sm:h-80 h-40 violet-gradient"})]}),Et("div",{children:[Be("div",{children:Et("h1",{className:`${er.heroHeadText} text-white`,children:[Be(Hge,{}),"I am ",Be("span",{className:"text-[#915EFF]",children:"Yoni"})]})}),Et("p",{className:`${er.heroSubText} mt-2 text-white-100`,children:["I develop web applications, user ",Be("br",{className:"sm:block hidden"}),"interfaces and WordPress websites"]})]})]}),Be("div",{className:"absolute xs:bottom-10 bottom-32 w-full flex justify-center items-center",children:Be("a",{href:"#about",children:Be("div",{className:"w-[35px] h-[64px] rounded-3xl border-4 border-secondary flex justify-center items-start p-2",children:Be(ds.div,{animate:{y:[0,24,0]},transition:{duration:1.5,repeat:1/0,repeatType:"loop"},className:"w-3 h-3 rounded-full bg-secondary mb-1"})})})})]}),xke="/assets/web-e53e8bec.png",wke="/assets/github-ee2344e6.png",_ke="/assets/menu-8bc4ab63.svg",bke="/assets/close-bd9e206a.svg",Ake="/assets/css-8f30e4d3.png",Ske="/assets/docker-602a695a.png",Mke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAMAAAAJixmgAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB1FBMVEUAAAD3Uh7zUB3zUB70UR30UB71UB70UB7/Xx/zUR3zUR71Th3zUR7zUB32VSLzUB7zUB30UR7zUR33Tx/0UB7zUB70UB70UR7zUh/zUR3zUR3zUB31UB70UB70UR70Tx7zUB7zUR3zUB3zUB70UB30UB3zUB30UB30UR70UR70UR7/AAD/fwD1ThvzUB7zUB30Tx3/TBn0UR70UR30UB31VRzzUB70Uh70UR7zUB3zUR7/VQDzUR3zUR7wSx70UB7yUR7yTx3yUB/zUR3zTSH1URzzUB3zUR70UR71UR/1UB30UB31UB3zUB30UB71Tx3yVRjwTRz0URzzUB3/VSrrTif0Uh/0UB32TxrsSCT2UB/zUR3zUB7zTx7zUB7zUB3zUh/zUR7zTx/0UB3yUh70UR30UR70UB3xTx70UR3zUB7zUBz1UR/0UB30UR70UB7yTh7zUB31UBz1Ux30UR70UR30Tx/0UR70USDzUxv0UR7yUh/xTiDxUBrzUR7xUhvzUB72UiD3TR7/PwDzUB3zUR3zUR30UB3/RRf0UR70UR3zUR7yUhzwVRz0UR70UR3zUR3zUR7wUB3zUB30VR/yTBn0UB3pVRXyTx7xUBr0UR7////mY6gFAAAAmnRSTlMAInK41vMzuwic/hrIzh7d4cDfIH+IdXRzcXBvZmVkY/2A5reUkbXp0pAyAQI3hedgCnfvXxvKXalW+wO2VRHaVD1S+Bc1+rDbUWiST/lMTRUkSPcGDUpGHQ45RfZDsYtB9UB7O/EZpTry/Fk4eO7BKqI2NKrVMOwvLusoJyblJeQfIQTN3orXC0uTQj4S3LzPoCPgGBTEDFMTww/LsAAAAAFiS0dEm+/YV4QAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfnAwQKADldxWHDAAAGjElEQVR42u3d6X8TRRgH8E3SJM0WCjZGUUQDPRAK1IoitEULWK1HRVAExLOKWq33bb2wFvCoFmpFn7/WF1WbNruTOZ7JzDP7/F7xgkzn+3kmye7sk90o4nA4HA6Hw+FwOBwOh8PhcDgcDocTVHL5Qkex2FHI5zLBLZXh/5RLwXM7KzE0JK50hu3t2gQbsrk7ZG/3FmjK1ly2vCGLk73hitO8oYrTvWGKRd4QxWJveOJW3tDErb1hiWW8IYnlvOGIZb2hiOW9YYhVvCGI1bz0xape6mJ1L3HxTaCRnmq2Kky7xixmMYtZTCE317IlvgUgU+JbATIl3rY63cyI8/9NNyPi29ammwnx7Y3TzYB4+/rpBi++I4ZMiXfETdMNWnxnnDDdgMV31ROnG6x4R5wy3Z2N/6vaAwC7evtqtf6B3aR3fVLq2yy+e8/ewdV/7tt/YIis+J66YLq11JcN33uQ5qq+ry6cbro4uv8QRfED9RbT3Zn+2uHD9Fb1kZGW0xXUeHSMWo2PjkhMVyB+8CFa4vERqekKxMdIfR8fGZGc7vH0MXoJfTuNy3pPPJw+yASdI5Djj8jO9VHRMJNUjjIfk/bC46JxniBylPnklPwZwH7RQE/RuJp6UsELT4tGOkXi+vHpZ1TO8Z4VDXWGwtnicyeUTmqHRWONEugROKtUX4BzosHO+78joOqF50Wj5bzvA7nwguo+TV748ed758uLyl54STTey573+rzyqvpO3JTg0HJwErwWT2t4AV4TfMH53c/1elFnfnDxjdQR/d69PabnBXgzfcxqj781fmsGdLM9IlhjAy+8/Q69Gs9eBIPE7w4SE+99D8zy/gekVvXEQTDN1Icf0anxx+ZeAIC1AT/5tOqz+LPPARm8cUX6taqxvOvAHou/wPKuB3sr/vIrsAP2VDw3BLbAXooxvU1gD8Vf7wKbYO/EuN4EsGfib74F22CvxN8hexPBHonRvcngDUeI7vq5Tn0P7QFvFDvq57rUA+0Ci1Zk2/q5bHhTwcLZtqef64et0E6wcEW2o5+ry0Z9RWDhbOfLkuIuXW/nJmg3WLgiZfu5fhzWBFeg/WBhjacl/0BF84S/7gIsrLFkP1esd/fIMjgBw2nBJqLkXyjreHPgBjw5KJjUguSf0Plu2uYIfFk0qX6Mq+8pKTgCnxRNSrafq6ABvuIILFyNsv1cVzTAM47AZ0STku3nmiEEHsXo55ohtKSvYlS4g9CHFsp7WOdDK+8I/BPGp7TO11LVEbhfNKmfLR54uDq0XIjMj7S0Di2jUuzmWHrC+Fha8+TBzekhQK/x2ZLm6aGTDQAAgF/SJvSr5Q0AB1s8q+dLi8nTWfzN8haP7gUAUzD8Pp94lCX3G0WzbctqjwswHB7W3rU03Yq3UePWYFi6pLkvbX55yYJYAgzF2vnGWVyVvPKAcTkNf1XLgAGGDszu+/fa0qzstSWcli10sRwYAHaP9dVqfWPSVw+xWtSwV7U0WDF4LQDIYktgzCYPXLEdMG4bD6rYChi7UQtTbAOM34qHKLYAttFsiSfGB9tpp0UTo4NtNUxjibHB9n72gCRGBtv8mQfGUWZ9YG28AYRr7nZ/yGMsjq9dbxzv+rXYa6+xeHm6qW9j2Wuv4fv40B/NA6786en7F6HGSzeSBryx5HF9jcRDKTd6ODfktVd/VY+nDXjU3/VsUuMy8mWsdt4EQKvGF9LHO+t1fTVrLOq/0rjLQ7tv5KFe4z0Y/VeO6qsl/ks02rj3XvVVPScabM7v9axV479FY614X1/1Gs+Lhpr3v77KNUbpv3JZX9Uao/RfgevbHiqIUfqv3N/KU35Vo/RfeXB7WmnxsmiUBTJehVVt3n/lyU21ZWss6L8q0Kmviti0/8qfW4hLihdWkl++OEnMKy122H/l6JPLYf+Voxo77L9yJHbYf+Xq+9hd/5W742pX/VdeXYUhtp5tin1+aJoNsd+PxcMX+/7gQ2yx/4+2xBVTeHgpppjG42nxxFQeQIwlpvOIaRwxpYeIY4hpPSbeXEzLay6m5jUV0/OaiSl6TcQ0vfpiqt5QHwyPLabs1RHT9qqLqXtVxfS9auIQvCriMLzy4lC8suJwvHLikLwy4rC8rcWheVuJw/OKxSF6ReIwveniUL1p4nC9yeKQvVHU1XTXuc3dUdDprMSN3LjSGYWeUsMPDculKAvJ5QsdxWJHIZ+LOBwOh8PhcDgcDofD4XA4HA6Hw+EElX8Ax5Dzlr1WtMMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDMtMDRUMTA6MDA6MDIrMDA6MDBIE/HDAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAzLTA0VDEwOjAwOjAyKzAwOjAwOU5JfwAAAABJRU5ErkJggg==",Eke="/assets/html-a85ec1a3.png",Cke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAMAAAAJixmgAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACkVBMVEUAAAD/1gAAAAFWSAH2zgDDpACNdgBgUQE/NQEhHAERDgEJCAEBAQEbFwEkHgFmVgGMdQC4mgD1zgD3zwCjiQBRRAEKCAEIBwFHPAGSewDvyQDtxwB4ZQEUEQENCwFvXQHeugD70wCLdQAQDQEGBQGAawD50QDYtQA2LQErJAHMqwC6nACylQCpjgAEAwGagQCxlQCligAODAHFpQAtJgEWEgHhvQCEbwDsxgAMCgGghgB7ZwESDwEYFAGZgAC0lwAvJwGPeADPrgDqxADJqQCTewA+NAFdTgHrxQBrWgELCQH+1QAwKAHBogBYSgEDAwFxXwH0zQD40ACDbgD80wBTRgHLqgDVswDzzAAqIwGHcQD60gC8ngBFOgFBNwHatwBjUwF/awCcgwCrkABGOwG/oACWfgACAgETEAHbuAAoIgEiHQGhhwCiiADGpgAFBAG3mgBURgExKQGnjADowwAHBgFeTwHQrwDSsAC5mwCCbQAuJwGmiwD91ABLPwGqjwBDOAHpxAB0YQHuyAApIgHKqgCFcAC7nQBZSwFhUQFJPQFCNwFOQQGzlgA0LAFyYAFMQAHRrwAaFgGQeQAfGgF+agGojQAyKgHxygCRegBEOQE3LgGvkwAXEwHmwQA9MwE6MQFzYQEsJQHgvABXSQGGcAAVEgFnVgG1mABfUAHTsQBpWAF5ZgE7MgF1YgHUsgAZFQE1LAHAoQA8MgGukgDwyQBsWwFKPgFVRwHyywDOrQBtWwHcuQAdGAE5MAF9aQHEpACehQBPQgG+nwDnwgBlVQGIcgCwlAAmIAEcFwHjvgDkvwB8aAHWtADIqABcTQGfhQBSRQEPDQFoVwFANgHivgAzKwEeGQFqWQEjHQH///9xKO5qAAAAAXRSTlMAQObYZgAAAAFiS0dE2u4DJoIAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfnAwQKAS+wCuXTAAAFo0lEQVR42u3b+VtUVRgHcM9hEYYBwqkBwQUEIVAnhEDQFAQFZRQCUdnUTGEwKEsWEwMXhDS31Iwss02LFnIvK9ttsT3b/5t+SKaZc+5y5unJub5+vz/ec8885/PcuXPnvOfcMWMQBEEQBEEQBEEQBEEQBEEQBEEQBEEUwm7CAAwwwAADDDDAAAMMMMAAAwwwwAADDDDAAAMMMMAAAwwwwAADDDDAAAMMMMAAAwwwwAADDDDAAAMMMMAAAwwwwAADDDDAAAMMMMAAAwwwwAADDDDAAAMMMMAAAwzw/wXmQkIMzg0NCx8bEWmLstuiYyJib4sbRxrsuP0Op3BufML4RKrgpAkTuVYmTU6mCE6Zksr1kjY1nRw4405ulMwsYuBpqdw4zumkwDNc3CyuuwiBs829nNtnkgFn5HCVxOcSAaffzdWSl08DPIurJoEEuKBQGcxnUwDPUffyewpufnDKXHWvbR6BK1wku4rnl5SOK12wsMzuf7x8EYV7eLHYWjHbPdqWu8TneGQcjedwpvi0Xeo7O64cPVx1bzWNf1o1VULjMr+utcuvf8tXUJk8rBTaour8+1bXc86jGhrJTA+bhLZVYucSF1+9hlABIFtou0/qvfZ+N6USzzqhbSz1qqX4GF5PHdwsPoUdxMFrxMYW4mCHR2hs3UB85eEBsbUtgza4XJo75LS7KYMf1JgGlj1EGJy0UWvmG/Ew3dXDR7Qn+5s6GomCl+rVN6KXddJcH16vW9Lp6t5MEfxomkEZa9UWNzkw6zGs3G19rJcauLfPuFiZuY0YmCVuNanPbs+iBWY7Mk3EVTsdpMCsP8KsCL9rgBSYpe/0mK2ID7opgRl7PNrsIu+uIQVmBXvMLvITDlJgxkr2moj31dICM7b/gLH4IDUwY2FP2o12thSRAzN2aE+8vvhwHT0wY4lHntIVH6UIZizl6SEdcM4zJMGMsWnbtcXHqIIZW/GsFvg5umDGjj8vgz0nCINZ5wuyeAZlMKt+UQK/ZHWw47+AWX6F2L3P6uBSJbDuHruDYveXLQR+pbtfPrhBHPFJjefuqYoFOp+ZK3Z/1TLgxgYnf00+PCyO+HXplDcOcF6vM9utk3auWQXcvItzbs+Wjp8SR/ymeHlndXHO+Vs6nyvexFXWAHeW/zPLsa0UW0ZE8NtCIf76v0iX9uazWvH9gEIrgHtbbN4lIWEJ/7T0XDnidx/0eBceIjU3jyaL3c9YAJx11mdAE8/5XaDzEviCT/PmTT4Nq7Vu44XSUkTQwRff8d8w6Vmc5G0L3S3/VTr07+Wd6r86/K5ctHLEiN0vBRs8U97i7Ywdfo8x5s6YH6nxzlXKaM/3i8W2vTvET/9AbUZ8A8GXdV46srV96NRsGPF2/UhuPOO/9F8zWT6lKdhXOJYHlo+9PT/RKl+VbfGWJtM76jW+IDXBBp+oCAzsszBWqf3duNTwadH09sHPWrVaK4M/Hw4PyNvms2KSn8MDzufBB7sTAhlwuG/XjoC9Q24LVDyu5KkPOOeiX9cvAgU3WaJq2RyvPOAv/XuGFgfmDbFIIf4rl+KAY8Tf2CtfB+K92m+VlYd2u9KAN8qz3m8i1b2FA9ZZW+qIUhnxeK3ZQZuqtyvOSsulA4fNRzxHs+eiMjVv6jlrLYh/O2L2Uvug3sLKd1UK3uLvrbbloXeezWjArcf1u/4wZMZNm1BjwU0tnT/q7lqwhxhuFa39yfBO9vxs8rJW0Mq0p8u7NPdZ7TPdWtbYoXsrX/vF9LWAINalC479KjyUPWd7flPqmjylTP4Hc7X7gsKrPcEtxCcOr13+e9413mX7Y+Rkz/7SQJYpwlr+7Fsy1+bik2x/na88uu6yWj9LrS3diAAMMMAAAwwwwAADDDDAAAMMMMAAA3xrgxEEQRAEQRAEQRAEQRAEQRAEQRAEuWXyNzdzSI4Dd9tRAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTAzLTA0VDEwOjAwOjAyKzAwOjAwSBPxwwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wMy0wNFQxMDowMDowMiswMDowMDlOSX8AAAAASUVORK5CYII=",Tke="/assets/mongodb-54000b2b.png",Pke="/assets/nodejs-e0130c56.png",_Z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAMAAADVRocKAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAC+lBMVEUAAABV1NRSwN1SwN5TwN5SwN5SwN1SwN5SwN1Swd1Vu91Qwt1Swd1Twd1Twd1SwN1Twd5Twd5Swd1SwN5VxuJRwdxSwN1Twd5TwN5Swd4A//9IttpTwt1Twd1Vwt5Swd5Twd1Uwd0/v79Uwd5Swd1SwN5TwN9VwuBSwd1SwN5TwdtTwd1Rv9pSwN5TwN1Twd1Twd5Tw9tVwN1TwN5Twd5Twd1SwN5Vv9ROxNdTwN5SwN1Twt1Rv99Vwtpaw+FTwt5TwN1Twd1TwN1TwN1Twd5Twd5Swd5Twd1Swd1SwN1SwNxTwN1Rw95Swd1Rv9xSwd1Swd5SwN5Twd5VvOJ///9Swd1MzOVSwt9fv99SwN1Vv91RwN5SwN5SwN1TwN1PwdtVxuJSwd5mzMxSwd5TwN9Twd1UwN5Swd5Swd1SwN5SwN5Swd1Sv99Swd5Twd5TwN1Swd5TwtxTwd5Uwt9TwN1SwN5RxdxTwN5VweBVv99Twd5Vw91SwN5Pv99Swd5RweBTwN5Twd1TwN5Twd5SwN1Uwd1Pv99SwN1SwN1Twd1Tv9xZv9hSwd1TwN1Twt1Vv9tTwN5OxOFTwN5Twd1Twd5SwNxVqv9Twd5Swd5SwN5Swd1SwN5SwN1SwN9Swd1Vw9xVwN9VxN5RwN1SwN5cuedTwd9TwN5Swd5SwN1TwN5Swd5Twd5Twd5UwN5Twd5RwN1Twd5TwN1Uv9xbyNpTwN5Tv99Twd5SwN5TwN1Twd1SwN1Swd5Sv91NvN1Twd1Vwd1Sw+FTwN1QwN9TwN1SwN1TwN1Swd5Twd1SwN1SwN5Swd9SwN5Swd1Tv9xSwd1Swd5TwN1Rv95SwN1Sv95Twd1SwN1Rv99TwN1TwN1Rwd1TwN5TwN5Swd1Swd1RweBQvdpSwN5Swd1Vv99SwN5Qu+RSv91SwN1SwN1Twd5Twd5RwN1Swd5Swd5Rwt1Svd5Rwd9SwtxSwd5Swd1Tv95Twd1Swd5TwN1SwN1Twd5Twt1TwN5TwN5Twd7///9l1TinAAAA/HRSTlMABlqkxOHVvJdTDyZssdbu+Nq2ZglC3vu0RwEHXMc/V9dbBGfn+Ukq9Mk67BzM/qJGKy1WjeCbDA2c/XE4FRE3n7diPbLcPt/3mCV6L6ks/HxvpRsCxgpQCNg8TtGgzR0SlQXrMYBV8OTU8aEo232SwkO7WK+jFvIhMOMexSCqMtmJrJbAZBByTb5ZFHnlLiTpGpNrukoDdMt+iH+CQc8zOSdF6gtoh6bthvO1T16MasrdYQ69QISOwZnI0kQXgTYijynQubjDrqf6YLO/NJGF5m2LXZD2SIqDS3duY3gZI5TOGHYTaXuw6F81np1UH3A7rZpl73X1c9NMq+JmbhbdAAAAAWJLR0T9SwmT6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+cDBAoBMD0C6CYAAAkSSURBVGje7ZlbYE5XFscXcmnHJQkqhIy6fE1Iv48gpR/iLhlKXCIxI1WiGlFaFGlDNYx76jZI61JxH6JBqFZdRqY6iNKh06BotR1TOh2mYzqmM/N7mIdzTr5z2eHkoW/W21l77fU/++y11/rvdUQeyAP5yaRa9RpBwSGhDz38s3tZ1axVu05YeETdevWr6v+RBugS2bBRlNqmcZNow4jgn1fNf9NITPJoMwVE8xYtzTaex6riPyYWq7RqbTdpFGIziXvcvf8oL+Br0za+XfsOCdp03xMdzRadntTU/qDOXbomdusO0MM9QFuAnjpYr94+APqYFtE3CYDkX/TTFf0BnnINUBcYEHgc2AOAlEHGTgyOBPANGVphkjoM6O7Wf1q4/XXStTcekCYiMrw7AL/8ldliBBCX6hKgEZBhVXV6GoCRz4iMGgbgG51mMcgcAzzrEmAsMNqufC4LYFzM0GyA8SPs47WBwS4Bng9ssUkmRADEJQBMjHEMvwC86BJgEjDZqR41xQj5SaOcoy8BU10CRAADFfrMaZr/3qrEMxnwugRIAp5RDUzPAfC8rBp7BajjEiAXmKHQD5+prSBblWCfAh51CTAOeNWpTp1l7EHd5s7R14A8lwDZQDunejZA6ByAXztHuwHZLgHmKqNoHkD2/OFBAAscwwuBRS4B5gCL7cq+kUDu4yL5EYC/rQp/gEuAF4HX7QG0BIhdKiKyLAxYvkJx0H7jEmAl0Ma2wasAX3vtYbUfmFvgPP5vuASYDLxpVa0BWGs8rQNYb7XwAm6r5gog1hKJb6UAG/rVLCzc2LqwcNOyVoB/s2WJserYVsuWQOrdGrN62/bfxqGQHUN2tmg0Ybhm1w8oinIL0BtYmdrvuZ27lnBfCa499u0ZUgzMdF0yXwfGFFEFiRsH7HbpfuievUonYUkleV6v15tXkhTmUxlE78u/v/fEldGWyb7g0GQgvMt+Ww3t4gGS38m1QKSENkm7p/sDQ5JNbxw6u+nS+pIOMMhp+y7ACNn6bPX3DuYEZmW9Xyl7SU0/ZH6bwzrFSAA2ZCqSdwSQpL1warR50T0OKP0/lm1YjBx0xA8sExGRnUCkki5M9gHviojI0RTg4d9lGB6Cjjl5eEN9LGFsqYgcBPqLiGzyAL+vnByEbxIRqQWMFJEP1upx7Xvelqv2JOur26yRp23AcRGRD4GW+9UAXeOAP4iInKhIRAXpk/QdbG+ynH9Sc39qqaHJL9OKTluAJoG6OHj37sGBTTwN0EjkZT/4K8j1sY80iO4VAXX0OABnzpowdwEfS+pxIMjIAKsPazMzjKQWNQk4XCB/BM6Ya0crbScS9YOVB5B12rL8JkBY/WLA10XTFHQIBMpuPVef9QE9M88B9SwBeT4WIKOriEjmTIBo2/WhYxYwL9hUpjqYY/gTXVkDWPInoGi+dX7pBoApBUYtPzXcvoOfAuWAp1SPYmtauKBpZ5TrZg4asPUkwFiRFeFA7QJHiPTTM4bBNzOsABt09UU9LJ1kNbMuUD5dtgPBqgSi3TqSVwR4lUV0bpmvZYkpCgcdc4FLEgLsU0X5ZwB8bFxq7ADn9YH1ACxUeegJHJbkSniipPYxLUA+sQPMNs5QGNBAebeZAZRLLLBUedXMA5KHmmmdWQwG0LUI2KK86McAOeIFLiuTn+UTXansE70HwFWVh8vAXvkcGDdcMaxlP2MJ7ewAetisKNdyu6LefzEeeEHmjwcuOoev+TVHX+rPx63+vzKxQIAjDgedvEDR1yJ/BnzzHOO7gXDAcy1w9TSJzk2veYA4oKF9/vVJBkmOaggw21az0sKAv+QCs1RxZGzxACB4MuCvaZ3frgRgTpSIyKgMgJHxFoNmQFbaacC3UQ/biyb/elh28wHFkgFst5zib8IB9nbSr4+HAJLXmNsdHwGjpSADGGZsYNuv9O+/2Zyuj6fKNiDYdBSOaBs2pcJhxxsA3NxT8Z2ulwGviFwA+LZiZnyttWtXBpZaXS84nXKAtwztX/Xr7neNTYeqllYyx33TVVPUM2jFFGB5orpk7j8HfGhU57/p1GSuzlxv2TYlSNMnT7vQXEQWGVxogkfVVwhUCM8EI8Sy6ouUrivRs+usoY7MUN0gactHH7ntBzZV0JaUYyr/S8uAnVp77Sbw9ysnDFJ46HvVhK2dK3hgmUEqRNKSgOzGTvOCvUDCVu3hIXMMz0yvjMdX62lqxOVMudgsvpp2feSS03gBQLqk3r7Qf05SYFrkP1rfk51ufCLHwmaTQu/sAMo22g5i/YGxQOyNkHDLAT/e+eh9+fXWlwbkKOl7edjNkgiv1xtR0iAsRWWQO3apyxvCOsBHlSQOCHV9w1kF/HPFwsttQlLu7zoypM3lhfnxQFFzl/5Tf6iocmkxjfatu7MrTPnJVj25pvjAtWqBOfEuASYAORYi830kELKptLCwsLCwXWlpbxxU4R3glkuAdOCEVfUvc/nUSO8QJ1Eb5BLgMnDHds6nmt653V2gj43TXwVquAT4Dvi3vSOYAJQXiogkTgQ8Z20GvYBolwCLgHRHw8kDnLstUm2RsmG0CYhwCZABOM/7Yh9QJ1HeB5jlyDajgB0uAYIrUqlF1gPMXQ8wzMlzCgB/gTuAHOBrBdWbZpyAJEXCaQ7Q2B1AEaDKWZmhep5VpZzGAC7b7zuAL1QDo4Irp9KdgEiXe9ASqKkaaKGxvTmqL7EMGO8S4EdA9ddqkJFhzyhav72AH10C3ACKnb2JaQD+OICQmsrue22XAB1MnLdCbkcDlC1+NQLgh8/s45eq0JFqqljtt+MBxl8Qme4F8HewHYUTwH9cAlz3A4WWVonWHcj7QESk438BCLFwmXjA09FtRQuy/s3I/7QMgF36ZTvq8xQA/9OBjkrUIhWFr1RuAaw04m/0XY3zvRE4Rm21rs3dL/XLg+wEOOAaIDUE4FT7+Blnr67SbzpvWq7aiTV0WnNwQZfp+V26U6Wupshrybb6O+a8vaC/PdFmkrWsKr9jiy2/e4t2Kk5W5vktZpuydKmS9A30fOvUquSneFrPQIP1f49IFSWtXu3snJaHT165JxeJuTK1zhhPXu+m1eSBPJCfTP4P2qckJ0elpLAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDMtMDRUMTA6MDA6MDIrMDA6MDBIE/HDAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAzLTA0VDEwOjAwOjAyKzAwOjAwOU5JfwAAAABJRU5ErkJggg==",Dke="/assets/redux-07db265e.png",Bke="/assets/tailwind-6ece120d.png",Lke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAMAAAAJixmgAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACT1BMVEUAAAAZdtLg7fn///+BtOYwg9ZVmd5wquOMuuioy+7D2/PR5Pbf7Pnv9fzw9vzs9Pvb6vi/2fKrze+XweuAs+ZppuJKk9wqgNU8i9l6sOW41fHo8frN4fWiyO13ruRMlNwie9Q3iNjZ6Pj8/f6szu91reQ2h9hLlNy10/Gkye05idi00vD+/v+cxOwad9L1+f2SvuojfNSLuugvg9bT5faCtOYnftV5r+UdeNPG3fSNu+lnpeFJkttfoODD3PNWm95and9Nldy71/Lh7fm31PGWweuJueibw+vi7vlFkNszhte61vFhoeAsgdYof9XM4fX9/v9YnN5jouBvqeNxq+PJ3/Q0htcrgdbK3/X6/P5tqOKaw+v0+f3z+P1opeLx9vw9i9mgx+wbd9Kz0vCVwOp0rOSfxuypzO5Mldyuz+9goOClye3p8vvO4vWvz+/y9/0eedMhe9Tu9fzS5PaTv+psp+IgetPm8Pp9suYfetPk7/oceNNZnN+Ywuux0fAwhNeexuxGkdtRl93r8/v2+v3I3vT3+v1bnd97seVen9++2PJDj9rW5/clfdR6r+WjyO3o8vuFtufE3PSKuegnf9WPvOk7itm61vJiouDt9PvC2vPe6/i51fEpgNUtgtYyhdc6itk/jdnL4PXV5vfP4/aRvelcnt+Uv+qZwuvl7/pmpOFnpOEkfNTY6PfW5venyu5HkdvX5/fH3vT5+/5Cj9o4iNhXm96x0PBEkNpTmN3U5feHuOhlo+G20/H4+/6tzu92reROltx/s+bB2vMmftSrdjnjAAAAAXRSTlMAQObYZgAAAAFiS0dEAxEMTPIAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfnAwQKARAGbMjuAAAEfUlEQVR42u3c6VcTZxTHcW8GhBREFLC4IRIDGjAWsTSiSAsFFQVjrNKUUGrclxpwR1S0SlWsu7gvuGvdrdbWrtr+YZWjR48nd7bTF/jc+X1fknkm+RyyMHcm9OuHEEIIIYQQQgghhBBCCCGEEEIWIgUDGGCAAQYYYIABBhhggAEGGGCAAQYYYIABBhhggAEGGGCAAQYYYIABBhhggAEGGGCAAQYYYIABBhhggAEGGGCAAQYYYIABBhhggAEGGGCAAQYYYIABBhhggAEGGGDbYJf2f0vQ33li/6Rk9wcpqa4BaWkDXekpgwZnZGYN+VAmOHvosOE6K9JGjMwZlSsKPDo5z2yZJ32MN18IuGCsx9rScSLAvsIiq0vHCwD7vROsL/1IfXDxMDtLJyoPLplka+nHqoNL7Xm1TxQHBybbXJqkOLjM7tIpaoOneuwuLVcbPM320gqlwZ/aX/qZ0uBK/U2qPh9XXZM8fXDljHd/PlNlcK3OK9gza3bd27ur718zJ/jmtuw+AM8Nsc2Lf+Tp/JYh36sdZfLewtq4u6z7Yv7rGxe8PxOPhviH/qXxCvYZHf5K52C5MdJ7c4PC4EAT4w1+rbt9fU2zpuUqDP6G+wUvNFpRXx2OKgwuZ7yROuM7ySaFwQkMeJFCY1rb4MUMeIlk8FIGPFcyeBkDXi4ZvIIBr5QMXsWAGyWDG7kzDKWCwdzHkuYWDA6xhw4ZcsE+/mApIyAVTKt58bc+qeA1OvOBWGaLTHBIdySSGvJLBLeu1Z8CrSv3ywPTeqPB16RQVBy4JGI468vbEBAGpmST8abL2yILvDHdbKK7aXObJDAVhE2H2FuS2gWBaaiFuX3eVkFg2mblVMX2Djlgmm5FHMuRA/bvsHQ+alGpFPDLA2NLp8VTd4oB03e7rIh3V4gBU36nFfH3e8SAKbrXytV44X1iwESjuyyII/vlgIkqfjAXuw4IAlPg4GpT8SFJYKI272ETcHCIKDBR8ZG1xuKjwsBEB441G4qnSgMTHe9uMgC75YFf7mub/nFyc5tAMNGJk1YutxQEJjp1WgdcJhRMiWd4cJdUMLUUsuCzYsEUOMceQvjFguk8+zrOlQvmvxNxQTC4gAM3CAZf5MCtgsE93AXzqr5L+xLaTXe6nPvbUlXwJe3yftMJLgO+oi5Y8+wwuT76KvedCIXBmha5dt5gk+vce9YNpcGaFrvZo7dFyS0O/KPiYE0Lds1uZd+i2dPlRReUB/c+s7ffvhM33eLnHndJArj34/Xe/ZwHr08RtudnuWM6h8PdUsCvmuB6mHJ3hsGFEEU+WWDTHpHDwBUOAz8iZ4F/euwwcAI5Czwr6izwiGJyFLiznhwFXhN/malkcMzL7EIt8BMb/0YrOKaWlAdT28/Vc8JWuOGnv/B7UHBqmfvrsUFNxtxnv3XorVZ0TBvt+b3sj7w/uUOjqr/+Nvraltpz6cTnG150L3z6z5neKt3XNmeN+tdkSZ+C+yKAAQYYYIABBhhgNcAIIYQQQgghhBBCCCGEEEIIIcf0H6s0di86BKRLAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTAzLTA0VDEwOjAwOjAyKzAwOjAwSBPxwwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wMy0wNFQxMDowMDowMiswMDowMDlOSX8AAAAASUVORK5CYII=",Rke="/assets/threejs-fe160e71.svg",EL="/assets/wordpress-3c2ec04c.png",Ike="/assets/meta-e386841a.png",Oke="/assets/shopify-c0fdbc80.png",Fke="/assets/yonisilvestre-7a5e3e54.png",Nke="/assets/yardsale-a447e28a.png",zke="/assets/landingyoni-3d6d784e.png",kke="/assets/calendary-f3361bee.png",Uke="/assets/expresscleanings-bf7a6887.png",Gke="/assets/justloan-c91d4fa3.png",Hke="/assets/lashroom-f43438fc.png",Vke="/assets/silvestresmarketing-d608e37f.png",kj=[{id:"#about",title:"About Me"},{id:"#work",title:"Portfolio"},{id:"#contact",title:"Contact"},{id:"https://rxresu.me/yonisantiagosg/yoni-silvestre",title:"Resume"}],jke=[{title:"Web Developer",icon:xke},{title:"React Js Developer",icon:_Z},{title:"WordPress Developer",icon:EL}],Wke=[{name:"HTML 5",icon:Eke},{name:"CSS 3",icon:Ake},{name:"JavaScript",icon:Cke},{name:"TypeScript",icon:Lke},{name:"React JS",icon:_Z},{name:"Redux Toolkit",icon:Dke},{name:"Tailwind CSS",icon:Bke},{name:"Node JS",icon:Pke},{name:"MongoDB",icon:Tke},{name:"Three JS",icon:Rke},{name:"git",icon:Mke},{name:"docker",icon:Ske}],Xke=[{title:"WordPress Developer",company_name:"Serena Realty Hotels",icon:EL,iconBg:"#383E56",date:"2017 - 2018",points:["Developing Serena Realty websites development including a Hotel booking system with a payment gateway using WordPress and woo-commerce, synchronized with multiple booking platforms: Airbnb API, Booking.com, Expedia, and iCalendar.","Increasing +$50k revenue through the booking system in the first 4 months.","Tech Stack: WordPress, PHP, Javascript, MySQL, CSS, HTML."]},{title:"WordPress Developer",company_name:"Estudio Digital",icon:EL,iconBg:"#E6DEDD",date:"2018 - 2019",points:["Developing responsive websites for clients in different niches, using WordPress and Shopify. Optimizing websites, installing CDN and SSL certificates, installing required plugins, improving website loading speeds by 40%, and additional coding to fit final design and functionality requirements.","Collaborating with cross-functional teams including designers, product managers, and other developers to create high-quality products.","Implementing responsive design and ensuring cross-browser compatibility.","Developing e-commerce websites using WooCommerce, connected payment methods (ePayco, PayPal, Stripe), and internal SEO done with Yoast SEO, achieving 40% more revenue for the client throughout website sales."]},{title:"Web Developer",company_name:"Express Cleanings",icon:Oke,iconBg:"#383E56",date:"2022 - 2023",points:["Developed main web app using WordPress and Woocommerce","Implementing automations using custom hooks, zapier, and hubspot","Building custom pricing calculator order form to schedule new bookings and collect payments through stripe API.","Technologies used: PHP, WordPress, MySQL, Javascript, HTML, CSS"]},{title:"Front End Developer",company_name:"Silvestres Media Group",icon:Ike,iconBg:"#E6DEDD",date:"2021 - Present",points:["Provided front-end website development and landing pages using React JS, WordPress, Hubspot, Elementor, Divi, Clickfunnels and Squarespace.","Leading team members for ongoing web development project using agile methodology, trello and slack.","Increasing 25% of website speeds by implementing improvements on current clients websites.","Participating in code reviews and providing constructive feedback to other developers."]}],Yke=[{testimonial:"I thought it was impossible to make a website as beautiful as our product, but Yoni proved me wrong.",name:"Eli P.",designation:"Founder",company:"lashroombyeli.com",image:"https://randomuser.me/api/portraits/women/4.jpg"},{testimonial:"I've never met a web developer who truly cares about their clients' success like Yoni does.",name:"Maria S.",designation:"CEO",company:"expresscleanings.com",image:"https://randomuser.me/api/portraits/women/8.jpg"},{testimonial:"After Rick optimized our website, our loading speed increased by 50%. We can't thank them enough!",name:"Carlos S.",designation:"Founder",company:"Carzul",image:"https://randomuser.me/api/portraits/men/7.jpg"}],qke=[{name:"Yard Sale Ecommerce",description:"Front End Project, React JS ecommerce store, SPA, built from scratch.",tags:[{name:"react",color:"blue-text-gradient"},{name:"javascript",color:"green-text-gradient"},{name:"sass",color:"pink-text-gradient"}],image:Nke,source_code_link:"https://github.com/yonisantiago/react-ecommerce-shop",projectUrl:"https://6513105c843700007c5dbadb--teal-axolotl-97d6e5.netlify.app/"},{name:"Personal Portfolio",description:"Web application that enables users to search for job openings, view estimated salary ranges for positions, and locate available jobs based on their current location.",tags:[{name:"react",color:"blue-text-gradient"},{name:"javascript",color:"green-text-gradient"},{name:"vite",color:"pink-text-gradient"},{name:"threejs",color:"blue-text-gradient"}],image:Fke,source_code_link:"https://yonisilvestre.com/",projectUrl:"https://yonisilvestre.com/"},{name:"Calendary App",description:"Calendar App, Front End and Back End  made using ReactJs, moment, Big Calendar, Bootstrap, Mongoose, MongoDB, Redux, React Router.",tags:[{name:"ReacJs",color:"blue-text-gradient"},{name:"moment",color:"green-text-gradient"},{name:"Big Calendar",color:"pink-text-gradient"},{name:"Bootstrap",color:"blue-text-gradient"},{name:"MongoDB",color:"green-text-gradient"},{name:"Redux",color:"blue-text-gradient"},{name:"React Router",color:"blue-text-gradient"},{name:"Mongoose",color:"green-text-gradient"}],image:kke,source_code_link:"https://github.com/yonisantiago/calendary-app-backend",projectUrl:"https://calendary-app-backend-production.up.railway.app/"},{name:"Portfolio - Async Landing Page",description:"Responsive landing page, made with HTML, CSS, JS, Tailwind CSS, RapidAPI to pull last youtube videos on channel.",tags:[{name:"html",color:"blue-text-gradient"},{name:"css",color:"green-text-gradient"},{name:"rapidapi",color:"pink-text-gradient"}],image:zke,source_code_link:"https://github.com/yonisantiago/async-landing",projectUrl:"https://yonisantiago.github.io/async-landing/"}],Qke=[{name:"Express Cleanings",description:"WordPress Site with a custom form to book an appointment and take payments.",tags:[{name:"wordpress",color:"blue-text-gradient"},{name:"elementor",color:"green-text-gradient"},{name:"WPforms",color:"pink-text-gradient"}],image:Uke,source_code_link:"https://github.com/yonisantiago/",projectUrl:"https://expresscleanings.com/"},{name:"LashRoom by Eli",description:"Landing page, thank you page optimized for a sales funnel, using WordPress and Divi Builder",tags:[{name:"wordpress",color:"blue-text-gradient"},{name:"css",color:"green-text-gradient"},{name:"divi",color:"pink-text-gradient"},{name:"zapier",color:"blue-text-gradient"}],image:Hke,source_code_link:"https://github.com/yonisantiago",projectUrl:"https://lashroombyeli.com/"},{name:"Silvestres Marketing",description:"Silvestres Marketing Website made using WordPress and Divi",tags:[{name:"wordpress",color:"blue-text-gradient"},{name:"css",color:"green-text-gradient"},{name:"divi",color:"pink-text-gradient"},{name:"hubspot",color:"blue-text-gradient"}],image:Vke,source_code_link:"https://github.com/yonisantiago/",projectUrl:"https://silvestresmarketing.com/"},{name:"Mortgage Broker",description:"Mortgage broker website.",tags:[{name:"wordpress",color:"blue-text-gradient"},{name:"css",color:"green-text-gradient"},{name:"Divi",color:"pink-text-gradient"}],image:Gke,source_code_link:"https://github.com/yonisantiago/",projectUrl:"https://justloan-solutions.com"}],bZ="/assets/YoniProfile-6025d7eb.png",Jke=()=>{const[e,t]=ae.useState(""),[i,n]=ae.useState(!1),[r,s]=ae.useState(!1);return ae.useEffect(()=>{const o=()=>{window.scrollY>100?s(!0):(s(!1),t(""))};window.addEventListener("scroll",o);const a=()=>{document.querySelectorAll("section[id]").forEach(c=>{const h=c.getAttribute("id"),u=c.offsetHeight,d=c.getBoundingClientRect().top-u*.2;d<0&&d+u>0&&t(h)})};return window.addEventListener("scroll",a),()=>{window.removeEventListener("scroll",o),window.removeEventListener("scroll",a)}},[]),Be("nav",{className:`${er.paddingX} w-full flex items-center py-5 fixed top-0 z-20 ${r?"bg-primary":"bg-transparent"}`,children:Et("div",{className:"w-full flex justify-between items-center max-w-7xl mx-auto",children:[Et(_ie,{to:"/",className:"flex items-center gap-2",onClick:()=>{window.scrollTo(0,0)},children:[Be("img",{src:bZ,alt:"logo",className:"w-12 h-12 object-contain"}),Et("p",{className:"text-white text-[18px] font-bold cursor-pointer flex ",children:["Yoni Silvestre |",Be("span",{className:"md:block hidden sm:block hidden",children:" Web Dev"})]})]}),Be("ul",{className:"list-none hidden sm:flex flex-row gap-10",children:kj.map(o=>Be("li",{className:`${e===o.id?"text-white":"text-secondary"} hover:text-white text-[18px] font-medium cursor-pointer`,children:Be("a",{href:`${o.id}`,children:o.title})},o.id))}),Et("div",{className:"sm:hidden flex flex-1 justify-end items-center",children:[Be("img",{src:i?bke:_ke,alt:"menu",className:"w-[28px] h-[28px] object-contain",onClick:()=>n(!i)}),Be("div",{className:`${i?"flex":"hidden"} p-6 black-gradient absolute top-20 right-0 mx-4 my-2 min-w-[140px] z-10 rounded-xl`,children:Be("ul",{className:"list-none flex justify-end items-start flex-1 flex-col gap-4",children:kj.map(o=>Be("li",{className:`font-poppins font-medium cursor-pointer text-[16px] ${e===o.id?"text-white":"text-secondary"}`,onClick:()=>{n(!i)},children:Be("a",{href:`#${o.id}`,children:o.title})},o.id))})})]})]})})};var AZ={};Object.defineProperty(AZ,"__esModule",{value:!0});var H0=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},Kke=function(){function e(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),SZ=ae,Zke=eUe(SZ),$ke=r9;function eUe(e){return e&&e.__esModule?e:{default:e}}function tUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iUe(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function nUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var rUe=function(e){nUe(t,e);function t(i){tUe(this,t);var n=iUe(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i));n.state={style:{}};var r={reverse:!1,max:35,perspective:1e3,easing:"cubic-bezier(.03,.98,.52,.99)",scale:"1.1",speed:"1000",transition:!0,axis:null,reset:!0};return n.width=null,n.height=null,n.left=null,n.top=null,n.transitionTimeout=null,n.updateCall=null,n.element=null,n.settings=Object.assign({},r,n.props.options),n.reverse=n.settings.reverse?-1:1,n.onMouseEnter=n.onMouseEnter.bind(n,n.props.onMouseEnter),n.onMouseMove=n.onMouseMove.bind(n,n.props.onMouseMove),n.onMouseLeave=n.onMouseLeave.bind(n,n.props.onMouseLeave),n}return Kke(t,[{key:"componentDidMount",value:function(){this.element=(0,$ke.findDOMNode)(this)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.transitionTimeout),cancelAnimationFrame(this.updateCall)}},{key:"onMouseEnter",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){},r=arguments[1];return this.updateElementPosition(),this.setState(Object.assign({},this.state,{style:H0({},this.state.style,{willChange:"transform"})})),this.setTransition(),n(r)}},{key:"reset",value:function(){var n=this;window.requestAnimationFrame(function(){n.setState(Object.assign({},n.state,{style:H0({},n.state.style,{transform:"perspective("+n.settings.perspective+"px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)"})}))})}},{key:"onMouseMove",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){},r=arguments[1];return r.persist(),this.updateCall!==null&&window.cancelAnimationFrame(this.updateCall),this.event=r,this.updateCall=requestAnimationFrame(this.update.bind(this,r)),n(r)}},{key:"setTransition",value:function(){var n=this;clearTimeout(this.transitionTimeout),this.setState(Object.assign({},this.state,{style:H0({},this.state.style,{transition:this.settings.speed+"ms "+this.settings.easing})})),this.transitionTimeout=setTimeout(function(){n.setState(Object.assign({},n.state,{style:H0({},n.state.style,{transition:""})}))},this.settings.speed)}},{key:"onMouseLeave",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){},r=arguments[1];return this.setTransition(),this.settings.reset&&this.reset(),n(r)}},{key:"getValues",value:function(n){var r=(n.nativeEvent.clientX-this.left)/this.width,s=(n.nativeEvent.clientY-this.top)/this.height,o=Math.min(Math.max(r,0),1),a=Math.min(Math.max(s,0),1),l=(this.reverse*(this.settings.max/2-o*this.settings.max)).toFixed(2),c=(this.reverse*(a*this.settings.max-this.settings.max/2)).toFixed(2),h=o*100,u=a*100;return{tiltX:l,tiltY:c,percentageX:h,percentageY:u}}},{key:"updateElementPosition",value:function(){var n=this.element.getBoundingClientRect();this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this.left=n.left,this.top=n.top}},{key:"update",value:function(n){var r=this.getValues(n);this.setState(Object.assign({},this.state,{style:H0({},this.state.style,{transform:"perspective("+this.settings.perspective+"px) rotateX("+(this.settings.axis==="x"?0:r.tiltY)+"deg) rotateY("+(this.settings.axis==="y"?0:r.tiltX)+"deg) scale3d("+this.settings.scale+", "+this.settings.scale+", "+this.settings.scale+")"})})),this.updateCall=null}},{key:"render",value:function(){var n=Object.assign({},this.props.style,this.state.style);return Zke.default.createElement("div",{style:n,className:this.props.className,onMouseEnter:this.onMouseEnter,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave},this.props.children)}}]),t}(SZ.Component),MZ=AZ.default=rUe;const Fx=e=>({hidden:{y:-50,opacity:0},show:{y:0,opacity:1,transition:{type:"spring",duration:1.25,delay:e}}}),Xg=(e,t,i,n)=>({hidden:{x:e==="left"?100:e==="right"?-100:0,y:e==="up"?100:e==="down"?-100:0,opacity:0},show:{x:0,y:0,opacity:1,transition:{type:t,delay:i,duration:n,ease:"easeOut"}}}),Uj=(e,t,i,n)=>({hidden:{x:e==="left"?"-100%":e==="right"?"100%":0,y:e==="up"||e==="down"?"100%":0},show:{x:0,y:0,transition:{type:t,delay:i,duration:n,ease:"easeOut"}}}),sUe=(e,t)=>({hidden:{},show:{transition:{staggerChildren:e,delayChildren:t||0}}}),B1=(e,t)=>function(){return Et(ds.section,{variants:sUe(),initial:"hidden",whileInView:"show",viewport:{once:!0,amount:.25},className:`${er.padding} max-w-7xl mx-auto relative z-0`,id:t,children:[Be("span",{className:"hash-span",children:" "}),Be(e,{})]})},oUe=({index:e,title:t,icon:i})=>Be(MZ,{className:"xs:w-[250px] w-full",children:Be(ds.div,{variants:Xg("right","spring",e*.5,.75),className:"w-full green-pink-gradient p-[1px] rounded-[20px] shadow-card",children:Et("div",{options:{max:45,scale:1,speed:450},className:"bg-tertiary rounded-[20px] py-5 px-12 min-h-[280px] flex justify-evenly items-center flex-col",children:[Be("img",{src:i,alt:"web-development",className:"w-16 h-16 object-contain"}),Be("h3",{className:"text-white text-[20px] font-bold text-center",children:t})]})})}),aUe=()=>Et(pg,{children:[Et(ds.div,{variants:Fx(),children:[Be("p",{className:er.sectionSubText,children:"Introduction"}),Be("h2",{className:er.sectionHeadText,children:"Overview."})]}),Be(ds.p,{variants:Xg("","",.1,1),className:"mt-4 text-secondary text-[17px] max-w-3xl leading-[30px]",children:"I'm a junior software developer with experience in the MERN(mongodb, express, react js, node.js) stack, and expertise in Wordpress. I'm a quick learner and collaborate closely with clients to create efficient, scalable, and user-friendly solutions that solve real-world problems. Let's work together to bring your ideas to life!"}),Be("div",{className:"mt-20 flex flex-wrap gap-10",children:jke.map((e,t)=>Be(oUe,{index:t,...e},e.title))})]}),lUe=B1(aUe,"about"),cUe=()=>Be(pg,{children:Be("div",{className:"flex flex-row flex-wrap justify-center gap-10",children:Wke.map(e=>Be("div",{className:"w-28 h-28",children:Be(Pde,{icon:e.icon})},e.name))})}),uUe=B1(cUe,"tech");var gE={},EZ={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function i(){for(var n=[],r=0;r<arguments.length;r++){var s=arguments[r];if(s){var o=typeof s;if(o==="string"||o==="number")n.push(s);else if(Array.isArray(s)){if(s.length){var a=i.apply(null,s);a&&n.push(a)}}else if(o==="object"){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){n.push(s.toString());continue}for(var l in s)t.call(s,l)&&s[l]&&n.push(l)}}}return n.join(" ")}e.exports?(i.default=i,e.exports=i):window.classNames=i})()})(EZ);var CZ=EZ.exports;gE.__esModule=!0;gE.default=void 0;var hUe=AF(ae),ju=AF(UX),dUe=AF(CZ);function AF(e){return e&&e.__esModule?e:{default:e}}const TZ=({animate:e=!0,className:t="",layout:i="2-columns",lineColor:n="#FFF",children:r})=>(typeof window=="object"&&document.documentElement.style.setProperty("--line-color",n),hUe.default.createElement("div",{className:(0,dUe.default)(t,"vertical-timeline",{"vertical-timeline--animate":e,"vertical-timeline--two-columns":i==="2-columns","vertical-timeline--one-column-left":i==="1-column"||i==="1-column-left","vertical-timeline--one-column-right":i==="1-column-right"})},r));TZ.propTypes={children:ju.default.oneOfType([ju.default.arrayOf(ju.default.node),ju.default.node]).isRequired,className:ju.default.string,animate:ju.default.bool,layout:ju.default.oneOf(["1-column-left","1-column","2-columns","1-column-right"]),lineColor:ju.default.string};var fUe=TZ;gE.default=fUe;var vE={};function CL(){return CL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},CL.apply(this,arguments)}function pUe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,TL(e,t)}function TL(e,t){return TL=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},TL(e,t)}function mUe(e,t){if(e==null)return{};var i={},n=Object.keys(e),r,s;for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&(i[r]=e[r]);return i}var PL=new Map,Hb=new WeakMap,Gj=0,PZ=void 0;function gUe(e){PZ=e}function vUe(e){return e?(Hb.has(e)||(Gj+=1,Hb.set(e,Gj.toString())),Hb.get(e)):"0"}function yUe(e){return Object.keys(e).sort().filter(function(t){return e[t]!==void 0}).map(function(t){return t+"_"+(t==="root"?vUe(e.root):e[t])}).toString()}function xUe(e){var t=yUe(e),i=PL.get(t);if(!i){var n=new Map,r,s=new IntersectionObserver(function(o){o.forEach(function(a){var l,c=a.isIntersecting&&r.some(function(h){return a.intersectionRatio>=h});e.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=c),(l=n.get(a.target))==null||l.forEach(function(h){h(c,a)})})},e);r=s.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),i={id:t,observer:s,elements:n},PL.set(t,i)}return i}function SF(e,t,i,n){if(i===void 0&&(i={}),n===void 0&&(n=PZ),typeof window.IntersectionObserver>"u"&&n!==void 0){var r=e.getBoundingClientRect();return t(n,{isIntersecting:n,target:e,intersectionRatio:typeof i.threshold=="number"?i.threshold:0,time:0,boundingClientRect:r,intersectionRect:r,rootBounds:r}),function(){}}var s=xUe(i),o=s.id,a=s.observer,l=s.elements,c=l.get(e)||[];return l.has(e)||l.set(e,c),c.push(t),a.observe(e),function(){c.splice(c.indexOf(t),1),c.length===0&&(l.delete(e),a.unobserve(e)),l.size===0&&(a.disconnect(),PL.delete(o))}}var wUe=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function Hj(e){return typeof e.children!="function"}var iM=function(e){pUe(t,e);function t(n){var r;return r=e.call(this,n)||this,r.node=null,r._unobserveCb=null,r.handleNode=function(s){r.node&&(r.unobserve(),!s&&!r.props.triggerOnce&&!r.props.skip&&r.setState({inView:!!r.props.initialInView,entry:void 0})),r.node=s||null,r.observeNode()},r.handleChange=function(s,o){s&&r.props.triggerOnce&&r.unobserve(),Hj(r.props)||r.setState({inView:s,entry:o}),r.props.onChange&&r.props.onChange(s,o)},r.state={inView:!!n.initialInView,entry:void 0},r}var i=t.prototype;return i.componentDidUpdate=function(r){(r.rootMargin!==this.props.rootMargin||r.root!==this.props.root||r.threshold!==this.props.threshold||r.skip!==this.props.skip||r.trackVisibility!==this.props.trackVisibility||r.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())},i.componentWillUnmount=function(){this.unobserve(),this.node=null},i.observeNode=function(){if(!(!this.node||this.props.skip)){var r=this.props,s=r.threshold,o=r.root,a=r.rootMargin,l=r.trackVisibility,c=r.delay,h=r.fallbackInView;this._unobserveCb=SF(this.node,this.handleChange,{threshold:s,root:o,rootMargin:a,trackVisibility:l,delay:c},h)}},i.unobserve=function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)},i.render=function(){if(!Hj(this.props)){var r=this.state,s=r.inView,o=r.entry;return this.props.children({inView:s,entry:o,ref:this.handleNode})}var a=this.props,l=a.children,c=a.as,h=mUe(a,wUe);return ae.createElement(c||"div",CL({ref:this.handleNode},h),l)},t}(ae.Component);iM.displayName="InView";iM.defaultProps={threshold:0,triggerOnce:!1,initialInView:!1};function _Ue(e){var t=e===void 0?{}:e,i=t.threshold,n=t.delay,r=t.trackVisibility,s=t.rootMargin,o=t.root,a=t.triggerOnce,l=t.skip,c=t.initialInView,h=t.fallbackInView,u=ae.useRef(),d=ae.useState({inView:!!c}),f=d[0],p=d[1],g=ae.useCallback(function(v){u.current!==void 0&&(u.current(),u.current=void 0),!l&&v&&(u.current=SF(v,function(x,w){p({inView:x,entry:w}),w.isIntersecting&&a&&u.current&&(u.current(),u.current=void 0)},{root:o,rootMargin:s,threshold:i,trackVisibility:r,delay:n},h))},[Array.isArray(i)?i.toString():i,o,s,a,l,r,h,n]);ae.useEffect(function(){!u.current&&f.entry&&!a&&!l&&p({inView:!!c})});var m=[g,f.inView,f.entry];return m.ref=m[0],m.inView=m[1],m.entry=m[2],m}const bUe=Object.freeze(Object.defineProperty({__proto__:null,InView:iM,default:iM,defaultFallbackInView:gUe,observe:SF,useInView:_Ue},Symbol.toStringTag,{value:"Module"})),AUe=C$(bUe);vE.__esModule=!0;vE.default=void 0;var Wu=MF(ae),Ji=MF(UX),Vb=MF(CZ),SUe=AUe;function MF(e){return e&&e.__esModule?e:{default:e}}const DZ=({children:e="",className:t="",contentArrowStyle:i=null,contentStyle:n=null,date:r="",dateClassName:s="",icon:o=null,iconClassName:a="",iconOnClick:l=null,onTimelineElementClick:c=null,iconStyle:h=null,id:u="",position:d="",style:f=null,textClassName:p="",intersectionObserverProps:g={rootMargin:"0px 0px -40px 0px",triggerOnce:!0},visible:m=!1})=>Wu.default.createElement(SUe.InView,g,({inView:v,ref:x})=>Wu.default.createElement("div",{ref:x,id:u,className:(0,Vb.default)(t,"vertical-timeline-element",{"vertical-timeline-element--left":d==="left","vertical-timeline-element--right":d==="right","vertical-timeline-element--no-children":e===""}),style:f},Wu.default.createElement(Wu.default.Fragment,null,Wu.default.createElement("span",{style:h,onClick:l,className:(0,Vb.default)(a,"vertical-timeline-element-icon",{"bounce-in":v||m,"is-hidden":!(v||m)})},o),Wu.default.createElement("div",{style:n,onClick:c,className:(0,Vb.default)(p,"vertical-timeline-element-content",{"bounce-in":v||m,"is-hidden":!(v||m)})},Wu.default.createElement("div",{style:i,className:"vertical-timeline-element-content-arrow"}),e,Wu.default.createElement("span",{className:(0,Vb.default)(s,"vertical-timeline-element-date")},r)))));DZ.propTypes={children:Ji.default.oneOfType([Ji.default.arrayOf(Ji.default.node),Ji.default.node]),className:Ji.default.string,contentArrowStyle:Ji.default.shape({}),contentStyle:Ji.default.shape({}),date:Ji.default.node,dateClassName:Ji.default.string,icon:Ji.default.element,iconClassName:Ji.default.string,iconStyle:Ji.default.shape({}),iconOnClick:Ji.default.func,onTimelineElementClick:Ji.default.func,id:Ji.default.string,position:Ji.default.string,style:Ji.default.shape({}),textClassName:Ji.default.string,visible:Ji.default.bool,intersectionObserverProps:Ji.default.shape({root:Ji.default.object,rootMargin:Ji.default.string,threshold:Ji.default.number,triggerOnce:Ji.default.bool})};var MUe=DZ;vE.default=MUe;var BZ={VerticalTimeline:gE.default,VerticalTimelineElement:vE.default};const EUe=({experience:e})=>Et(BZ.VerticalTimelineElement,{contentStyle:{background:"#1d1836",color:"#000"},contentArrowStyle:{borderRight:"7px solid  #232631"},date:e.date,iconStyle:{background:e.iconBg},icon:Be("div",{className:"flex justify-center items-center w-full h-full",children:Be("img",{src:e.icon,alt:e.company_name,className:"w-[60%] h-[60%] object-contain"})}),children:[Et("div",{children:[Be("h3",{className:"text-white text-[24px] font-bold",children:e.title}),Be("p",{className:"text-secondary text-[16px] font-semibold",style:{margin:0},children:e.company_name})]}),Be("ul",{className:"mt-5 list-disc ml-5 space-y-2",children:e.points.map((t,i)=>Be("li",{className:"text-white-100 text-[14px] pl-1 tracking-wider",children:t},`experience-point-${i}`))})]}),CUe=()=>Et(pg,{children:[Et(ds.div,{variants:Fx(),children:[Be("p",{className:er.sectionSubText,children:"What I have done so far"}),Be("h2",{className:er.sectionHeadText,children:"Work Experience."})]}),Be("div",{className:"mt-20 flex flex-col",children:Be(BZ.VerticalTimeline,{children:Xke.map((e,t)=>Be(EUe,{experience:e},t))})})]}),TUe=B1(CUe,"work"),Vj=({index:e,name:t,description:i,tags:n,image:r,source_code_link:s,projectUrl:o})=>Be(ds.div,{variants:Xg("up","spring",e*.5,.75),children:Et(MZ,{options:{max:45,scale:1,speed:450},className:"bg-tertiary p-5 rounded-2xl sm:w-[300px] w-full",children:[Et("div",{className:"relative w-full h-[230px]",children:[Be("img",{src:r,alt:t,className:"w-full h-full object-cover rounded-2xl"}),Be("div",{className:"absolute inset-0 flex justify-end m-3 card-img_hover",children:Be("div",{onClick:()=>window.open(s,"_blank"),className:"black-gradient w-10 h-10 rounded-full flex justify-center items-center cursor-pointer",children:Be("img",{src:wke,alt:"github",className:"w-1/2 h-1/2 object-contain"})})})]}),Et("div",{className:"mt-5",children:[Be("h3",{className:"text-white font-bold text-[24px]",children:t}),Be("a",{className:"underline decoration-sky-500",href:o,target:"_blank",children:"Go to project"}),Be("p",{className:"mt-2 text-secondary text-[14px]",children:i})]}),Be("div",{className:"mt-4 flex flex-wrap gap-2",children:n.map(a=>Et("p",{className:`text-[14px] ${a.color}`,children:["#",a.name]},a.name))})]})}),PUe=()=>Et(pg,{children:[Et(ds.div,{variants:Fx(),children:[Be("p",{className:er.sectionSubText,children:"My work"}),Be("h2",{className:er.sectionHeadText,children:"Projects."})]}),Be("div",{className:"w-full flex",children:Be(ds.p,{variants:Xg("","",.1,1),className:"mt-3 text-secondary text-[17px] max-w-3xl leading-[30px]",children:"Following projects showcases my skills and experience through real-world examples of my work, hosted in a VPS. Each project is briefly described with links to code repositories and live demos in it. It reflects my ability to solve complex problems, work with different technologies, and manage projects effectively."})}),Be("div",{className:"mt-20 flex flex-wrap gap-7",children:qke.map((e,t)=>Be(Vj,{index:t,...e},`project-${t}`))}),Be("div",{className:"mt-20",children:Et(ds.div,{variants:Fx(),children:[Be("p",{className:er.sectionSubText,children:"My work"}),Be("h2",{className:er.sectionHeadText,children:"WordPress Projects."})]})}),Be("div",{className:"w-full flex",children:Be(ds.p,{variants:Xg("","",.1,1),className:"mt-3 text-secondary text-[17px] max-w-3xl leading-[30px]",children:"Following WordPress projects showcases my skills and experience through real-world examples of my work. Each project is briefly described with links to live demos in it. It reflects my ability to build websites using WordPress CMS and PHP, work with different technologies, and manage projects effectively."})}),Be("div",{className:"mt-20 flex flex-wrap gap-7",children:Qke.map((e,t)=>Be(Vj,{index:t,...e},`project-${t}`))})]}),DUe=B1(PUe,""),BUe=({index:e,testimonial:t,name:i,designation:n,company:r,image:s})=>Et(ds.div,{variants:Xg("","spring",e*.5,.75),className:"bg-black-200 p-10 rounded-3xl xs:w-[320px] w-full",children:[Be("p",{className:"text-white font-black text-[48px]",children:'"'}),Et("div",{className:"mt-1",children:[Be("p",{className:"text-white tracking-wider text-[18px]",children:t}),Et("div",{className:"mt-7 flex justify-between items-center gap-1",children:[Et("div",{className:"flex-1 flex flex-col",children:[Et("p",{className:"text-white font-medium text-[16px]",children:[Be("span",{className:"blue-text-gradient",children:"@"})," ",i]}),Et("p",{className:"mt-1 text-secondary text-[12px]",children:[n," of ",r]})]}),Be("img",{src:s,alt:`feedback_by-${i}`,className:"w-10 h-10 rounded-full object-cover"})]})]})]}),LUe=()=>Et("div",{className:"mt-12 bg-black-100 rounded-[20px]",children:[Be("div",{className:`${er.padding} bg-tertiary rounded-2xl min-h-[300px]`,children:Et(ds.div,{variants:Fx(),children:[Be("p",{className:er.sectionSubText,children:"What others say"}),Be("h2",{className:er.sectionHeadTextWhite,children:"Testimonials."})]})}),Be("div",{className:`${er.paddingX} -mt-20 pb-14 flex flex-wrap gap-7`,children:Yke.map((e,t)=>Be(BUe,{index:t,...e},e.name))})]}),Nx={_origin:"https://api.emailjs.com"},RUe=(e,t="https://api.emailjs.com")=>{Nx._userID=e,Nx._origin=t},LZ=(e,t,i)=>{if(!e)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!i)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class jj{constructor(t){this.status=t?t.status:0,this.text=t?t.responseText:"Network Error"}}const RZ=(e,t,i={})=>new Promise((n,r)=>{const s=new XMLHttpRequest;s.addEventListener("load",({target:o})=>{const a=new jj(o);a.status===200||a.text==="OK"?n(a):r(a)}),s.addEventListener("error",({target:o})=>{r(new jj(o))}),s.open("POST",Nx._origin+e,!0),Object.keys(i).forEach(o=>{s.setRequestHeader(o,i[o])}),s.send(t)}),IUe=(e,t,i,n)=>{const r=n||Nx._userID;return LZ(r,e,t),RZ("/api/v1.0/email/send",JSON.stringify({lib_version:"3.11.0",user_id:r,service_id:e,template_id:t,template_params:i}),{"Content-type":"application/json"})},OUe=e=>{let t;if(typeof e=="string"?t=document.querySelector(e):t=e,!t||t.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return t},FUe=(e,t,i,n)=>{const r=n||Nx._userID,s=OUe(i);LZ(r,e,t);const o=new FormData(s);return o.append("lib_version","3.11.0"),o.append("service_id",e),o.append("template_id",t),o.append("user_id",r),RZ("/api/v1.0/email/send-form",o)},NUe={init:RUe,send:IUe,sendForm:FUe},zUe=()=>{const e=ae.useRef(),[t,i]=ae.useState({name:"",email:"",message:""}),[n,r]=ae.useState(!1),s=a=>{const{name:l,value:c}=a.target;i({...t,[l]:c})},o=a=>{a.preventDefault(),r(!0),NUe.send("service_53mhdhg","template_l7yyk9s",{form_name:t.name,to_name:"Yoni",from_email:t.email,to_email:"yonisantiagosg@gmail.com",message:t.message},"21GIU2-S0fAWmmwBq").then(()=>{r(!1),alert("Thank you. I will get back to you as soon as possible."),i({name:"",email:"",message:""})},l=>{r(!1),console.log(l),alert("Something went wrong.")})};return Et("div",{className:"xl:mt-12 flex xl:flex-row flex-col-reverse gap-10 overflow-hidden",children:[Et(ds.div,{variants:Uj("left","tween",.2,1),className:"flex-[0.75] bg-black-100 p-8 rounded-2xl",children:[Be("p",{className:er.sectionSubText,children:"Get in touch"}),Be("h3",{className:er.sectionHeadTextWhite,children:"Contact."}),Et("form",{ref:e,onSubmit:o,className:"mt-12 flex flex-col gap-8",children:[Et("label",{className:"flex flex-col",children:[Be("span",{className:"text-white font-medium mb-4",children:"Your Name"}),Be("input",{type:"text",name:"name",value:t.name,onChange:s,placeholder:"What's your name?",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-lg outline-none border-none font-medium"})]}),Et("label",{className:"flex flex-col",children:[Be("span",{className:"text-white font-medium mb-4",children:"Your email"}),Be("input",{type:"email",name:"email",value:t.email,onChange:s,placeholder:"What's your email?",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-lg outline-none border-none font-medium"})]}),Et("label",{className:"flex flex-col",children:[Be("span",{className:"text-white font-medium mb-4",children:"Your Message"}),Be("textarea",{rows:7,name:"message",value:t.message,onChange:s,placeholder:"What do you want to say?",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-lg outline-none border-none font-medium"})]}),Be("button",{type:"submit",className:"bg-tertiary py-3 px-8 rounded-xl outline-none w-fit text-white font-bold shadow-md shadow-primary",children:n?"Sending...":"Send"})]})]}),Be(ds.div,{variants:Uj("right","tween",.2,1),className:"xl:flex-1 xl:h-auto md:h-[550px] h-[350px]",children:Be(Cde,{})})]})},kUe=B1(zUe,"contact"),UUe=()=>Be("footer",{className:"bg-white rounded-lg shadow dark:bg-gray-900 ",children:Et("div",{className:"w-full max-w-screen-xl mx-auto p-4 md:py-8",children:[Et("div",{className:"sm:flex sm:items-center sm:justify-between",children:[Et("a",{href:"https://yonisilvestre.com/",className:"flex items-center mb-4 sm:mb-0",children:[Be("img",{src:bZ,className:"h-8 mr-3",alt:"Flowbite Logo"}),Be("span",{className:"self-center text-xl font-semibold whitespace-nowrap dark:text-white",children:"Personal Portfolio"})]}),Be("div",{className:"sm:flex sm:items-center sm:justify-between",children:Et("div",{className:"flex mt-4 space-x-5 sm:justify-center sm:mt-0",children:[Et("a",{href:"https://github.com/yonisantiago",className:"text-gray-500 hover:text-gray-900 dark:hover:text-white",children:[Be("svg",{className:"w-4 h-4","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20",children:Be("path",{"fill-rule":"evenodd",d:"M10 .333A9.911 9.911 0 0 0 6.866 19.65c.5.092.678-.215.678-.477 0-.237-.01-1.017-.014-1.845-2.757.6-3.338-1.169-3.338-1.169a2.627 2.627 0 0 0-1.1-1.451c-.9-.615.07-.6.07-.6a2.084 2.084 0 0 1 1.518 1.021 2.11 2.11 0 0 0 2.884.823c.044-.503.268-.973.63-1.325-2.2-.25-4.516-1.1-4.516-4.9A3.832 3.832 0 0 1 4.7 7.068a3.56 3.56 0 0 1 .095-2.623s.832-.266 2.726 1.016a9.409 9.409 0 0 1 4.962 0c1.89-1.282 2.717-1.016 2.717-1.016.366.83.402 1.768.1 2.623a3.827 3.827 0 0 1 1.02 2.659c0 3.807-2.319 4.644-4.525 4.889a2.366 2.366 0 0 1 .673 1.834c0 1.326-.012 2.394-.012 2.72 0 .263.18.572.681.475A9.911 9.911 0 0 0 10 .333Z","clip-rule":"evenodd"})}),Be("span",{className:"sr-only",children:"GitHub account"})]}),Et("a",{href:"https://linkedin.com/in/yonisilvestre",className:"text-gray-500 hover:text-gray-900 dark:hover:text-white",children:[Be("svg",{className:"w-4 h-4","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20",children:Be("path",{"fill-rule":"evenodd",d:"M10 0a10 10 0 1 0 10 10A10.009 10.009 0 0 0 10 0Zm6.613 4.614a8.523 8.523 0 0 1 1.93 5.32 20.094 20.094 0 0 0-5.949-.274c-.059-.149-.122-.292-.184-.441a23.879 23.879 0 0 0-.566-1.239 11.41 11.41 0 0 0 4.769-3.366ZM8 1.707a8.821 8.821 0 0 1 2-.238 8.5 8.5 0 0 1 5.664 2.152 9.608 9.608 0 0 1-4.476 3.087A45.758 45.758 0 0 0 8 1.707ZM1.642 8.262a8.57 8.57 0 0 1 4.73-5.981A53.998 53.998 0 0 1 9.54 7.222a32.078 32.078 0 0 1-7.9 1.04h.002Zm2.01 7.46a8.51 8.51 0 0 1-2.2-5.707v-.262a31.64 31.64 0 0 0 8.777-1.219c.243.477.477.964.692 1.449-.114.032-.227.067-.336.1a13.569 13.569 0 0 0-6.942 5.636l.009.003ZM10 18.556a8.508 8.508 0 0 1-5.243-1.8 11.717 11.717 0 0 1 6.7-5.332.509.509 0 0 1 .055-.02 35.65 35.65 0 0 1 1.819 6.476 8.476 8.476 0 0 1-3.331.676Zm4.772-1.462A37.232 37.232 0 0 0 13.113 11a12.513 12.513 0 0 1 5.321.364 8.56 8.56 0 0 1-3.66 5.73h-.002Z","clip-rule":"evenodd"})}),Be("span",{className:"sr-only",children:"LinkedIn account"})]})]})})]}),Be("hr",{className:"my-6 border-gray-200 sm:mx-auto dark:border-gray-700 lg:my-8"}),Et("span",{className:"block text-sm text-gray-500 sm:text-center dark:text-gray-400",children:["© 2023 ",Be("a",{href:"https://yonisilvestre.com/",className:"hover:underline",children:"Yoni Silvestre™"}),". All Rights Reserved."]})]})}),GUe=()=>Be(yie,{children:Et("div",{className:"relative z-0 bg-gray-100",children:[Et("div",{className:"bg-hero-pattern bg-cover bg-no-repeat bg-center",children:[Be(Jke,{}),Be(yke,{})]}),Be(lUe,{}),Be(TUe,{}),Be(uUe,{}),Be(DUe,{}),Be(LUe,{}),Et("div",{className:"relative z-0",children:[Be(kUe,{}),Be(Bde,{})]}),Be(UUe,{})]})});VP.createRoot(document.getElementById("root")).render(Be(kx.StrictMode,{children:Be(GUe,{})}))});export default HUe();
